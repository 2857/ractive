<!DOCTYPE HTML>
<html>
<head>
	<title><%= moduleName %> | Ractive Test Suite</title>
	<link rel='stylesheet' href='<%= levels %>vendor/qunit.css' type='text/css' media='screen' />
</head>
<body>
	<div id='qunit'></div>
	<div id='qunit-fixture'></div>

	<script src='<%= levels %>vendor/qunit.js'></script>
	<script src='<%= levels %>vendor/qunit-html.js'></script>
	<script src='<%= levels %>vendor/simulant.js'></script>
	<script src='<%= levels %>vendor/require.js'></script>

	<script>
		_modules = [ '<%= moduleName %>' ];
	</script>

	<script>
		(function () {

			'use strict';

			var isBuild, config, i, prefixedModules = [];

			if ( /build=true/.test( window.location.search ) || /phantomjs/i.test( window.navigator.userAgent ) ) {
				isBuild = true;
				QUnit.config.autostart = false;

				config = {
					baseUrl: '../<%= levels %>src/',
					paths: {
						ractive: '<%= levels %>tmp/ractive-legacy',
						modules: '<%= levels %>test/modules',
						samples: '<%= levels %>test/samples',
						vendor: '<%= levels %>test/vendor'
					}
				};
			} else {
				config = {
					baseUrl: '../<%= levels %>src/',
					paths: {
						modules: '<%= levels %>test/modules',
						samples: '<%= levels %>test/samples',
						vendor: '<%= levels %>test/vendor'
					}
				};
			}

			require.config( config );

			// can't use .map() because of IE...
			i = _modules.length;
			while ( i-- ) {
				prefixedModules[i] = 'modules/' + _modules[i];
			}

			require( [ 'ractive' ].concat( prefixedModules ), function ( Ractive ) {
				window.Ractive = Ractive;

				Ractive.defaults.magic = /magic=true/.test( window.location.search );

				Array.prototype.slice.call( arguments, 1 ).forEach( function ( testSet ) {
					testSet();
				});

				if ( isBuild ) {
					QUnit.start();
				}
			});

		}());

	</script>
</body>
</html>
