{"version":3,"file":"ractive.runtime.min.js","sources":["ractive.runtime.js"],"sourcesContent":["/*\n\tRactive.js v0.8.0-edge\n\tThu Apr 07 2016 20:01:11 GMT+0000 (UTC) - commit 82b28d40d7b69ecb1acfbaee8b56f0006d339bc1\n\n\thttp://ractivejs.org\n\thttp://twitter.com/RactiveJS\n\n\tReleased under the MIT License.\n*/\n\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.Ractive = factory());\n}(this, function () { 'use strict';\n\n  var babelHelpers = {};\n  babelHelpers.typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n  };\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers.toConsumableArray = function (arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    } else {\n      return Array.from(arr);\n    }\n  };\n\n  babelHelpers;\n\n  var defaults = {\n  \t// render placement:\n  \tel: void 0,\n  \tappend: false,\n\n  \t// template:\n  \ttemplate: null,\n\n  \t// parse:\n  \tdelimiters: ['{{', '}}'],\n  \ttripleDelimiters: ['{{{', '}}}'],\n  \tstaticDelimiters: ['[[', ']]'],\n  \tstaticTripleDelimiters: ['[[[', ']]]'],\n  \tcsp: true,\n  \tinterpolate: false,\n  \tpreserveWhitespace: false,\n  \tsanitize: false,\n  \tstripComments: true,\n\n  \t// data & binding:\n  \tdata: {},\n  \tcomputed: {},\n  \tmagic: false,\n  \tmodifyArrays: true,\n  \tadapt: [],\n  \tisolated: false,\n  \ttwoway: true,\n  \tlazy: false,\n\n  \t// transitions:\n  \tnoIntro: false,\n  \ttransitionsEnabled: true,\n  \tcomplete: void 0,\n\n  \t// css:\n  \tcss: null,\n  \tnoCssTransform: false\n  };\n\n  // These are a subset of the easing equations found at\n  // https://raw.github.com/danro/easing-js - license info\n  // follows:\n\n  // --------------------------------------------------\n  // easing.js v0.5.4\n  // Generic set of easing functions with AMD support\n  // https://github.com/danro/easing-js\n  // This code may be freely distributed under the MIT license\n  // http://danro.mit-license.org/\n  // --------------------------------------------------\n  // All functions adapted from Thomas Fuchs & Jeremy Kahn\n  // Easing Equations (c) 2003 Robert Penner, BSD license\n  // https://raw.github.com/danro/easing-js/master/LICENSE\n  // --------------------------------------------------\n\n  // In that library, the functions named easeIn, easeOut, and\n  // easeInOut below are named easeInCubic, easeOutCubic, and\n  // (you guessed it) easeInOutCubic.\n  //\n  // You can add additional easing functions to this list, and they\n  // will be globally available.\n\n  var easing = {\n  \tlinear: function linear(pos) {\n  \t\treturn pos;\n  \t},\n  \teaseIn: function easeIn(pos) {\n  \t\treturn Math.pow(pos, 3);\n  \t},\n  \teaseOut: function easeOut(pos) {\n  \t\treturn Math.pow(pos - 1, 3) + 1;\n  \t},\n  \teaseInOut: function easeInOut(pos) {\n  \t\tif ((pos /= 0.5) < 1) {\n  \t\t\treturn 0.5 * Math.pow(pos, 3);\n  \t\t}\n  \t\treturn 0.5 * (Math.pow(pos - 2, 3) + 2);\n  \t}\n  };\n\n  var legacy = null;\n\n  /*global console, navigator */\n\n  var win = typeof window !== 'undefined' ? window : null;\n  var doc = win ? document : null;\n\n  var isClient = !!doc;\n  var isJsdom = typeof navigator !== 'undefined' && /jsDom/.test(navigator.appName);\n  var hasConsole = typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function';\n\n  var magicSupported = void 0;\n  try {\n  \tObject.defineProperty({}, 'test', { value: 0 });\n  \tmagicSupported = true;\n  } catch (e) {\n  \tmagicSupported = false;\n  }\n\n  var svg = doc ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1') : false;\n\n  var vendors = ['o', 'ms', 'moz', 'webkit'];\n\n  var html = 'http://www.w3.org/1999/xhtml';\n  var mathml = 'http://www.w3.org/1998/Math/MathML';\n  var svg$1 = 'http://www.w3.org/2000/svg';\n  var xlink = 'http://www.w3.org/1999/xlink';\n  var xml = 'http://www.w3.org/XML/1998/namespace';\n  var xmlns = 'http://www.w3.org/2000/xmlns';\n\n  var namespaces = { html: html, mathml: mathml, svg: svg$1, xlink: xlink, xml: xml, xmlns: xmlns };\n\n  var createElement;\n  var matches;\n  var div;\n  var methodNames;\n  var unprefixed;\n  var prefixed;\n  var i;\n  var j;\n  var makeFunction;\n  // Test for SVG support\n  if (!svg) {\n  \tcreateElement = function createElement(type, ns, extend) {\n  \t\tif (ns && ns !== html) {\n  \t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n  \t\t}\n\n  \t\treturn extend ? doc.createElement(type, extend) : doc.createElement(type);\n  \t};\n  } else {\n  \tcreateElement = function createElement(type, ns, extend) {\n  \t\tif (!ns || ns === html) {\n  \t\t\treturn extend ? doc.createElement(type, extend) : doc.createElement(type);\n  \t\t}\n\n  \t\treturn extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  \t};\n  }\n\n  function createDocumentFragment() {\n  \treturn doc.createDocumentFragment();\n  }\n\n  function getElement(input) {\n  \tvar output;\n\n  \tif (!input || typeof input === 'boolean') {\n  \t\treturn;\n  \t}\n\n  \tif (!win || !doc || !input) {\n  \t\treturn null;\n  \t}\n\n  \t// We already have a DOM node - no work to do. (Duck typing alert!)\n  \tif (input.nodeType) {\n  \t\treturn input;\n  \t}\n\n  \t// Get node from string\n  \tif (typeof input === 'string') {\n  \t\t// try ID first\n  \t\toutput = doc.getElementById(input);\n\n  \t\t// then as selector, if possible\n  \t\tif (!output && doc.querySelector) {\n  \t\t\toutput = doc.querySelector(input);\n  \t\t}\n\n  \t\t// did it work?\n  \t\tif (output && output.nodeType) {\n  \t\t\treturn output;\n  \t\t}\n  \t}\n\n  \t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n  \tif (input[0] && input[0].nodeType) {\n  \t\treturn input[0];\n  \t}\n\n  \treturn null;\n  }\n\n  if (!isClient) {\n  \tmatches = null;\n  } else {\n  \tdiv = createElement('div');\n  \tmethodNames = ['matches', 'matchesSelector'];\n\n  \tmakeFunction = function makeFunction(methodName) {\n  \t\treturn function (node, selector) {\n  \t\t\treturn node[methodName](selector);\n  \t\t};\n  \t};\n\n  \ti = methodNames.length;\n\n  \twhile (i-- && !matches) {\n  \t\tunprefixed = methodNames[i];\n\n  \t\tif (div[unprefixed]) {\n  \t\t\tmatches = makeFunction(unprefixed);\n  \t\t} else {\n  \t\t\tj = vendors.length;\n  \t\t\twhile (j--) {\n  \t\t\t\tprefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n  \t\t\t\tif (div[prefixed]) {\n  \t\t\t\t\tmatches = makeFunction(prefixed);\n  \t\t\t\t\tbreak;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \t// IE8...\n  \tif (!matches) {\n  \t\tmatches = function matches(node, selector) {\n  \t\t\tvar nodes, parentNode, i;\n\n  \t\t\tparentNode = node.parentNode;\n\n  \t\t\tif (!parentNode) {\n  \t\t\t\t// empty dummy <div>\n  \t\t\t\tdiv.innerHTML = '';\n\n  \t\t\t\tparentNode = div;\n  \t\t\t\tnode = node.cloneNode();\n\n  \t\t\t\tdiv.appendChild(node);\n  \t\t\t}\n\n  \t\t\tnodes = parentNode.querySelectorAll(selector);\n\n  \t\t\ti = nodes.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tif (nodes[i] === node) {\n  \t\t\t\t\treturn true;\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\treturn false;\n  \t\t};\n  \t}\n  }\n\n  function detachNode(node) {\n  \tif (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n  \t\tnode.parentNode.removeChild(node);\n  \t}\n\n  \treturn node;\n  }\n\n  function safeToStringValue(value) {\n  \treturn value == null || !value.toString ? '' : '' + value;\n  }\n\n  var create;\n  var defineProperty;\n  var defineProperties;\n  try {\n  \tObject.defineProperty({}, 'test', {\n  \t\tget: function get() {},\n  \t\tset: function set() {}\n  \t});\n\n  \tif (doc) {\n  \t\tObject.defineProperty(createElement('div'), 'test', { value: 0 });\n  \t}\n\n  \tdefineProperty = Object.defineProperty;\n  } catch (err) {\n  \t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n  \t// only use it with DOM objects (what were you smoking, MSFT?)\n  \tdefineProperty = function defineProperty(obj, prop, desc) {\n  \t\tobj[prop] = desc.value;\n  \t};\n  }\n\n  try {\n  \ttry {\n  \t\tObject.defineProperties({}, { test: { value: 0 } });\n  \t} catch (err) {\n  \t\t// TODO how do we account for this? noMagic = true;\n  \t\tthrow err;\n  \t}\n\n  \tif (doc) {\n  \t\tObject.defineProperties(createElement('div'), { test: { value: 0 } });\n  \t}\n\n  \tdefineProperties = Object.defineProperties;\n  } catch (err) {\n  \tdefineProperties = function defineProperties(obj, props) {\n  \t\tvar prop;\n\n  \t\tfor (prop in props) {\n  \t\t\tif (props.hasOwnProperty(prop)) {\n  \t\t\t\tdefineProperty(obj, prop, props[prop]);\n  \t\t\t}\n  \t\t}\n  \t};\n  }\n\n  try {\n  \tObject.create(null);\n\n  \tcreate = Object.create;\n  } catch (err) {\n  \t// sigh\n  \tcreate = function () {\n  \t\tvar F = function F() {};\n\n  \t\treturn function (proto, props) {\n  \t\t\tvar obj;\n\n  \t\t\tif (proto === null) {\n  \t\t\t\treturn {};\n  \t\t\t}\n\n  \t\t\tF.prototype = proto;\n  \t\t\tobj = new F();\n\n  \t\t\tif (props) {\n  \t\t\t\tObject.defineProperties(obj, props);\n  \t\t\t}\n\n  \t\t\treturn obj;\n  \t\t};\n  \t}();\n  }\n\n  function extendObj(target) {\n  \tvar prop;\n\n  \tfor (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\tsources[_key - 1] = arguments[_key];\n  \t}\n\n  \tsources.forEach(function (source) {\n  \t\tfor (prop in source) {\n  \t\t\tif (hasOwn.call(source, prop)) {\n  \t\t\t\ttarget[prop] = source[prop];\n  \t\t\t}\n  \t\t}\n  \t});\n\n  \treturn target;\n  }\n\n  function fillGaps(target) {\n  \tfor (var _len2 = arguments.length, sources = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n  \t\tsources[_key2 - 1] = arguments[_key2];\n  \t}\n\n  \tsources.forEach(function (s) {\n  \t\tfor (var key in s) {\n  \t\t\tif (hasOwn.call(s, key) && !(key in target)) {\n  \t\t\t\ttarget[key] = s[key];\n  \t\t\t}\n  \t\t}\n  \t});\n\n  \treturn target;\n  }\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n\n  var toString = Object.prototype.toString;\n  // thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\n  function isArray(thing) {\n  \treturn toString.call(thing) === '[object Array]';\n  }\n\n  function isEqual(a, b) {\n  \tif (a === null && b === null) {\n  \t\treturn true;\n  \t}\n\n  \tif ((typeof a === 'undefined' ? 'undefined' : babelHelpers.typeof(a)) === 'object' || (typeof b === 'undefined' ? 'undefined' : babelHelpers.typeof(b)) === 'object') {\n  \t\treturn false;\n  \t}\n\n  \treturn a === b;\n  }\n\n  // http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\n  function isNumeric(thing) {\n  \treturn !isNaN(parseFloat(thing)) && isFinite(thing);\n  }\n\n  function isObject(thing) {\n  \treturn thing && toString.call(thing) === '[object Object]';\n  }\n\n  function noop () {}\n\n  var alreadyWarned = {};\n  var log;\n  var printWarning;\n  var welcome;\n  if (hasConsole) {\n  \t(function () {\n  \t\tvar welcomeIntro = ['%cRactive.js %c0.8.0-edge %cin debug mode, %cmore...', 'color: rgb(114, 157, 52); font-weight: normal;', 'color: rgb(85, 85, 85); font-weight: normal;', 'color: rgb(85, 85, 85); font-weight: normal;', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'];\n  \t\tvar welcomeMessage = 'You\\'re running Ractive 0.8.0-edge in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\\n\\nTo disable debug mode, add this line at the start of your app:\\n  Ractive.DEBUG = false;\\n\\nTo disable debug mode when your app is minified, add this snippet:\\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\\n\\nGet help and support:\\n  http://docs.ractivejs.org\\n  http://stackoverflow.com/questions/tagged/ractivejs\\n  http://groups.google.com/forum/#!forum/ractive-js\\n  http://twitter.com/ractivejs\\n\\nFound a bug? Raise an issue:\\n  https://github.com/ractivejs/ractive/issues\\n\\n';\n\n  \t\twelcome = function welcome$$() {\n  \t\t\tvar hasGroup = !!console.groupCollapsed;\n  \t\t\tconsole[hasGroup ? 'groupCollapsed' : 'log'].apply(console, welcomeIntro);\n  \t\t\tconsole.log(welcomeMessage);\n  \t\t\tif (hasGroup) {\n  \t\t\t\tconsole.groupEnd(welcomeIntro);\n  \t\t\t}\n\n  \t\t\twelcome = noop;\n  \t\t};\n\n  \t\tprintWarning = function printWarning(message, args) {\n  \t\t\twelcome();\n\n  \t\t\t// extract information about the instance this message pertains to, if applicable\n  \t\t\tif (babelHelpers.typeof(args[args.length - 1]) === 'object') {\n  \t\t\t\tvar options = args.pop();\n  \t\t\t\tvar ractive = options ? options.ractive : null;\n\n  \t\t\t\tif (ractive) {\n  \t\t\t\t\t// if this is an instance of a component that we know the name of, add\n  \t\t\t\t\t// it to the message\n  \t\t\t\t\tvar name = void 0;\n  \t\t\t\t\tif (ractive.component && (name = ractive.component.name)) {\n  \t\t\t\t\t\tmessage = '<' + name + '> ' + message;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar node = void 0;\n  \t\t\t\t\tif (node = options.node || ractive.fragment && ractive.fragment.rendered && ractive.find('*')) {\n  \t\t\t\t\t\targs.push(node);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tconsole.warn.apply(console, ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(args));\n  \t\t};\n\n  \t\tlog = function log() {\n  \t\t\tconsole.log.apply(console, arguments);\n  \t\t};\n  \t})();\n  } else {\n  \tprintWarning = log = welcome = noop;\n  }\n\n  function format(message, args) {\n  \treturn message.replace(/%s/g, function () {\n  \t\treturn args.shift();\n  \t});\n  }\n\n  function fatal(message) {\n  \tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\targs[_key - 1] = arguments[_key];\n  \t}\n\n  \tmessage = format(message, args);\n  \tthrow new Error(message);\n  }\n\n  function logIfDebug() {\n  \tif (Ractive.DEBUG) {\n  \t\tlog.apply(null, arguments);\n  \t}\n  }\n\n  function warn(message) {\n  \tfor (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n  \t\targs[_key2 - 1] = arguments[_key2];\n  \t}\n\n  \tmessage = format(message, args);\n  \tprintWarning(message, args);\n  }\n\n  function warnOnce(message) {\n  \tfor (var _len3 = arguments.length, args = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n  \t\targs[_key3 - 1] = arguments[_key3];\n  \t}\n\n  \tmessage = format(message, args);\n\n  \tif (alreadyWarned[message]) {\n  \t\treturn;\n  \t}\n\n  \talreadyWarned[message] = true;\n  \tprintWarning(message, args);\n  }\n\n  function warnIfDebug() {\n  \tif (Ractive.DEBUG) {\n  \t\twarn.apply(null, arguments);\n  \t}\n  }\n\n  function warnOnceIfDebug() {\n  \tif (Ractive.DEBUG) {\n  \t\twarnOnce.apply(null, arguments);\n  \t}\n  }\n\n  // Error messages that are used (or could be) in multiple places\n  var badArguments = 'Bad arguments';\n  var noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\n  var missingPlugin = function missingPlugin(name, type) {\n    return 'Missing \"' + name + '\" ' + type + ' plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#' + type + 's';\n  };\n\n  function findInViewHierarchy(registryName, ractive, name) {\n  \tvar instance = findInstance(registryName, ractive, name);\n  \treturn instance ? instance[registryName][name] : null;\n  }\n\n  function findInstance(registryName, ractive, name) {\n  \twhile (ractive) {\n  \t\tif (name in ractive[registryName]) {\n  \t\t\treturn ractive;\n  \t\t}\n\n  \t\tif (ractive.isolated) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tractive = ractive.parent;\n  \t}\n  }\n\n  function interpolate(from, to, ractive, type) {\n  \tif (from === to) return null;\n\n  \tif (type) {\n  \t\tvar interpol = findInViewHierarchy('interpolators', ractive, type);\n  \t\tif (interpol) return interpol(from, to) || null;\n\n  \t\tfatal(missingPlugin(type, 'interpolator'));\n  \t}\n\n  \treturn interpolators.number(from, to) || interpolators.array(from, to) || interpolators.object(from, to) || null;\n  }\n\n  function snap(to) {\n  \treturn function () {\n  \t\treturn to;\n  \t};\n  }\n\n  var interpolators = {\n  \tnumber: function number(from, to) {\n  \t\tvar delta;\n\n  \t\tif (!isNumeric(from) || !isNumeric(to)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tfrom = +from;\n  \t\tto = +to;\n\n  \t\tdelta = to - from;\n\n  \t\tif (!delta) {\n  \t\t\treturn function () {\n  \t\t\t\treturn from;\n  \t\t\t};\n  \t\t}\n\n  \t\treturn function (t) {\n  \t\t\treturn from + t * delta;\n  \t\t};\n  \t},\n\n  \tarray: function array(from, to) {\n  \t\tvar intermediate, interpolators, len, i;\n\n  \t\tif (!isArray(from) || !isArray(to)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tintermediate = [];\n  \t\tinterpolators = [];\n\n  \t\ti = len = Math.min(from.length, to.length);\n  \t\twhile (i--) {\n  \t\t\tinterpolators[i] = interpolate(from[i], to[i]);\n  \t\t}\n\n  \t\t// surplus values - don't interpolate, but don't exclude them either\n  \t\tfor (i = len; i < from.length; i += 1) {\n  \t\t\tintermediate[i] = from[i];\n  \t\t}\n\n  \t\tfor (i = len; i < to.length; i += 1) {\n  \t\t\tintermediate[i] = to[i];\n  \t\t}\n\n  \t\treturn function (t) {\n  \t\t\tvar i = len;\n\n  \t\t\twhile (i--) {\n  \t\t\t\tintermediate[i] = interpolators[i](t);\n  \t\t\t}\n\n  \t\t\treturn intermediate;\n  \t\t};\n  \t},\n\n  \tobject: function object(from, to) {\n  \t\tvar properties, len, interpolators, intermediate, prop;\n\n  \t\tif (!isObject(from) || !isObject(to)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tproperties = [];\n  \t\tintermediate = {};\n  \t\tinterpolators = {};\n\n  \t\tfor (prop in from) {\n  \t\t\tif (hasOwn.call(from, prop)) {\n  \t\t\t\tif (hasOwn.call(to, prop)) {\n  \t\t\t\t\tproperties.push(prop);\n  \t\t\t\t\tinterpolators[prop] = interpolate(from[prop], to[prop]) || snap(to[prop]);\n  \t\t\t\t} else {\n  \t\t\t\t\tintermediate[prop] = from[prop];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tfor (prop in to) {\n  \t\t\tif (hasOwn.call(to, prop) && !hasOwn.call(from, prop)) {\n  \t\t\t\tintermediate[prop] = to[prop];\n  \t\t\t}\n  \t\t}\n\n  \t\tlen = properties.length;\n\n  \t\treturn function (t) {\n  \t\t\tvar i = len,\n  \t\t\t    prop;\n\n  \t\t\twhile (i--) {\n  \t\t\t\tprop = properties[i];\n\n  \t\t\t\tintermediate[prop] = interpolators[prop](t);\n  \t\t\t}\n\n  \t\t\treturn intermediate;\n  \t\t};\n  \t}\n  };\n\n  var refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\n  var splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\n  var escapeKeyPattern = /\\\\|\\./g;\n  var unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\n  function escapeKey(key) {\n  \tif (typeof key === 'string') {\n  \t\treturn key.replace(escapeKeyPattern, '\\\\$&');\n  \t}\n\n  \treturn key;\n  }\n\n  function normalise(ref) {\n  \treturn ref ? ref.replace(refPattern, '.$1') : '';\n  }\n\n  function splitKeypathI(keypath) {\n  \tvar result = [],\n  \t    match = void 0;\n\n  \tkeypath = normalise(keypath);\n\n  \twhile (match = splitPattern.exec(keypath)) {\n  \t\tvar index = match.index + match[1].length;\n  \t\tresult.push(keypath.substr(0, index));\n  \t\tkeypath = keypath.substr(index + 1);\n  \t}\n\n  \tresult.push(keypath);\n\n  \treturn result;\n  }\n\n  function unescapeKey(key) {\n  \tif (typeof key === 'string') {\n  \t\treturn key.replace(unescapeKeyPattern, '$1$2');\n  \t}\n\n  \treturn key;\n  }\n\n  var errorMessage = 'Cannot add to a non-numeric value';\n\n  function add(ractive, keypath, d) {\n  \tif (typeof keypath !== 'string' || !isNumeric(d)) {\n  \t\tthrow new Error('Bad arguments');\n  \t}\n\n  \tvar changes = void 0;\n\n  \tif (/\\*/.test(keypath)) {\n  \t\tchanges = {};\n\n  \t\tractive.viewmodel.findMatches(splitKeypathI(keypath)).forEach(function (model) {\n  \t\t\tvar value = model.get();\n\n  \t\t\tif (!isNumeric(value)) throw new Error(errorMessage);\n\n  \t\t\tchanges[model.getKeypath()] = value + d;\n  \t\t});\n\n  \t\treturn ractive.set(changes);\n  \t}\n\n  \tvar value = ractive.get(keypath);\n\n  \tif (!isNumeric(value)) {\n  \t\tthrow new Error(errorMessage);\n  \t}\n\n  \treturn ractive.set(keypath, +value + d);\n  }\n\n  function Ractive$add(keypath, d) {\n  \treturn add(this, keypath, d === undefined ? 1 : +d);\n  }\n\n  // TODO: deprecate in future release\n  var deprecations = {\n  \tconstruct: {\n  \t\tdeprecated: 'beforeInit',\n  \t\treplacement: 'onconstruct'\n  \t},\n  \trender: {\n  \t\tdeprecated: 'init',\n  \t\tmessage: 'The \"init\" method has been deprecated ' + 'and will likely be removed in a future release. ' + 'You can either use the \"oninit\" method which will fire ' + 'only once prior to, and regardless of, any eventual ractive ' + 'instance being rendered, or if you need to access the ' + 'rendered DOM, use \"onrender\" instead. ' + 'See http://docs.ractivejs.org/latest/migrating for more information.'\n  \t},\n  \tcomplete: {\n  \t\tdeprecated: 'complete',\n  \t\treplacement: 'oncomplete'\n  \t}\n  };\n\n  var Hook = function () {\n  \tfunction Hook(event) {\n  \t\tbabelHelpers.classCallCheck(this, Hook);\n\n  \t\tthis.event = event;\n  \t\tthis.method = 'on' + event;\n  \t\tthis.deprecate = deprecations[event];\n  \t}\n\n  \tHook.prototype.call = function call(method, ractive, arg) {\n  \t\tif (ractive[method]) {\n  \t\t\targ ? ractive[method](arg) : ractive[method]();\n  \t\t\treturn true;\n  \t\t}\n  \t};\n\n  \tHook.prototype.fire = function fire(ractive, arg) {\n  \t\tthis.call(this.method, ractive, arg);\n\n  \t\t// handle deprecations\n  \t\tif (!ractive[this.method] && this.deprecate && this.call(this.deprecate.deprecated, ractive, arg)) {\n  \t\t\tif (this.deprecate.message) {\n  \t\t\t\twarnIfDebug(this.deprecate.message);\n  \t\t\t} else {\n  \t\t\t\twarnIfDebug('The method \"%s\" has been deprecated in favor of \"%s\" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.', this.deprecate.deprecated, this.deprecate.replacement);\n  \t\t\t}\n  \t\t}\n\n  \t\t// TODO should probably use internal method, in case ractive.fire was overwritten\n  \t\targ ? ractive.fire(this.event, arg) : ractive.fire(this.event);\n  \t};\n\n  \treturn Hook;\n  }();\n\n  function addToArray(array, value) {\n  \tvar index = array.indexOf(value);\n\n  \tif (index === -1) {\n  \t\tarray.push(value);\n  \t}\n  }\n\n  function arrayContains(array, value) {\n  \tfor (var i = 0, c = array.length; i < c; i++) {\n  \t\tif (array[i] == value) {\n  \t\t\treturn true;\n  \t\t}\n  \t}\n\n  \treturn false;\n  }\n\n  function arrayContentsMatch(a, b) {\n  \tvar i;\n\n  \tif (!isArray(a) || !isArray(b)) {\n  \t\treturn false;\n  \t}\n\n  \tif (a.length !== b.length) {\n  \t\treturn false;\n  \t}\n\n  \ti = a.length;\n  \twhile (i--) {\n  \t\tif (a[i] !== b[i]) {\n  \t\t\treturn false;\n  \t\t}\n  \t}\n\n  \treturn true;\n  }\n\n  function ensureArray(x) {\n  \tif (typeof x === 'string') {\n  \t\treturn [x];\n  \t}\n\n  \tif (x === undefined) {\n  \t\treturn [];\n  \t}\n\n  \treturn x;\n  }\n\n  function lastItem(array) {\n  \treturn array[array.length - 1];\n  }\n\n  function removeFromArray(array, member) {\n  \tif (!array) {\n  \t\treturn;\n  \t}\n\n  \tvar index = array.indexOf(member);\n\n  \tif (index !== -1) {\n  \t\tarray.splice(index, 1);\n  \t}\n  }\n\n  function toArray(arrayLike) {\n  \tvar array = [],\n  \t    i = arrayLike.length;\n  \twhile (i--) {\n  \t\tarray[i] = arrayLike[i];\n  \t}\n\n  \treturn array;\n  }\n\n  var _Promise2;\n  var PENDING = {};\n  var FULFILLED = {};\n  var REJECTED = {};\n  if (typeof Promise === 'function') {\n  \t// use native Promise\n  \t_Promise2 = Promise;\n  } else {\n  \t_Promise2 = function _Promise(callback) {\n  \t\tvar fulfilledHandlers = [],\n  \t\t    rejectedHandlers = [],\n  \t\t    state = PENDING,\n  \t\t    result,\n  \t\t    dispatchHandlers,\n  \t\t    makeResolver,\n  \t\t    fulfil,\n  \t\t    reject,\n  \t\t    promise;\n\n  \t\tmakeResolver = function makeResolver(newState) {\n  \t\t\treturn function (value) {\n  \t\t\t\tif (state !== PENDING) {\n  \t\t\t\t\treturn;\n  \t\t\t\t}\n\n  \t\t\t\tresult = value;\n  \t\t\t\tstate = newState;\n\n  \t\t\t\tdispatchHandlers = makeDispatcher(state === FULFILLED ? fulfilledHandlers : rejectedHandlers, result);\n\n  \t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n  \t\t\t\twait(dispatchHandlers);\n  \t\t\t};\n  \t\t};\n\n  \t\tfulfil = makeResolver(FULFILLED);\n  \t\treject = makeResolver(REJECTED);\n\n  \t\ttry {\n  \t\t\tcallback(fulfil, reject);\n  \t\t} catch (err) {\n  \t\t\treject(err);\n  \t\t}\n\n  \t\tpromise = {\n  \t\t\t// `then()` returns a Promise - 2.2.7\n  \t\t\tthen: function then(onFulfilled, onRejected) {\n  \t\t\t\tvar promise2 = new _Promise2(function (fulfil, reject) {\n\n  \t\t\t\t\tvar processResolutionHandler = function processResolutionHandler(handler, handlers, forward) {\n\n  \t\t\t\t\t\t// 2.2.1.1\n  \t\t\t\t\t\tif (typeof handler === 'function') {\n  \t\t\t\t\t\t\thandlers.push(function (p1result) {\n  \t\t\t\t\t\t\t\tvar x;\n\n  \t\t\t\t\t\t\t\ttry {\n  \t\t\t\t\t\t\t\t\tx = handler(p1result);\n  \t\t\t\t\t\t\t\t\tresolve(promise2, x, fulfil, reject);\n  \t\t\t\t\t\t\t\t} catch (err) {\n  \t\t\t\t\t\t\t\t\treject(err);\n  \t\t\t\t\t\t\t\t}\n  \t\t\t\t\t\t\t});\n  \t\t\t\t\t\t} else {\n  \t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n  \t\t\t\t\t\t\t// are not given\n  \t\t\t\t\t\t\thandlers.push(forward);\n  \t\t\t\t\t\t}\n  \t\t\t\t\t};\n\n  \t\t\t\t\t// 2.2\n  \t\t\t\t\tprocessResolutionHandler(onFulfilled, fulfilledHandlers, fulfil);\n  \t\t\t\t\tprocessResolutionHandler(onRejected, rejectedHandlers, reject);\n\n  \t\t\t\t\tif (state !== PENDING) {\n  \t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n  \t\t\t\t\t\twait(dispatchHandlers);\n  \t\t\t\t\t}\n  \t\t\t\t});\n\n  \t\t\t\treturn promise2;\n  \t\t\t}\n  \t\t};\n\n  \t\tpromise['catch'] = function (onRejected) {\n  \t\t\treturn this.then(null, onRejected);\n  \t\t};\n\n  \t\treturn promise;\n  \t};\n\n  \t_Promise2.all = function (promises) {\n  \t\treturn new _Promise2(function (fulfil, reject) {\n  \t\t\tvar result = [],\n  \t\t\t    pending,\n  \t\t\t    i,\n  \t\t\t    processPromise;\n\n  \t\t\tif (!promises.length) {\n  \t\t\t\tfulfil(result);\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tprocessPromise = function processPromise(promise, i) {\n  \t\t\t\tif (promise && typeof promise.then === 'function') {\n  \t\t\t\t\tpromise.then(function (value) {\n  \t\t\t\t\t\tresult[i] = value;\n  \t\t\t\t\t\t--pending || fulfil(result);\n  \t\t\t\t\t}, reject);\n  \t\t\t\t} else {\n  \t\t\t\t\tresult[i] = promise;\n  \t\t\t\t\t--pending || fulfil(result);\n  \t\t\t\t}\n  \t\t\t};\n\n  \t\t\tpending = i = promises.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tprocessPromise(promises[i], i);\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \t_Promise2.resolve = function (value) {\n  \t\treturn new _Promise2(function (fulfil) {\n  \t\t\tfulfil(value);\n  \t\t});\n  \t};\n\n  \t_Promise2.reject = function (reason) {\n  \t\treturn new _Promise2(function (fulfil, reject) {\n  \t\t\treject(reason);\n  \t\t});\n  \t};\n  }\n\n  var Promise$1 = _Promise2;\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  function wait(callback) {\n  \tsetTimeout(callback, 0);\n  }\n\n  function makeDispatcher(handlers, result) {\n  \treturn function () {\n  \t\tvar handler;\n\n  \t\twhile (handler = handlers.shift()) {\n  \t\t\thandler(result);\n  \t\t}\n  \t};\n  }\n\n  function resolve(promise, x, fulfil, reject) {\n  \t// Promise Resolution Procedure\n  \tvar then;\n\n  \t// 2.3.1\n  \tif (x === promise) {\n  \t\tthrow new TypeError('A promise\\'s fulfillment handler cannot return the same promise');\n  \t}\n\n  \t// 2.3.2\n  \tif (x instanceof _Promise2) {\n  \t\tx.then(fulfil, reject);\n  \t}\n\n  \t// 2.3.3\n  \telse if (x && ((typeof x === 'undefined' ? 'undefined' : babelHelpers.typeof(x)) === 'object' || typeof x === 'function')) {\n  \t\t\ttry {\n  \t\t\t\tthen = x.then; // 2.3.3.1\n  \t\t\t} catch (e) {\n  \t\t\t\treject(e); // 2.3.3.2\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\t// 2.3.3.3\n  \t\t\tif (typeof then === 'function') {\n  \t\t\t\tvar called, resolvePromise, rejectPromise;\n\n  \t\t\t\tresolvePromise = function resolvePromise(y) {\n  \t\t\t\t\tif (called) {\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n  \t\t\t\t\tcalled = true;\n  \t\t\t\t\tresolve(promise, y, fulfil, reject);\n  \t\t\t\t};\n\n  \t\t\t\trejectPromise = function rejectPromise(r) {\n  \t\t\t\t\tif (called) {\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n  \t\t\t\t\tcalled = true;\n  \t\t\t\t\treject(r);\n  \t\t\t\t};\n\n  \t\t\t\ttry {\n  \t\t\t\t\tthen.call(x, resolvePromise, rejectPromise);\n  \t\t\t\t} catch (e) {\n  \t\t\t\t\tif (!called) {\n  \t\t\t\t\t\t// 2.3.3.3.4.1\n  \t\t\t\t\t\treject(e); // 2.3.3.3.4.2\n  \t\t\t\t\t\tcalled = true;\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tfulfil(x);\n  \t\t\t}\n  \t\t} else {\n  \t\t\tfulfil(x);\n  \t\t}\n  }\n\n  var TransitionManager = function () {\n  \tfunction TransitionManager(callback, parent) {\n  \t\tbabelHelpers.classCallCheck(this, TransitionManager);\n\n  \t\tthis.callback = callback;\n  \t\tthis.parent = parent;\n\n  \t\tthis.intros = [];\n  \t\tthis.outros = [];\n\n  \t\tthis.children = [];\n  \t\tthis.totalChildren = this.outroChildren = 0;\n\n  \t\tthis.detachQueue = [];\n  \t\tthis.outrosComplete = false;\n\n  \t\tif (parent) {\n  \t\t\tparent.addChild(this);\n  \t\t}\n  \t}\n\n  \tTransitionManager.prototype.add = function add(transition) {\n  \t\tvar list = transition.isIntro ? this.intros : this.outros;\n  \t\tlist.push(transition);\n  \t};\n\n  \tTransitionManager.prototype.addChild = function addChild(child) {\n  \t\tthis.children.push(child);\n\n  \t\tthis.totalChildren += 1;\n  \t\tthis.outroChildren += 1;\n  \t};\n\n  \tTransitionManager.prototype.decrementOutros = function decrementOutros() {\n  \t\tthis.outroChildren -= 1;\n  \t\tcheck(this);\n  \t};\n\n  \tTransitionManager.prototype.decrementTotal = function decrementTotal() {\n  \t\tthis.totalChildren -= 1;\n  \t\tcheck(this);\n  \t};\n\n  \tTransitionManager.prototype.detachNodes = function detachNodes() {\n  \t\tthis.detachQueue.forEach(detach);\n  \t\tthis.children.forEach(_detachNodes);\n  \t};\n\n  \tTransitionManager.prototype.remove = function remove(transition) {\n  \t\tvar list = transition.isIntro ? this.intros : this.outros;\n  \t\tremoveFromArray(list, transition);\n  \t\tcheck(this);\n  \t};\n\n  \tTransitionManager.prototype.start = function start() {\n  \t\tthis.intros.concat(this.outros).forEach(function (t) {\n  \t\t\treturn t.start();\n  \t\t});\n  \t\tthis.ready = true;\n  \t\tcheck(this);\n  \t};\n\n  \treturn TransitionManager;\n  }();\n\n  function detach(element) {\n  \telement.detach();\n  }\n\n  function _detachNodes(tm) {\n  \t// _ to avoid transpiler quirk\n  \ttm.detachNodes();\n  }\n\n  function check(tm) {\n  \tif (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  \t// If all outros are complete, and we haven't already done this,\n  \t// we notify the parent if there is one, otherwise\n  \t// start detaching nodes\n  \tif (!tm.outrosComplete) {\n  \t\tif (tm.parent && !tm.parent.outrosComplete) {\n  \t\t\ttm.parent.decrementOutros(tm);\n  \t\t} else {\n  \t\t\ttm.detachNodes();\n  \t\t}\n\n  \t\ttm.outrosComplete = true;\n  \t}\n\n  \t// Once everything is done, we can notify parent transition\n  \t// manager and call the callback\n  \tif (!tm.intros.length && !tm.totalChildren) {\n  \t\tif (typeof tm.callback === 'function') {\n  \t\t\ttm.callback();\n  \t\t}\n\n  \t\tif (tm.parent) {\n  \t\t\ttm.parent.decrementTotal();\n  \t\t}\n  \t}\n  }\n\n  var changeHook = new Hook('change');\n\n  var batch = void 0;\n\n  var runloop = {\n  \tstart: function start(instance, returnPromise) {\n  \t\tvar promise, fulfilPromise;\n\n  \t\tif (returnPromise) {\n  \t\t\tpromise = new Promise$1(function (f) {\n  \t\t\t\treturn fulfilPromise = f;\n  \t\t\t});\n  \t\t}\n\n  \t\tbatch = {\n  \t\t\tpreviousBatch: batch,\n  \t\t\ttransitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n  \t\t\tfragments: [],\n  \t\t\ttasks: [],\n  \t\t\timmediateObservers: [],\n  \t\t\tdeferredObservers: [],\n  \t\t\tinstance: instance\n  \t\t};\n\n  \t\treturn promise;\n  \t},\n  \tend: function end() {\n  \t\tflushChanges();\n  \t\tbatch = batch.previousBatch;\n  \t},\n  \taddFragment: function addFragment(fragment) {\n  \t\taddToArray(batch.fragments, fragment);\n  \t},\n  \taddObserver: function addObserver(observer, defer) {\n  \t\taddToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n  \t},\n  \tregisterTransition: function registerTransition(transition) {\n  \t\ttransition._manager = batch.transitionManager;\n  \t\tbatch.transitionManager.add(transition);\n  \t},\n\n\n  \t// synchronise node detachments with transition ends\n  \tdetachWhenReady: function detachWhenReady(thing) {\n  \t\tbatch.transitionManager.detachQueue.push(thing);\n  \t},\n  \tscheduleTask: function scheduleTask(task, postRender) {\n  \t\tvar _batch;\n\n  \t\tif (!batch) {\n  \t\t\ttask();\n  \t\t} else {\n  \t\t\t_batch = batch;\n  \t\t\twhile (postRender && _batch.previousBatch) {\n  \t\t\t\t// this can't happen until the DOM has been fully updated\n  \t\t\t\t// otherwise in some situations (with components inside elements)\n  \t\t\t\t// transitions and decorators will initialise prematurely\n  \t\t\t\t_batch = _batch.previousBatch;\n  \t\t\t}\n\n  \t\t\t_batch.tasks.push(task);\n  \t\t}\n  \t}\n  };\n\n  function dispatch(observer) {\n  \tobserver.dispatch();\n  }\n\n  function flushChanges() {\n  \tvar which = batch.immediateObservers;\n  \tbatch.immediateObservers = [];\n  \twhich.forEach(dispatch);\n\n  \t// Now that changes have been fully propagated, we can update the DOM\n  \t// and complete other tasks\n  \tvar i = batch.fragments.length;\n  \tvar fragment = void 0;\n\n  \twhich = batch.fragments;\n  \tbatch.fragments = [];\n\n  \twhile (i--) {\n  \t\tfragment = which[i];\n\n  \t\t// TODO deprecate this. It's annoying and serves no useful function\n  \t\tvar ractive = fragment.ractive;\n  \t\tchangeHook.fire(ractive, ractive.viewmodel.changes);\n  \t\tractive.viewmodel.changes = {};\n\n  \t\tfragment.update();\n  \t}\n\n  \tbatch.transitionManager.start();\n\n  \twhich = batch.deferredObservers;\n  \tbatch.deferredObservers = [];\n  \twhich.forEach(dispatch);\n\n  \tvar tasks = batch.tasks;\n  \tbatch.tasks = [];\n\n  \tfor (i = 0; i < tasks.length; i += 1) {\n  \t\ttasks[i]();\n  \t}\n\n  \t// If updating the view caused some model blowback - e.g. a triple\n  \t// containing <option> elements caused the binding on the <select>\n  \t// to update - then we start over\n  \tif (batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length) return flushChanges();\n  }\n\n  var noAnimation = Promise$1.resolve();\n  defineProperty(noAnimation, 'stop', { value: noop });\n\n  var linear = easing.linear;\n\n  function getOptions(options, instance) {\n  \toptions = options || {};\n\n  \tvar easing = void 0;\n  \tif (options.easing) {\n  \t\teasing = typeof options.easing === 'function' ? options.easing : instance.easing[options.easing];\n  \t}\n\n  \treturn {\n  \t\teasing: easing || linear,\n  \t\tduration: 'duration' in options ? options.duration : 400,\n  \t\tcomplete: options.complete || noop,\n  \t\tstep: options.step || noop\n  \t};\n  }\n\n  function Ractive$animate(keypath, to, options) {\n  \tif ((typeof keypath === 'undefined' ? 'undefined' : babelHelpers.typeof(keypath)) === 'object') {\n  \t\tvar keys = Object.keys(keypath);\n\n  \t\tthrow new Error('ractive.animate(...) no longer supports objects. Instead of ractive.animate({\\n  ' + keys.map(function (key) {\n  \t\t\treturn '\\'' + key + '\\': ' + keypath[key];\n  \t\t}).join('\\n  ') + '\\n}, {...}), do\\n\\n' + keys.map(function (key) {\n  \t\t\treturn 'ractive.animate(\\'' + key + '\\', ' + keypath[key] + ', {...});';\n  \t\t}).join('\\n') + '\\n');\n  \t}\n\n  \toptions = getOptions(options, this);\n\n  \tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \tvar from = model.get();\n\n  \t// don't bother animating values that stay the same\n  \tif (isEqual(from, to)) {\n  \t\toptions.complete(options.to);\n  \t\treturn noAnimation; // TODO should this have .then and .catch methods?\n  \t}\n\n  \tvar interpolator = interpolate(from, to, this, options.interpolator);\n\n  \t// if we can't interpolate the value, set it immediately\n  \tif (!interpolator) {\n  \t\trunloop.start();\n  \t\tmodel.set(to);\n  \t\trunloop.end();\n\n  \t\treturn noAnimation;\n  \t}\n\n  \treturn model.animate(from, to, options, interpolator);\n  }\n\n  var detachHook = new Hook('detach');\n\n  function Ractive$detach() {\n  \tif (this.isDetached) {\n  \t\treturn this.el;\n  \t}\n\n  \tif (this.el) {\n  \t\tremoveFromArray(this.el.__ractive_instances__, this);\n  \t}\n\n  \tthis.el = this.fragment.detach();\n  \tthis.isDetached = true;\n\n  \tdetachHook.fire(this);\n  \treturn this.el;\n  }\n\n  function Ractive$find(selector) {\n  \tif (!this.el) throw new Error(\"Cannot call ractive.find('\" + selector + \"') unless instance is rendered to the DOM\");\n\n  \treturn this.fragment.find(selector);\n  }\n\n  function sortByDocumentPosition(node, otherNode) {\n  \tif (node.compareDocumentPosition) {\n  \t\tvar bitmask = node.compareDocumentPosition(otherNode);\n  \t\treturn bitmask & 2 ? 1 : -1;\n  \t}\n\n  \t// In old IE, we can piggy back on the mechanism for\n  \t// comparing component positions\n  \treturn sortByItemPosition(node, otherNode);\n  }\n\n  function sortByItemPosition(a, b) {\n  \tvar ancestryA = getAncestry(a.component || a._ractive.proxy);\n  \tvar ancestryB = getAncestry(b.component || b._ractive.proxy);\n\n  \tvar oldestA = lastItem(ancestryA);\n  \tvar oldestB = lastItem(ancestryB);\n  \tvar mutualAncestor = void 0;\n\n  \t// remove items from the end of both ancestries as long as they are identical\n  \t// - the final one removed is the closest mutual ancestor\n  \twhile (oldestA && oldestA === oldestB) {\n  \t\tancestryA.pop();\n  \t\tancestryB.pop();\n\n  \t\tmutualAncestor = oldestA;\n\n  \t\toldestA = lastItem(ancestryA);\n  \t\toldestB = lastItem(ancestryB);\n  \t}\n\n  \t// now that we have the mutual ancestor, we can find which is earliest\n  \toldestA = oldestA.component || oldestA;\n  \toldestB = oldestB.component || oldestB;\n\n  \tvar fragmentA = oldestA.parentFragment;\n  \tvar fragmentB = oldestB.parentFragment;\n\n  \t// if both items share a parent fragment, our job is easy\n  \tif (fragmentA === fragmentB) {\n  \t\tvar indexA = fragmentA.items.indexOf(oldestA);\n  \t\tvar indexB = fragmentB.items.indexOf(oldestB);\n\n  \t\t// if it's the same index, it means one contains the other,\n  \t\t// so we see which has the longest ancestry\n  \t\treturn indexA - indexB || ancestryA.length - ancestryB.length;\n  \t}\n\n  \t// if mutual ancestor is a section, we first test to see which section\n  \t// fragment comes first\n  \tvar fragments = mutualAncestor.iterations;\n  \tif (fragments) {\n  \t\tvar _indexA = fragments.indexOf(fragmentA);\n  \t\tvar _indexB = fragments.indexOf(fragmentB);\n\n  \t\treturn _indexA - _indexB || ancestryA.length - ancestryB.length;\n  \t}\n\n  \tthrow new Error('An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!');\n  }\n\n  function getParent(item) {\n  \tvar parentFragment = item.parentFragment;\n\n  \tif (parentFragment) return parentFragment.owner;\n\n  \tif (item.component && (parentFragment = item.component.parentFragment)) {\n  \t\treturn parentFragment.owner;\n  \t}\n  }\n\n  function getAncestry(item) {\n  \tvar ancestry = [item];\n  \tvar ancestor = getParent(item);\n\n  \twhile (ancestor) {\n  \t\tancestry.push(ancestor);\n  \t\tancestor = getParent(ancestor);\n  \t}\n\n  \treturn ancestry;\n  }\n\n  var Query = function () {\n  \tfunction Query(ractive, selector, live, isComponentQuery) {\n  \t\tbabelHelpers.classCallCheck(this, Query);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.selector = selector;\n  \t\tthis.live = live;\n  \t\tthis.isComponentQuery = isComponentQuery;\n\n  \t\tthis.result = [];\n\n  \t\tthis.dirty = true;\n  \t}\n\n  \tQuery.prototype.add = function add(item) {\n  \t\tthis.result.push(item);\n  \t\tthis.makeDirty();\n  \t};\n\n  \tQuery.prototype.cancel = function cancel() {\n  \t\tvar liveQueries = this._root[this.isComponentQuery ? 'liveComponentQueries' : 'liveQueries'];\n  \t\tvar selector = this.selector;\n\n  \t\tvar index = liveQueries.indexOf(selector);\n\n  \t\tif (index !== -1) {\n  \t\t\tliveQueries.splice(index, 1);\n  \t\t\tliveQueries[selector] = null;\n  \t\t}\n  \t};\n\n  \tQuery.prototype.init = function init() {\n  \t\tthis.dirty = false;\n  \t};\n\n  \tQuery.prototype.makeDirty = function makeDirty() {\n  \t\tvar _this = this;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n\n  \t\t\t// Once the DOM has been updated, ensure the query\n  \t\t\t// is correctly ordered\n  \t\t\trunloop.scheduleTask(function () {\n  \t\t\t\treturn _this.update();\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tQuery.prototype.remove = function remove(nodeOrComponent) {\n  \t\tvar index = this.result.indexOf(this.isComponentQuery ? nodeOrComponent.instance : nodeOrComponent);\n  \t\tif (index !== -1) this.result.splice(index, 1);\n  \t};\n\n  \tQuery.prototype.update = function update() {\n  \t\tthis.result.sort(this.isComponentQuery ? sortByItemPosition : sortByDocumentPosition);\n  \t\tthis.dirty = false;\n  \t};\n\n  \tQuery.prototype.test = function test(item) {\n  \t\treturn this.isComponentQuery ? !this.selector || item.name === this.selector : item ? matches(item, this.selector) : null;\n  \t};\n\n  \treturn Query;\n  }();\n\n  function Ractive$findAll(selector, options) {\n  \tif (!this.el) throw new Error('Cannot call ractive.findAll(\\'' + selector + '\\', ...) unless instance is rendered to the DOM');\n\n  \toptions = options || {};\n  \tvar liveQueries = this._liveQueries;\n\n  \t// Shortcut: if we're maintaining a live query with this\n  \t// selector, we don't need to traverse the parallel DOM\n  \tvar query = liveQueries[selector];\n  \tif (query) {\n  \t\t// Either return the exact same query, or (if not live) a snapshot\n  \t\treturn options && options.live ? query : query.slice();\n  \t}\n\n  \tquery = new Query(this, selector, !!options.live, false);\n\n  \t// Add this to the list of live queries Ractive needs to maintain,\n  \t// if applicable\n  \tif (query.live) {\n  \t\tliveQueries.push(selector);\n  \t\tliveQueries['_' + selector] = query;\n  \t}\n\n  \tthis.fragment.findAll(selector, query);\n\n  \tquery.init();\n  \treturn query.result;\n  }\n\n  function Ractive$findAllComponents(selector, options) {\n  \toptions = options || {};\n  \tvar liveQueries = this._liveComponentQueries;\n\n  \t// Shortcut: if we're maintaining a live query with this\n  \t// selector, we don't need to traverse the parallel DOM\n  \tvar query = liveQueries[selector];\n  \tif (query) {\n  \t\t// Either return the exact same query, or (if not live) a snapshot\n  \t\treturn options && options.live ? query : query.slice();\n  \t}\n\n  \tquery = new Query(this, selector, !!options.live, true);\n\n  \t// Add this to the list of live queries Ractive needs to maintain,\n  \t// if applicable\n  \tif (query.live) {\n  \t\tliveQueries.push(selector);\n  \t\tliveQueries['_' + selector] = query;\n  \t}\n\n  \tthis.fragment.findAllComponents(selector, query);\n\n  \tquery.init();\n  \treturn query.result;\n  }\n\n  function Ractive$findComponent(selector) {\n  \treturn this.fragment.findComponent(selector);\n  }\n\n  function Ractive$findContainer(selector) {\n  \tif (this.container) {\n  \t\tif (this.container.component && this.container.component.name === selector) {\n  \t\t\treturn this.container;\n  \t\t} else {\n  \t\t\treturn this.container.findContainer(selector);\n  \t\t}\n  \t}\n\n  \treturn null;\n  }\n\n  function Ractive$findParent(selector) {\n\n  \tif (this.parent) {\n  \t\tif (this.parent.component && this.parent.component.name === selector) {\n  \t\t\treturn this.parent;\n  \t\t} else {\n  \t\t\treturn this.parent.findParent(selector);\n  \t\t}\n  \t}\n\n  \treturn null;\n  }\n\n  function enqueue(ractive, event) {\n  \tif (ractive.event) {\n  \t\tractive._eventQueue.push(ractive.event);\n  \t}\n\n  \tractive.event = event;\n  }\n\n  function dequeue(ractive) {\n  \tif (ractive._eventQueue.length) {\n  \t\tractive.event = ractive._eventQueue.pop();\n  \t} else {\n  \t\tractive.event = null;\n  \t}\n  }\n\n  var starMaps = {};\n\n  // This function takes a keypath such as 'foo.bar.baz', and returns\n  // all the variants of that keypath that include a wildcard in place\n  // of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n  // These are then checked against the dependants map (ractive.viewmodel.depsMap)\n  // to see if any pattern observers are downstream of one or more of\n  // these wildcard keypaths (e.g. 'foo.bar.*.status')\n  function getPotentialWildcardMatches(keypath) {\n  \tvar keys, starMap, mapper, i, result, wildcardKeypath;\n\n  \tkeys = splitKeypathI(keypath);\n  \tif (!(starMap = starMaps[keys.length])) {\n  \t\tstarMap = getStarMap(keys.length);\n  \t}\n\n  \tresult = [];\n\n  \tmapper = function mapper(star, i) {\n  \t\treturn star ? '*' : keys[i];\n  \t};\n\n  \ti = starMap.length;\n  \twhile (i--) {\n  \t\twildcardKeypath = starMap[i].map(mapper).join('.');\n\n  \t\tif (!result.hasOwnProperty(wildcardKeypath)) {\n  \t\t\tresult.push(wildcardKeypath);\n  \t\t\tresult[wildcardKeypath] = true;\n  \t\t}\n  \t}\n\n  \treturn result;\n  }\n\n  // This function returns all the possible true/false combinations for\n  // a given number - e.g. for two, the possible combinations are\n  // [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n  // It does so by getting all the binary values between 0 and e.g. 11\n  function getStarMap(num) {\n  \tvar ones = '',\n  \t    max,\n  \t    binary,\n  \t    starMap,\n  \t    mapper,\n  \t    i,\n  \t    j,\n  \t    l,\n  \t    map;\n\n  \tif (!starMaps[num]) {\n  \t\tstarMap = [];\n\n  \t\twhile (ones.length < num) {\n  \t\t\tones += 1;\n  \t\t}\n\n  \t\tmax = parseInt(ones, 2);\n\n  \t\tmapper = function mapper(digit) {\n  \t\t\treturn digit === '1';\n  \t\t};\n\n  \t\tfor (i = 0; i <= max; i += 1) {\n  \t\t\tbinary = i.toString(2);\n  \t\t\twhile (binary.length < num) {\n  \t\t\t\tbinary = '0' + binary;\n  \t\t\t}\n\n  \t\t\tmap = [];\n  \t\t\tl = binary.length;\n  \t\t\tfor (j = 0; j < l; j++) {\n  \t\t\t\tmap.push(mapper(binary[j]));\n  \t\t\t}\n  \t\t\tstarMap[i] = map;\n  \t\t}\n\n  \t\tstarMaps[num] = starMap;\n  \t}\n\n  \treturn starMaps[num];\n  }\n\n  var wildcardCache = {};\n\n  function fireEvent(ractive, eventName) {\n  \tvar options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n  \tif (!eventName) {\n  \t\treturn;\n  \t}\n\n  \tif (!options.event) {\n  \t\toptions.event = {\n  \t\t\tname: eventName,\n  \t\t\t// until event not included as argument default\n  \t\t\t_noArg: true\n  \t\t};\n  \t} else {\n  \t\toptions.event.name = eventName;\n  \t}\n\n  \tvar eventNames = getWildcardNames(eventName);\n\n  \tfireEventAs(ractive, eventNames, options.event, options.args, true);\n  }\n\n  function getWildcardNames(eventName) {\n  \tif (wildcardCache.hasOwnProperty(eventName)) {\n  \t\treturn wildcardCache[eventName];\n  \t} else {\n  \t\treturn wildcardCache[eventName] = getPotentialWildcardMatches(eventName);\n  \t}\n  }\n\n  function fireEventAs(ractive, eventNames, event, args) {\n  \tvar initialFire = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];\n\n\n  \tvar subscribers,\n  \t    i,\n  \t    bubble = true;\n\n  \tenqueue(ractive, event);\n\n  \tfor (i = eventNames.length; i >= 0; i--) {\n  \t\tsubscribers = ractive._subs[eventNames[i]];\n\n  \t\tif (subscribers) {\n  \t\t\tbubble = notifySubscribers(ractive, subscribers, event, args) && bubble;\n  \t\t}\n  \t}\n\n  \tdequeue(ractive);\n\n  \tif (ractive.parent && bubble) {\n\n  \t\tif (initialFire && ractive.component) {\n  \t\t\tvar fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n  \t\t\teventNames = getWildcardNames(fullName);\n\n  \t\t\tif (event && !event.component) {\n  \t\t\t\tevent.component = ractive;\n  \t\t\t}\n  \t\t}\n\n  \t\tfireEventAs(ractive.parent, eventNames, event, args);\n  \t}\n  }\n\n  function notifySubscribers(ractive, subscribers, event, args) {\n  \tvar originalEvent = null,\n  \t    stopEvent = false;\n\n  \tif (event && !event._noArg) {\n  \t\targs = [event].concat(args);\n  \t}\n\n  \t// subscribers can be modified inflight, e.g. \"once\" functionality\n  \t// so we need to copy to make sure everyone gets called\n  \tsubscribers = subscribers.slice();\n\n  \tfor (var i = 0, len = subscribers.length; i < len; i += 1) {\n  \t\tif (subscribers[i].apply(ractive, args) === false) {\n  \t\t\tstopEvent = true;\n  \t\t}\n  \t}\n\n  \tif (event && !event._noArg && stopEvent && (originalEvent = event.original)) {\n  \t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n  \t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n  \t}\n\n  \treturn !stopEvent;\n  }\n\n  function Ractive$fire(eventName) {\n  \tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\targs[_key - 1] = arguments[_key];\n  \t}\n\n  \tfireEvent(this, eventName, { args: args });\n  }\n\n  function badReference(key) {\n  \tthrow new Error('An index or key reference (' + key + ') cannot have child properties');\n  }\n\n  function resolveAmbiguousReference(fragment, ref) {\n  \tvar localViewmodel = fragment.findContext().root;\n  \tvar keys = splitKeypathI(ref);\n  \tvar key = keys[0];\n\n  \tvar hasContextChain = void 0;\n  \tvar crossedComponentBoundary = void 0;\n  \tvar aliases = void 0;\n\n  \twhile (fragment) {\n  \t\t// repeated fragments\n  \t\tif (fragment.isIteration) {\n  \t\t\tif (key === fragment.parent.keyRef) {\n  \t\t\t\tif (keys.length > 1) badReference(key);\n  \t\t\t\treturn fragment.context.getKeyModel();\n  \t\t\t}\n\n  \t\t\tif (key === fragment.parent.indexRef) {\n  \t\t\t\tif (keys.length > 1) badReference(key);\n  \t\t\t\treturn fragment.context.getIndexModel(fragment.index);\n  \t\t\t}\n  \t\t}\n\n  \t\t// alias node or iteration\n  \t\tif (((aliases = fragment.owner.aliases) || (aliases = fragment.aliases)) && aliases.hasOwnProperty(key)) {\n  \t\t\tvar model = aliases[key];\n\n  \t\t\tif (keys.length === 1) return model;else if (typeof model.joinAll === 'function') {\n  \t\t\t\treturn model.joinAll(keys.slice(1));\n  \t\t\t}\n  \t\t}\n\n  \t\tif (fragment.context) {\n  \t\t\t// TODO better encapsulate the component check\n  \t\t\tif (!fragment.isRoot || fragment.ractive.component) hasContextChain = true;\n\n  \t\t\tif (fragment.context.has(key)) {\n  \t\t\t\tif (crossedComponentBoundary) {\n  \t\t\t\t\tlocalViewmodel.map(key, fragment.context.joinKey(key));\n  \t\t\t\t}\n\n  \t\t\t\treturn fragment.context.joinAll(keys);\n  \t\t\t}\n  \t\t}\n\n  \t\tif (fragment.componentParent && !fragment.ractive.isolated) {\n  \t\t\t// ascend through component boundary\n  \t\t\tfragment = fragment.componentParent;\n  \t\t\tcrossedComponentBoundary = true;\n  \t\t} else {\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n  \t}\n\n  \tif (!hasContextChain) {\n  \t\treturn localViewmodel.joinAll(keys);\n  \t}\n  }\n\n  var stack = [];\n  var captureGroup = void 0;\n\n  function startCapturing() {\n  \tstack.push(captureGroup = []);\n  }\n\n  function stopCapturing() {\n  \tvar dependencies = stack.pop();\n  \tcaptureGroup = stack[stack.length - 1];\n  \treturn dependencies;\n  }\n\n  function capture(model) {\n  \tif (captureGroup) {\n  \t\tcaptureGroup.push(model);\n  \t}\n  }\n\n  function _bind(x) {\n    x.bind();\n  }\n  function cancel(x) {\n    x.cancel();\n  }\n  function _handleChange(x) {\n    x.handleChange();\n  }\n  function mark(x) {\n    x.mark();\n  }\n  function _render(x) {\n    x.render();\n  }\n  function _rebind(x) {\n    x.rebind();\n  }\n  function teardown(x) {\n    x.teardown();\n  }\n  function _unbind(x) {\n    x.unbind();\n  }\n  function _unrender(x) {\n    x.unrender();\n  }\n  function unrenderAndDestroy(x) {\n    x.unrender(true);\n  }\n  function _update(x) {\n    x.update();\n  }\n  function _toString(x) {\n    return x.toString();\n  }\n  function toEscapedString(x) {\n    return x.toString(true);\n  }\n\n  var requestAnimationFrame;\n\n  // If window doesn't exist, we don't need requestAnimationFrame\n  if (!win) {\n  \trequestAnimationFrame = null;\n  } else {\n  \t// https://gist.github.com/paulirish/1579671\n  \t(function (vendors, lastTime, win) {\n\n  \t\tvar x, setTimeout;\n\n  \t\tif (win.requestAnimationFrame) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tfor (x = 0; x < vendors.length && !win.requestAnimationFrame; ++x) {\n  \t\t\twin.requestAnimationFrame = win[vendors[x] + 'RequestAnimationFrame'];\n  \t\t}\n\n  \t\tif (!win.requestAnimationFrame) {\n  \t\t\tsetTimeout = win.setTimeout;\n\n  \t\t\twin.requestAnimationFrame = function (callback) {\n  \t\t\t\tvar currTime, timeToCall, id;\n\n  \t\t\t\tcurrTime = Date.now();\n  \t\t\t\ttimeToCall = Math.max(0, 16 - (currTime - lastTime));\n  \t\t\t\tid = setTimeout(function () {\n  \t\t\t\t\tcallback(currTime + timeToCall);\n  \t\t\t\t}, timeToCall);\n\n  \t\t\t\tlastTime = currTime + timeToCall;\n  \t\t\t\treturn id;\n  \t\t\t};\n  \t\t}\n  \t})(vendors, 0, win);\n\n  \trequestAnimationFrame = win.requestAnimationFrame;\n  }\n\n  var rAF = requestAnimationFrame;\n\n  var getTime = win && win.performance && typeof win.performance.now === 'function' ? function () {\n  \treturn win.performance.now();\n  } : function () {\n  \treturn Date.now();\n  };\n\n  // TODO what happens if a transition is aborted?\n\n  var tickers = [];\n  var running = false;\n\n  function tick() {\n  \trunloop.start();\n\n  \tvar now = getTime();\n\n  \tvar i = void 0;\n  \tvar ticker = void 0;\n\n  \tfor (i = 0; i < tickers.length; i += 1) {\n  \t\tticker = tickers[i];\n\n  \t\tif (!ticker.tick(now)) {\n  \t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\n  \t\t\ttickers.splice(i--, 1);\n  \t\t}\n  \t}\n\n  \trunloop.end();\n\n  \tif (tickers.length) {\n  \t\trAF(tick);\n  \t} else {\n  \t\trunning = false;\n  \t}\n  }\n\n  var Ticker = function () {\n  \tfunction Ticker(options) {\n  \t\tbabelHelpers.classCallCheck(this, Ticker);\n\n  \t\tthis.duration = options.duration;\n  \t\tthis.step = options.step;\n  \t\tthis.complete = options.complete;\n  \t\tthis.easing = options.easing;\n\n  \t\tthis.start = getTime();\n  \t\tthis.end = this.start + this.duration;\n\n  \t\tthis.running = true;\n\n  \t\ttickers.push(this);\n  \t\tif (!running) rAF(tick);\n  \t}\n\n  \tTicker.prototype.tick = function tick(now) {\n  \t\tif (!this.running) return false;\n\n  \t\tif (now > this.end) {\n  \t\t\tif (this.step) this.step(1);\n  \t\t\tif (this.complete) this.complete(1);\n\n  \t\t\treturn false;\n  \t\t}\n\n  \t\tvar elapsed = now - this.start;\n  \t\tvar eased = this.easing(elapsed / this.duration);\n\n  \t\tif (this.step) this.step(eased);\n\n  \t\treturn true;\n  \t};\n\n  \tTicker.prototype.stop = function stop() {\n  \t\tif (this.abort) this.abort();\n  \t\tthis.running = false;\n  \t};\n\n  \treturn Ticker;\n  }();\n\n  var prefixers = {};\n\n  // TODO this is legacy. sooner we can replace the old adaptor API the better\n  function prefixKeypath(obj, prefix) {\n  \tvar prefixed = {},\n  \t    key;\n\n  \tif (!prefix) {\n  \t\treturn obj;\n  \t}\n\n  \tprefix += '.';\n\n  \tfor (key in obj) {\n  \t\tif (obj.hasOwnProperty(key)) {\n  \t\t\tprefixed[prefix + key] = obj[key];\n  \t\t}\n  \t}\n\n  \treturn prefixed;\n  }\n\n  function getPrefixer(rootKeypath) {\n  \tvar rootDot;\n\n  \tif (!prefixers[rootKeypath]) {\n  \t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n  \t\tprefixers[rootKeypath] = function (relativeKeypath, value) {\n  \t\t\tvar obj;\n\n  \t\t\tif (typeof relativeKeypath === 'string') {\n  \t\t\t\tobj = {};\n  \t\t\t\tobj[rootDot + relativeKeypath] = value;\n  \t\t\t\treturn obj;\n  \t\t\t}\n\n  \t\t\tif ((typeof relativeKeypath === 'undefined' ? 'undefined' : babelHelpers.typeof(relativeKeypath)) === 'object') {\n  \t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n  \t\t\t\treturn rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n  \t\t\t}\n  \t\t};\n  \t}\n\n  \treturn prefixers[rootKeypath];\n  }\n\n  var KeyModel = function () {\n  \tfunction KeyModel(key) {\n  \t\tbabelHelpers.classCallCheck(this, KeyModel);\n\n  \t\tthis.value = key;\n  \t\tthis.isReadonly = true;\n  \t\tthis.dependants = [];\n  \t}\n\n  \tKeyModel.prototype.get = function get() {\n  \t\treturn unescapeKey(this.value);\n  \t};\n\n  \tKeyModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn unescapeKey(this.value);\n  \t};\n\n  \tKeyModel.prototype.rebind = function rebind(key) {\n  \t\tthis.value = key;\n  \t\tthis.dependants.forEach(_handleChange);\n  \t};\n\n  \tKeyModel.prototype.register = function register(dependant) {\n  \t\tthis.dependants.push(dependant);\n  \t};\n\n  \tKeyModel.prototype.unregister = function unregister(dependant) {\n  \t\tremoveFromArray(this.dependants, dependant);\n  \t};\n\n  \treturn KeyModel;\n  }();\n\n  var KeypathModel = function () {\n  \tfunction KeypathModel(parent, ractive) {\n  \t\tbabelHelpers.classCallCheck(this, KeypathModel);\n\n  \t\tthis.parent = parent;\n  \t\tthis.ractive = ractive;\n  \t\tthis.value = ractive ? parent.getKeypath(ractive) : parent.getKeypath();\n  \t\tthis.dependants = [];\n  \t\tthis.children = [];\n  \t}\n\n  \tKeypathModel.prototype.addChild = function addChild(model) {\n  \t\tthis.children.push(model);\n  \t\tmodel.owner = this;\n  \t};\n\n  \tKeypathModel.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tKeypathModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn this.value;\n  \t};\n\n  \tKeypathModel.prototype.handleChange = function handleChange() {\n  \t\tthis.value = this.ractive ? this.parent.getKeypath(this.ractive) : this.parent.getKeypath();\n  \t\tif (this.ractive && this.owner) {\n  \t\t\tthis.ractive.viewmodel.keypathModels[this.owner.value] = this;\n  \t\t}\n  \t\tthis.children.forEach(_handleChange);\n  \t\tthis.dependants.forEach(_handleChange);\n  \t};\n\n  \tKeypathModel.prototype.register = function register(dependant) {\n  \t\tthis.dependants.push(dependant);\n  \t};\n\n  \tKeypathModel.prototype.removeChild = function removeChild(model) {\n  \t\tremoveFromArray(this.children, model);\n  \t};\n\n  \tKeypathModel.prototype.teardown = function teardown$$() {\n  \t\tif (this.owner) this.owner.removeChild(this);\n  \t\tthis.children.forEach(teardown);\n  \t};\n\n  \tKeypathModel.prototype.unregister = function unregister(dependant) {\n  \t\tremoveFromArray(this.dependants, dependant);\n  \t};\n\n  \treturn KeypathModel;\n  }();\n\n  var hasProp = Object.prototype.hasOwnProperty;\n\n  function _updateFromBindings(model) {\n  \tmodel.updateFromBindings(true);\n  }\n\n  function _updateKeypathDependants(model) {\n  \tmodel.updateKeypathDependants();\n  }\n\n  var originatingModel = null;\n\n  var Model = function () {\n  \tfunction Model(parent, key) {\n  \t\tbabelHelpers.classCallCheck(this, Model);\n\n  \t\tthis.deps = [];\n\n  \t\tthis.children = [];\n  \t\tthis.childByKey = {};\n\n  \t\tthis.indexModels = [];\n\n  \t\tthis.unresolved = [];\n  \t\tthis.unresolvedByKey = {};\n\n  \t\tthis.bindings = [];\n\n  \t\tthis.value = undefined;\n\n  \t\tthis.ticker = null;\n\n  \t\tif (parent) {\n  \t\t\tthis.parent = parent;\n  \t\t\tthis.root = parent.root;\n  \t\t\tthis.key = unescapeKey(key);\n  \t\t\tthis.isReadonly = parent.isReadonly;\n\n  \t\t\tif (parent.value) {\n  \t\t\t\tthis.value = parent.value[this.key];\n  \t\t\t\tthis.adapt();\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tModel.prototype.adapt = function adapt() {\n  \t\tvar adaptors = this.root.adaptors;\n  \t\tvar len = adaptors.length;\n\n  \t\t// Exit early if no adaptors\n  \t\tif (len === 0) return;\n\n  \t\tvar value = this.value;\n\n  \t\t// TODO remove this legacy nonsense\n  \t\tvar ractive = this.root.ractive;\n  \t\tvar keypath = this.getKeypath();\n\n  \t\t// tear previous adaptor down if present\n  \t\tif (this.wrapper) {\n  \t\t\tthis.wrapper.teardown();\n  \t\t\tthis.wrapper = null;\n  \t\t}\n\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar adaptor = adaptors[i];\n  \t\t\tif (adaptor.filter(value, keypath, ractive)) {\n  \t\t\t\tthis.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n  \t\t\t\tthis.wrapper.value = this.value;\n  \t\t\t\tthis.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n  \t\t\t\tthis.value = this.wrapper.get();\n\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tModel.prototype.addUnresolved = function addUnresolved(key, resolver) {\n  \t\tif (!this.unresolvedByKey[key]) {\n  \t\t\tthis.unresolved.push(key);\n  \t\t\tthis.unresolvedByKey[key] = [];\n  \t\t}\n\n  \t\tthis.unresolvedByKey[key].push(resolver);\n  \t};\n\n  \tModel.prototype.animate = function animate(from, to, options, interpolator) {\n  \t\tvar _this = this;\n\n  \t\tif (this.ticker) this.ticker.stop();\n\n  \t\tvar fulfilPromise = void 0;\n  \t\tvar promise = new Promise$1(function (fulfil) {\n  \t\t\treturn fulfilPromise = fulfil;\n  \t\t});\n\n  \t\tthis.ticker = new Ticker({\n  \t\t\tduration: options.duration,\n  \t\t\teasing: options.easing,\n  \t\t\tstep: function step(t) {\n  \t\t\t\tvar value = interpolator(t);\n  \t\t\t\t_this.applyValue(value);\n  \t\t\t\tif (options.step) options.step(t, value);\n  \t\t\t},\n  \t\t\tcomplete: function complete() {\n  \t\t\t\t_this.applyValue(to);\n  \t\t\t\tif (options.complete) options.complete(to);\n\n  \t\t\t\t_this.ticker = null;\n  \t\t\t\tfulfilPromise();\n  \t\t\t}\n  \t\t});\n\n  \t\tpromise.stop = this.ticker.stop;\n  \t\treturn promise;\n  \t};\n\n  \tModel.prototype.applyValue = function applyValue(value) {\n  \t\tif (isEqual(value, this.value)) return;\n\n  \t\t// TODO deprecate this nonsense\n  \t\tthis.root.changes[this.getKeypath()] = value;\n\n  \t\tif (this.parent.wrapper && this.parent.wrapper.set) {\n  \t\t\tthis.parent.wrapper.set(this.key, value);\n  \t\t\tthis.parent.value = this.parent.wrapper.get();\n\n  \t\t\tthis.value = this.parent.value[this.key];\n  \t\t\t// TODO should this value be adapted? probably\n  \t\t} else if (this.wrapper) {\n  \t\t\t\tvar shouldTeardown = !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n  \t\t\t\tif (shouldTeardown) {\n  \t\t\t\t\tthis.wrapper.teardown();\n  \t\t\t\t\tthis.wrapper = null;\n  \t\t\t\t\tvar parentValue = this.parent.value || this.parent.createBranch(this.key);\n  \t\t\t\t\tparentValue[this.key] = this.value = value;\n  \t\t\t\t\tthis.adapt();\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.value = this.wrapper.get();\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tvar _parentValue = this.parent.value || this.parent.createBranch(this.key);\n  \t\t\t\t_parentValue[this.key] = value;\n\n  \t\t\t\tthis.value = value;\n  \t\t\t\tthis.adapt();\n  \t\t\t}\n\n  \t\tthis.parent.clearUnresolveds();\n  \t\tthis.clearUnresolveds();\n\n  \t\t// notify dependants\n  \t\tvar previousOriginatingModel = originatingModel; // for the array.length special case\n  \t\toriginatingModel = this;\n\n  \t\tthis.children.forEach(mark);\n  \t\tthis.deps.forEach(_handleChange);\n\n  \t\tvar parent = this.parent;\n  \t\twhile (parent) {\n  \t\t\tparent.deps.forEach(_handleChange);\n  \t\t\tparent = parent.parent;\n  \t\t}\n\n  \t\toriginatingModel = previousOriginatingModel;\n  \t};\n\n  \tModel.prototype.clearUnresolveds = function clearUnresolveds(specificKey) {\n  \t\tvar i = this.unresolved.length;\n\n  \t\twhile (i--) {\n  \t\t\tvar key = this.unresolved[i];\n\n  \t\t\tif (specificKey && key !== specificKey) continue;\n\n  \t\t\tvar resolvers = this.unresolvedByKey[key];\n  \t\t\tvar hasKey = this.has(key);\n\n  \t\t\tvar j = resolvers.length;\n  \t\t\twhile (j--) {\n  \t\t\t\tif (hasKey) resolvers[j].attemptResolution();\n  \t\t\t\tif (resolvers[j].resolved) resolvers.splice(j, 1);\n  \t\t\t}\n\n  \t\t\tif (!resolvers.length) {\n  \t\t\t\tthis.unresolved.splice(i, 1);\n  \t\t\t\tthis.unresolvedByKey[key] = null;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tModel.prototype.createBranch = function createBranch(key) {\n  \t\tvar branch = isNumeric(key) ? [] : {};\n  \t\tthis.set(branch);\n\n  \t\treturn branch;\n  \t};\n\n  \tModel.prototype.findMatches = function findMatches(keys) {\n  \t\tvar len = keys.length;\n\n  \t\tvar existingMatches = [this];\n  \t\tvar matches = void 0;\n  \t\tvar i = void 0;\n\n  \t\tvar _loop = function _loop() {\n  \t\t\tvar key = keys[i];\n\n  \t\t\tif (key === '*') {\n  \t\t\t\tmatches = [];\n  \t\t\t\texistingMatches.forEach(function (model) {\n  \t\t\t\t\tmatches.push.apply(matches, model.getValueChildren(model.get()));\n  \t\t\t\t});\n  \t\t\t} else {\n  \t\t\t\tmatches = existingMatches.map(function (model) {\n  \t\t\t\t\treturn model.joinKey(key);\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\t\texistingMatches = matches;\n  \t\t};\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t_loop();\n  \t\t}\n\n  \t\treturn matches;\n  \t};\n\n  \tModel.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n  \t\treturn this.value;\n  \t};\n\n  \tModel.prototype.getIndexModel = function getIndexModel(fragmentIndex) {\n  \t\tvar indexModels = this.parent.indexModels;\n\n  \t\t// non-numeric keys are a special of a numeric index in a object iteration\n  \t\tif (typeof this.key === 'string' && fragmentIndex !== undefined) {\n  \t\t\treturn new KeyModel(fragmentIndex);\n  \t\t} else if (!indexModels[this.key]) {\n  \t\t\tindexModels[this.key] = new KeyModel(this.key);\n  \t\t}\n\n  \t\treturn indexModels[this.key];\n  \t};\n\n  \tModel.prototype.getKeyModel = function getKeyModel() {\n  \t\t// TODO... different to IndexModel because key can never change\n  \t\treturn new KeyModel(escapeKey(this.key));\n  \t};\n\n  \tModel.prototype.getKeypathModel = function getKeypathModel(ractive) {\n  \t\tvar keypath = this.getKeypath(),\n  \t\t    model = this.keypathModel || (this.keypathModel = new KeypathModel(this));\n\n  \t\tif (ractive && ractive.component) {\n  \t\t\tvar mapped = this.getKeypath(ractive);\n  \t\t\tif (mapped !== keypath) {\n  \t\t\t\tvar map = ractive.viewmodel.keypathModels || (ractive.viewmodel.keypathModels = {});\n  \t\t\t\tvar child = map[keypath] || (map[keypath] = new KeypathModel(this, ractive));\n  \t\t\t\tmodel.addChild(child);\n  \t\t\t\treturn child;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn model;\n  \t};\n\n  \tModel.prototype.getKeypath = function getKeypath(ractive) {\n  \t\tvar root = this.parent.isRoot ? escapeKey(this.key) : this.parent.getKeypath() + '.' + escapeKey(this.key);\n\n  \t\tif (ractive && ractive.component) {\n  \t\t\tvar map = ractive.viewmodel.mappings;\n  \t\t\tfor (var k in map) {\n  \t\t\t\tif (root.indexOf(map[k].getKeypath()) >= 0) {\n  \t\t\t\t\troot = root.replace(map[k].getKeypath(), k);\n  \t\t\t\t\tbreak;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn root;\n  \t};\n\n  \tModel.prototype.getValueChildren = function getValueChildren(value) {\n  \t\tvar _this2 = this;\n\n  \t\tvar children = void 0;\n  \t\tif (isArray(value)) {\n  \t\t\tchildren = [];\n  \t\t\t// special case - array.length. This is a horrible kludge, but\n  \t\t\t// it'll do for now. Alternatives welcome\n  \t\t\tif (originatingModel && originatingModel.parent === this && originatingModel.key === 'length') {\n  \t\t\t\tchildren.push(originatingModel);\n  \t\t\t}\n  \t\t\tvalue.forEach(function (m, i) {\n  \t\t\t\tchildren.push(_this2.joinKey(i));\n  \t\t\t});\n  \t\t} else if (isObject(value) || typeof value === 'function') {\n  \t\t\tchildren = Object.keys(value).map(function (key) {\n  \t\t\t\treturn _this2.joinKey(key);\n  \t\t\t});\n  \t\t} else if (value != null) {\n  \t\t\t// TODO: this will return incorrect keypath if model is mapped\n  \t\t\tthrow new Error('Cannot get values of ' + this.getKeypath() + '.* as ' + this.getKeypath() + ' is not an array, object or function');\n  \t\t}\n\n  \t\treturn children;\n  \t};\n\n  \tModel.prototype.has = function has(key) {\n  \t\tvar value = this.get();\n  \t\tif (!value) return false;\n\n  \t\tkey = unescapeKey(key);\n  \t\tif (hasProp.call(value, key)) return true;\n\n  \t\t// We climb up the constructor chain to find if one of them contains the key\n  \t\tvar constructor = value.constructor;\n  \t\twhile (constructor !== Function && constructor !== Array && constructor !== Object) {\n  \t\t\tif (hasProp.call(constructor.prototype, key)) return true;\n  \t\t\tconstructor = constructor.constructor;\n  \t\t}\n\n  \t\treturn false;\n  \t};\n\n  \tModel.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new Model(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tModel.prototype.joinAll = function joinAll(keys) {\n  \t\tvar model = this;\n  \t\tfor (var i = 0; i < keys.length; i += 1) {\n  \t\t\tmodel = model.joinKey(keys[i]);\n  \t\t}\n\n  \t\treturn model;\n  \t};\n\n  \tModel.prototype.mark = function mark$$() {\n  \t\tvar value = this.retrieve();\n\n  \t\tif (!isEqual(value, this.value)) {\n  \t\t\tvar old = this.value;\n  \t\t\tthis.value = value;\n\n  \t\t\t// make sure the wrapper stays in sync\n  \t\t\tif (old !== value) this.adapt();\n\n  \t\t\tthis.children.forEach(mark);\n\n  \t\t\tthis.deps.forEach(_handleChange);\n  \t\t\tthis.clearUnresolveds();\n  \t\t}\n  \t};\n\n  \tModel.prototype.merge = function merge(array, comparator) {\n  \t\tvar oldArray = comparator ? this.value.map(comparator) : this.value;\n  \t\tvar newArray = comparator ? array.map(comparator) : array;\n\n  \t\tvar oldLength = oldArray.length;\n\n  \t\tvar usedIndices = {};\n  \t\tvar firstUnusedIndex = 0;\n\n  \t\tvar newIndices = oldArray.map(function (item) {\n  \t\t\tvar index = void 0;\n  \t\t\tvar start = firstUnusedIndex;\n\n  \t\t\tdo {\n  \t\t\t\tindex = newArray.indexOf(item, start);\n\n  \t\t\t\tif (index === -1) {\n  \t\t\t\t\treturn -1;\n  \t\t\t\t}\n\n  \t\t\t\tstart = index + 1;\n  \t\t\t} while (usedIndices[index] === true && start < oldLength);\n\n  \t\t\t// keep track of the first unused index, so we don't search\n  \t\t\t// the whole of newArray for each item in oldArray unnecessarily\n  \t\t\tif (index === firstUnusedIndex) {\n  \t\t\t\tfirstUnusedIndex += 1;\n  \t\t\t}\n  \t\t\t// allow next instance of next \"equal\" to be found item\n  \t\t\tusedIndices[index] = true;\n  \t\t\treturn index;\n  \t\t});\n\n  \t\tthis.parent.value[this.key] = array;\n  \t\tthis._merged = true;\n  \t\tthis.shuffle(newIndices);\n  \t};\n\n  \tModel.prototype.register = function register(dep) {\n  \t\tthis.deps.push(dep);\n  \t};\n\n  \tModel.prototype.registerTwowayBinding = function registerTwowayBinding(binding) {\n  \t\tthis.bindings.push(binding);\n  \t};\n\n  \tModel.prototype.retrieve = function retrieve() {\n  \t\treturn this.parent.value ? this.parent.value[this.key] : undefined;\n  \t};\n\n  \tModel.prototype.set = function set(value) {\n  \t\tif (this.ticker) this.ticker.stop();\n  \t\tthis.applyValue(value);\n  \t};\n\n  \tModel.prototype.shuffle = function shuffle(newIndices) {\n  \t\tvar _this3 = this;\n\n  \t\tvar indexModels = [];\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\tif (! ~newIndex) return;\n\n  \t\t\tvar model = _this3.indexModels[oldIndex];\n\n  \t\t\tif (!model) return;\n\n  \t\t\tindexModels[newIndex] = model;\n\n  \t\t\tif (newIndex !== oldIndex) {\n  \t\t\t\tmodel.rebind(newIndex);\n  \t\t\t}\n  \t\t});\n\n  \t\tthis.indexModels = indexModels;\n\n  \t\t// shuffles need to happen before marks...\n  \t\tthis.deps.forEach(function (dep) {\n  \t\t\tif (dep.shuffle) dep.shuffle(newIndices);\n  \t\t});\n\n  \t\tthis.updateKeypathDependants();\n  \t\tthis.mark();\n\n  \t\t// ...but handleChange must happen after (TODO document why)\n  \t\tthis.deps.forEach(function (dep) {\n  \t\t\tif (!dep.shuffle) dep.handleChange();\n  \t\t});\n  \t};\n\n  \tModel.prototype.teardown = function teardown$$() {\n  \t\tthis.children.forEach(teardown);\n  \t\tif (this.wrapper) this.wrapper.teardown();\n  \t\tif (this.keypathModels) {\n  \t\t\tfor (var k in this.keypathModels) {\n  \t\t\t\tthis.keypathModels[k].teardown();\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tModel.prototype.unregister = function unregister(dependant) {\n  \t\tremoveFromArray(this.deps, dependant);\n  \t};\n\n  \tModel.prototype.unregisterTwowayBinding = function unregisterTwowayBinding(binding) {\n  \t\tremoveFromArray(this.bindings, binding);\n  \t};\n\n  \tModel.prototype.updateFromBindings = function updateFromBindings(cascade) {\n  \t\tvar i = this.bindings.length;\n  \t\twhile (i--) {\n  \t\t\tvar value = this.bindings[i].getValue();\n  \t\t\tif (value !== this.value) this.set(value);\n  \t\t}\n\n  \t\tif (cascade) {\n  \t\t\tthis.children.forEach(_updateFromBindings);\n  \t\t}\n  \t};\n\n  \tModel.prototype.updateKeypathDependants = function updateKeypathDependants() {\n  \t\tthis.children.forEach(_updateKeypathDependants);\n  \t\tif (this.keypathModel) this.keypathModel.handleChange();\n  \t};\n\n  \treturn Model;\n  }();\n\n  var GlobalModel = function (_Model) {\n  \tbabelHelpers.inherits(GlobalModel, _Model);\n\n  \tfunction GlobalModel() {\n  \t\tbabelHelpers.classCallCheck(this, GlobalModel);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, '@global'));\n\n  \t\t_this.value = typeof global !== 'undefined' ? global : window;\n  \t\t_this.isRoot = true;\n  \t\t_this.root = _this;\n  \t\t_this.adaptors = [];\n  \t\t_this.changes = {};\n  \t\treturn _this;\n  \t}\n\n  \tGlobalModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn '@global';\n  \t};\n\n  \treturn GlobalModel;\n  }(Model);\n\n  var GlobalModel$1 = new GlobalModel();\n\n  function resolveReference(fragment, ref) {\n  \tvar context = fragment.findContext();\n\n  \t// special references\n  \t// TODO does `this` become `.` at parse time?\n  \tif (ref === '.' || ref === 'this') return context;\n  \tif (ref === '@keypath') return context.getKeypathModel(fragment.ractive);\n  \tif (ref === '@rootpath') return context.getKeypathModel();\n  \tif (ref === '@index') {\n  \t\tvar repeater = fragment.findRepeatingFragment();\n  \t\t// make sure the found fragment is actually an iteration\n  \t\tif (!repeater.isIteration) return;\n  \t\treturn repeater.context.getIndexModel(repeater.index);\n  \t}\n  \tif (ref === '@key') return fragment.findRepeatingFragment().context.getKeyModel();\n  \tif (ref === '@ractive') {\n  \t\treturn fragment.ractive.viewmodel.getRactiveModel();\n  \t}\n  \tif (ref === '@global') {\n  \t\treturn GlobalModel$1;\n  \t}\n\n  \t// ancestor references\n  \tif (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypathI(ref.slice(2)));\n  \tif (ref[0] === '.') {\n  \t\tvar parts = ref.split('/');\n\n  \t\twhile (parts[0] === '.' || parts[0] === '..') {\n  \t\t\tvar part = parts.shift();\n\n  \t\t\tif (part === '..') {\n  \t\t\t\tcontext = context.parent;\n  \t\t\t}\n  \t\t}\n\n  \t\tref = parts.join('/');\n\n  \t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n  \t\tif (ref[0] === '.') ref = ref.slice(1);\n  \t\treturn context.joinAll(splitKeypathI(ref));\n  \t}\n\n  \treturn resolveAmbiguousReference(fragment, ref);\n  }\n\n  function Ractive$get(keypath) {\n  \tif (!keypath) return this.viewmodel.get(true);\n\n  \tvar keys = splitKeypathI(keypath);\n  \tvar key = keys[0];\n\n  \tvar model = void 0;\n\n  \tif (!this.viewmodel.has(key)) {\n  \t\t// if this is an inline component, we may need to create\n  \t\t// an implicit mapping\n  \t\tif (this.component && !this.isolated) {\n  \t\t\tmodel = resolveReference(this.component.parentFragment, key);\n\n  \t\t\tif (model) {\n  \t\t\t\tthis.viewmodel.map(key, model);\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tmodel = this.viewmodel.joinAll(keys);\n  \treturn model.get(true);\n  }\n\n  var insertHook = new Hook('insert');\n\n  function Ractive$insert(target, anchor) {\n  \tif (!this.fragment.rendered) {\n  \t\t// TODO create, and link to, documentation explaining this\n  \t\tthrow new Error('The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.');\n  \t}\n\n  \ttarget = getElement(target);\n  \tanchor = getElement(anchor) || null;\n\n  \tif (!target) {\n  \t\tthrow new Error('You must specify a valid target to insert into');\n  \t}\n\n  \ttarget.insertBefore(this.detach(), anchor);\n  \tthis.el = target;\n\n  \t(target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  \tthis.isDetached = false;\n\n  \tfireInsertHook(this);\n  }\n\n  function fireInsertHook(ractive) {\n  \tinsertHook.fire(ractive);\n\n  \tractive.findAllComponents('*').forEach(function (child) {\n  \t\tfireInsertHook(child.instance);\n  \t});\n  }\n\n  function link(there, here) {\n  \tif (here === there || (there + '.').indexOf(here + '.') === 0 || (here + '.').indexOf(there + '.') === 0) {\n  \t\tthrow new Error('A keypath cannot be linked to itself.');\n  \t}\n\n  \tvar unlink = void 0,\n  \t    run = void 0,\n  \t    model = void 0;\n\n  \tvar ln = this._links[here];\n\n  \tif (ln) {\n  \t\tif (ln.source.model.str !== there || ln.dest.model.str !== here) {\n  \t\t\tunlink = this.unlink(here);\n  \t\t} else {\n  \t\t\treturn Promise$1.resolve(true);\n  \t\t}\n  \t}\n\n  \trun = runloop.start();\n\n  \t// may need to allow a mapping to resolve implicitly\n  \tvar sourcePath = splitKeypathI(there);\n  \tif (!this.viewmodel.has(sourcePath[0]) && this.component) {\n  \t\tmodel = resolveReference(this.component.parentFragment, sourcePath[0]);\n\n  \t\tif (model) {\n  \t\t\tthis.viewmodel.map(sourcePath[0], model);\n  \t\t}\n  \t}\n\n  \tln = new Link(this.viewmodel.joinAll(sourcePath), this.viewmodel.joinAll(splitKeypathI(here)), this);\n  \tthis._links[here] = ln;\n  \tln.source.handleChange();\n\n  \trunloop.end();\n\n  \treturn Promise$1.all([unlink, run]);\n  }\n\n  var Link = function () {\n  \tfunction Link(source, dest, ractive) {\n  \t\tbabelHelpers.classCallCheck(this, Link);\n\n  \t\tthis.source = new LinkSide(source, this);\n  \t\tthis.dest = new LinkSide(dest, this);\n  \t\tthis.ractive = ractive;\n  \t\tthis.locked = false;\n  \t\tthis.initialValue = dest.get();\n  \t}\n\n  \tLink.prototype.sync = function sync(side) {\n  \t\tif (!this.locked) {\n  \t\t\tthis.locked = true;\n\n  \t\t\tif (side === this.dest) {\n  \t\t\t\tthis.source.model.set(this.dest.model.get());\n  \t\t\t} else {\n  \t\t\t\tthis.dest.model.set(this.source.model.get());\n  \t\t\t}\n\n  \t\t\tthis.locked = false;\n  \t\t}\n  \t};\n\n  \tLink.prototype.unlink = function unlink() {\n  \t\tthis.source.model.unregister(this.source);\n  \t\tthis.dest.model.unregister(this.dest);\n  \t};\n\n  \treturn Link;\n  }();\n\n  var LinkSide = function () {\n  \tfunction LinkSide(model, owner) {\n  \t\tbabelHelpers.classCallCheck(this, LinkSide);\n\n  \t\tthis.model = model;\n  \t\tthis.owner = owner;\n  \t\tmodel.register(this);\n  \t}\n\n  \tLinkSide.prototype.handleChange = function handleChange() {\n  \t\tthis.owner.sync(this);\n  \t};\n\n  \treturn LinkSide;\n  }();\n\n  var comparators = {};\n\n  function getComparator(option) {\n  \tif (!option) return null; // use existing arrays\n  \tif (option === true) return JSON.stringify;\n  \tif (typeof option === 'function') return option;\n\n  \tif (typeof option === 'string') {\n  \t\treturn comparators[option] || (comparators[option] = function (thing) {\n  \t\t\treturn thing[option];\n  \t\t});\n  \t}\n\n  \tthrow new Error('If supplied, options.compare must be a string, function, or `true`'); // TODO link to docs\n  }\n\n  function Ractive$merge(keypath, array, options) {\n  \tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \tvar promise = runloop.start(this, true);\n  \tvar value = model.get();\n\n  \tif (array === value) {\n  \t\tthrow new Error('You cannot merge an array with itself'); // TODO link to docs\n  \t} else if (!isArray(value) || !isArray(array)) {\n  \t\t\tthrow new Error('You cannot merge an array with a non-array');\n  \t\t}\n\n  \tvar comparator = getComparator(options && options.compare);\n  \tmodel.merge(array, comparator);\n\n  \trunloop.end();\n  \treturn promise;\n  }\n\n  function observe(keypath, callback, options) {\n  \tvar _this = this;\n\n  \tvar observers = [];\n  \tvar map = void 0;\n\n  \tif (isObject(keypath)) {\n  \t\tmap = keypath;\n  \t\toptions = callback || {};\n\n  \t\tObject.keys(map).forEach(function (keypath) {\n  \t\t\tvar callback = map[keypath];\n\n  \t\t\tkeypath.split(' ').forEach(function (keypath) {\n  \t\t\t\tobservers.push(createObserver(_this, keypath, callback, options));\n  \t\t\t});\n  \t\t});\n  \t} else {\n  \t\tvar keypaths = void 0;\n\n  \t\tif (typeof keypath === 'function') {\n  \t\t\toptions = callback;\n  \t\t\tcallback = keypath;\n  \t\t\tkeypaths = [''];\n  \t\t} else {\n  \t\t\tkeypaths = keypath.split(' ');\n  \t\t}\n\n  \t\tkeypaths.forEach(function (keypath) {\n  \t\t\tobservers.push(createObserver(_this, keypath, callback, options || {}));\n  \t\t});\n  \t}\n\n  \t// add observers to the Ractive instance, so they can be\n  \t// cancelled on ractive.teardown()\n  \tthis._observers.push.apply(this._observers, observers);\n\n  \treturn {\n  \t\tcancel: function cancel() {\n  \t\t\tobservers.forEach(function (observer) {\n  \t\t\t\tremoveFromArray(_this._observers, observer);\n  \t\t\t\tobserver.cancel();\n  \t\t\t});\n  \t\t}\n  \t};\n  }\n\n  function createObserver(ractive, keypath, callback, options) {\n  \tvar viewmodel = ractive.viewmodel;\n\n  \tvar keys = splitKeypathI(keypath);\n  \tvar wildcardIndex = keys.indexOf('*');\n\n  \t// normal keypath - no wildcards\n  \tif (! ~wildcardIndex) {\n  \t\tvar key = keys[0];\n\n  \t\t// if not the root model itself, check if viewmodel has key.\n  \t\tif (key !== '' && !viewmodel.has(key)) {\n  \t\t\t// if this is an inline component, we may need to create an implicit mapping\n  \t\t\tif (ractive.component) {\n  \t\t\t\tvar _model = resolveReference(ractive.component.parentFragment, key);\n  \t\t\t\tif (_model) viewmodel.map(key, _model);\n  \t\t\t}\n  \t\t}\n\n  \t\tvar model = viewmodel.joinAll(keys);\n  \t\treturn new Observer(ractive, model, callback, options);\n  \t}\n\n  \t// pattern observers - more complex case\n  \tvar baseModel = wildcardIndex === 0 ? viewmodel : viewmodel.joinAll(keys.slice(0, wildcardIndex));\n\n  \treturn new PatternObserver(ractive, baseModel, keys.splice(wildcardIndex), callback, options);\n  }\n\n  var Observer = function () {\n  \tfunction Observer(ractive, model, callback, options) {\n  \t\tbabelHelpers.classCallCheck(this, Observer);\n\n  \t\tthis.context = options.context || ractive;\n  \t\tthis.model = model;\n  \t\tthis.keypath = model.getKeypath(ractive);\n  \t\tthis.callback = callback;\n\n  \t\tthis.oldValue = undefined;\n  \t\tthis.newValue = model.get();\n\n  \t\tthis.defer = options.defer;\n  \t\tthis.once = options.once;\n  \t\tthis.strict = options.strict;\n\n  \t\tthis.dirty = false;\n\n  \t\tif (options.init !== false) {\n  \t\t\tthis.dispatch();\n  \t\t} else {\n  \t\t\tthis.oldValue = this.newValue;\n  \t\t}\n\n  \t\tmodel.register(this);\n  \t}\n\n  \tObserver.prototype.cancel = function cancel() {\n  \t\tthis.model.unregister(this);\n  \t};\n\n  \tObserver.prototype.dispatch = function dispatch() {\n  \t\tthis.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n  \t\tthis.oldValue = this.newValue;\n  \t\tthis.dirty = false;\n  \t};\n\n  \tObserver.prototype.handleChange = function handleChange() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.newValue = this.model.get();\n\n  \t\t\tif (this.strict && this.newValue === this.oldValue) return;\n\n  \t\t\trunloop.addObserver(this, this.defer);\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.once) this.cancel();\n  \t\t}\n  \t};\n\n  \treturn Observer;\n  }();\n\n  var PatternObserver = function () {\n  \tfunction PatternObserver(ractive, baseModel, keys, callback, options) {\n  \t\tvar _this2 = this;\n\n  \t\tbabelHelpers.classCallCheck(this, PatternObserver);\n\n  \t\tthis.context = options.context || ractive;\n  \t\tthis.ractive = ractive;\n  \t\tthis.baseModel = baseModel;\n  \t\tthis.keys = keys;\n  \t\tthis.callback = callback;\n\n  \t\tvar pattern = keys.join('\\\\.').replace(/\\*/g, '(.+)');\n  \t\tvar baseKeypath = baseModel.getKeypath(ractive);\n  \t\tthis.pattern = new RegExp('^' + (baseKeypath ? baseKeypath + '\\\\.' : '') + pattern + '$');\n\n  \t\tthis.oldValues = {};\n  \t\tthis.newValues = {};\n\n  \t\tthis.defer = options.defer;\n  \t\tthis.once = options.once;\n  \t\tthis.strict = options.strict;\n\n  \t\tthis.dirty = false;\n\n  \t\tvar models = baseModel.findMatches(this.keys);\n\n  \t\tmodels.forEach(function (model) {\n  \t\t\t_this2.newValues[model.getKeypath(_this2.ractive)] = model.get();\n  \t\t});\n\n  \t\tif (options.init !== false) {\n  \t\t\tthis.dispatch();\n  \t\t} else {\n  \t\t\tthis.oldValues = this.newValues;\n  \t\t}\n\n  \t\tbaseModel.register(this);\n  \t}\n\n  \tPatternObserver.prototype.cancel = function cancel() {\n  \t\tthis.baseModel.unregister(this);\n  \t};\n\n  \tPatternObserver.prototype.dispatch = function dispatch() {\n  \t\tvar _this3 = this;\n\n  \t\tObject.keys(this.newValues).forEach(function (keypath) {\n  \t\t\tif (_this3.newKeys && !_this3.newKeys[keypath]) return;\n\n  \t\t\tvar newValue = _this3.newValues[keypath];\n  \t\t\tvar oldValue = _this3.oldValues[keypath];\n\n  \t\t\tif (_this3.strict && newValue === oldValue) return;\n  \t\t\tif (isEqual(newValue, oldValue)) return;\n\n  \t\t\tvar args = [newValue, oldValue, keypath];\n  \t\t\tif (keypath) {\n  \t\t\t\tvar wildcards = _this3.pattern.exec(keypath).slice(1);\n  \t\t\t\targs = args.concat(wildcards);\n  \t\t\t}\n\n  \t\t\t_this3.callback.apply(_this3.context, args);\n  \t\t});\n\n  \t\tthis.oldValues = this.newValues;\n  \t\tthis.newKeys = null;\n  \t\tthis.dirty = false;\n  \t};\n\n  \tPatternObserver.prototype.shuffle = function shuffle(newIndices) {\n  \t\tif (!isArray(this.baseModel.value)) return;\n\n  \t\tvar base = this.baseModel.getKeypath(this.ractive);\n  \t\tvar max = this.baseModel.value.length;\n  \t\tvar suffix = this.keys.length > 1 ? '.' + this.keys.slice(1).join('.') : '';\n\n  \t\tthis.newKeys = {};\n  \t\tfor (var i = 0; i < newIndices.length; i++) {\n  \t\t\tif (newIndices[i] === -1 || newIndices[i] === i) continue;\n  \t\t\tthis.newKeys[base + '.' + i + suffix] = true;\n  \t\t}\n\n  \t\tfor (var _i = newIndices.touchedFrom; _i < max; _i++) {\n  \t\t\tthis.newKeys[base + '.' + _i + suffix] = true;\n  \t\t}\n  \t};\n\n  \tPatternObserver.prototype.handleChange = function handleChange() {\n  \t\tvar _this4 = this;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.newValues = {};\n\n  \t\t\t// handle case where previously extant keypath no longer exists -\n  \t\t\t// observer should still fire, with undefined as new value\n  \t\t\t// TODO huh. according to the test suite that's not the case...\n  \t\t\t// Object.keys( this.oldValues ).forEach( keypath => {\n  \t\t\t// \tthis.newValues[ keypath ] = undefined;\n  \t\t\t// });\n\n  \t\t\tthis.baseModel.findMatches(this.keys).forEach(function (model) {\n  \t\t\t\tvar keypath = model.getKeypath(_this4.ractive);\n  \t\t\t\t_this4.newValues[keypath] = model.get();\n  \t\t\t});\n\n  \t\t\trunloop.addObserver(this, this.defer);\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.once) this.cancel();\n  \t\t}\n  \t};\n\n  \treturn PatternObserver;\n  }();\n\n  function observeList(keypath, callback, options) {\n  \tif (typeof keypath !== 'string') {\n  \t\tthrow new Error('ractive.observeList() must be passed a string as its first argument');\n  \t}\n\n  \tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \tvar observer = new ListObserver(this, model, callback, options || {});\n\n  \t// add observer to the Ractive instance, so it can be\n  \t// cancelled on ractive.teardown()\n  \tthis._observers.push(observer);\n\n  \treturn {\n  \t\tcancel: function cancel() {\n  \t\t\tobserver.cancel();\n  \t\t}\n  \t};\n  }\n\n  function negativeOne() {\n  \treturn -1;\n  }\n\n  var ListObserver = function () {\n  \tfunction ListObserver(context, model, callback, options) {\n  \t\tbabelHelpers.classCallCheck(this, ListObserver);\n\n  \t\tthis.context = context;\n  \t\tthis.model = model;\n  \t\tthis.keypath = model.getKeypath();\n  \t\tthis.callback = callback;\n\n  \t\tthis.pending = null;\n\n  \t\tmodel.register(this);\n\n  \t\tif (options.init !== false) {\n  \t\t\tthis.sliced = [];\n  \t\t\tthis.shuffle([]);\n  \t\t\tthis.handleChange();\n  \t\t} else {\n  \t\t\tthis.sliced = this.slice();\n  \t\t}\n  \t}\n\n  \tListObserver.prototype.handleChange = function handleChange() {\n  \t\tif (this.pending) {\n  \t\t\t// post-shuffle\n  \t\t\tthis.callback(this.pending);\n  \t\t\tthis.pending = null;\n  \t\t} else {\n  \t\t\t// entire array changed\n  \t\t\tthis.shuffle(this.sliced.map(negativeOne));\n  \t\t\tthis.handleChange();\n  \t\t}\n  \t};\n\n  \tListObserver.prototype.shuffle = function shuffle(newIndices) {\n  \t\tvar _this = this;\n\n  \t\tvar newValue = this.slice();\n\n  \t\tvar inserted = [];\n  \t\tvar deleted = [];\n  \t\tvar start = void 0;\n\n  \t\tvar hadIndex = {};\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\thadIndex[newIndex] = true;\n\n  \t\t\tif (newIndex !== oldIndex && start === undefined) {\n  \t\t\t\tstart = oldIndex;\n  \t\t\t}\n\n  \t\t\tif (newIndex === -1) {\n  \t\t\t\tdeleted.push(_this.sliced[oldIndex]);\n  \t\t\t}\n  \t\t});\n\n  \t\tif (start === undefined) start = newIndices.length;\n\n  \t\tvar len = newValue.length;\n  \t\tfor (var i = 0; i < len; i += 1) {\n  \t\t\tif (!hadIndex[i]) inserted.push(newValue[i]);\n  \t\t}\n\n  \t\tthis.pending = { inserted: inserted, deleted: deleted, start: start };\n  \t\tthis.sliced = newValue;\n  \t};\n\n  \tListObserver.prototype.slice = function slice() {\n  \t\tvar value = this.model.get();\n  \t\treturn isArray(value) ? value.slice() : [];\n  \t};\n\n  \treturn ListObserver;\n  }();\n\n  var onceOptions = { init: false, once: true };\n\n  function observeOnce(keypath, callback, options) {\n  \tif (isObject(keypath) || typeof keypath === 'function') {\n  \t\toptions = extendObj(callback || {}, onceOptions);\n  \t\treturn this.observe(keypath, options);\n  \t}\n\n  \toptions = extendObj(options || {}, onceOptions);\n  \treturn this.observe(keypath, callback, options);\n  }\n\n  var trim = (function (str) {\n    return str.trim();\n  })\n\n  var notEmptyString = (function (str) {\n    return str !== '';\n  })\n\n  function Ractive$off(eventName, callback) {\n  \tvar _this = this;\n\n  \t// if no arguments specified, remove all callbacks\n  \tif (!eventName) {\n  \t\t// TODO use this code instead, once the following issue has been resolved\n  \t\t// in PhantomJS (tests are unpassable otherwise!)\n  \t\t// https://github.com/ariya/phantomjs/issues/11856\n  \t\t// defineProperty( this, '_subs', { value: create( null ), configurable: true });\n  \t\tfor (eventName in this._subs) {\n  \t\t\tdelete this._subs[eventName];\n  \t\t}\n  \t} else {\n  \t\t// Handle multiple space-separated event names\n  \t\tvar eventNames = eventName.split(' ').map(trim).filter(notEmptyString);\n\n  \t\teventNames.forEach(function (eventName) {\n  \t\t\tvar subscribers = _this._subs[eventName];\n\n  \t\t\t// If we have subscribers for this event...\n  \t\t\tif (subscribers) {\n  \t\t\t\t// ...if a callback was specified, only remove that\n  \t\t\t\tif (callback) {\n  \t\t\t\t\tvar index = subscribers.indexOf(callback);\n  \t\t\t\t\tif (index !== -1) {\n  \t\t\t\t\t\tsubscribers.splice(index, 1);\n  \t\t\t\t\t}\n  \t\t\t\t}\n\n  \t\t\t\t// ...otherwise remove all callbacks\n  \t\t\t\telse {\n  \t\t\t\t\t\t_this._subs[eventName] = [];\n  \t\t\t\t\t}\n  \t\t\t}\n  \t\t});\n  \t}\n\n  \treturn this;\n  }\n\n  function Ractive$on(eventName, callback) {\n  \tvar _this = this;\n\n  \t// allow multiple listeners to be bound in one go\n  \tif ((typeof eventName === 'undefined' ? 'undefined' : babelHelpers.typeof(eventName)) === 'object') {\n  \t\tvar _ret = function () {\n  \t\t\tvar listeners = [];\n  \t\t\tvar n = void 0;\n\n  \t\t\tfor (n in eventName) {\n  \t\t\t\tif (eventName.hasOwnProperty(n)) {\n  \t\t\t\t\tlisteners.push(_this.on(n, eventName[n]));\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\treturn {\n  \t\t\t\tv: {\n  \t\t\t\t\tcancel: function cancel() {\n  \t\t\t\t\t\tvar listener = void 0;\n  \t\t\t\t\t\twhile (listener = listeners.pop()) {\n  \t\t\t\t\t\t\tlistener.cancel();\n  \t\t\t\t\t\t}\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t};\n  \t\t}();\n\n  \t\tif ((typeof _ret === 'undefined' ? 'undefined' : babelHelpers.typeof(_ret)) === \"object\") return _ret.v;\n  \t}\n\n  \t// Handle multiple space-separated event names\n  \tvar eventNames = eventName.split(' ').map(trim).filter(notEmptyString);\n\n  \teventNames.forEach(function (eventName) {\n  \t\t(_this._subs[eventName] || (_this._subs[eventName] = [])).push(callback);\n  \t});\n\n  \treturn {\n  \t\tcancel: function cancel() {\n  \t\t\treturn _this.off(eventName, callback);\n  \t\t}\n  \t};\n  }\n\n  function Ractive$once(eventName, handler) {\n  \tvar listener = this.on(eventName, function () {\n  \t\thandler.apply(this, arguments);\n  \t\tlistener.cancel();\n  \t});\n\n  \t// so we can still do listener.cancel() manually\n  \treturn listener;\n  }\n\n  // This function takes an array, the name of a mutator method, and the\n  // arguments to call that mutator method with, and returns an array that\n  // maps the old indices to their new indices.\n\n  // So if you had something like this...\n  //\n  //     array = [ 'a', 'b', 'c', 'd' ];\n  //     array.push( 'e' );\n  //\n  // ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n  // have changed. If you then did this...\n  //\n  //     array.unshift( 'z' );\n  //\n  // ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n  // one higher to make room for the 'z'. If you removed an item, the new index\n  // would be -1...\n  //\n  //     array.splice( 2, 2 );\n  //\n  // ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n  //\n  // This information is used to enable fast, non-destructive shuffling of list\n  // sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\n  function getNewIndices(length, methodName, args) {\n  \tvar spliceArguments,\n  \t    newIndices = [],\n  \t    removeStart,\n  \t    removeEnd,\n  \t    balance,\n  \t    i;\n\n  \tspliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  \tif (!spliceArguments) {\n  \t\treturn null; // TODO support reverse and sort?\n  \t}\n\n  \tbalance = spliceArguments.length - 2 - spliceArguments[1];\n\n  \tremoveStart = Math.min(length, spliceArguments[0]);\n  \tremoveEnd = removeStart + spliceArguments[1];\n\n  \tfor (i = 0; i < removeStart; i += 1) {\n  \t\tnewIndices.push(i);\n  \t}\n\n  \tfor (; i < removeEnd; i += 1) {\n  \t\tnewIndices.push(-1);\n  \t}\n\n  \tfor (; i < length; i += 1) {\n  \t\tnewIndices.push(i + balance);\n  \t}\n\n  \t// there is a net shift for the rest of the array starting with index + balance\n  \tif (balance !== 0) {\n  \t\tnewIndices.touchedFrom = spliceArguments[0];\n  \t} else {\n  \t\tnewIndices.touchedFrom = length;\n  \t}\n\n  \treturn newIndices;\n  }\n\n  // The pop, push, shift an unshift methods can all be represented\n  // as an equivalent splice\n  function getSpliceEquivalent(length, methodName, args) {\n  \tswitch (methodName) {\n  \t\tcase 'splice':\n  \t\t\tif (args[0] !== undefined && args[0] < 0) {\n  \t\t\t\targs[0] = length + Math.max(args[0], -length);\n  \t\t\t}\n\n  \t\t\twhile (args.length < 2) {\n  \t\t\t\targs.push(length - args[0]);\n  \t\t\t}\n\n  \t\t\t// ensure we only remove elements that exist\n  \t\t\targs[1] = Math.min(args[1], length - args[0]);\n\n  \t\t\treturn args;\n\n  \t\tcase 'sort':\n  \t\tcase 'reverse':\n  \t\t\treturn null;\n\n  \t\tcase 'pop':\n  \t\t\tif (length) {\n  \t\t\t\treturn [length - 1, 1];\n  \t\t\t}\n  \t\t\treturn [0, 0];\n\n  \t\tcase 'push':\n  \t\t\treturn [length, 0].concat(args);\n\n  \t\tcase 'shift':\n  \t\t\treturn [0, length ? 1 : 0];\n\n  \t\tcase 'unshift':\n  \t\t\treturn [0, 0].concat(args);\n  \t}\n  }\n\n  var arrayProto = Array.prototype;\n\n  function makeArrayMethod (methodName) {\n  \treturn function (keypath) {\n  \t\tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \t\tvar array = model.get();\n\n  \t\tif (!isArray(array)) {\n  \t\t\tthrow new Error('shuffle array method ' + methodName + ' called on non-array at ' + model.getKeypath());\n  \t\t}\n\n  \t\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\t\targs[_key - 1] = arguments[_key];\n  \t\t}\n\n  \t\tvar newIndices = getNewIndices(array.length, methodName, args);\n  \t\tvar result = arrayProto[methodName].apply(array, args);\n\n  \t\tvar promise = runloop.start(this, true).then(function () {\n  \t\t\treturn result;\n  \t\t});\n\n  \t\tif (newIndices) {\n  \t\t\tmodel.shuffle(newIndices);\n  \t\t} else {\n  \t\t\tmodel.set(result);\n  \t\t}\n\n  \t\trunloop.end();\n\n  \t\treturn promise;\n  \t};\n  }\n\n  var pop = makeArrayMethod('pop');\n\n  var push = makeArrayMethod('push');\n\n  var PREFIX = '/* Ractive.js component styles */';\n\n  // Holds current definitions of styles.\n  var styleDefinitions = [];\n\n  // Flag to tell if we need to update the CSS\n  var isDirty = false;\n\n  // These only make sense on the browser. See additional setup below.\n  var styleElement = null;\n  var useCssText = null;\n\n  function addCSS(styleDefinition) {\n  \tstyleDefinitions.push(styleDefinition);\n  \tisDirty = true;\n  }\n\n  function applyCSS() {\n\n  \t// Apply only seems to make sense when we're in the DOM. Server-side renders\n  \t// can call toCSS to get the updated CSS.\n  \tif (!doc || !isDirty) return;\n\n  \tif (useCssText) {\n  \t\tstyleElement.styleSheet.cssText = getCSS(null);\n  \t} else {\n  \t\tstyleElement.innerHTML = getCSS(null);\n  \t}\n\n  \tisDirty = false;\n  }\n\n  function getCSS(cssIds) {\n\n  \tvar filteredStyleDefinitions = cssIds ? styleDefinitions.filter(function (style) {\n  \t\treturn ~cssIds.indexOf(style.id);\n  \t}) : styleDefinitions;\n\n  \treturn filteredStyleDefinitions.reduce(function (styles, style) {\n  \t\treturn styles + '\\n\\n/* {' + style.id + '} */\\n' + style.styles;\n  \t}, PREFIX);\n  }\n\n  // If we're on the browser, additional setup needed.\n  if (doc && (!styleElement || !styleElement.parentNode)) {\n\n  \tstyleElement = doc.createElement('style');\n  \tstyleElement.type = 'text/css';\n\n  \tdoc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n  \tuseCssText = !!styleElement.styleSheet;\n  }\n\n  var renderHook = new Hook('render');\n  var completeHook = new Hook('complete');\n\n  function render(ractive, target, anchor, occupants) {\n  \t// if `noIntro` is `true`, temporarily disable transitions\n  \tvar transitionsEnabled = ractive.transitionsEnabled;\n  \tif (ractive.noIntro) ractive.transitionsEnabled = false;\n\n  \tvar promise = runloop.start(ractive, true);\n  \trunloop.scheduleTask(function () {\n  \t\treturn renderHook.fire(ractive);\n  \t}, true);\n\n  \tif (ractive.fragment.rendered) {\n  \t\tthrow new Error('You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first');\n  \t}\n\n  \tanchor = getElement(anchor) || ractive.anchor;\n\n  \tractive.el = target;\n  \tractive.anchor = anchor;\n\n  \t// ensure encapsulated CSS is up-to-date\n  \tif (ractive.cssId) applyCSS();\n\n  \tif (target) {\n  \t\t(target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n  \t\tif (anchor) {\n  \t\t\tvar docFrag = doc.createDocumentFragment();\n  \t\t\tractive.fragment.render(docFrag);\n  \t\t\ttarget.insertBefore(docFrag, anchor);\n  \t\t} else {\n  \t\t\tractive.fragment.render(target, occupants);\n  \t\t}\n  \t}\n\n  \trunloop.end();\n  \tractive.transitionsEnabled = transitionsEnabled;\n\n  \treturn promise.then(function () {\n  \t\treturn completeHook.fire(ractive);\n  \t});\n  }\n\n  function Ractive$render(target, anchor) {\n  \ttarget = getElement(target) || this.el;\n\n  \tif (!this.append && target) {\n  \t\t// Teardown any existing instances *before* trying to set up the new one -\n  \t\t// avoids certain weird bugs\n  \t\tvar others = target.__ractive_instances__;\n  \t\tif (others) others.forEach(teardown);\n\n  \t\t// make sure we are the only occupants\n  \t\tif (!this.enhance) {\n  \t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n  \t\t}\n  \t}\n\n  \tvar occupants = this.enhance ? toArray(target.childNodes) : null;\n  \tvar promise = render(this, target, anchor, occupants);\n\n  \tif (occupants) {\n  \t\twhile (occupants.length) {\n  \t\t\ttarget.removeChild(occupants.pop());\n  \t\t}\n  \t}\n\n  \treturn promise;\n  }\n\n  var adaptConfigurator = {\n  \textend: function extend(Parent, proto, options) {\n  \t\tproto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  \t},\n\n  \tinit: function init() {}\n  };\n\n  function combine(a, b) {\n  \tvar c = a.slice();\n  \tvar i = b.length;\n\n  \twhile (i--) {\n  \t\tif (! ~c.indexOf(b[i])) {\n  \t\t\tc.push(b[i]);\n  \t\t}\n  \t}\n\n  \treturn c;\n  }\n\n  var selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g;\n  var commentsPattern = /\\/\\*.*?\\*\\//g;\n  var selectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\n  var excludePattern = /^(?:@|\\d+%)/;\n  var dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\n  function trim$1(str) {\n  \treturn str.trim();\n  }\n\n  function extractString(unit) {\n  \treturn unit.str;\n  }\n\n  function transformSelector(selector, parent) {\n  \tvar selectorUnits = [];\n  \tvar match = void 0;\n\n  \twhile (match = selectorUnitPattern.exec(selector)) {\n  \t\tselectorUnits.push({\n  \t\t\tstr: match[0],\n  \t\t\tbase: match[1],\n  \t\t\tmodifiers: match[2]\n  \t\t});\n  \t}\n\n  \t// For each simple selector within the selector, we need to create a version\n  \t// that a) combines with the id, and b) is inside the id\n  \tvar base = selectorUnits.map(extractString);\n\n  \tvar transformed = [];\n  \tvar i = selectorUnits.length;\n\n  \twhile (i--) {\n  \t\tvar appended = base.slice();\n\n  \t\t// Pseudo-selectors should go after the attribute selector\n  \t\tvar unit = selectorUnits[i];\n  \t\tappended[i] = unit.base + parent + unit.modifiers || '';\n\n  \t\tvar prepended = base.slice();\n  \t\tprepended[i] = parent + ' ' + prepended[i];\n\n  \t\ttransformed.push(appended.join(' '), prepended.join(' '));\n  \t}\n\n  \treturn transformed.join(', ');\n  }\n\n  function transformCss(css, id) {\n  \tvar dataAttr = '[data-ractive-css~=\"{' + id + '}\"]';\n\n  \tvar transformed = void 0;\n\n  \tif (dataRvcGuidPattern.test(css)) {\n  \t\ttransformed = css.replace(dataRvcGuidPattern, dataAttr);\n  \t} else {\n  \t\ttransformed = css.replace(commentsPattern, '').replace(selectorsPattern, function (match, $1) {\n  \t\t\t// don't transform at-rules and keyframe declarations\n  \t\t\tif (excludePattern.test($1)) return match;\n\n  \t\t\tvar selectors = $1.split(',').map(trim$1);\n  \t\t\tvar transformed = selectors.map(function (selector) {\n  \t\t\t\treturn transformSelector(selector, dataAttr);\n  \t\t\t}).join(', ') + ' ';\n\n  \t\t\treturn match.replace($1, transformed);\n  \t\t});\n  \t}\n\n  \treturn transformed;\n  }\n\n  function s4() {\n  \treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n\n  function uuid() {\n  \treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n  }\n\n  var cssConfigurator = {\n  \tname: 'css',\n\n  \t// Called when creating a new component definition\n  \textend: function extend(Parent, proto, options) {\n  \t\tif (!options.css) return;\n\n  \t\tvar id = uuid();\n  \t\tvar styles = options.noCssTransform ? options.css : transformCss(options.css, id);\n\n  \t\tproto.cssId = id;\n\n  \t\taddCSS({ id: id, styles: styles });\n  \t},\n\n  \t// Called when creating a new component instance\n  \tinit: function init(Parent, target, options) {\n  \t\tif (!options.css) return;\n\n  \t\twarnIfDebug('\\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\\n\\nconst Component = Ractive.extend({\\n\\t...\\n\\tcss: \\'/* your css */\\',\\n\\t...\\n});\\n\\nconst componentInstance = new Component({ ... })\\n\\t\\t');\n  \t}\n\n  };\n\n  function bind(fn, context) {\n  \tif (!/this/.test(fn.toString())) return fn;\n\n  \tvar bound = fn.bind(context);\n  \tfor (var prop in fn) {\n  \t\tbound[prop] = fn[prop];\n  \t}return bound;\n  }\n\n  function validate(data) {\n  \t// Warn if userOptions.data is a non-POJO\n  \tif (data && data.constructor !== Object) {\n  \t\tif (typeof data === 'function') {\n  \t\t\t// TODO do we need to support this in the new Ractive() case?\n  \t\t} else if ((typeof data === 'undefined' ? 'undefined' : babelHelpers.typeof(data)) !== 'object') {\n  \t\t\t\tfatal('data option must be an object or a function, `' + data + '` is not valid');\n  \t\t\t} else {\n  \t\t\t\twarnIfDebug('If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged');\n  \t\t\t}\n  \t}\n  }\n\n  var dataConfigurator = {\n  \tname: 'data',\n\n  \textend: function extend(Parent, proto, options) {\n  \t\tvar key = void 0;\n  \t\tvar value = void 0;\n\n  \t\t// check for non-primitives, which could cause mutation-related bugs\n  \t\tif (options.data && isObject(options.data)) {\n  \t\t\tfor (key in options.data) {\n  \t\t\t\tvalue = options.data[key];\n\n  \t\t\t\tif (value && (typeof value === 'undefined' ? 'undefined' : babelHelpers.typeof(value)) === 'object') {\n  \t\t\t\t\tif (isObject(value) || isArray(value)) {\n  \t\t\t\t\t\twarnIfDebug('Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\\n\\n  // this...\\n  data: function () {\\n    return {\\n      myObject: {}\\n    };\\n  })\\n\\n  // instead of this:\\n  data: {\\n    myObject: {}\\n  }');\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tproto.data = combine$1(proto.data, options.data);\n  \t},\n\n  \tinit: function init(Parent, ractive, options) {\n  \t\tvar result = combine$1(Parent.prototype.data, options.data);\n\n  \t\tif (typeof result === 'function') result = result.call(ractive);\n\n  \t\t// bind functions to the ractive instance at the top level,\n  \t\t// unless it's a non-POJO (in which case alarm bells should ring)\n  \t\tif (result && result.constructor === Object) {\n  \t\t\tfor (var prop in result) {\n  \t\t\t\tif (typeof result[prop] === 'function') result[prop] = bind(result[prop], ractive);\n  \t\t\t}\n  \t\t}\n\n  \t\treturn result || {};\n  \t},\n\n  \treset: function reset(ractive) {\n  \t\tvar result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n  \t\tractive.viewmodel.root.set(result);\n  \t\treturn true;\n  \t}\n  };\n\n  function combine$1(parentValue, childValue) {\n  \tvalidate(childValue);\n\n  \tvar parentIsFn = typeof parentValue === 'function';\n  \tvar childIsFn = typeof childValue === 'function';\n\n  \t// Very important, otherwise child instance can become\n  \t// the default data object on Ractive or a component.\n  \t// then ractive.set() ends up setting on the prototype!\n  \tif (!childValue && !parentIsFn) {\n  \t\tchildValue = {};\n  \t}\n\n  \t// Fast path, where we just need to copy properties from\n  \t// parent to child\n  \tif (!parentIsFn && !childIsFn) {\n  \t\treturn fromProperties(childValue, parentValue);\n  \t}\n\n  \treturn function () {\n  \t\tvar child = childIsFn ? callDataFunction(childValue, this) : childValue;\n  \t\tvar parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n  \t\treturn fromProperties(child, parent);\n  \t};\n  }\n\n  function callDataFunction(fn, context) {\n  \tvar data = fn.call(context);\n\n  \tif (!data) return;\n\n  \tif ((typeof data === 'undefined' ? 'undefined' : babelHelpers.typeof(data)) !== 'object') {\n  \t\tfatal('Data function must return an object');\n  \t}\n\n  \tif (data.constructor !== Object) {\n  \t\twarnOnceIfDebug('Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged');\n  \t}\n\n  \treturn data;\n  }\n\n  function fromProperties(primary, secondary) {\n  \tif (primary && secondary) {\n  \t\tfor (var key in secondary) {\n  \t\t\tif (!(key in primary)) {\n  \t\t\t\tprimary[key] = secondary[key];\n  \t\t\t}\n  \t\t}\n\n  \t\treturn primary;\n  \t}\n\n  \treturn primary || secondary;\n  }\n\n  var TEMPLATE_VERSION = 3;\n\n  var pattern = /\\$\\{([^\\}]+)\\}/g;\n\n  function fromExpression(body) {\n  \tvar length = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n  \tvar args = new Array(length);\n\n  \twhile (length--) {\n  \t\targs[length] = '_' + length;\n  \t}\n\n  \t// Functions created directly with new Function() look like this:\n  \t//     function anonymous (_0 /**/) { return _0*2 }\n  \t//\n  \t// With this workaround, we get a little more compact:\n  \t//     function (_0){return _0*2}\n  \treturn new Function([], 'return function (' + args.join(',') + '){return(' + body + ');};')();\n  }\n\n  function fromComputationString(str, bindTo) {\n  \tvar hasThis = void 0;\n\n  \tvar functionBody = 'return (' + str.replace(pattern, function (match, keypath) {\n  \t\thasThis = true;\n  \t\treturn '__ractive.get(\"' + keypath + '\")';\n  \t}) + ');';\n\n  \tif (hasThis) functionBody = 'var __ractive = this; ' + functionBody;\n  \tvar fn = new Function(functionBody);\n  \treturn hasThis ? fn.bind(bindTo) : fn;\n  }\n\n  var functions = create(null);\n\n  function getFunction(str, i) {\n  \tif (functions[str]) return functions[str];\n  \treturn functions[str] = createFunction(str, i);\n  }\n\n  function addFunctions(template) {\n  \tif (!template) return;\n\n  \tvar exp = template.e;\n\n  \tif (!exp) return;\n\n  \tObject.keys(exp).forEach(function (str) {\n  \t\tif (functions[str]) return;\n  \t\tfunctions[str] = exp[str];\n  \t});\n  }\n\n  var parse = null;\n\n  var parseOptions = ['delimiters', 'tripleDelimiters', 'staticDelimiters', 'staticTripleDelimiters', 'csp', 'interpolate', 'preserveWhitespace', 'sanitize', 'stripComments'];\n\n  var TEMPLATE_INSTRUCTIONS = 'Either preparse or use a ractive runtime source that includes the parser. ';\n\n  var COMPUTATION_INSTRUCTIONS = 'Either use:\\n\\n\\tRactive.parse.computedStrings( component.computed )\\n\\nat build time to pre-convert the strings to functions, or use functions instead of strings in computed properties.';\n\n  function throwNoParse(method, error, instructions) {\n  \tif (!method) {\n  \t\tfatal('Missing Ractive.parse - cannot parse ' + error + '. ' + instructions);\n  \t}\n  }\n\n  function createFunction(body, length) {\n  \tthrowNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  \treturn fromExpression(body, length);\n  }\n\n  function createFunctionFromString(str, bindTo) {\n  \tthrowNoParse(fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  \treturn fromComputationString(str, bindTo);\n  }\n\n  var parser = {\n  \tfromId: function fromId(id, options) {\n  \t\tif (!doc) {\n  \t\t\tif (options && options.noThrow) {\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t\tthrow new Error('Cannot retrieve template #' + id + ' as Ractive is not running in a browser.');\n  \t\t}\n\n  \t\tif (id) id = id.replace(/^#/, '');\n\n  \t\tvar template = void 0;\n\n  \t\tif (!(template = doc.getElementById(id))) {\n  \t\t\tif (options && options.noThrow) {\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t\tthrow new Error('Could not find template element with id #' + id);\n  \t\t}\n\n  \t\tif (template.tagName.toUpperCase() !== 'SCRIPT') {\n  \t\t\tif (options && options.noThrow) {\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t\tthrow new Error('Template element with id #' + id + ', must be a <script> element');\n  \t\t}\n\n  \t\treturn 'textContent' in template ? template.textContent : template.innerHTML;\n  \t},\n  \tisParsed: function isParsed(template) {\n  \t\treturn !(typeof template === 'string');\n  \t},\n  \tgetParseOptions: function getParseOptions(ractive) {\n  \t\t// Could be Ractive or a Component\n  \t\tif (ractive.defaults) {\n  \t\t\tractive = ractive.defaults;\n  \t\t}\n\n  \t\treturn parseOptions.reduce(function (val, key) {\n  \t\t\tval[key] = ractive[key];\n  \t\t\treturn val;\n  \t\t}, {});\n  \t},\n  \tparse: function parse$$(template, options) {\n  \t\tthrowNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n  \t\tvar parsed = parse(template, options);\n  \t\taddFunctions(parsed);\n  \t\treturn parsed;\n  \t},\n  \tparseFor: function parseFor(template, ractive) {\n  \t\treturn this.parse(template, this.getParseOptions(ractive));\n  \t}\n  };\n\n  var templateConfigurator = {\n  \tname: 'template',\n\n  \textend: function extend(Parent, proto, options) {\n  \t\t// only assign if exists\n  \t\tif ('template' in options) {\n  \t\t\tvar template = options.template;\n\n  \t\t\tif (typeof template === 'function') {\n  \t\t\t\tproto.template = template;\n  \t\t\t} else {\n  \t\t\t\tproto.template = parseTemplate(template, proto);\n  \t\t\t}\n  \t\t}\n  \t},\n  \tinit: function init(Parent, ractive, options) {\n  \t\t// TODO because of prototypal inheritance, we might just be able to use\n  \t\t// ractive.template, and not bother passing through the Parent object.\n  \t\t// At present that breaks the test mocks' expectations\n  \t\tvar template = 'template' in options ? options.template : Parent.prototype.template;\n  \t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\n\n  \t\tif (typeof template === 'function') {\n  \t\t\tvar fn = template;\n  \t\t\ttemplate = getDynamicTemplate(ractive, fn);\n\n  \t\t\tractive._config.template = {\n  \t\t\t\tfn: fn,\n  \t\t\t\tresult: template\n  \t\t\t};\n  \t\t}\n\n  \t\ttemplate = parseTemplate(template, ractive);\n\n  \t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n  \t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n  \t\t// it's unnecessary, because the developer never needs to access\n  \t\t// ractive.template\n  \t\tractive.template = template.t;\n\n  \t\tif (template.p) {\n  \t\t\textendPartials(ractive.partials, template.p);\n  \t\t}\n  \t},\n  \treset: function reset(ractive) {\n  \t\tvar result = resetValue(ractive);\n\n  \t\tif (result) {\n  \t\t\tvar parsed = parseTemplate(result, ractive);\n\n  \t\t\tractive.template = parsed.t;\n  \t\t\textendPartials(ractive.partials, parsed.p, true);\n\n  \t\t\treturn true;\n  \t\t}\n  \t}\n  };\n\n  function resetValue(ractive) {\n  \tvar initial = ractive._config.template;\n\n  \t// If this isn't a dynamic template, there's nothing to do\n  \tif (!initial || !initial.fn) {\n  \t\treturn;\n  \t}\n\n  \tvar result = getDynamicTemplate(ractive, initial.fn);\n\n  \t// TODO deep equality check to prevent unnecessary re-rendering\n  \t// in the case of already-parsed templates\n  \tif (result !== initial.result) {\n  \t\tinitial.result = result;\n  \t\treturn result;\n  \t}\n  }\n\n  function getDynamicTemplate(ractive, fn) {\n  \treturn fn.call(ractive, {\n  \t\tfromId: parser.fromId,\n  \t\tisParsed: parser.isParsed,\n  \t\tparse: function parse(template) {\n  \t\t\tvar options = arguments.length <= 1 || arguments[1] === undefined ? parser.getParseOptions(ractive) : arguments[1];\n\n  \t\t\treturn parser.parse(template, options);\n  \t\t}\n  \t});\n  }\n\n  function parseTemplate(template, ractive) {\n  \tif (typeof template === 'string') {\n  \t\t// parse will validate and add expression functions\n  \t\ttemplate = parseAsString(template, ractive);\n  \t} else {\n  \t\t// need to validate and add exp for already parsed template\n  \t\tvalidate$1(template);\n  \t\taddFunctions(template);\n  \t}\n\n  \treturn template;\n  }\n\n  function parseAsString(template, ractive) {\n  \t// ID of an element containing the template?\n  \tif (template[0] === '#') {\n  \t\ttemplate = parser.fromId(template);\n  \t}\n\n  \treturn parser.parseFor(template, ractive);\n  }\n\n  function validate$1(template) {\n\n  \t// Check that the template even exists\n  \tif (template == undefined) {\n  \t\tthrow new Error('The template cannot be ' + template + '.');\n  \t}\n\n  \t// Check the parsed template has a version at all\n  \telse if (typeof template.v !== 'number') {\n  \t\t\tthrow new Error('The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.');\n  \t\t}\n\n  \t\t// Check we're using the correct version\n  \t\telse if (template.v !== TEMPLATE_VERSION) {\n  \t\t\t\tthrow new Error('Mismatched template version (expected ' + TEMPLATE_VERSION + ', got ' + template.v + ') Please ensure you are using the latest version of Ractive.js in your build process as well as in your app');\n  \t\t\t}\n  }\n\n  function extendPartials(existingPartials, newPartials, overwrite) {\n  \tif (!newPartials) return;\n\n  \t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  \t// case, but not initially...\n\n  \tfor (var key in newPartials) {\n  \t\tif (overwrite || !existingPartials.hasOwnProperty(key)) {\n  \t\t\texistingPartials[key] = newPartials[key];\n  \t\t}\n  \t}\n  }\n\n  var registryNames = ['adaptors', 'components', 'computed', 'decorators', 'easing', 'events', 'interpolators', 'partials', 'transitions'];\n\n  var Registry = function () {\n  \tfunction Registry(name, useDefaults) {\n  \t\tbabelHelpers.classCallCheck(this, Registry);\n\n  \t\tthis.name = name;\n  \t\tthis.useDefaults = useDefaults;\n  \t}\n\n  \tRegistry.prototype.extend = function extend(Parent, proto, options) {\n  \t\tthis.configure(this.useDefaults ? Parent.defaults : Parent, this.useDefaults ? proto : proto.constructor, options);\n  \t};\n\n  \tRegistry.prototype.init = function init() {\n  \t\t// noop\n  \t};\n\n  \tRegistry.prototype.configure = function configure(Parent, target, options) {\n  \t\tvar name = this.name;\n  \t\tvar option = options[name];\n\n  \t\tvar registry = create(Parent[name]);\n\n  \t\tfor (var key in option) {\n  \t\t\tregistry[key] = option[key];\n  \t\t}\n\n  \t\ttarget[name] = registry;\n  \t};\n\n  \tRegistry.prototype.reset = function reset(ractive) {\n  \t\tvar registry = ractive[this.name];\n  \t\tvar changed = false;\n\n  \t\tObject.keys(registry).forEach(function (key) {\n  \t\t\tvar item = registry[key];\n\n  \t\t\tif (item._fn) {\n  \t\t\t\tif (item._fn.isOwner) {\n  \t\t\t\t\tregistry[key] = item._fn;\n  \t\t\t\t} else {\n  \t\t\t\t\tdelete registry[key];\n  \t\t\t\t}\n  \t\t\t\tchanged = true;\n  \t\t\t}\n  \t\t});\n\n  \t\treturn changed;\n  \t};\n\n  \treturn Registry;\n  }();\n\n  var registries = registryNames.map(function (name) {\n  \treturn new Registry(name, name === 'computed');\n  });\n\n  function wrap(parent, name, method) {\n  \tif (!/_super/.test(method)) return method;\n\n  \tfunction wrapper() {\n  \t\tvar superMethod = getSuperMethod(wrapper._parent, name);\n  \t\tvar hasSuper = '_super' in this;\n  \t\tvar oldSuper = this._super;\n\n  \t\tthis._super = superMethod;\n\n  \t\tvar result = method.apply(this, arguments);\n\n  \t\tif (hasSuper) {\n  \t\t\tthis._super = oldSuper;\n  \t\t} else {\n  \t\t\tdelete this._super;\n  \t\t}\n\n  \t\treturn result;\n  \t}\n\n  \twrapper._parent = parent;\n  \twrapper._method = method;\n\n  \treturn wrapper;\n  }\n\n  function getSuperMethod(parent, name) {\n  \tif (name in parent) {\n  \t\tvar _ret = function () {\n  \t\t\tvar value = parent[name];\n\n  \t\t\treturn {\n  \t\t\t\tv: typeof value === 'function' ? value : function () {\n  \t\t\t\t\treturn value;\n  \t\t\t\t}\n  \t\t\t};\n  \t\t}();\n\n  \t\tif ((typeof _ret === 'undefined' ? 'undefined' : babelHelpers.typeof(_ret)) === \"object\") return _ret.v;\n  \t}\n\n  \treturn noop;\n  }\n\n  function getMessage(deprecated, correct, isError) {\n  \treturn 'options.' + deprecated + ' has been deprecated in favour of options.' + correct + '.' + (isError ? ' You cannot specify both options, please use options.' + correct + '.' : '');\n  }\n\n  function deprecateOption(options, deprecatedOption, correct) {\n  \tif (deprecatedOption in options) {\n  \t\tif (!(correct in options)) {\n  \t\t\twarnIfDebug(getMessage(deprecatedOption, correct));\n  \t\t\toptions[correct] = options[deprecatedOption];\n  \t\t} else {\n  \t\t\tthrow new Error(getMessage(deprecatedOption, correct, true));\n  \t\t}\n  \t}\n  }\n\n  function deprecate(options) {\n  \tdeprecateOption(options, 'beforeInit', 'onconstruct');\n  \tdeprecateOption(options, 'init', 'onrender');\n  \tdeprecateOption(options, 'complete', 'oncomplete');\n  \tdeprecateOption(options, 'eventDefinitions', 'events');\n\n  \t// Using extend with Component instead of options,\n  \t// like Human.extend( Spider ) means adaptors as a registry\n  \t// gets copied to options. So we have to check if actually an array\n  \tif (isArray(options.adaptors)) {\n  \t\tdeprecateOption(options, 'adaptors', 'adapt');\n  \t}\n  }\n\n  var custom = {\n  \tadapt: adaptConfigurator,\n  \tcss: cssConfigurator,\n  \tdata: dataConfigurator,\n  \ttemplate: templateConfigurator\n  };\n\n  var defaultKeys = Object.keys(defaults);\n\n  var isStandardKey = makeObj(defaultKeys.filter(function (key) {\n  \treturn !custom[key];\n  }));\n\n  // blacklisted keys that we don't double extend\n  var isBlacklisted = makeObj(defaultKeys.concat(registries.map(function (r) {\n  \treturn r.name;\n  })));\n\n  var order = [].concat(defaultKeys.filter(function (key) {\n  \treturn !registries[key] && !custom[key];\n  }), registries,\n  //custom.data,\n  custom.template, custom.css);\n\n  var config = {\n  \textend: function extend(Parent, proto, options) {\n  \t\treturn configure('extend', Parent, proto, options);\n  \t},\n\n  \tinit: function init(Parent, ractive, options) {\n  \t\treturn configure('init', Parent, ractive, options);\n  \t},\n\n  \treset: function reset(ractive) {\n  \t\treturn order.filter(function (c) {\n  \t\t\treturn c.reset && c.reset(ractive);\n  \t\t}).map(function (c) {\n  \t\t\treturn c.name;\n  \t\t});\n  \t},\n\n  \t// this defines the order. TODO this isn't used anywhere in the codebase,\n  \t// only in the test suite - should get rid of it\n  \torder: order\n  };\n\n  function configure(method, Parent, target, options) {\n  \tdeprecate(options);\n\n  \tfor (var key in options) {\n  \t\tif (isStandardKey.hasOwnProperty(key)) {\n  \t\t\tvar value = options[key];\n\n  \t\t\t// warn the developer if they passed a function and ignore its value\n\n  \t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n  \t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n  \t\t\t// function object as the result of querySelector methods\n  \t\t\tif (key !== 'el' && typeof value === 'function') {\n  \t\t\t\twarnIfDebug(key + ' is a Ractive option that does not expect a function and will be ignored', method === 'init' ? target : null);\n  \t\t\t} else {\n  \t\t\t\ttarget[key] = value;\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \t// disallow combination of `append` and `enhance`\n  \tif (options.append && options.enhance) {\n  \t\tthrow new Error('Cannot use append and enhance at the same time');\n  \t}\n\n  \tregistries.forEach(function (registry) {\n  \t\tregistry[method](Parent, target, options);\n  \t});\n\n  \tadaptConfigurator[method](Parent, target, options);\n  \ttemplateConfigurator[method](Parent, target, options);\n  \tcssConfigurator[method](Parent, target, options);\n\n  \textendOtherMethods(Parent.prototype, target, options);\n  }\n\n  function extendOtherMethods(parent, target, options) {\n  \tfor (var key in options) {\n  \t\tif (!isBlacklisted[key] && options.hasOwnProperty(key)) {\n  \t\t\tvar member = options[key];\n\n  \t\t\t// if this is a method that overwrites a method, wrap it:\n  \t\t\tif (typeof member === 'function') {\n  \t\t\t\tmember = wrap(parent, key, member);\n  \t\t\t}\n\n  \t\t\ttarget[key] = member;\n  \t\t}\n  \t}\n  }\n\n  function makeObj(array) {\n  \tvar obj = {};\n  \tarray.forEach(function (x) {\n  \t\treturn obj[x] = true;\n  \t});\n  \treturn obj;\n  }\n\n  var shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\n  var completeHook$1 = new Hook('complete');\n  var resetHook = new Hook('reset');\n  var renderHook$1 = new Hook('render');\n  var unrenderHook = new Hook('unrender');\n\n  function Ractive$reset(data) {\n  \tdata = data || {};\n\n  \tif ((typeof data === 'undefined' ? 'undefined' : babelHelpers.typeof(data)) !== 'object') {\n  \t\tthrow new Error('The reset method takes either no arguments, or an object containing new data');\n  \t}\n\n  \t// TEMP need to tidy this up\n  \tdata = dataConfigurator.init(this.constructor, this, { data: data });\n\n  \tvar promise = runloop.start(this, true);\n\n  \t// If the root object is wrapped, try and use the wrapper's reset value\n  \tvar wrapper = this.viewmodel.wrapper;\n  \tif (wrapper && wrapper.reset) {\n  \t\tif (wrapper.reset(data) === false) {\n  \t\t\t// reset was rejected, we need to replace the object\n  \t\t\tthis.viewmodel.set(data);\n  \t\t}\n  \t} else {\n  \t\tthis.viewmodel.set(data);\n  \t}\n\n  \t// reset config items and track if need to rerender\n  \tvar changes = config.reset(this);\n  \tvar rerender = void 0;\n\n  \tvar i = changes.length;\n  \twhile (i--) {\n  \t\tif (shouldRerender.indexOf(changes[i]) > -1) {\n  \t\t\trerender = true;\n  \t\t\tbreak;\n  \t\t}\n  \t}\n\n  \tif (rerender) {\n  \t\tunrenderHook.fire(this);\n  \t\tthis.fragment.resetTemplate(this.template);\n  \t\trenderHook$1.fire(this);\n  \t\tcompleteHook$1.fire(this);\n  \t}\n\n  \trunloop.end();\n\n  \tresetHook.fire(this, data);\n\n  \treturn promise;\n  }\n\n  var TEXT = 1;\n  var INTERPOLATOR = 2;\n  var TRIPLE = 3;\n  var SECTION = 4;\n  var ELEMENT = 7;\n  var PARTIAL = 8;\n  var COMPONENT = 15;\n  var YIELDER = 16;\n  var DOCTYPE = 18;\n  var ALIAS = 19;\n\n  var NUMBER_LITERAL = 20;\n  var STRING_LITERAL = 21;\n  var REFERENCE = 30;\n  var SECTION_IF = 50;\n  var SECTION_UNLESS = 51;\n  var SECTION_EACH = 52;\n  var SECTION_WITH = 53;\n  var SECTION_IF_WITH = 54;\n\n  function collect(source, name, dest) {\n  \tsource.forEach(function (item) {\n  \t\t// queue to rerender if the item is a partial and the current name matches\n  \t\tif (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n  \t\t\tdest.push(item);\n  \t\t\treturn; // go no further\n  \t\t}\n\n  \t\t// if it has a fragment, process its items\n  \t\tif (item.fragment) {\n  \t\t\tcollect(item.fragment.iterations || item.fragment.items, name, dest);\n  \t\t}\n\n  \t\t// or if it is itself a fragment, process its items\n  \t\telse if (isArray(item.items)) {\n  \t\t\t\tcollect(item.items, name, dest);\n  \t\t\t}\n\n  \t\t\t// or if it is a component, step in and process its items\n  \t\t\telse if (item.type === COMPONENT && item.instance) {\n  \t\t\t\t\t// ...unless the partial is shadowed\n  \t\t\t\t\tif (item.instance.partials[name]) return;\n  \t\t\t\t\tcollect(item.instance.fragment.items, name, dest);\n  \t\t\t\t}\n\n  \t\t// if the item is an element, process its attributes too\n  \t\tif (item.type === ELEMENT) {\n  \t\t\tif (isArray(item.attributes)) {\n  \t\t\t\tcollect(item.attributes, name, dest);\n  \t\t\t}\n\n  \t\t\tif (isArray(item.conditionalAttributes)) {\n  \t\t\t\tcollect(item.conditionalAttributes, name, dest);\n  \t\t\t}\n  \t\t}\n  \t});\n  }\n\n  function forceResetTemplate(partial) {\n  \tpartial.forceResetTemplate();\n  }\n\n  function resetPartial (name, partial) {\n  \tvar collection = [];\n  \tcollect(this.fragment.items, name, collection);\n\n  \tvar promise = runloop.start(this, true);\n\n  \tthis.partials[name] = partial;\n  \tcollection.forEach(forceResetTemplate);\n\n  \trunloop.end();\n\n  \treturn promise;\n  }\n\n  var Item = function () {\n  \tfunction Item(options) {\n  \t\tbabelHelpers.classCallCheck(this, Item);\n\n  \t\tthis.parentFragment = options.parentFragment;\n  \t\tthis.ractive = options.parentFragment.ractive;\n\n  \t\tthis.template = options.template;\n  \t\tthis.index = options.index;\n  \t\tthis.type = options.template.t;\n\n  \t\tthis.dirty = false;\n  \t}\n\n  \tItem.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.parentFragment.bubble();\n  \t\t}\n  \t};\n\n  \tItem.prototype.find = function find() {\n  \t\treturn null;\n  \t};\n\n  \tItem.prototype.findAll = function findAll() {\n  \t\t// noop\n  \t};\n\n  \tItem.prototype.findComponent = function findComponent() {\n  \t\treturn null;\n  \t};\n\n  \tItem.prototype.findAllComponents = function findAllComponents() {\n  \t\t// noop;\n  \t};\n\n  \tItem.prototype.findNextNode = function findNextNode() {\n  \t\treturn this.parentFragment.findNextNode(this);\n  \t};\n\n  \tItem.prototype.valueOf = function valueOf() {\n  \t\treturn this.toString();\n  \t};\n\n  \treturn Item;\n  }();\n\n  var ComputationChild = function (_Model) {\n  \tbabelHelpers.inherits(ComputationChild, _Model);\n\n  \tfunction ComputationChild() {\n  \t\tbabelHelpers.classCallCheck(this, ComputationChild);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Model.apply(this, arguments));\n  \t}\n\n  \tComputationChild.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n\n  \t\tvar parentValue = this.parent.get();\n  \t\treturn parentValue ? parentValue[this.key] : undefined;\n  \t};\n\n  \tComputationChild.prototype.handleChange = function handleChange() {\n  \t\tthis.dirty = true;\n\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(_handleChange);\n  \t\tthis.clearUnresolveds(); // TODO is this necessary?\n  \t};\n\n  \tComputationChild.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ComputationChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \t// TODO this causes problems with inter-component mappings\n  \t// set () {\n  \t// \tthrow new Error( `Cannot set read-only property of computed value (${this.getKeypath()})` );\n  \t// }\n\n\n  \treturn ComputationChild;\n  }(Model);\n\n  function getValue(model) {\n  \treturn model ? model.get(true) : undefined;\n  }\n\n  var ExpressionProxy = function (_Model) {\n  \tbabelHelpers.inherits(ExpressionProxy, _Model);\n\n  \tfunction ExpressionProxy(fragment, template) {\n  \t\tbabelHelpers.classCallCheck(this, ExpressionProxy);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, fragment.ractive.viewmodel, null));\n\n  \t\t_this.fragment = fragment;\n  \t\t_this.template = template;\n\n  \t\t_this.isReadonly = true;\n\n  \t\t_this.fn = getFunction(template.s, template.r.length);\n  \t\t_this.computation = null;\n\n  \t\t_this.resolvers = [];\n  \t\t_this.models = _this.template.r.map(function (ref, index) {\n  \t\t\tvar model = resolveReference(_this.fragment, ref);\n  \t\t\tvar resolver = void 0;\n\n  \t\t\tif (!model) {\n  \t\t\t\tresolver = _this.fragment.resolve(ref, function (model) {\n  \t\t\t\t\tremoveFromArray(_this.resolvers, resolver);\n  \t\t\t\t\t_this.models[index] = model;\n  \t\t\t\t\t_this.bubble();\n  \t\t\t\t});\n\n  \t\t\t\t_this.resolvers.push(resolver);\n  \t\t\t}\n\n  \t\t\treturn model;\n  \t\t});\n\n  \t\t_this.bubble();\n  \t\treturn _this;\n  \t}\n\n  \tExpressionProxy.prototype.bubble = function bubble() {\n  \t\tvar _this2 = this;\n\n  \t\tvar ractive = this.fragment.ractive;\n\n  \t\t// TODO the @ prevents computed props from shadowing keypaths, but the real\n  \t\t// question is why it's a computed prop in the first place... (hint, it's\n  \t\t// to do with {{else}} blocks)\n  \t\tvar key = '@' + this.template.s.replace(/_(\\d+)/g, function (match, i) {\n  \t\t\tif (i >= _this2.models.length) return match;\n\n  \t\t\tvar model = _this2.models[i];\n  \t\t\treturn model ? model.getKeypath() : '@undefined';\n  \t\t});\n\n  \t\t// TODO can/should we reuse computations?\n  \t\tvar signature = {\n  \t\t\tgetter: function getter() {\n  \t\t\t\tvar values = _this2.models.map(getValue);\n  \t\t\t\treturn _this2.fn.apply(ractive, values);\n  \t\t\t},\n  \t\t\tgetterString: key\n  \t\t};\n\n  \t\tvar computation = ractive.viewmodel.compute(key, signature);\n\n  \t\tthis.value = computation.get(); // TODO should not need this, eventually\n\n  \t\tif (this.computation) {\n  \t\t\tthis.computation.unregister(this);\n  \t\t\t// notify children...\n  \t\t}\n\n  \t\tthis.computation = computation;\n  \t\tcomputation.register(this);\n\n  \t\tthis.handleChange();\n  \t};\n\n  \tExpressionProxy.prototype.get = function get(shouldCapture) {\n  \t\treturn this.computation.get(shouldCapture);\n  \t};\n\n  \tExpressionProxy.prototype.getKeypath = function getKeypath() {\n  \t\treturn this.computation ? this.computation.getKeypath() : '@undefined';\n  \t};\n\n  \tExpressionProxy.prototype.handleChange = function handleChange() {\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(_handleChange);\n\n  \t\tthis.clearUnresolveds();\n  \t};\n\n  \tExpressionProxy.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ComputationChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tExpressionProxy.prototype.mark = function mark() {\n  \t\tthis.handleChange();\n  \t};\n\n  \tExpressionProxy.prototype.retrieve = function retrieve() {\n  \t\treturn this.get();\n  \t};\n\n  \tExpressionProxy.prototype.teardown = function teardown() {\n  \t\tthis.unbind();\n  \t\tthis.fragment = undefined;\n  \t\tif (this.computation) {\n  \t\t\tthis.computation.teardown();\n  \t\t}\n  \t\tthis.computation = undefined;\n  \t\t_Model.prototype.teardown.call(this);\n  \t};\n\n  \tExpressionProxy.prototype.unregister = function unregister(dep) {\n  \t\t_Model.prototype.unregister.call(this, dep);\n  \t\tif (!this.deps.length) this.teardown();\n  \t};\n\n  \tExpressionProxy.prototype.unbind = function unbind() {\n  \t\tthis.resolvers.forEach(_unbind);\n\n  \t\tvar i = this.models.length;\n  \t\twhile (i--) {\n  \t\t\tif (this.models[i]) this.models[i].unregister(this);\n  \t\t}\n  \t};\n\n  \treturn ExpressionProxy;\n  }(Model);\n\n  var ReferenceExpressionChild = function (_Model) {\n  \tbabelHelpers.inherits(ReferenceExpressionChild, _Model);\n\n  \tfunction ReferenceExpressionChild(parent, key) {\n  \t\tbabelHelpers.classCallCheck(this, ReferenceExpressionChild);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Model.call(this, parent, key));\n  \t}\n\n  \tReferenceExpressionChild.prototype.applyValue = function applyValue(value) {\n  \t\tif (isEqual(value, this.value)) return;\n\n  \t\tvar parent = this.parent,\n  \t\t    keys = [this.key];\n  \t\twhile (parent) {\n  \t\t\tif (parent.base) {\n  \t\t\t\tvar target = parent.model.joinAll(keys);\n  \t\t\t\ttarget.applyValue(value);\n  \t\t\t\tbreak;\n  \t\t\t}\n\n  \t\t\tkeys.unshift(parent.key);\n\n  \t\t\tparent = parent.parent;\n  \t\t}\n  \t};\n\n  \tReferenceExpressionChild.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ReferenceExpressionChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \treturn ReferenceExpressionChild;\n  }(Model);\n\n  var ReferenceExpressionProxy = function (_Model2) {\n  \tbabelHelpers.inherits(ReferenceExpressionProxy, _Model2);\n\n  \tfunction ReferenceExpressionProxy(fragment, template) {\n  \t\tbabelHelpers.classCallCheck(this, ReferenceExpressionProxy);\n\n  \t\tvar _this2 = babelHelpers.possibleConstructorReturn(this, _Model2.call(this, null, null));\n\n  \t\t_this2.root = fragment.ractive.viewmodel;\n\n  \t\t_this2.resolvers = [];\n\n  \t\t_this2.base = resolve$1(fragment, template);\n  \t\tvar baseResolver = void 0;\n\n  \t\tif (!_this2.base) {\n  \t\t\tbaseResolver = fragment.resolve(template.r, function (model) {\n  \t\t\t\t_this2.base = model;\n  \t\t\t\t_this2.bubble();\n\n  \t\t\t\tremoveFromArray(_this2.resolvers, baseResolver);\n  \t\t\t});\n\n  \t\t\t_this2.resolvers.push(baseResolver);\n  \t\t}\n\n  \t\tvar intermediary = {\n  \t\t\thandleChange: function handleChange() {\n  \t\t\t\treturn _this2.bubble();\n  \t\t\t}\n  \t\t};\n\n  \t\t_this2.members = template.m.map(function (template, i) {\n  \t\t\tif (typeof template === 'string') {\n  \t\t\t\treturn { get: function get() {\n  \t\t\t\t\t\treturn template;\n  \t\t\t\t\t} };\n  \t\t\t}\n\n  \t\t\tvar model = void 0;\n  \t\t\tvar resolver = void 0;\n\n  \t\t\tif (template.t === REFERENCE) {\n  \t\t\t\tmodel = resolveReference(fragment, template.n);\n\n  \t\t\t\tif (model) {\n  \t\t\t\t\tmodel.register(intermediary);\n  \t\t\t\t} else {\n  \t\t\t\t\tresolver = fragment.resolve(template.n, function (model) {\n  \t\t\t\t\t\t_this2.members[i] = model;\n\n  \t\t\t\t\t\tmodel.register(intermediary);\n  \t\t\t\t\t\t_this2.bubble();\n\n  \t\t\t\t\t\tremoveFromArray(_this2.resolvers, resolver);\n  \t\t\t\t\t});\n\n  \t\t\t\t\t_this2.resolvers.push(resolver);\n  \t\t\t\t}\n\n  \t\t\t\treturn model;\n  \t\t\t}\n\n  \t\t\tmodel = new ExpressionProxy(fragment, template);\n  \t\t\tmodel.register(intermediary);\n  \t\t\treturn model;\n  \t\t});\n\n  \t\t_this2.isUnresolved = true;\n  \t\t_this2.bubble();\n  \t\treturn _this2;\n  \t}\n\n  \tReferenceExpressionProxy.prototype.bubble = function bubble() {\n  \t\tif (!this.base) return;\n\n  \t\t// if some members are not resolved, abort\n  \t\tvar i = this.members.length;\n  \t\twhile (i--) {\n  \t\t\tif (!this.members[i]) return;\n  \t\t}\n\n  \t\tthis.isUnresolved = false;\n\n  \t\tvar keys = this.members.map(function (model) {\n  \t\t\treturn escapeKey(String(model.get()));\n  \t\t});\n  \t\tvar model = this.base.joinAll(keys);\n\n  \t\tif (this.model) {\n  \t\t\tthis.model.unregister(this);\n  \t\t\tthis.model.unregisterTwowayBinding(this);\n  \t\t}\n\n  \t\tthis.model = model;\n  \t\tthis.parent = model.parent;\n\n  \t\tmodel.register(this);\n  \t\tmodel.registerTwowayBinding(this);\n\n  \t\tif (this.keypathModel) this.keypathModel.handleChange();\n\n  \t\tthis.mark();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.forceResolution = function forceResolution() {\n  \t\tthis.resolvers.forEach(function (resolver) {\n  \t\t\treturn resolver.forceResolution();\n  \t\t});\n  \t\tthis.bubble();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.get = function get() {\n  \t\treturn this.model ? this.model.get() : undefined;\n  \t};\n\n  \t// indirect two-way bindings\n\n\n  \tReferenceExpressionProxy.prototype.getValue = function getValue() {\n  \t\tvar i = this.bindings.length;\n  \t\twhile (i--) {\n  \t\t\tvar value = this.bindings[i].getValue();\n  \t\t\tif (value !== this.value) return value;\n  \t\t}\n\n  \t\treturn this.value;\n  \t};\n\n  \tReferenceExpressionProxy.prototype.getKeypath = function getKeypath() {\n  \t\treturn this.model ? this.model.getKeypath() : '@undefined';\n  \t};\n\n  \tReferenceExpressionProxy.prototype.handleChange = function handleChange() {\n  \t\tthis.mark();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ReferenceExpressionChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tReferenceExpressionProxy.prototype.retrieve = function retrieve() {\n  \t\treturn this.get();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.set = function set(value) {\n  \t\tif (!this.model) throw new Error('Unresolved reference expression. This should not happen!');\n  \t\tthis.model.set(value);\n  \t};\n\n  \tReferenceExpressionProxy.prototype.unbind = function unbind() {\n  \t\tthis.resolvers.forEach(_unbind);\n  \t};\n\n  \treturn ReferenceExpressionProxy;\n  }(Model);\n\n  function resolve$1(fragment, template) {\n  \tif (template.r) {\n  \t\treturn resolveReference(fragment, template.r);\n  \t} else if (template.x) {\n  \t\treturn new ExpressionProxy(fragment, template.x);\n  \t} else {\n  \t\treturn new ReferenceExpressionProxy(fragment, template.rx);\n  \t}\n  }\n\n  function resolveAliases(section) {\n  \tif (section.template.z) {\n  \t\tsection.aliases = {};\n\n  \t\tvar refs = section.template.z;\n  \t\tfor (var i = 0; i < refs.length; i++) {\n  \t\t\tsection.aliases[refs[i].n] = resolve$1(section.parentFragment, refs[i].x);\n  \t\t}\n  \t}\n  }\n\n  var Alias = function (_Item) {\n  \tbabelHelpers.inherits(Alias, _Item);\n\n  \tfunction Alias(options) {\n  \t\tbabelHelpers.classCallCheck(this, Alias);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.fragment = null;\n  \t\treturn _this;\n  \t}\n\n  \tAlias.prototype.bind = function bind() {\n  \t\tresolveAliases(this);\n\n  \t\tthis.fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\ttemplate: this.template.f\n  \t\t}).bind();\n  \t};\n\n  \tAlias.prototype.detach = function detach() {\n  \t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n  \t};\n\n  \tAlias.prototype.find = function find(selector) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.find(selector);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.findAll = function findAll(selector, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.findComponent = function findComponent(name) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment && this.fragment.firstNode(skipParent);\n  \t};\n\n  \tAlias.prototype.rebind = function rebind() {\n  \t\tresolveAliases(this);\n  \t\tif (this.fragment) this.fragment.rebind();\n  \t};\n\n  \tAlias.prototype.render = function render(target) {\n  \t\tthis.rendered = true;\n  \t\tif (this.fragment) this.fragment.render(target);\n  \t};\n\n  \tAlias.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment ? this.fragment.toString(escape) : '';\n  \t};\n\n  \tAlias.prototype.unbind = function unbind() {\n  \t\tthis.aliases = {};\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tAlias.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n  \t\tthis.rendered = false;\n  \t};\n\n  \tAlias.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tthis.fragment.update();\n  \t\t}\n  \t};\n\n  \treturn Alias;\n  }(Item);\n\n  function processWrapper (wrapper, array, methodName, newIndices) {\n  \tvar __model = wrapper.__model;\n\n\n  \tif (newIndices) {\n  \t\t__model.shuffle(newIndices);\n  \t} else {\n  \t\t// If this is a sort or reverse, we just do root.set()...\n  \t\t// TODO use merge logic?\n  \t\t//root.viewmodel.mark( keypath );\n  \t}\n  }\n\n  var mutatorMethods = ['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'];\n  var patchedArrayProto = [];\n\n  mutatorMethods.forEach(function (methodName) {\n  \tvar method = function method() {\n  \t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n  \t\t\targs[_key] = arguments[_key];\n  \t\t}\n\n  \t\tvar newIndices = getNewIndices(this.length, methodName, args);\n\n  \t\t// apply the underlying method\n  \t\tvar result = Array.prototype[methodName].apply(this, arguments);\n\n  \t\t// trigger changes\n  \t\trunloop.start();\n\n  \t\tthis._ractive.setting = true;\n  \t\tvar i = this._ractive.wrappers.length;\n  \t\twhile (i--) {\n  \t\t\tprocessWrapper(this._ractive.wrappers[i], this, methodName, newIndices);\n  \t\t}\n\n  \t\trunloop.end();\n\n  \t\tthis._ractive.setting = false;\n  \t\treturn result;\n  \t};\n\n  \tdefineProperty(patchedArrayProto, methodName, {\n  \t\tvalue: method\n  \t});\n  });\n\n  var patchArrayMethods = void 0;\n  var unpatchArrayMethods = void 0;\n\n  // can we use prototype chain injection?\n  // http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\n  if ({}.__proto__) {\n  \t// yes, we can\n  \tpatchArrayMethods = function patchArrayMethods(array) {\n  \t\treturn array.__proto__ = patchedArrayProto;\n  \t};\n  \tunpatchArrayMethods = function unpatchArrayMethods(array) {\n  \t\treturn array.__proto__ = Array.prototype;\n  \t};\n  } else {\n  \t// no, we can't\n  \tpatchArrayMethods = function patchArrayMethods(array) {\n  \t\tvar i = mutatorMethods.length;\n  \t\twhile (i--) {\n  \t\t\tvar methodName = mutatorMethods[i];\n  \t\t\tdefineProperty(array, methodName, {\n  \t\t\t\tvalue: patchedArrayProto[methodName],\n  \t\t\t\tconfigurable: true\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tunpatchArrayMethods = function unpatchArrayMethods(array) {\n  \t\tvar i = mutatorMethods.length;\n  \t\twhile (i--) {\n  \t\t\tdelete array[mutatorMethods[i]];\n  \t\t}\n  \t};\n  }\n\n  patchArrayMethods.unpatch = unpatchArrayMethods; // TODO export separately?\n  var patch = patchArrayMethods;\n\n  var errorMessage$1 = 'Something went wrong in a rather interesting way';\n\n  var arrayAdaptor = {\n  \tfilter: function filter(object) {\n  \t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n  \t\t// or the array didn't trigger the get() itself\n  \t\treturn isArray(object) && (!object._ractive || !object._ractive.setting);\n  \t},\n  \twrap: function wrap(ractive, array, keypath) {\n  \t\treturn new ArrayWrapper(ractive, array, keypath);\n  \t}\n  };\n\n  var ArrayWrapper = function () {\n  \tfunction ArrayWrapper(ractive, array) {\n  \t\tbabelHelpers.classCallCheck(this, ArrayWrapper);\n\n  \t\tthis.root = ractive;\n  \t\tthis.value = array;\n  \t\tthis.__model = null; // filled in later\n\n  \t\t// if this array hasn't already been ractified, ractify it\n  \t\tif (!array._ractive) {\n  \t\t\t// define a non-enumerable _ractive property to store the wrappers\n  \t\t\tdefineProperty(array, '_ractive', {\n  \t\t\t\tvalue: {\n  \t\t\t\t\twrappers: [],\n  \t\t\t\t\tinstances: [],\n  \t\t\t\t\tsetting: false\n  \t\t\t\t},\n  \t\t\t\tconfigurable: true\n  \t\t\t});\n\n  \t\t\tpatch(array);\n  \t\t}\n\n  \t\t// store the ractive instance, so we can handle transitions later\n  \t\tif (!array._ractive.instances[ractive._guid]) {\n  \t\t\tarray._ractive.instances[ractive._guid] = 0;\n  \t\t\tarray._ractive.instances.push(ractive);\n  \t\t}\n\n  \t\tarray._ractive.instances[ractive._guid] += 1;\n  \t\tarray._ractive.wrappers.push(this);\n  \t}\n\n  \tArrayWrapper.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tArrayWrapper.prototype.teardown = function teardown() {\n  \t\tvar array, storage, wrappers, instances, index;\n\n  \t\tarray = this.value;\n  \t\tstorage = array._ractive;\n  \t\twrappers = storage.wrappers;\n  \t\tinstances = storage.instances;\n\n  \t\t// if teardown() was invoked because we're clearing the cache as a result of\n  \t\t// a change that the array itself triggered, we can save ourselves the teardown\n  \t\t// and immediate setup\n  \t\tif (storage.setting) {\n  \t\t\treturn false; // so that we don't remove it from cached wrappers\n  \t\t}\n\n  \t\tindex = wrappers.indexOf(this);\n  \t\tif (index === -1) {\n  \t\t\tthrow new Error(errorMessage$1);\n  \t\t}\n\n  \t\twrappers.splice(index, 1);\n\n  \t\t// if nothing else depends on this array, we can revert it to its\n  \t\t// natural state\n  \t\tif (!wrappers.length) {\n  \t\t\tdelete array._ractive;\n  \t\t\tpatch.unpatch(this.value);\n  \t\t} else {\n  \t\t\t// remove ractive instance if possible\n  \t\t\tinstances[this.root._guid] -= 1;\n  \t\t\tif (!instances[this.root._guid]) {\n  \t\t\t\tindex = instances.indexOf(this.root);\n\n  \t\t\t\tif (index === -1) {\n  \t\t\t\t\tthrow new Error(errorMessage$1);\n  \t\t\t\t}\n\n  \t\t\t\tinstances.splice(index, 1);\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \treturn ArrayWrapper;\n  }();\n\n  var magicAdaptor = void 0;\n\n  try {\n  \tObject.defineProperty({}, 'test', {\n  \t\tget: function get() {},\n  \t\tset: function set() {}\n  \t});\n\n  \tmagicAdaptor = {\n  \t\tfilter: function filter(value) {\n  \t\t\treturn value && (typeof value === 'undefined' ? 'undefined' : babelHelpers.typeof(value)) === 'object';\n  \t\t},\n  \t\twrap: function wrap(ractive, value, keypath) {\n  \t\t\treturn new MagicWrapper(ractive, value, keypath);\n  \t\t}\n  \t};\n  } catch (err) {\n  \tmagicAdaptor = false;\n  }\n\n  var magicAdaptor$1 = magicAdaptor;\n\n  function createOrWrapDescriptor(originalDescriptor, ractive, keypath) {\n  \tif (originalDescriptor.set && originalDescriptor.set.__magic) {\n  \t\toriginalDescriptor.set.__magic.dependants.push({ ractive: ractive, keypath: keypath });\n  \t\treturn originalDescriptor;\n  \t}\n\n  \tvar setting = void 0;\n\n  \tvar dependants = [{ ractive: ractive, keypath: keypath }];\n\n  \tvar descriptor = {\n  \t\tget: function get() {\n  \t\t\treturn 'value' in originalDescriptor ? originalDescriptor.value : originalDescriptor.get();\n  \t\t},\n  \t\tset: function set(value) {\n  \t\t\tif (setting) return;\n\n  \t\t\tif ('value' in originalDescriptor) {\n  \t\t\t\toriginalDescriptor.value = value;\n  \t\t\t} else {\n  \t\t\t\toriginalDescriptor.set(value);\n  \t\t\t}\n\n  \t\t\tsetting = true;\n  \t\t\tdependants.forEach(function (_ref) {\n  \t\t\t\tvar ractive = _ref.ractive;\n  \t\t\t\tvar keypath = _ref.keypath;\n\n  \t\t\t\tractive.set(keypath, value);\n  \t\t\t});\n  \t\t\tsetting = false;\n  \t\t},\n  \t\tenumerable: true\n  \t};\n\n  \tdescriptor.set.__magic = { dependants: dependants, originalDescriptor: originalDescriptor };\n\n  \treturn descriptor;\n  }\n\n  function revert(descriptor, ractive, keypath) {\n  \tif (!descriptor.set || !descriptor.set.__magic) return true;\n\n  \tvar dependants = descriptor.set.__magic;\n  \tvar i = dependants.length;\n  \twhile (i--) {\n  \t\tvar dependant = dependants[i];\n  \t\tif (dependant.ractive === ractive && dependant.keypath === keypath) {\n  \t\t\tdependants.splice(i, 1);\n  \t\t\treturn false;\n  \t\t}\n  \t}\n  }\n\n  var MagicWrapper = function () {\n  \tfunction MagicWrapper(ractive, value, keypath) {\n  \t\tvar _this = this;\n\n  \t\tbabelHelpers.classCallCheck(this, MagicWrapper);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.value = value;\n  \t\tthis.keypath = keypath;\n\n  \t\tthis.originalDescriptors = {};\n\n  \t\t// wrap all properties with getters\n  \t\tObject.keys(value).forEach(function (key) {\n  \t\t\tvar originalDescriptor = Object.getOwnPropertyDescriptor(_this.value, key);\n  \t\t\t_this.originalDescriptors[key] = originalDescriptor;\n\n  \t\t\tvar childKeypath = keypath ? keypath + '.' + escapeKey(key) : escapeKey(key);\n\n  \t\t\tvar descriptor = createOrWrapDescriptor(originalDescriptor, ractive, childKeypath);\n\n  \t\t\tObject.defineProperty(_this.value, key, descriptor);\n  \t\t});\n  \t}\n\n  \tMagicWrapper.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tMagicWrapper.prototype.reset = function reset() {\n  \t\tthrow new Error('TODO magic adaptor reset'); // does this ever happen?\n  \t};\n\n  \tMagicWrapper.prototype.set = function set(key, value) {\n  \t\tthis.value[key] = value;\n  \t};\n\n  \tMagicWrapper.prototype.teardown = function teardown() {\n  \t\tvar _this2 = this;\n\n  \t\tObject.keys(this.value).forEach(function (key) {\n  \t\t\tvar descriptor = Object.getOwnPropertyDescriptor(_this2.value, key);\n  \t\t\tif (!descriptor.set || !descriptor.set.__magic) return;\n\n  \t\t\trevert(descriptor);\n\n  \t\t\tif (descriptor.set.__magic.dependants.length === 1) {\n  \t\t\t\tObject.defineProperty(_this2.value, key, descriptor.set.__magic.originalDescriptor);\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \treturn MagicWrapper;\n  }();\n\n  var MagicArrayWrapper = function () {\n  \tfunction MagicArrayWrapper(ractive, array, keypath) {\n  \t\tbabelHelpers.classCallCheck(this, MagicArrayWrapper);\n\n  \t\tthis.value = array;\n\n  \t\tthis.magic = true;\n\n  \t\tthis.magicWrapper = magicAdaptor$1.wrap(ractive, array, keypath);\n  \t\tthis.arrayWrapper = arrayAdaptor.wrap(ractive, array, keypath);\n\n  \t\t// ugh, this really is a terrible hack\n  \t\tObject.defineProperty(this, '__model', {\n  \t\t\tget: function get() {\n  \t\t\t\treturn this.arrayWrapper.__model;\n  \t\t\t},\n  \t\t\tset: function set(model) {\n  \t\t\t\tthis.arrayWrapper.__model = model;\n  \t\t\t}\n  \t\t});\n  \t}\n\n  \tMagicArrayWrapper.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tMagicArrayWrapper.prototype.teardown = function teardown() {\n  \t\tthis.arrayWrapper.teardown();\n  \t\tthis.magicWrapper.teardown();\n  \t};\n\n  \tMagicArrayWrapper.prototype.reset = function reset(value) {\n  \t\treturn this.magicWrapper.reset(value);\n  \t};\n\n  \treturn MagicArrayWrapper;\n  }();\n\n  var magicArrayAdaptor = {\n  \tfilter: function filter(object, keypath, ractive) {\n  \t\treturn magicAdaptor$1.filter(object, keypath, ractive) && arrayAdaptor.filter(object);\n  \t},\n  \twrap: function wrap(ractive, array, keypath) {\n  \t\treturn new MagicArrayWrapper(ractive, array, keypath);\n  \t}\n  };\n\n  // TODO this is probably a bit anal, maybe we should leave it out\n  function prettify(fnBody) {\n  \tvar lines = fnBody.replace(/^\\t+/gm, function (tabs) {\n  \t\treturn tabs.split('\\t').join('  ');\n  \t}).split('\\n');\n\n  \tvar minIndent = lines.length < 2 ? 0 : lines.slice(1).reduce(function (prev, line) {\n  \t\treturn Math.min(prev, /^\\s*/.exec(line)[0].length);\n  \t}, Infinity);\n\n  \treturn lines.map(function (line, i) {\n  \t\treturn '    ' + (i ? line.substring(minIndent) : line);\n  \t}).join('\\n');\n  }\n\n  // Ditto. This function truncates the stack to only include app code\n  function truncateStack(stack) {\n  \tif (!stack) return '';\n\n  \tvar lines = stack.split('\\n');\n  \tvar name = Computation.name + '.getValue';\n\n  \tvar truncated = [];\n\n  \tvar len = lines.length;\n  \tfor (var i = 1; i < len; i += 1) {\n  \t\tvar line = lines[i];\n\n  \t\tif (~line.indexOf(name)) {\n  \t\t\treturn truncated.join('\\n');\n  \t\t} else {\n  \t\t\ttruncated.push(line);\n  \t\t}\n  \t}\n  }\n\n  var Computation = function (_Model) {\n  \tbabelHelpers.inherits(Computation, _Model);\n\n  \tfunction Computation(viewmodel, signature, key) {\n  \t\tbabelHelpers.classCallCheck(this, Computation);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, null));\n\n  \t\t_this.root = _this.parent = viewmodel;\n  \t\t_this.signature = signature;\n\n  \t\t_this.key = key; // not actually used, but helps with debugging\n  \t\t_this.isExpression = key && key[0] === '@';\n\n  \t\t_this.isReadonly = !_this.signature.setter;\n\n  \t\t_this.context = viewmodel.computationContext;\n\n  \t\t_this.dependencies = [];\n\n  \t\t_this.children = [];\n  \t\t_this.childByKey = {};\n\n  \t\t_this.deps = [];\n\n  \t\t_this.boundsSensitive = true;\n  \t\t_this.dirty = true;\n\n  \t\t// TODO: is there a less hackish way to do this?\n  \t\t_this.shuffle = undefined;\n  \t\treturn _this;\n  \t}\n\n  \tComputation.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tthis.value = this.getValue();\n  \t\t\tthis.adapt();\n  \t\t}\n\n  \t\treturn this.value;\n  \t};\n\n  \tComputation.prototype.getValue = function getValue() {\n  \t\tstartCapturing();\n  \t\tvar result = void 0;\n\n  \t\ttry {\n  \t\t\tresult = this.signature.getter.call(this.context);\n  \t\t} catch (err) {\n  \t\t\twarnIfDebug('Failed to compute ' + this.getKeypath() + ': ' + (err.message || err));\n\n  \t\t\t// TODO this is all well and good in Chrome, but...\n  \t\t\t// ...also, should encapsulate this stuff better, and only\n  \t\t\t// show it if Ractive.DEBUG\n  \t\t\tif (hasConsole) {\n  \t\t\t\tif (console.groupCollapsed) console.groupCollapsed('%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;');\n  \t\t\t\tvar functionBody = prettify(this.signature.getterString);\n  \t\t\t\tvar stack = this.signature.getterUseStack ? '\\n\\n' + truncateStack(err.stack) : '';\n  \t\t\t\tconsole.error(err.name + ': ' + err.message + '\\n\\n' + functionBody + stack);\n  \t\t\t\tif (console.groupCollapsed) console.groupEnd();\n  \t\t\t}\n  \t\t}\n\n  \t\tvar dependencies = stopCapturing();\n  \t\tthis.setDependencies(dependencies);\n\n  \t\treturn result;\n  \t};\n\n  \tComputation.prototype.handleChange = function handleChange() {\n  \t\tthis.dirty = true;\n\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(_handleChange);\n  \t\tthis.clearUnresolveds(); // TODO same question as on Model - necessary for primitives?\n  \t};\n\n  \tComputation.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ComputationChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tComputation.prototype.mark = function mark() {\n  \t\tthis.handleChange();\n  \t};\n\n  \tComputation.prototype.set = function set(value) {\n  \t\tif (!this.signature.setter) {\n  \t\t\tthrow new Error('Cannot set read-only computed value \\'' + this.key + '\\'');\n  \t\t}\n\n  \t\tthis.signature.setter(value);\n  \t};\n\n  \tComputation.prototype.setDependencies = function setDependencies(dependencies) {\n  \t\t// unregister any soft dependencies we no longer have\n  \t\tvar i = this.dependencies.length;\n  \t\twhile (i--) {\n  \t\t\tvar model = this.dependencies[i];\n  \t\t\tif (! ~dependencies.indexOf(model)) model.unregister(this);\n  \t\t}\n\n  \t\t// and add any new ones\n  \t\ti = dependencies.length;\n  \t\twhile (i--) {\n  \t\t\tvar _model = dependencies[i];\n  \t\t\tif (! ~this.dependencies.indexOf(_model)) _model.register(this);\n  \t\t}\n\n  \t\tthis.dependencies = dependencies;\n  \t};\n\n  \tComputation.prototype.teardown = function teardown() {\n  \t\tvar i = this.dependencies.length;\n  \t\twhile (i--) {\n  \t\t\tif (this.dependencies[i]) this.dependencies[i].unregister(this);\n  \t\t}\n  \t\tif (this.root.computations[this.key] === this) delete this.root.computations[this.key];\n  \t\t_Model.prototype.teardown.call(this);\n  \t};\n\n  \treturn Computation;\n  }(Model);\n\n  var RactiveModel = function (_Model) {\n  \tbabelHelpers.inherits(RactiveModel, _Model);\n\n  \tfunction RactiveModel(ractive) {\n  \t\tbabelHelpers.classCallCheck(this, RactiveModel);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, ''));\n\n  \t\t_this.value = ractive;\n  \t\t_this.isRoot = true;\n  \t\t_this.root = _this;\n  \t\t_this.adaptors = [];\n  \t\t_this.ractive = ractive;\n  \t\t_this.changes = {};\n  \t\treturn _this;\n  \t}\n\n  \tRactiveModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn '@ractive';\n  \t};\n\n  \treturn RactiveModel;\n  }(Model);\n\n  var hasProp$1 = Object.prototype.hasOwnProperty;\n\n  var RootModel = function (_Model) {\n  \tbabelHelpers.inherits(RootModel, _Model);\n\n  \tfunction RootModel(options) {\n  \t\tbabelHelpers.classCallCheck(this, RootModel);\n\n\n  \t\t// TODO deprecate this\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, null));\n\n  \t\t_this.changes = {};\n\n  \t\t_this.isRoot = true;\n  \t\t_this.root = _this;\n  \t\t_this.ractive = options.ractive; // TODO sever this link\n\n  \t\t_this.value = options.data;\n  \t\t_this.adaptors = options.adapt;\n  \t\t_this.adapt();\n\n  \t\t_this.mappings = {};\n\n  \t\t_this.computationContext = options.ractive;\n  \t\t_this.computations = {};\n  \t\treturn _this;\n  \t}\n\n  \tRootModel.prototype.applyChanges = function applyChanges() {\n  \t\tthis._changeHash = {};\n  \t\tthis.flush();\n\n  \t\treturn this._changeHash;\n  \t};\n\n  \tRootModel.prototype.compute = function compute(key, signature) {\n  \t\tvar computation = new Computation(this, signature, key);\n  \t\tthis.computations[key] = computation;\n\n  \t\treturn computation;\n  \t};\n\n  \tRootModel.prototype.extendChildren = function extendChildren(fn) {\n  \t\tvar mappings = this.mappings;\n  \t\tObject.keys(mappings).forEach(function (key) {\n  \t\t\tfn(key, mappings[key]);\n  \t\t});\n\n  \t\tvar computations = this.computations;\n  \t\tObject.keys(computations).forEach(function (key) {\n  \t\t\tvar computation = computations[key];\n  \t\t\t// exclude template expressions\n  \t\t\tif (!computation.isExpression) {\n  \t\t\t\tfn(key, computation);\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \tRootModel.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n  \t\tvar result = extendObj({}, this.value);\n\n  \t\tthis.extendChildren(function (key, model) {\n  \t\t\tresult[key] = model.value;\n  \t\t});\n\n  \t\treturn result;\n  \t};\n\n  \tRootModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn '';\n  \t};\n\n  \tRootModel.prototype.getRactiveModel = function getRactiveModel() {\n  \t\treturn this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  \t};\n\n  \tRootModel.prototype.getValueChildren = function getValueChildren() {\n  \t\tvar children = _Model.prototype.getValueChildren.call(this, this.value);\n\n  \t\tthis.extendChildren(function (key, model) {\n  \t\t\tchildren.push(model);\n  \t\t});\n\n  \t\treturn children;\n  \t};\n\n  \tRootModel.prototype.handleChange = function handleChange() {\n  \t\tthis.deps.forEach(_handleChange);\n  \t};\n\n  \tRootModel.prototype.has = function has(key) {\n  \t\tif (key in this.mappings || key in this.computations) return true;\n\n  \t\tvar value = this.value;\n\n  \t\tkey = unescapeKey(key);\n  \t\tif (hasProp$1.call(value, key)) return true;\n\n  \t\t// We climb up the constructor chain to find if one of them contains the key\n  \t\tvar constructor = value.constructor;\n  \t\twhile (constructor !== Function && constructor !== Array && constructor !== Object) {\n  \t\t\tif (hasProp$1.call(constructor.prototype, key)) return true;\n  \t\t\tconstructor = constructor.constructor;\n  \t\t}\n\n  \t\treturn false;\n  \t};\n\n  \tRootModel.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === '@global') return GlobalModel$1;\n  \t\tif (key === '@ractive') return this.getRactiveModel();\n\n  \t\treturn this.mappings.hasOwnProperty(key) ? this.mappings[key] : this.computations.hasOwnProperty(key) ? this.computations[key] : _Model.prototype.joinKey.call(this, key);\n  \t};\n\n  \tRootModel.prototype.map = function map(localKey, origin) {\n  \t\t// TODO remapping\n  \t\tthis.mappings[localKey] = origin;\n  \t\torigin.register(this);\n  \t};\n\n  \tRootModel.prototype.set = function set(value) {\n  \t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n  \t\tvar wrapper = this.wrapper;\n  \t\tif (wrapper) {\n  \t\t\tvar shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n  \t\t\tif (shouldTeardown) {\n  \t\t\t\twrapper.teardown();\n  \t\t\t\tthis.wrapper = null;\n  \t\t\t\tthis.value = value;\n  \t\t\t\tthis.adapt();\n  \t\t\t}\n  \t\t} else {\n  \t\t\tthis.value = value;\n  \t\t\tthis.adapt();\n  \t\t}\n\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(mark);\n  \t\tthis.clearUnresolveds(); // TODO do we need to do this with primitive values? if not, what about e.g. unresolved `length` property of null -> string?\n  \t};\n\n  \tRootModel.prototype.retrieve = function retrieve() {\n  \t\treturn this.value;\n  \t};\n\n  \tRootModel.prototype.teardown = function teardown() {\n  \t\tvar keys = Object.keys(this.mappings);\n  \t\tvar i = keys.length;\n  \t\twhile (i--) {\n  \t\t\tif (this.mappings[keys[i]]) this.mappings[keys[i]].unregister(this);\n  \t\t}\n\n  \t\t_Model.prototype.teardown.call(this);\n  \t};\n\n  \tRootModel.prototype.update = function update() {\n  \t\t// noop\n  \t};\n\n  \tRootModel.prototype.updateFromBindings = function updateFromBindings(cascade) {\n  \t\tvar _this2 = this;\n\n  \t\t_Model.prototype.updateFromBindings.call(this, cascade);\n\n  \t\tif (cascade) {\n  \t\t\t// TODO computations as well?\n  \t\t\tObject.keys(this.mappings).forEach(function (key) {\n  \t\t\t\tvar model = _this2.mappings[key];\n  \t\t\t\tmodel.updateFromBindings(cascade);\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \treturn RootModel;\n  }(Model);\n\n  function getComputationSignature(ractive, key, signature) {\n  \tvar getter = void 0;\n  \tvar setter = void 0;\n\n  \t// useful for debugging\n  \tvar getterString = void 0;\n  \tvar getterUseStack = void 0;\n  \tvar setterString = void 0;\n\n  \tif (typeof signature === 'function') {\n  \t\tgetter = bind(signature, ractive);\n  \t\tgetterString = signature.toString();\n  \t\tgetterUseStack = true;\n  \t}\n\n  \tif (typeof signature === 'string') {\n  \t\tgetter = createFunctionFromString(signature, ractive);\n  \t\tgetterString = signature;\n  \t}\n\n  \tif ((typeof signature === 'undefined' ? 'undefined' : babelHelpers.typeof(signature)) === 'object') {\n  \t\tif (typeof signature.get === 'string') {\n  \t\t\tgetter = createFunctionFromString(signature.get, ractive);\n  \t\t\tgetterString = signature.get;\n  \t\t} else if (typeof signature.get === 'function') {\n  \t\t\tgetter = bind(signature.get, ractive);\n  \t\t\tgetterString = signature.get.toString();\n  \t\t\tgetterUseStack = true;\n  \t\t} else {\n  \t\t\tfatal('`%s` computation must have a `get()` method', key);\n  \t\t}\n\n  \t\tif (typeof signature.set === 'function') {\n  \t\t\tsetter = bind(signature.set, ractive);\n  \t\t\tsetterString = signature.set.toString();\n  \t\t}\n  \t}\n\n  \treturn {\n  \t\tgetter: getter,\n  \t\tsetter: setter,\n  \t\tgetterString: getterString,\n  \t\tsetterString: setterString,\n  \t\tgetterUseStack: getterUseStack\n  \t};\n  }\n\n  var constructHook = new Hook('construct');\n\n  var registryNames$1 = ['adaptors', 'components', 'decorators', 'easing', 'events', 'interpolators', 'partials', 'transitions'];\n\n  var uid = 0;\n\n  function construct(ractive, options) {\n  \tif (Ractive.DEBUG) welcome();\n\n  \tinitialiseProperties(ractive);\n\n  \t// TODO remove this, eventually\n  \tdefineProperty(ractive, 'data', { get: deprecateRactiveData });\n\n  \t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  \tconstructHook.fire(ractive, options);\n\n  \t// Add registries\n  \tregistryNames$1.forEach(function (name) {\n  \t\tractive[name] = extendObj(create(ractive.constructor[name] || null), options[name]);\n  \t});\n\n  \t// Create a viewmodel\n  \tvar viewmodel = new RootModel({\n  \t\tadapt: getAdaptors(ractive, ractive.adapt, options),\n  \t\tdata: dataConfigurator.init(ractive.constructor, ractive, options),\n  \t\tractive: ractive\n  \t});\n\n  \tractive.viewmodel = viewmodel;\n\n  \t// Add computed properties\n  \tvar computed = extendObj(create(ractive.constructor.prototype.computed), options.computed);\n\n  \tfor (var key in computed) {\n  \t\tvar signature = getComputationSignature(ractive, key, computed[key]);\n  \t\tviewmodel.compute(key, signature);\n  \t}\n  }\n\n  function combine$2(a, b) {\n  \tvar c = a.slice();\n  \tvar i = b.length;\n\n  \twhile (i--) {\n  \t\tif (! ~c.indexOf(b[i])) {\n  \t\t\tc.push(b[i]);\n  \t\t}\n  \t}\n\n  \treturn c;\n  }\n\n  function getAdaptors(ractive, protoAdapt, options) {\n  \tprotoAdapt = protoAdapt.map(lookup);\n  \tvar adapt = ensureArray(options.adapt).map(lookup);\n\n  \tadapt = combine$2(protoAdapt, adapt);\n\n  \tvar magic = 'magic' in options ? options.magic : ractive.magic;\n  \tvar modifyArrays = 'modifyArrays' in options ? options.modifyArrays : ractive.modifyArrays;\n\n  \tif (magic) {\n  \t\tif (!magicSupported) {\n  \t\t\tthrow new Error('Getters and setters (magic mode) are not supported in this browser');\n  \t\t}\n\n  \t\tif (modifyArrays) {\n  \t\t\tadapt.push(magicArrayAdaptor);\n  \t\t}\n\n  \t\tadapt.push(magicAdaptor$1);\n  \t}\n\n  \tif (modifyArrays) {\n  \t\tadapt.push(arrayAdaptor);\n  \t}\n\n  \treturn adapt;\n\n  \tfunction lookup(adaptor) {\n  \t\tif (typeof adaptor === 'string') {\n  \t\t\tadaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n  \t\t\tif (!adaptor) {\n  \t\t\t\tfatal(missingPlugin(adaptor, 'adaptor'));\n  \t\t\t}\n  \t\t}\n\n  \t\treturn adaptor;\n  \t}\n  }\n\n  function initialiseProperties(ractive) {\n  \t// Generate a unique identifier, for places where you'd use a weak map if it\n  \t// existed\n  \tractive._guid = 'r-' + uid++;\n\n  \t// events\n  \tractive._subs = create(null);\n\n  \t// storage for item configuration from instantiation to reset,\n  \t// like dynamic functions or original values\n  \tractive._config = {};\n\n  \t// nodes registry\n  \tractive.nodes = {};\n\n  \t// events\n  \tractive.event = null;\n  \tractive._eventQueue = [];\n\n  \t// live queries\n  \tractive._liveQueries = [];\n  \tractive._liveComponentQueries = [];\n\n  \t// observers\n  \tractive._observers = [];\n\n  \t// links\n  \tractive._links = {};\n\n  \tif (!ractive.component) {\n  \t\tractive.root = ractive;\n  \t\tractive.parent = ractive.container = null; // TODO container still applicable?\n  \t}\n  }\n\n  function deprecateRactiveData() {\n  \tthrow new Error('Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead');\n  }\n\n  function getChildQueue(queue, ractive) {\n  \treturn queue[ractive._guid] || (queue[ractive._guid] = []);\n  }\n\n  function fire(hookQueue, ractive) {\n  \tvar childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  \thookQueue.hook.fire(ractive);\n\n  \t// queue is \"live\" because components can end up being\n  \t// added while hooks fire on parents that modify data values.\n  \twhile (childQueue.length) {\n  \t\tfire(hookQueue, childQueue.shift());\n  \t}\n\n  \tdelete hookQueue.queue[ractive._guid];\n  }\n\n  var HookQueue = function () {\n  \tfunction HookQueue(event) {\n  \t\tbabelHelpers.classCallCheck(this, HookQueue);\n\n  \t\tthis.hook = new Hook(event);\n  \t\tthis.inProcess = {};\n  \t\tthis.queue = {};\n  \t}\n\n  \tHookQueue.prototype.begin = function begin(ractive) {\n  \t\tthis.inProcess[ractive._guid] = true;\n  \t};\n\n  \tHookQueue.prototype.end = function end(ractive) {\n  \t\tvar parent = ractive.parent;\n\n  \t\t// If this is *isn't* a child of a component that's in process,\n  \t\t// it should call methods or fire at this point\n  \t\tif (!parent || !this.inProcess[parent._guid]) {\n  \t\t\tfire(this, ractive);\n  \t\t}\n  \t\t// elsewise, handoff to parent to fire when ready\n  \t\telse {\n  \t\t\t\tgetChildQueue(this.queue, parent).push(ractive);\n  \t\t\t}\n\n  \t\tdelete this.inProcess[ractive._guid];\n  \t};\n\n  \treturn HookQueue;\n  }();\n\n  var configHook = new Hook('config');\n  var initHook = new HookQueue('init');\n\n  function initialise(ractive, userOptions, options) {\n  \tObject.keys(ractive.viewmodel.computations).forEach(function (key) {\n  \t\tvar computation = ractive.viewmodel.computations[key];\n\n  \t\tif (ractive.viewmodel.value.hasOwnProperty(key)) {\n  \t\t\tcomputation.set(ractive.viewmodel.value[key]);\n  \t\t}\n  \t});\n\n  \t// init config from Parent and options\n  \tconfig.init(ractive.constructor, ractive, userOptions);\n\n  \tconfigHook.fire(ractive);\n  \tinitHook.begin(ractive);\n\n  \tvar fragment = void 0;\n\n  \t// Render virtual DOM\n  \tif (ractive.template) {\n  \t\tvar cssIds = void 0;\n\n  \t\tif (options.cssIds || ractive.cssId) {\n  \t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n  \t\t\tif (ractive.cssId) {\n  \t\t\t\tcssIds.push(ractive.cssId);\n  \t\t\t}\n  \t\t}\n\n  \t\tractive.fragment = fragment = new Fragment({\n  \t\t\towner: ractive,\n  \t\t\ttemplate: ractive.template,\n  \t\t\tcssIds: cssIds\n  \t\t}).bind(ractive.viewmodel);\n  \t}\n\n  \tinitHook.end(ractive);\n\n  \tif (fragment) {\n  \t\t// render automatically ( if `el` is specified )\n  \t\tvar el = getElement(ractive.el);\n  \t\tif (el) {\n  \t\t\tvar promise = ractive.render(el, ractive.append);\n\n  \t\t\tif (Ractive.DEBUG_PROMISES) {\n  \t\t\t\tpromise.catch(function (err) {\n  \t\t\t\t\twarnOnceIfDebug('Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;');\n  \t\t\t\t\twarnIfDebug('An error happened during rendering', { ractive: ractive });\n  \t\t\t\t\tlogIfDebug(err);\n\n  \t\t\t\t\tthrow err;\n  \t\t\t\t});\n  \t\t\t}\n  \t\t}\n  \t}\n  }\n\n  var Parser;\n  var ParseError;\n  var leadingWhitespace = /^\\s+/;\n  ParseError = function ParseError(message) {\n  \tthis.name = 'ParseError';\n  \tthis.message = message;\n  \ttry {\n  \t\tthrow new Error(message);\n  \t} catch (e) {\n  \t\tthis.stack = e.stack;\n  \t}\n  };\n\n  ParseError.prototype = Error.prototype;\n\n  Parser = function Parser(str, options) {\n  \tvar items,\n  \t    item,\n  \t    lineStart = 0;\n\n  \tthis.str = str;\n  \tthis.options = options || {};\n  \tthis.pos = 0;\n\n  \tthis.lines = this.str.split('\\n');\n  \tthis.lineEnds = this.lines.map(function (line) {\n  \t\tvar lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n  \t\tlineStart = lineEnd;\n  \t\treturn lineEnd;\n  \t}, 0);\n\n  \t// Custom init logic\n  \tif (this.init) this.init(str, options);\n\n  \titems = [];\n\n  \twhile (this.pos < this.str.length && (item = this.read())) {\n  \t\titems.push(item);\n  \t}\n\n  \tthis.leftover = this.remaining();\n  \tthis.result = this.postProcess ? this.postProcess(items, options) : items;\n  };\n\n  Parser.prototype = {\n  \tread: function read(converters) {\n  \t\tvar pos, i, len, item;\n\n  \t\tif (!converters) converters = this.converters;\n\n  \t\tpos = this.pos;\n\n  \t\tlen = converters.length;\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tthis.pos = pos; // reset for each attempt\n\n  \t\t\tif (item = converters[i](this)) {\n  \t\t\t\treturn item;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn null;\n  \t},\n\n  \tgetLinePos: function getLinePos(char) {\n  \t\tvar lineNum = 0,\n  \t\t    lineStart = 0,\n  \t\t    columnNum;\n\n  \t\twhile (char >= this.lineEnds[lineNum]) {\n  \t\t\tlineStart = this.lineEnds[lineNum];\n  \t\t\tlineNum += 1;\n  \t\t}\n\n  \t\tcolumnNum = char - lineStart;\n  \t\treturn [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  \t},\n\n  \terror: function error(message) {\n  \t\tvar pos = this.getLinePos(this.pos);\n  \t\tvar lineNum = pos[0];\n  \t\tvar columnNum = pos[1];\n\n  \t\tvar line = this.lines[pos[0] - 1];\n  \t\tvar numTabs = 0;\n  \t\tvar annotation = line.replace(/\\t/g, function (match, char) {\n  \t\t\tif (char < pos[1]) {\n  \t\t\t\tnumTabs += 1;\n  \t\t\t}\n\n  \t\t\treturn '  ';\n  \t\t}) + '\\n' + new Array(pos[1] + numTabs).join(' ') + '^----';\n\n  \t\tvar error = new ParseError(message + ' at line ' + lineNum + ' character ' + columnNum + ':\\n' + annotation);\n\n  \t\terror.line = pos[0];\n  \t\terror.character = pos[1];\n  \t\terror.shortMessage = message;\n\n  \t\tthrow error;\n  \t},\n\n  \tmatchString: function matchString(string) {\n  \t\tif (this.str.substr(this.pos, string.length) === string) {\n  \t\t\tthis.pos += string.length;\n  \t\t\treturn string;\n  \t\t}\n  \t},\n\n  \tmatchPattern: function matchPattern(pattern) {\n  \t\tvar match;\n\n  \t\tif (match = pattern.exec(this.remaining())) {\n  \t\t\tthis.pos += match[0].length;\n  \t\t\treturn match[1] || match[0];\n  \t\t}\n  \t},\n\n  \tallowWhitespace: function allowWhitespace() {\n  \t\tthis.matchPattern(leadingWhitespace);\n  \t},\n\n  \tremaining: function remaining() {\n  \t\treturn this.str.substring(this.pos);\n  \t},\n\n  \tnextChar: function nextChar() {\n  \t\treturn this.str.charAt(this.pos);\n  \t}\n  };\n\n  Parser.extend = function (proto) {\n  \tvar Parent = this,\n  \t    Child,\n  \t    key;\n\n  \tChild = function Child(str, options) {\n  \t\tParser.call(this, str, options);\n  \t};\n\n  \tChild.prototype = create(Parent.prototype);\n\n  \tfor (key in proto) {\n  \t\tif (hasOwn.call(proto, key)) {\n  \t\t\tChild.prototype[key] = proto[key];\n  \t\t}\n  \t}\n\n  \tChild.extend = Parser.extend;\n  \treturn Child;\n  };\n\n  var Parser$1 = Parser;\n\n  var stringMiddlePattern;\n  var escapeSequencePattern;\n  var lineContinuationPattern;\n  // Match one or more characters until: \", ', \\, or EOL/EOF.\n  // EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\n  stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n  // Match one escape sequence, including the backslash.\n  escapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n  // Match one ES5 line continuation (backslash + line terminator).\n  lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n  // Helper for defining getDoubleQuotedString and getSingleQuotedString.\n  function makeQuotedStringMatcher (okQuote) {\n  \treturn function (parser) {\n  \t\tvar literal = '\"';\n  \t\tvar done = false;\n  \t\tvar next = void 0;\n\n  \t\twhile (!done) {\n  \t\t\tnext = parser.matchPattern(stringMiddlePattern) || parser.matchPattern(escapeSequencePattern) || parser.matchString(okQuote);\n  \t\t\tif (next) {\n  \t\t\t\tif (next === '\"') {\n  \t\t\t\t\tliteral += '\\\\\"';\n  \t\t\t\t} else if (next === '\\\\\\'') {\n  \t\t\t\t\tliteral += '\\'';\n  \t\t\t\t} else {\n  \t\t\t\t\tliteral += next;\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tnext = parser.matchPattern(lineContinuationPattern);\n  \t\t\t\tif (next) {\n  \t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n  \t\t\t\t\tliteral += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n  \t\t\t\t} else {\n  \t\t\t\t\tdone = true;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tliteral += '\"';\n\n  \t\t// use JSON.parse to interpret escapes\n  \t\treturn JSON.parse(literal);\n  \t};\n  }\n\n  var getSingleQuotedString = makeQuotedStringMatcher('\"');\n  var getDoubleQuotedString = makeQuotedStringMatcher('\\'');\n\n  function readStringLiteral (parser) {\n  \tvar start, string;\n\n  \tstart = parser.pos;\n\n  \tif (parser.matchString('\"')) {\n  \t\tstring = getDoubleQuotedString(parser);\n\n  \t\tif (!parser.matchString('\"')) {\n  \t\t\tparser.pos = start;\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn {\n  \t\t\tt: STRING_LITERAL,\n  \t\t\tv: string\n  \t\t};\n  \t}\n\n  \tif (parser.matchString('\\'')) {\n  \t\tstring = getSingleQuotedString(parser);\n\n  \t\tif (!parser.matchString('\\'')) {\n  \t\t\tparser.pos = start;\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn {\n  \t\t\tt: STRING_LITERAL,\n  \t\t\tv: string\n  \t\t};\n  \t}\n\n  \treturn null;\n  }\n\n  // bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\n  var numberPattern$1 = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\n  function readNumberLiteral(parser) {\n  \tvar result;\n\n  \tif (result = parser.matchPattern(numberPattern$1)) {\n  \t\treturn {\n  \t\t\tt: NUMBER_LITERAL,\n  \t\t\tv: result\n  \t\t};\n  \t}\n\n  \treturn null;\n  }\n\n  var name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\n\n  var identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n  // http://mathiasbynens.be/notes/javascript-properties\n  // can be any name, string literal, or number literal\n  function readKey(parser) {\n  \tvar token;\n\n  \tif (token = readStringLiteral(parser)) {\n  \t\treturn identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  \t}\n\n  \tif (token = readNumberLiteral(parser)) {\n  \t\treturn token.v;\n  \t}\n\n  \tif (token = parser.matchPattern(name)) {\n  \t\treturn token;\n  \t}\n\n  \treturn null;\n  }\n\n  // simple JSON parser, without the restrictions of JSON parse\n  // (i.e. having to double-quote keys).\n  //\n  // If passed a hash of values as the second argument, ${placeholders}\n  // will be replaced with those values\n\n  var specials = {\n  \ttrue: true,\n  \tfalse: false,\n  \tnull: null,\n  \tundefined: undefined\n  };\n\n  var specialsPattern = new RegExp('^(?:' + Object.keys(specials).join('|') + ')');\n  var numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n  var placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\n  var placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\n  var onlyWhitespace = /^\\s*$/;\n\n  var JsonParser = Parser$1.extend({\n  \tinit: function init(str, options) {\n  \t\tthis.values = options.values;\n  \t\tthis.allowWhitespace();\n  \t},\n  \tpostProcess: function postProcess(result) {\n  \t\tif (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn { value: result[0].v };\n  \t},\n\n\n  \tconverters: [function getPlaceholder(parser) {\n  \t\tif (!parser.values) return null;\n\n  \t\tvar placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n  \t\tif (placeholder && parser.values.hasOwnProperty(placeholder)) {\n  \t\t\treturn { v: parser.values[placeholder] };\n  \t\t}\n  \t}, function getSpecial(parser) {\n  \t\tvar special = parser.matchPattern(specialsPattern);\n  \t\tif (special) return { v: specials[special] };\n  \t}, function getNumber(parser) {\n  \t\tvar number = parser.matchPattern(numberPattern);\n  \t\tif (number) return { v: +number };\n  \t}, function getString(parser) {\n  \t\tvar stringLiteral = readStringLiteral(parser);\n  \t\tvar values = parser.values;\n\n  \t\tif (stringLiteral && values) {\n  \t\t\treturn {\n  \t\t\t\tv: stringLiteral.v.replace(placeholderPattern, function (match, $1) {\n  \t\t\t\t\treturn $1 in values ? values[$1] : $1;\n  \t\t\t\t})\n  \t\t\t};\n  \t\t}\n\n  \t\treturn stringLiteral;\n  \t}, function getObject(parser) {\n  \t\tif (!parser.matchString('{')) return null;\n\n  \t\tvar result = {};\n\n  \t\tparser.allowWhitespace();\n\n  \t\tif (parser.matchString('}')) {\n  \t\t\treturn { v: result };\n  \t\t}\n\n  \t\tvar pair = void 0;\n  \t\twhile (pair = getKeyValuePair(parser)) {\n  \t\t\tresult[pair.key] = pair.value;\n\n  \t\t\tparser.allowWhitespace();\n\n  \t\t\tif (parser.matchString('}')) {\n  \t\t\t\treturn { v: result };\n  \t\t\t}\n\n  \t\t\tif (!parser.matchString(',')) {\n  \t\t\t\treturn null;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn null;\n  \t}, function getArray(parser) {\n  \t\tif (!parser.matchString('[')) return null;\n\n  \t\tvar result = [];\n\n  \t\tparser.allowWhitespace();\n\n  \t\tif (parser.matchString(']')) {\n  \t\t\treturn { v: result };\n  \t\t}\n\n  \t\tvar valueToken = void 0;\n  \t\twhile (valueToken = parser.read()) {\n  \t\t\tresult.push(valueToken.v);\n\n  \t\t\tparser.allowWhitespace();\n\n  \t\t\tif (parser.matchString(']')) {\n  \t\t\t\treturn { v: result };\n  \t\t\t}\n\n  \t\t\tif (!parser.matchString(',')) {\n  \t\t\t\treturn null;\n  \t\t\t}\n\n  \t\t\tparser.allowWhitespace();\n  \t\t}\n\n  \t\treturn null;\n  \t}]\n  });\n\n  function getKeyValuePair(parser) {\n  \tparser.allowWhitespace();\n\n  \tvar key = readKey(parser);\n\n  \tif (!key) return null;\n\n  \tvar pair = { key: key };\n\n  \tparser.allowWhitespace();\n  \tif (!parser.matchString(':')) {\n  \t\treturn null;\n  \t}\n  \tparser.allowWhitespace();\n\n  \tvar valueToken = parser.read();\n\n  \tif (!valueToken) return null;\n\n  \tpair.value = valueToken.v;\n  \treturn pair;\n  }\n\n  function parseJSON (str, values) {\n  \tvar parser = new JsonParser(str, { values: values });\n  \treturn parser.result;\n  }\n\n  function gatherRefs(fragment) {\n  \tvar key = {},\n  \t    index = {};\n\n  \t// walk up the template gather refs as we go\n  \twhile (fragment) {\n  \t\tif (fragment.parent && (fragment.parent.indexRef || fragment.parent.keyRef)) {\n  \t\t\tvar ref = fragment.parent.indexRef;\n  \t\t\tif (ref && !(ref in index)) index[ref] = fragment.index;\n  \t\t\tref = fragment.parent.keyRef;\n  \t\t\tif (ref && !(ref in key)) key[ref] = fragment.key;\n  \t\t}\n\n  \t\tif (fragment.componentParent && !fragment.ractive.isolated) {\n  \t\t\tfragment = fragment.componentParent;\n  \t\t} else {\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n  \t}\n\n  \treturn { key: key, index: index };\n  }\n\n  var eventPattern = /^event(?:\\.(.+))?$/;\n  var argumentsPattern = /^arguments\\.(\\d*)$/;\n  var dollarArgsPattern = /^\\$(\\d*)$/;\n\n  var EventDirective = function () {\n  \tfunction EventDirective(owner, event, template) {\n  \t\tbabelHelpers.classCallCheck(this, EventDirective);\n\n  \t\tthis.owner = owner;\n  \t\tthis.event = event;\n  \t\tthis.template = template;\n\n  \t\tthis.ractive = owner.parentFragment.ractive;\n  \t\tthis.parentFragment = owner.parentFragment;\n\n  \t\tthis.context = null;\n  \t\tthis.passthru = false;\n\n  \t\t// method calls\n  \t\tthis.method = null;\n  \t\tthis.resolvers = null;\n  \t\tthis.models = null;\n  \t\tthis.argsFn = null;\n\n  \t\t// handler directive\n  \t\tthis.action = null;\n  \t\tthis.args = null;\n  \t}\n\n  \tEventDirective.prototype.bind = function bind() {\n  \t\tvar _this = this;\n\n  \t\tthis.context = this.parentFragment.findContext();\n\n  \t\tvar template = this.template;\n\n  \t\tif (template.m) {\n  \t\t\tthis.method = template.m;\n\n  \t\t\t// pass-thru \"...arguments\"\n  \t\t\tthis.passthru = !!template.g;\n\n  \t\t\tif (template.a) {\n  \t\t\t\tthis.resolvers = [];\n  \t\t\t\tthis.models = template.a.r.map(function (ref, i) {\n\n  \t\t\t\t\tif (eventPattern.test(ref)) {\n  \t\t\t\t\t\t// on-click=\"foo(event.node)\"\n  \t\t\t\t\t\treturn {\n  \t\t\t\t\t\t\tevent: true,\n  \t\t\t\t\t\t\tkeys: ref.length > 5 ? splitKeypathI(ref.slice(6)) : [],\n  \t\t\t\t\t\t\tunbind: noop\n  \t\t\t\t\t\t};\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar argMatch = argumentsPattern.exec(ref);\n  \t\t\t\t\tif (argMatch) {\n  \t\t\t\t\t\t// on-click=\"foo(arguments[0])\"\n  \t\t\t\t\t\treturn {\n  \t\t\t\t\t\t\targument: true,\n  \t\t\t\t\t\t\tindex: argMatch[1]\n  \t\t\t\t\t\t};\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar dollarMatch = dollarArgsPattern.exec(ref);\n  \t\t\t\t\tif (dollarMatch) {\n  \t\t\t\t\t\t// on-click=\"foo($1)\"\n  \t\t\t\t\t\treturn {\n  \t\t\t\t\t\t\targument: true,\n  \t\t\t\t\t\t\tindex: dollarMatch[1] - 1\n  \t\t\t\t\t\t};\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar resolver = void 0;\n\n  \t\t\t\t\tvar model = resolveReference(_this.parentFragment, ref);\n  \t\t\t\t\tif (!model) {\n  \t\t\t\t\t\tresolver = _this.parentFragment.resolve(ref, function (model) {\n  \t\t\t\t\t\t\t_this.models[i] = model;\n  \t\t\t\t\t\t\tremoveFromArray(_this.resolvers, resolver);\n  \t\t\t\t\t\t});\n\n  \t\t\t\t\t\t_this.resolvers.push(resolver);\n  \t\t\t\t\t}\n\n  \t\t\t\t\treturn model;\n  \t\t\t\t});\n\n  \t\t\t\tthis.argsFn = getFunction(template.a.s, template.a.r.length);\n  \t\t\t}\n  \t\t} else {\n  \t\t\t// TODO deprecate this style of directive\n  \t\t\tthis.action = typeof template === 'string' ? // on-click='foo'\n  \t\t\ttemplate : typeof template.n === 'string' ? // on-click='{{dynamic}}'\n  \t\t\ttemplate.n : new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.n\n  \t\t\t});\n\n  \t\t\tthis.args = template.a ? // static arguments\n  \t\t\ttypeof template.a === 'string' ? [template.a] : template.a : template.d ? // dynamic arguments\n  \t\t\tnew Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.d\n  \t\t\t}) : []; // no arguments\n  \t\t}\n\n  \t\tif (this.template.n && typeof this.template.n !== 'string') this.action.bind();\n  \t\tif (this.template.d) this.args.bind();\n  \t};\n\n  \tEventDirective.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.owner.bubble();\n  \t\t}\n  \t};\n\n  \tEventDirective.prototype.fire = function fire(event) {\n  \t\tvar passedArgs = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n\n  \t\t// augment event object\n  \t\tif (event) {\n  \t\t\tvar refs = gatherRefs(this.parentFragment);\n  \t\t\tevent.keypath = this.context.getKeypath(this.ractive);\n  \t\t\tevent.rootpath = this.context.getKeypath();\n  \t\t\tevent.context = this.context.get();\n  \t\t\tevent.index = refs.index;\n  \t\t\tevent.key = refs.key;\n  \t\t}\n\n  \t\tif (this.method) {\n  \t\t\tif (typeof this.ractive[this.method] !== 'function') {\n  \t\t\t\tthrow new Error('Attempted to call a non-existent method (\"' + this.method + '\")');\n  \t\t\t}\n\n  \t\t\tvar args = void 0;\n\n  \t\t\tif (event) passedArgs.unshift(event);\n\n  \t\t\tif (this.models) {\n  \t\t\t\tvar values = this.models.map(function (model) {\n  \t\t\t\t\tif (!model) return undefined;\n\n  \t\t\t\t\tif (model.event) {\n  \t\t\t\t\t\tvar obj = event;\n  \t\t\t\t\t\tvar keys = model.keys.slice();\n\n  \t\t\t\t\t\twhile (keys.length) {\n  \t\t\t\t\t\t\tobj = obj[keys.shift()];\n  \t\t\t\t\t\t}return obj;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (model.argument) {\n  \t\t\t\t\t\treturn passedArgs ? passedArgs[model.index] : void 0;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (model.wrapper) {\n  \t\t\t\t\t\treturn model.wrapper.value;\n  \t\t\t\t\t}\n\n  \t\t\t\t\treturn model.get();\n  \t\t\t\t});\n\n  \t\t\t\targs = this.argsFn.apply(null, values);\n  \t\t\t}\n\n  \t\t\tif (this.passthru) {\n  \t\t\t\targs = args ? args.concat(passedArgs) : passedArgs;\n  \t\t\t}\n\n  \t\t\t// make event available as `this.event`\n  \t\t\tvar ractive = this.ractive;\n  \t\t\tvar oldEvent = ractive.event;\n\n  \t\t\tractive.event = event;\n  \t\t\tvar result = ractive[this.method].apply(ractive, args);\n\n  \t\t\t// Auto prevent and stop if return is explicitly false\n  \t\t\tvar original = void 0;\n  \t\t\tif (result === false && (original = event.original)) {\n  \t\t\t\toriginal.preventDefault && original.preventDefault();\n  \t\t\t\toriginal.stopPropagation && original.stopPropagation();\n  \t\t\t}\n\n  \t\t\tractive.event = oldEvent;\n  \t\t} else {\n  \t\t\tvar action = this.action.toString();\n  \t\t\tvar _args = this.template.d ? this.args.getArgsList() : this.args;\n\n  \t\t\tif (passedArgs.length) _args = _args.concat(passedArgs);\n\n  \t\t\tif (event) event.name = action;\n\n  \t\t\tfireEvent(this.ractive, action, {\n  \t\t\t\tevent: event,\n  \t\t\t\targs: _args\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tEventDirective.prototype.rebind = function rebind() {\n  \t\tthis.unbind();\n  \t\tthis.bind();\n  \t};\n\n  \tEventDirective.prototype.render = function render() {\n  \t\tthis.event.listen(this);\n  \t};\n\n  \tEventDirective.prototype.unbind = function unbind() {\n  \t\tvar template = this.template;\n\n  \t\tif (template.m) {\n  \t\t\tif (this.resolvers) this.resolvers.forEach(_unbind);\n  \t\t\tthis.resolvers = [];\n\n  \t\t\tthis.models = null;\n  \t\t} else {\n  \t\t\t// TODO this is brittle and non-explicit, fix it\n  \t\t\tif (this.action.unbind) this.action.unbind();\n  \t\t\tif (this.args.unbind) this.args.unbind();\n  \t\t}\n  \t};\n\n  \tEventDirective.prototype.unrender = function unrender() {\n  \t\tthis.event.unlisten();\n  \t};\n\n  \tEventDirective.prototype.update = function update() {\n  \t\tif (this.method || !this.dirty) return; // nothing to do\n\n  \t\tthis.dirty = false;\n\n  \t\t// ugh legacy\n  \t\tif (this.action.update) this.action.update();\n  \t\tif (this.template.d) this.args.update();\n  \t};\n\n  \treturn EventDirective;\n  }();\n\n  var RactiveEvent = function () {\n  \tfunction RactiveEvent(ractive, name) {\n  \t\tbabelHelpers.classCallCheck(this, RactiveEvent);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.name = name;\n  \t\tthis.handler = null;\n  \t}\n\n  \tRactiveEvent.prototype.listen = function listen(directive) {\n  \t\tvar ractive = this.ractive;\n\n  \t\tthis.handler = ractive.on(this.name, function () {\n  \t\t\tvar event = void 0;\n\n  \t\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n  \t\t\tif (arguments.length && arguments[0] && arguments[0].node) {\n  \t\t\t\tevent = Array.prototype.shift.call(arguments);\n  \t\t\t\tevent.component = ractive;\n  \t\t\t}\n\n  \t\t\tvar args = Array.prototype.slice.call(arguments);\n  \t\t\tdirective.fire(event, args);\n\n  \t\t\t// cancel bubbling\n  \t\t\treturn false;\n  \t\t});\n  \t};\n\n  \tRactiveEvent.prototype.unlisten = function unlisten() {\n  \t\tthis.handler.cancel();\n  \t};\n\n  \treturn RactiveEvent;\n  }();\n\n  // TODO it's unfortunate that this has to run every time a\n  // component is rendered... is there a better way?\n  function updateLiveQueries(component) {\n  \t// Does this need to be added to any live queries?\n  \tvar instance = component.ractive;\n\n  \tdo {\n  \t\tvar liveQueries = instance._liveComponentQueries;\n\n  \t\tvar i = liveQueries.length;\n  \t\twhile (i--) {\n  \t\t\tvar name = liveQueries[i];\n  \t\t\tvar query = liveQueries[\"_\" + name];\n\n  \t\t\tif (query.test(component)) {\n  \t\t\t\tquery.add(component.instance);\n  \t\t\t\t// keep register of applicable selectors, for when we teardown\n  \t\t\t\tcomponent.liveQueries.push(query);\n  \t\t\t}\n  \t\t}\n  \t} while (instance = instance.parent);\n  }\n\n  function removeFromLiveComponentQueries(component) {\n  \tvar instance = component.ractive;\n\n  \twhile (instance) {\n  \t\tvar query = instance._liveComponentQueries['_' + component.name];\n  \t\tif (query) query.remove(component);\n\n  \t\tinstance = instance.parent;\n  \t}\n  }\n\n  function makeDirty(query) {\n  \tquery.makeDirty();\n  }\n\n  var teardownHook = new Hook('teardown');\n\n  var Component = function (_Item) {\n  \tbabelHelpers.inherits(Component, _Item);\n\n  \tfunction Component(options, ComponentConstructor) {\n  \t\tbabelHelpers.classCallCheck(this, Component);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.type = COMPONENT; // override ELEMENT from super\n\n  \t\tvar instance = create(ComponentConstructor.prototype);\n\n  \t\t_this.instance = instance;\n  \t\t_this.name = options.template.e;\n  \t\t_this.parentFragment = options.parentFragment;\n  \t\t_this.complexMappings = [];\n\n  \t\t_this.liveQueries = [];\n\n  \t\tif (instance.el) {\n  \t\t\twarnIfDebug('The <' + _this.name + '> component has a default \\'el\\' property; it has been disregarded');\n  \t\t}\n\n  \t\tvar partials = options.template.p || {};\n  \t\tif (!('content' in partials)) partials.content = options.template.f || [];\n  \t\t_this._partials = partials; // TEMP\n\n  \t\t_this.yielders = {};\n\n  \t\t// find container\n  \t\tvar fragment = options.parentFragment;\n  \t\tvar container = void 0;\n  \t\twhile (fragment) {\n  \t\t\tif (fragment.owner.type === YIELDER) {\n  \t\t\t\tcontainer = fragment.owner.container;\n  \t\t\t\tbreak;\n  \t\t\t}\n\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n\n  \t\t// add component-instance-specific properties\n  \t\tinstance.parent = _this.parentFragment.ractive;\n  \t\tinstance.container = container || null;\n  \t\tinstance.root = instance.parent.root;\n  \t\tinstance.component = _this;\n\n  \t\tconstruct(_this.instance, { partials: partials });\n\n  \t\t// for hackability, this could be an open option\n  \t\t// for any ractive instance, but for now, just\n  \t\t// for components and just for ractive...\n  \t\tinstance._inlinePartials = partials;\n\n  \t\t_this.eventHandlers = [];\n  \t\tif (_this.template.v) _this.setupEvents();\n  \t\treturn _this;\n  \t}\n\n  \tComponent.prototype.bind = function bind() {\n  \t\tvar _this2 = this;\n\n  \t\tvar viewmodel = this.instance.viewmodel;\n  \t\tvar childData = viewmodel.value;\n\n  \t\t// determine mappings\n  \t\tif (this.template.a) {\n  \t\t\tObject.keys(this.template.a).forEach(function (localKey) {\n  \t\t\t\tvar template = _this2.template.a[localKey];\n  \t\t\t\tvar model = void 0;\n  \t\t\t\tvar fragment = void 0;\n\n  \t\t\t\tif (template === 0) {\n  \t\t\t\t\t// empty attributes are `true`\n  \t\t\t\t\tviewmodel.joinKey(localKey).set(true);\n  \t\t\t\t} else if (typeof template === 'string') {\n  \t\t\t\t\tvar parsed = parseJSON(template);\n  \t\t\t\t\tviewmodel.joinKey(localKey).set(parsed ? parsed.value : template);\n  \t\t\t\t} else if (isArray(template)) {\n  \t\t\t\t\tif (template.length === 1 && template[0].t === INTERPOLATOR) {\n  \t\t\t\t\t\tmodel = resolve$1(_this2.parentFragment, template[0]);\n\n  \t\t\t\t\t\tif (!model) {\n  \t\t\t\t\t\t\twarnOnceIfDebug('The ' + localKey + '=\\'{{' + template[0].r + '}}\\' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity', { ractive: _this2.instance }); // TODO add docs page explaining this\n  \t\t\t\t\t\t\t_this2.parentFragment.ractive.get(localKey); // side-effect: create mappings as necessary\n  \t\t\t\t\t\t\tmodel = _this2.parentFragment.findContext().joinKey(localKey);\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tviewmodel.map(localKey, model);\n\n  \t\t\t\t\t\tif (model.get() === undefined && localKey in childData) {\n  \t\t\t\t\t\t\tmodel.set(childData[localKey]);\n  \t\t\t\t\t\t}\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tfragment = new Fragment({\n  \t\t\t\t\t\t\towner: _this2,\n  \t\t\t\t\t\t\ttemplate: template\n  \t\t\t\t\t\t}).bind();\n\n  \t\t\t\t\t\tmodel = viewmodel.joinKey(localKey);\n  \t\t\t\t\t\tmodel.set(fragment.valueOf());\n\n  \t\t\t\t\t\t// this is a *bit* of a hack\n  \t\t\t\t\t\tfragment.bubble = function () {\n  \t\t\t\t\t\t\tFragment.prototype.bubble.call(fragment);\n  \t\t\t\t\t\t\tfragment.update();\n  \t\t\t\t\t\t\tmodel.set(fragment.valueOf());\n  \t\t\t\t\t\t};\n\n  \t\t\t\t\t\t_this2.complexMappings.push(fragment);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t});\n  \t\t}\n\n  \t\tinitialise(this.instance, {\n  \t\t\tpartials: this._partials\n  \t\t}, {\n  \t\t\tcssIds: this.parentFragment.cssIds\n  \t\t});\n\n  \t\tthis.eventHandlers.forEach(_bind);\n  \t};\n\n  \tComponent.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.parentFragment.bubble();\n  \t\t}\n  \t};\n\n  \tComponent.prototype.checkYielders = function checkYielders() {\n  \t\tvar _this3 = this;\n\n  \t\tObject.keys(this.yielders).forEach(function (name) {\n  \t\t\tif (_this3.yielders[name].length > 1) {\n  \t\t\t\trunloop.end();\n  \t\t\t\tthrow new Error('A component template can only have one {{yield' + (name ? ' ' + name : '') + '}} declaration at a time');\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \tComponent.prototype.detach = function detach() {\n  \t\treturn this.instance.fragment.detach();\n  \t};\n\n  \tComponent.prototype.find = function find(selector) {\n  \t\treturn this.instance.fragment.find(selector);\n  \t};\n\n  \tComponent.prototype.findAll = function findAll(selector, query) {\n  \t\tthis.instance.fragment.findAll(selector, query);\n  \t};\n\n  \tComponent.prototype.findComponent = function findComponent(name) {\n  \t\tif (!name || this.name === name) return this.instance;\n\n  \t\tif (this.instance.fragment) {\n  \t\t\treturn this.instance.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tComponent.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (query.test(this)) {\n  \t\t\tquery.add(this.instance);\n\n  \t\t\tif (query.live) {\n  \t\t\t\tthis.liveQueries.push(query);\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.instance.fragment.findAllComponents(name, query);\n  \t};\n\n  \tComponent.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.instance.fragment.firstNode(skipParent);\n  \t};\n\n  \tComponent.prototype.rebind = function rebind() {\n  \t\tvar _this4 = this;\n\n  \t\tthis.complexMappings.forEach(_rebind);\n\n  \t\tthis.liveQueries.forEach(makeDirty);\n\n  \t\t// update relevant mappings\n  \t\tvar viewmodel = this.instance.viewmodel;\n  \t\tviewmodel.mappings = {};\n\n  \t\tif (this.template.a) {\n  \t\t\tObject.keys(this.template.a).forEach(function (localKey) {\n  \t\t\t\tvar template = _this4.template.a[localKey];\n  \t\t\t\tvar model = void 0;\n\n  \t\t\t\tif (isArray(template) && template.length === 1 && template[0].t === INTERPOLATOR) {\n  \t\t\t\t\tmodel = resolve$1(_this4.parentFragment, template[0]);\n\n  \t\t\t\t\tif (!model) {\n  \t\t\t\t\t\t// TODO is this even possible?\n  \t\t\t\t\t\twarnOnceIfDebug('The ' + localKey + '=\\'{{' + template[0].r + '}}\\' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity', { ractive: _this4.instance });\n  \t\t\t\t\t\t_this4.parentFragment.ractive.get(localKey); // side-effect: create mappings as necessary\n  \t\t\t\t\t\tmodel = _this4.parentFragment.findContext().joinKey(localKey);\n  \t\t\t\t\t}\n\n  \t\t\t\t\tviewmodel.map(localKey, model);\n  \t\t\t\t}\n  \t\t\t});\n  \t\t}\n\n  \t\tthis.instance.fragment.rebind(viewmodel);\n  \t};\n\n  \tComponent.prototype.render = function render$$(target, occupants) {\n  \t\trender(this.instance, target, null, occupants);\n\n  \t\tthis.checkYielders();\n  \t\tthis.eventHandlers.forEach(_render);\n  \t\tupdateLiveQueries(this);\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tComponent.prototype.setupEvents = function setupEvents() {\n  \t\tvar _this5 = this;\n\n  \t\tvar handlers = this.eventHandlers;\n\n  \t\tObject.keys(this.template.v).forEach(function (key) {\n  \t\t\tvar eventNames = key.split('-');\n  \t\t\tvar template = _this5.template.v[key];\n\n  \t\t\teventNames.forEach(function (eventName) {\n  \t\t\t\tvar event = new RactiveEvent(_this5.instance, eventName);\n  \t\t\t\thandlers.push(new EventDirective(_this5, event, template));\n  \t\t\t});\n  \t\t});\n  \t};\n\n  \tComponent.prototype.toString = function toString() {\n  \t\treturn this.instance.toHTML();\n  \t};\n\n  \tComponent.prototype.unbind = function unbind() {\n  \t\tthis.complexMappings.forEach(_unbind);\n\n  \t\tvar instance = this.instance;\n  \t\tinstance.viewmodel.teardown();\n  \t\tinstance.fragment.unbind();\n  \t\tinstance._observers.forEach(cancel);\n\n  \t\tremoveFromLiveComponentQueries(this);\n\n  \t\tif (instance.fragment.rendered && instance.el.__ractive_instances__) {\n  \t\t\tremoveFromArray(instance.el.__ractive_instances__, instance);\n  \t\t}\n\n  \t\tObject.keys(instance._links).forEach(function (k) {\n  \t\t\treturn instance._links[k].unlink();\n  \t\t});\n\n  \t\tteardownHook.fire(instance);\n  \t};\n\n  \tComponent.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tvar _this6 = this;\n\n  \t\tthis.shouldDestroy = shouldDestroy;\n  \t\tthis.instance.unrender();\n  \t\tthis.eventHandlers.forEach(_unrender);\n  \t\tthis.liveQueries.forEach(function (query) {\n  \t\t\treturn query.remove(_this6.instance);\n  \t\t});\n  \t};\n\n  \tComponent.prototype.update = function update() {\n  \t\tthis.dirty = false;\n  \t\tthis.instance.fragment.update();\n  \t\tthis.checkYielders();\n  \t\tthis.eventHandlers.forEach(_update);\n  \t\tthis.complexMappings.forEach(_update);\n  \t};\n\n  \treturn Component;\n  }(Item);\n\n  var Doctype = function (_Item) {\n  \tbabelHelpers.inherits(Doctype, _Item);\n\n  \tfunction Doctype() {\n  \t\tbabelHelpers.classCallCheck(this, Doctype);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Item.apply(this, arguments));\n  \t}\n\n  \tDoctype.prototype.bind = function bind() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.render = function render() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.teardown = function teardown() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.toString = function toString() {\n  \t\treturn '<!DOCTYPE' + this.template.a + '>';\n  \t};\n\n  \tDoctype.prototype.unbind = function unbind() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.unrender = function unrender() {\n  \t\t// noop\n  \t};\n\n  \treturn Doctype;\n  }(Item);\n\n  var textTypes = [undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit'];\n\n  function getUpdateDelegate(attribute) {\n  \tvar element = attribute.element;\n  \tvar name = attribute.name;\n\n\n  \tif (name === 'id') return updateId;\n\n  \tif (name === 'value') {\n  \t\t// special case - selects\n  \t\tif (element.name === 'select' && name === 'value') {\n  \t\t\treturn element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n  \t\t}\n\n  \t\tif (element.name === 'textarea') return updateStringValue;\n\n  \t\t// special case - contenteditable\n  \t\tif (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n  \t\t// special case - <input>\n  \t\tif (element.name === 'input') {\n  \t\t\tvar type = element.getAttribute('type');\n\n  \t\t\t// type='file' value='{{fileList}}'>\n  \t\t\tif (type === 'file') return noop; // read-only\n\n  \t\t\t// type='radio' name='{{twoway}}'\n  \t\t\tif (type === 'radio' && element.binding && element.binding.attribute.name === 'name') return updateRadioValue;\n\n  \t\t\tif (~textTypes.indexOf(type)) return updateStringValue;\n  \t\t}\n\n  \t\treturn updateValue;\n  \t}\n\n  \tvar node = element.node;\n\n  \t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n  \tif (attribute.isTwoway && name === 'name') {\n  \t\tif (node.type === 'radio') return updateRadioName;\n  \t\tif (node.type === 'checkbox') return updateCheckboxName;\n  \t}\n\n  \t// special case - style attributes in Internet Exploder\n  \tif (name === 'style' && node.style.setAttribute) return updateIEStyleAttribute;\n\n  \t// special case - class names. IE fucks things up, again\n  \tif (name === 'class' && (!node.namespaceURI || node.namespaceURI === html)) return updateClassName;\n\n  \tif (attribute.isBoolean) return updateBoolean;\n\n  \tif (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI) return updateNamespacedAttribute;\n\n  \treturn updateAttribute;\n  }\n\n  function updateId() {\n  \tvar node = this.node;\n\n  \tvar value = this.getValue();\n\n  \tdelete this.ractive.nodes[node.id];\n  \tthis.ractive.nodes[value] = node;\n\n  \tnode.id = value;\n  }\n\n  function updateMultipleSelectValue() {\n  \tvar value = this.getValue();\n\n  \tif (!isArray(value)) value = [value];\n\n  \tvar options = this.node.options;\n  \tvar i = options.length;\n\n  \twhile (i--) {\n  \t\tvar option = options[i];\n  \t\tvar optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n  \t\toption.selected = arrayContains(value, optionValue);\n  \t}\n  }\n\n  function updateSelectValue() {\n  \tvar value = this.getValue();\n\n  \tif (!this.locked) {\n  \t\t// TODO is locked still a thing?\n  \t\tthis.node._ractive.value = value;\n\n  \t\tvar options = this.node.options;\n  \t\tvar i = options.length;\n\n  \t\twhile (i--) {\n  \t\t\tvar option = options[i];\n  \t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n  \t\t\tif (optionValue == value) {\n  \t\t\t\t// double equals as we may be comparing numbers with strings\n  \t\t\t\toption.selected = true;\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.node.selectedIndex = -1;\n  \t}\n  }\n\n  function updateContentEditableValue() {\n  \tvar value = this.getValue();\n\n  \tif (!this.locked) {\n  \t\tthis.node.innerHTML = value === undefined ? '' : value;\n  \t}\n  }\n\n  function updateRadioValue() {\n  \tvar node = this.node;\n  \tvar wasChecked = node.checked;\n\n  \tvar value = this.getValue();\n\n  \t//node.value = this.element.getAttribute( 'value' );\n  \tnode.value = this.node._ractive.value = value;\n  \tnode.checked = value === this.element.getAttribute('name');\n\n  \t// This is a special case - if the input was checked, and the value\n  \t// changed so that it's no longer checked, the twoway binding is\n  \t// most likely out of date. To fix it we have to jump through some\n  \t// hoops... this is a little kludgy but it works\n  \tif (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n  \t\tthis.element.binding.group.model.set(this.element.binding.group.getValue());\n  \t}\n  }\n\n  function updateValue() {\n  \tif (!this.locked) {\n  \t\tvar value = this.getValue();\n\n  \t\tthis.node.value = this.node._ractive.value = value;\n  \t\tthis.node.setAttribute('value', value);\n  \t}\n  }\n\n  function updateStringValue() {\n  \tif (!this.locked) {\n  \t\tvar value = this.getValue();\n\n  \t\tthis.node._ractive.value = value;\n\n  \t\tthis.node.value = safeToStringValue(value);\n  \t\tthis.node.setAttribute('value', safeToStringValue(value));\n  \t}\n  }\n\n  function updateRadioName() {\n  \tthis.node.checked = this.getValue() == this.node._ractive.value;\n  }\n\n  function updateCheckboxName() {\n  \tvar element = this.element;\n  \tvar node = this.node;\n\n  \tvar binding = element.binding;\n\n  \tvar value = this.getValue();\n  \tvar valueAttribute = element.getAttribute('value');\n\n  \tif (!isArray(value)) {\n  \t\tbinding.isChecked = node.checked = value == valueAttribute;\n  \t} else {\n  \t\tvar i = value.length;\n  \t\twhile (i--) {\n  \t\t\tif (valueAttribute == value[i]) {\n  \t\t\t\tbinding.isChecked = node.checked = true;\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t}\n  \t\tbinding.isChecked = node.checked = false;\n  \t}\n  }\n\n  function updateIEStyleAttribute() {\n  \tthis.node.style.setAttribute('cssText', this.getValue() || '');\n  }\n\n  function updateClassName() {\n  \tthis.node.className = safeToStringValue(this.getValue());\n  }\n\n  function updateBoolean() {\n  \t// with two-way binding, only update if the change wasn't initiated by the user\n  \t// otherwise the cursor will often be sent to the wrong place\n  \tif (!this.locked) {\n  \t\tif (this.useProperty) {\n  \t\t\tthis.node[this.propertyName] = this.getValue();\n  \t\t} else {\n  \t\t\tif (this.getValue()) {\n  \t\t\t\tthis.node.setAttribute(this.propertyName, '');\n  \t\t\t} else {\n  \t\t\t\tthis.node.removeAttribute(this.propertyName);\n  \t\t\t}\n  \t\t}\n  \t}\n  }\n\n  function updateAttribute() {\n  \tthis.node.setAttribute(this.name, safeToStringValue(this.getString()));\n  }\n\n  function updateNamespacedAttribute() {\n  \tthis.node.setAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1), safeToStringValue(this.getString()));\n  }\n\n  var propertyNames = {\n  \t'accept-charset': 'acceptCharset',\n  \taccesskey: 'accessKey',\n  \tbgcolor: 'bgColor',\n  \tclass: 'className',\n  \tcodebase: 'codeBase',\n  \tcolspan: 'colSpan',\n  \tcontenteditable: 'contentEditable',\n  \tdatetime: 'dateTime',\n  \tdirname: 'dirName',\n  \tfor: 'htmlFor',\n  \t'http-equiv': 'httpEquiv',\n  \tismap: 'isMap',\n  \tmaxlength: 'maxLength',\n  \tnovalidate: 'noValidate',\n  \tpubdate: 'pubDate',\n  \treadonly: 'readOnly',\n  \trowspan: 'rowSpan',\n  \ttabindex: 'tabIndex',\n  \tusemap: 'useMap'\n  };\n\n  // https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\n  var booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\n  var voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\n  var htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, 'int': 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830 };\n  var controlCharacters = [8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376];\n  var entityPattern = new RegExp('&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys(htmlEntities).join('|') + '));?', 'g');\n  var codePointSupport = typeof String.fromCodePoint === 'function';\n  var codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\n  function decodeCharacterReferences(html) {\n  \treturn html.replace(entityPattern, function (match, entity) {\n  \t\tvar code;\n\n  \t\t// Handle named entities\n  \t\tif (entity[0] !== '#') {\n  \t\t\tcode = htmlEntities[entity];\n  \t\t} else if (entity[1] === 'x') {\n  \t\t\tcode = parseInt(entity.substring(2), 16);\n  \t\t} else {\n  \t\t\tcode = parseInt(entity.substring(1), 10);\n  \t\t}\n\n  \t\tif (!code) {\n  \t\t\treturn match;\n  \t\t}\n\n  \t\treturn codeToChar(validateCode(code));\n  \t});\n  }\n\n  var lessThan = /</g;\n  var greaterThan = />/g;\n  var amp = /&/g;\n  var invalid = 65533;\n\n  function escapeHtml(str) {\n  \treturn str.replace(amp, '&amp;').replace(lessThan, '&lt;').replace(greaterThan, '&gt;');\n  }\n\n  // some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n  // code points with alternatives in some cases - since we're bypassing that mechanism, we need\n  // to replace them ourselves\n  //\n  // Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n  function validateCode(code) {\n  \tif (!code) {\n  \t\treturn invalid;\n  \t}\n\n  \t// line feed becomes generic whitespace\n  \tif (code === 10) {\n  \t\treturn 32;\n  \t}\n\n  \t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  \tif (code < 128) {\n  \t\treturn code;\n  \t}\n\n  \t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  \t// to correct the mistake or we'll end up with missing € signs and so on\n  \tif (code <= 159) {\n  \t\treturn controlCharacters[code - 128];\n  \t}\n\n  \t// basic multilingual plane\n  \tif (code < 55296) {\n  \t\treturn code;\n  \t}\n\n  \t// UTF-16 surrogate halves\n  \tif (code <= 57343) {\n  \t\treturn invalid;\n  \t}\n\n  \t// rest of the basic multilingual plane\n  \tif (code <= 65535) {\n  \t\treturn code;\n  \t} else if (!codePointSupport) {\n  \t\treturn invalid;\n  \t}\n\n  \t// supplementary multilingual plane 0x10000 - 0x1ffff\n  \tif (code >= 65536 && code <= 131071) {\n  \t\treturn code;\n  \t}\n\n  \t// supplementary ideographic plane 0x20000 - 0x2ffff\n  \tif (code >= 131072 && code <= 196607) {\n  \t\treturn code;\n  \t}\n\n  \treturn invalid;\n  }\n\n  function lookupNamespace(node, prefix) {\n  \tvar qualified = 'xmlns:' + prefix;\n\n  \twhile (node) {\n  \t\tif (node.hasAttribute(qualified)) return node.getAttribute(qualified);\n  \t\tnode = node.parentNode;\n  \t}\n\n  \treturn namespaces[prefix];\n  }\n\n  var Attribute = function (_Item) {\n  \tbabelHelpers.inherits(Attribute, _Item);\n\n  \tfunction Attribute(options) {\n  \t\tbabelHelpers.classCallCheck(this, Attribute);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.name = options.name;\n  \t\t_this.namespace = null;\n  \t\t_this.element = options.element;\n  \t\t_this.parentFragment = options.element.parentFragment; // shared\n  \t\t_this.ractive = _this.parentFragment.ractive;\n\n  \t\t_this.rendered = false;\n  \t\t_this.updateDelegate = null;\n  \t\t_this.fragment = null;\n  \t\t_this.value = null;\n\n  \t\tif (!isArray(options.template)) {\n  \t\t\t_this.value = options.template;\n  \t\t\tif (_this.value === 0) {\n  \t\t\t\t_this.value = '';\n  \t\t\t}\n  \t\t} else {\n  \t\t\t_this.fragment = new Fragment({\n  \t\t\t\towner: _this,\n  \t\t\t\ttemplate: options.template\n  \t\t\t});\n  \t\t}\n\n  \t\t_this.interpolator = _this.fragment && _this.fragment.items.length === 1 && _this.fragment.items[0].type === INTERPOLATOR && _this.fragment.items[0];\n  \t\treturn _this;\n  \t}\n\n  \tAttribute.prototype.bind = function bind() {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.bind();\n  \t\t}\n  \t};\n\n  \tAttribute.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.element.bubble();\n  \t\t\tthis.dirty = true;\n  \t\t}\n  \t};\n\n  \tAttribute.prototype.getString = function getString() {\n  \t\treturn this.fragment ? this.fragment.toString() : this.value != null ? '' + this.value : '';\n  \t};\n\n  \t// TODO could getValue ever be called for a static attribute,\n  \t// or can we assume that this.fragment exists?\n\n\n  \tAttribute.prototype.getValue = function getValue() {\n  \t\treturn this.fragment ? this.fragment.valueOf() : booleanAttributes.test(this.name) ? true : this.value;\n  \t};\n\n  \tAttribute.prototype.rebind = function rebind() {\n  \t\tif (this.fragment) this.fragment.rebind();\n  \t};\n\n  \tAttribute.prototype.render = function render() {\n  \t\tvar node = this.element.node;\n  \t\tthis.node = node;\n\n  \t\t// should we use direct property access, or setAttribute?\n  \t\tif (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n  \t\t\tthis.propertyName = propertyNames[this.name] || this.name;\n\n  \t\t\tif (node[this.propertyName] !== undefined) {\n  \t\t\t\tthis.useProperty = true;\n  \t\t\t}\n\n  \t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n  \t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n  \t\t\tif (booleanAttributes.test(this.name) || this.isTwoway) {\n  \t\t\t\tthis.isBoolean = true;\n  \t\t\t}\n\n  \t\t\tif (this.propertyName === 'value') {\n  \t\t\t\tnode._ractive.value = this.value;\n  \t\t\t}\n  \t\t}\n\n  \t\tif (node.namespaceURI) {\n  \t\t\tvar index = this.name.indexOf(':');\n  \t\t\tif (index !== -1) {\n  \t\t\t\tthis.namespace = lookupNamespace(node, this.name.slice(0, index));\n  \t\t\t} else {\n  \t\t\t\tthis.namespace = node.namespaceURI;\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t\tthis.updateDelegate = getUpdateDelegate(this);\n  \t\tthis.updateDelegate();\n  \t};\n\n  \tAttribute.prototype.toString = function toString() {\n  \t\tvar value = this.getValue();\n\n  \t\t// Special case - select and textarea values (should not be stringified)\n  \t\tif (this.name === 'value' && (this.element.getAttribute('contenteditable') !== undefined || this.element.name === 'select' || this.element.name === 'textarea')) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\t// Special case – bound radio `name` attributes\n  \t\tif (this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute('type') === 'radio') {\n  \t\t\treturn 'name=\"{{' + this.interpolator.model.getKeypath() + '}}\"';\n  \t\t}\n\n  \t\tif (booleanAttributes.test(this.name)) return value ? this.name : '';\n  \t\tif (value == null) return '';\n\n  \t\tvar str = safeToStringValue(this.getString()).replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;');\n\n  \t\treturn str ? this.name + '=\"' + str + '\"' : this.name;\n  \t};\n\n  \tAttribute.prototype.unbind = function unbind() {\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tAttribute.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tif (this.fragment) this.fragment.update();\n  \t\t\tif (this.rendered) this.updateDelegate();\n  \t\t}\n  \t};\n\n  \treturn Attribute;\n  }(Item);\n\n  var div$1 = doc ? createElement('div') : null;\n\n  var ConditionalAttribute = function (_Item) {\n  \tbabelHelpers.inherits(ConditionalAttribute, _Item);\n\n  \tfunction ConditionalAttribute(options) {\n  \t\tbabelHelpers.classCallCheck(this, ConditionalAttribute);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.attributes = [];\n\n  \t\t_this.owner = options.owner;\n\n  \t\t_this.fragment = new Fragment({\n  \t\t\tractive: _this.ractive,\n  \t\t\towner: _this,\n  \t\t\ttemplate: [_this.template]\n  \t\t});\n\n  \t\t_this.dirty = false;\n  \t\treturn _this;\n  \t}\n\n  \tConditionalAttribute.prototype.bind = function bind() {\n  \t\tthis.fragment.bind();\n  \t};\n\n  \tConditionalAttribute.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.owner.bubble();\n  \t\t}\n  \t};\n\n  \tConditionalAttribute.prototype.rebind = function rebind() {\n  \t\tthis.fragment.rebind();\n  \t};\n\n  \tConditionalAttribute.prototype.render = function render() {\n  \t\tthis.node = this.owner.node;\n  \t\tthis.isSvg = this.node.namespaceURI === svg$1;\n\n  \t\tthis.rendered = true;\n  \t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n  \t\tthis.update();\n  \t};\n\n  \tConditionalAttribute.prototype.toString = function toString() {\n  \t\treturn this.fragment.toString();\n  \t};\n\n  \tConditionalAttribute.prototype.unbind = function unbind() {\n  \t\tthis.fragment.unbind();\n  \t};\n\n  \tConditionalAttribute.prototype.unrender = function unrender() {\n  \t\tthis.rendered = false;\n  \t};\n\n  \tConditionalAttribute.prototype.update = function update() {\n  \t\tvar _this2 = this;\n\n  \t\tvar str = void 0;\n  \t\tvar attrs = void 0;\n\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tthis.fragment.update();\n\n  \t\t\tif (this.rendered) {\n  \t\t\t\tstr = this.fragment.toString();\n  \t\t\t\tattrs = parseAttributes(str, this.isSvg);\n\n  \t\t\t\t// any attributes that previously existed but no longer do\n  \t\t\t\t// must be removed\n  \t\t\t\tthis.attributes.filter(function (a) {\n  \t\t\t\t\treturn notIn(attrs, a);\n  \t\t\t\t}).forEach(function (a) {\n  \t\t\t\t\t_this2.node.removeAttribute(a.name);\n  \t\t\t\t});\n\n  \t\t\t\tattrs.forEach(function (a) {\n  \t\t\t\t\t_this2.node.setAttribute(a.name, a.value);\n  \t\t\t\t});\n\n  \t\t\t\tthis.attributes = attrs;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \treturn ConditionalAttribute;\n  }(Item);\n\n  function parseAttributes(str, isSvg) {\n  \tvar tagName = isSvg ? 'svg' : 'div';\n  \treturn str ? (div$1.innerHTML = '<' + tagName + ' ' + str + '></' + tagName + '>') && toArray(div$1.childNodes[0].attributes) : [];\n  }\n\n  function notIn(haystack, needle) {\n  \tvar i = haystack.length;\n\n  \twhile (i--) {\n  \t\tif (haystack[i].name === needle.name) {\n  \t\t\treturn false;\n  \t\t}\n  \t}\n\n  \treturn true;\n  }\n\n  var missingDecorator = {\n  \tupdate: noop,\n  \tteardown: noop\n  };\n\n  var Decorator = function () {\n  \tfunction Decorator(owner, template) {\n  \t\tbabelHelpers.classCallCheck(this, Decorator);\n\n  \t\tthis.owner = owner;\n  \t\tthis.template = template;\n\n  \t\tthis.parentFragment = owner.parentFragment;\n  \t\tthis.ractive = owner.ractive;\n\n  \t\tthis.dynamicName = babelHelpers.typeof(template.n) === 'object';\n  \t\tthis.dynamicArgs = !!template.d;\n\n  \t\tif (this.dynamicName) {\n  \t\t\tthis.nameFragment = new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.n\n  \t\t\t});\n  \t\t} else {\n  \t\t\tthis.name = template.n || template;\n  \t\t}\n\n  \t\tif (this.dynamicArgs) {\n  \t\t\tthis.argsFragment = new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.d\n  \t\t\t});\n  \t\t} else {\n  \t\t\tthis.args = template.a || [];\n  \t\t}\n\n  \t\tthis.node = null;\n  \t\tthis.intermediary = null;\n  \t}\n\n  \tDecorator.prototype.bind = function bind() {\n  \t\tif (this.dynamicName) {\n  \t\t\tthis.nameFragment.bind();\n  \t\t\tthis.name = this.nameFragment.toString();\n  \t\t}\n\n  \t\tif (this.dynamicArgs) this.argsFragment.bind();\n  \t};\n\n  \tDecorator.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.owner.bubble();\n  \t\t}\n  \t};\n\n  \tDecorator.prototype.rebind = function rebind() {\n  \t\tif (this.dynamicName) this.nameFragment.rebind();\n  \t\tif (this.dynamicArgs) this.argsFragment.rebind();\n  \t};\n\n  \tDecorator.prototype.render = function render() {\n  \t\tvar fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n  \t\tif (!fn) {\n  \t\t\twarnOnce(missingPlugin(this.name, 'decorator'));\n  \t\t\tthis.intermediary = missingDecorator;\n  \t\t\treturn;\n  \t\t}\n\n  \t\tthis.node = this.owner.node;\n\n  \t\tvar args = this.dynamicArgs ? this.argsFragment.getArgsList() : this.args;\n  \t\tthis.intermediary = fn.apply(this.ractive, [this.node].concat(args));\n\n  \t\tif (!this.intermediary || !this.intermediary.teardown) {\n  \t\t\tthrow new Error('The \\'' + this.name + '\\' decorator must return an object with a teardown method');\n  \t\t}\n  \t};\n\n  \tDecorator.prototype.unbind = function unbind() {\n  \t\tif (this.dynamicName) this.nameFragment.unbind();\n  \t\tif (this.dynamicArgs) this.argsFragment.unbind();\n  \t};\n\n  \tDecorator.prototype.unrender = function unrender() {\n  \t\tif (this.intermediary) this.intermediary.teardown();\n  \t};\n\n  \tDecorator.prototype.update = function update() {\n  \t\tif (!this.dirty) return;\n\n  \t\tthis.dirty = false;\n\n  \t\tvar nameChanged = false;\n\n  \t\tif (this.dynamicName && this.nameFragment.dirty) {\n  \t\t\tvar name = this.nameFragment.toString();\n  \t\t\tnameChanged = name !== this.name;\n  \t\t\tthis.name = name;\n  \t\t}\n\n  \t\tif (this.intermediary) {\n  \t\t\tif (nameChanged || !this.intermediary.update) {\n  \t\t\t\tthis.unrender();\n  \t\t\t\tthis.render();\n  \t\t\t} else {\n  \t\t\t\tif (this.dynamicArgs) {\n  \t\t\t\t\tif (this.argsFragment.dirty) {\n  \t\t\t\t\t\tvar args = this.argsFragment.getArgsList();\n  \t\t\t\t\t\tthis.intermediary.update.apply(this.ractive, args);\n  \t\t\t\t\t}\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.intermediary.update.apply(this.ractive, this.args);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\t// need to run these for unrender/render cases\n  \t\t// so can't just be in conditional if above\n\n  \t\tif (this.dynamicName && this.nameFragment.dirty) {\n  \t\t\tthis.nameFragment.update();\n  \t\t}\n\n  \t\tif (this.dynamicArgs && this.argsFragment.dirty) {\n  \t\t\tthis.argsFragment.update();\n  \t\t}\n  \t};\n\n  \treturn Decorator;\n  }();\n\n  var DOMEvent = function () {\n  \tfunction DOMEvent(name, owner) {\n  \t\tbabelHelpers.classCallCheck(this, DOMEvent);\n\n  \t\tif (name.indexOf('*') !== -1) {\n  \t\t\tfatal('Only component proxy-events may contain \"*\" wildcards, <' + owner.name + ' on-' + name + '=\"...\"/> is not valid');\n  \t\t}\n\n  \t\tthis.name = name;\n  \t\tthis.owner = owner;\n  \t\tthis.node = null;\n  \t\tthis.handler = null;\n  \t}\n\n  \tDOMEvent.prototype.listen = function listen(directive) {\n  \t\tvar node = this.node = this.owner.node;\n  \t\tvar name = this.name;\n\n  \t\tif (!('on' + name in node)) {\n  \t\t\twarnOnce(missingPlugin(name, 'events'));\n  \t\t}\n\n  \t\tnode.addEventListener(name, this.handler = function (event) {\n  \t\t\tdirective.fire({\n  \t\t\t\tnode: node,\n  \t\t\t\toriginal: event\n  \t\t\t});\n  \t\t}, false);\n  \t};\n\n  \tDOMEvent.prototype.unlisten = function unlisten() {\n  \t\tthis.node.removeEventListener(this.name, this.handler, false);\n  \t};\n\n  \treturn DOMEvent;\n  }();\n\n  var CustomEvent = function () {\n  \tfunction CustomEvent(eventPlugin, owner) {\n  \t\tbabelHelpers.classCallCheck(this, CustomEvent);\n\n  \t\tthis.eventPlugin = eventPlugin;\n  \t\tthis.owner = owner;\n  \t\tthis.handler = null;\n  \t}\n\n  \tCustomEvent.prototype.listen = function listen(directive) {\n  \t\tvar node = this.owner.node;\n\n  \t\tthis.handler = this.eventPlugin(node, function () {\n  \t\t\tvar event = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  \t\t\tevent.node = event.node || node;\n  \t\t\tdirective.fire(event);\n  \t\t});\n  \t};\n\n  \tCustomEvent.prototype.unlisten = function unlisten() {\n  \t\tthis.handler.teardown();\n  \t};\n\n  \treturn CustomEvent;\n  }();\n\n  function camelCase (hyphenatedStr) {\n  \treturn hyphenatedStr.replace(/-([a-zA-Z])/g, function (match, $1) {\n  \t\treturn $1.toUpperCase();\n  \t});\n  }\n\n  var prefix = void 0;\n\n  if (!isClient) {\n  \tprefix = null;\n  } else {\n  \t(function () {\n  \t\tvar prefixCache = {};\n  \t\tvar testStyle = createElement('div').style;\n\n  \t\tprefix = function prefix(prop) {\n  \t\t\tprop = camelCase(prop);\n\n  \t\t\tif (!prefixCache[prop]) {\n  \t\t\t\tif (testStyle[prop] !== undefined) {\n  \t\t\t\t\tprefixCache[prop] = prop;\n  \t\t\t\t} else {\n  \t\t\t\t\t// test vendors...\n  \t\t\t\t\tvar capped = prop.charAt(0).toUpperCase() + prop.substring(1);\n\n  \t\t\t\t\tvar i = vendors.length;\n  \t\t\t\t\twhile (i--) {\n  \t\t\t\t\t\tvar vendor = vendors[i];\n  \t\t\t\t\t\tif (testStyle[vendor + capped] !== undefined) {\n  \t\t\t\t\t\t\tprefixCache[prop] = vendor + capped;\n  \t\t\t\t\t\t\tbreak;\n  \t\t\t\t\t\t}\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\treturn prefixCache[prop];\n  \t\t};\n  \t})();\n  }\n\n  var prefix$1 = prefix;\n\n  var visible = void 0;\n  var hidden = 'hidden';\n\n  if (doc) {\n  \tvar prefix$2 = void 0;\n\n  \tif (hidden in doc) {\n  \t\tprefix$2 = '';\n  \t} else {\n  \t\tvar i$1 = vendors.length;\n  \t\twhile (i$1--) {\n  \t\t\tvar vendor = vendors[i$1];\n  \t\t\thidden = vendor + 'Hidden';\n\n  \t\t\tif (hidden in doc) {\n  \t\t\t\tprefix$2 = vendor;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tif (prefix$2 !== undefined) {\n  \t\tdoc.addEventListener(prefix$2 + 'visibilitychange', onChange);\n  \t\tonChange();\n  \t} else {\n  \t\t// gah, we're in an old browser\n  \t\tif ('onfocusout' in doc) {\n  \t\t\tdoc.addEventListener('focusout', onHide);\n  \t\t\tdoc.addEventListener('focusin', onShow);\n  \t\t} else {\n  \t\t\twin.addEventListener('pagehide', onHide);\n  \t\t\twin.addEventListener('blur', onHide);\n\n  \t\t\twin.addEventListener('pageshow', onShow);\n  \t\t\twin.addEventListener('focus', onShow);\n  \t\t}\n\n  \t\tvisible = true; // until proven otherwise. Not ideal but hey\n  \t}\n  }\n\n  function onChange() {\n  \tvisible = !doc[hidden];\n  }\n\n  function onHide() {\n  \tvisible = false;\n  }\n\n  function onShow() {\n  \tvisible = true;\n  }\n\n  var unprefixPattern = new RegExp('^-(?:' + vendors.join('|') + ')-');\n\n  function unprefix (prop) {\n  \treturn prop.replace(unprefixPattern, '');\n  }\n\n  var vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\n  function hyphenate (str) {\n  \tif (!str) return ''; // edge case\n\n  \tif (vendorPattern.test(str)) str = '-' + str;\n\n  \treturn str.replace(/[A-Z]/g, function (match) {\n  \t\treturn '-' + match.toLowerCase();\n  \t});\n  }\n\n  var createTransitions = void 0;\n\n  if (!isClient) {\n  \tcreateTransitions = null;\n  } else {\n  \t(function () {\n  \t\tvar testStyle = createElement('div').style;\n  \t\tvar linear = function linear(x) {\n  \t\t\treturn x;\n  \t\t};\n\n  \t\tvar canUseCssTransitions = {};\n  \t\tvar cannotUseCssTransitions = {};\n\n  \t\t// determine some facts about our environment\n  \t\tvar TRANSITION = void 0;\n  \t\tvar TRANSITIONEND = void 0;\n  \t\tvar CSS_TRANSITIONS_ENABLED = void 0;\n  \t\tvar TRANSITION_DURATION = void 0;\n  \t\tvar TRANSITION_PROPERTY = void 0;\n  \t\tvar TRANSITION_TIMING_FUNCTION = void 0;\n\n  \t\tif (testStyle.transition !== undefined) {\n  \t\t\tTRANSITION = 'transition';\n  \t\t\tTRANSITIONEND = 'transitionend';\n  \t\t\tCSS_TRANSITIONS_ENABLED = true;\n  \t\t} else if (testStyle.webkitTransition !== undefined) {\n  \t\t\tTRANSITION = 'webkitTransition';\n  \t\t\tTRANSITIONEND = 'webkitTransitionEnd';\n  \t\t\tCSS_TRANSITIONS_ENABLED = true;\n  \t\t} else {\n  \t\t\tCSS_TRANSITIONS_ENABLED = false;\n  \t\t}\n\n  \t\tif (TRANSITION) {\n  \t\t\tTRANSITION_DURATION = TRANSITION + 'Duration';\n  \t\t\tTRANSITION_PROPERTY = TRANSITION + 'Property';\n  \t\t\tTRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  \t\t}\n\n  \t\tcreateTransitions = function createTransitions(t, to, options, changedProperties, resolve) {\n\n  \t\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n  \t\t\t// TODO use a fastdom-style mechanism?\n  \t\t\tsetTimeout(function () {\n  \t\t\t\tvar jsTransitionsComplete = void 0;\n  \t\t\t\tvar cssTransitionsComplete = void 0;\n\n  \t\t\t\tfunction checkComplete() {\n  \t\t\t\t\tif (jsTransitionsComplete && cssTransitionsComplete) {\n  \t\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n  \t\t\t\t\t\tt.ractive.fire(t.name + ':end', t.node, t.isIntro);\n  \t\t\t\t\t\tresolve();\n  \t\t\t\t\t}\n  \t\t\t\t}\n\n  \t\t\t\t// this is used to keep track of which elements can use CSS to animate\n  \t\t\t\t// which properties\n  \t\t\t\tvar hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n  \t\t\t\t// need to reset transition properties\n  \t\t\t\tvar style = t.node.style;\n  \t\t\t\tvar previous = {\n  \t\t\t\t\tproperty: style[TRANSITION_PROPERTY],\n  \t\t\t\t\ttiming: style[TRANSITION_TIMING_FUNCTION],\n  \t\t\t\t\tduration: style[TRANSITION_DURATION]\n  \t\t\t\t};\n\n  \t\t\t\tstyle[TRANSITION_PROPERTY] = changedProperties.map(prefix$1).map(hyphenate).join(',');\n  \t\t\t\tstyle[TRANSITION_TIMING_FUNCTION] = hyphenate(options.easing || 'linear');\n  \t\t\t\tstyle[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n  \t\t\t\tfunction transitionEndHandler(event) {\n  \t\t\t\t\tvar index = changedProperties.indexOf(camelCase(unprefix(event.propertyName)));\n\n  \t\t\t\t\tif (index !== -1) {\n  \t\t\t\t\t\tchangedProperties.splice(index, 1);\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (changedProperties.length) {\n  \t\t\t\t\t\t// still transitioning...\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tstyle[TRANSITION_PROPERTY] = previous.property;\n  \t\t\t\t\tstyle[TRANSITION_TIMING_FUNCTION] = previous.duration;\n  \t\t\t\t\tstyle[TRANSITION_DURATION] = previous.timing;\n\n  \t\t\t\t\tt.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n  \t\t\t\t\tcssTransitionsComplete = true;\n  \t\t\t\t\tcheckComplete();\n  \t\t\t\t}\n\n  \t\t\t\tt.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n  \t\t\t\tsetTimeout(function () {\n  \t\t\t\t\tvar i = changedProperties.length;\n  \t\t\t\t\tvar hash = void 0;\n  \t\t\t\t\tvar originalValue = void 0;\n  \t\t\t\t\tvar index = void 0;\n  \t\t\t\t\tvar propertiesToTransitionInJs = [];\n  \t\t\t\t\tvar prop = void 0;\n  \t\t\t\t\tvar suffix = void 0;\n  \t\t\t\t\tvar interpolator = void 0;\n\n  \t\t\t\t\twhile (i--) {\n  \t\t\t\t\t\tprop = changedProperties[i];\n  \t\t\t\t\t\thash = hashPrefix + prop;\n\n  \t\t\t\t\t\tif (CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\tstyle[prefix$1(prop)] = to[prop];\n\n  \t\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n  \t\t\t\t\t\t\t// this tag/property combo, find out now\n  \t\t\t\t\t\t\tif (!canUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\t\toriginalValue = t.getStyle(prop);\n\n  \t\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n  \t\t\t\t\t\t\t\t// the current style will be different from the target style\n  \t\t\t\t\t\t\t\tcanUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n  \t\t\t\t\t\t\t\tcannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n  \t\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n  \t\t\t\t\t\t\t\tif (cannotUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\t\t\tstyle[prefix$1(prop)] = originalValue;\n  \t\t\t\t\t\t\t\t}\n  \t\t\t\t\t\t\t}\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tif (!CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\t// we need to fall back to timer-based stuff\n  \t\t\t\t\t\t\tif (originalValue === undefined) {\n  \t\t\t\t\t\t\t\toriginalValue = t.getStyle(prop);\n  \t\t\t\t\t\t\t}\n\n  \t\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n  \t\t\t\t\t\t\t// will get confused\n  \t\t\t\t\t\t\tindex = changedProperties.indexOf(prop);\n  \t\t\t\t\t\t\tif (index === -1) {\n  \t\t\t\t\t\t\t\twarnIfDebug('Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n  \t\t\t\t\t\t\t} else {\n  \t\t\t\t\t\t\t\tchangedProperties.splice(index, 1);\n  \t\t\t\t\t\t\t}\n\n  \t\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n  \t\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec(to[prop])[0];\n  \t\t\t\t\t\t\tinterpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop])) || function () {\n  \t\t\t\t\t\t\t\treturn to[prop];\n  \t\t\t\t\t\t\t};\n\n  \t\t\t\t\t\t\t// ...then kick off a timer-based transition\n  \t\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n  \t\t\t\t\t\t\t\tname: prefix$1(prop),\n  \t\t\t\t\t\t\t\tinterpolator: interpolator,\n  \t\t\t\t\t\t\t\tsuffix: suffix\n  \t\t\t\t\t\t\t});\n  \t\t\t\t\t\t}\n  \t\t\t\t\t}\n\n  \t\t\t\t\t// javascript transitions\n  \t\t\t\t\tif (propertiesToTransitionInJs.length) {\n  \t\t\t\t\t\tvar easing = void 0;\n\n  \t\t\t\t\t\tif (typeof options.easing === 'string') {\n  \t\t\t\t\t\t\teasing = t.ractive.easing[options.easing];\n\n  \t\t\t\t\t\t\tif (!easing) {\n  \t\t\t\t\t\t\t\twarnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n  \t\t\t\t\t\t\t\teasing = linear;\n  \t\t\t\t\t\t\t}\n  \t\t\t\t\t\t} else if (typeof options.easing === 'function') {\n  \t\t\t\t\t\t\teasing = options.easing;\n  \t\t\t\t\t\t} else {\n  \t\t\t\t\t\t\teasing = linear;\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tnew Ticker({\n  \t\t\t\t\t\t\tduration: options.duration,\n  \t\t\t\t\t\t\teasing: easing,\n  \t\t\t\t\t\t\tstep: function step(pos) {\n  \t\t\t\t\t\t\t\tvar i = propertiesToTransitionInJs.length;\n  \t\t\t\t\t\t\t\twhile (i--) {\n  \t\t\t\t\t\t\t\t\tvar _prop = propertiesToTransitionInJs[i];\n  \t\t\t\t\t\t\t\t\tt.node.style[_prop.name] = _prop.interpolator(pos) + _prop.suffix;\n  \t\t\t\t\t\t\t\t}\n  \t\t\t\t\t\t\t},\n  \t\t\t\t\t\t\tcomplete: function complete() {\n  \t\t\t\t\t\t\t\tjsTransitionsComplete = true;\n  \t\t\t\t\t\t\t\tcheckComplete();\n  \t\t\t\t\t\t\t}\n  \t\t\t\t\t\t});\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tjsTransitionsComplete = true;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (!changedProperties.length) {\n  \t\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n  \t\t\t\t\t\t// the fact that it will never fire\n  \t\t\t\t\t\tt.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n  \t\t\t\t\t\tcssTransitionsComplete = true;\n  \t\t\t\t\t\tcheckComplete();\n  \t\t\t\t\t}\n  \t\t\t\t}, 0);\n  \t\t\t}, options.delay || 0);\n  \t\t};\n  \t})();\n  }\n\n  var createTransitions$1 = createTransitions;\n\n  function resetStyle(node, style) {\n  \tif (style) {\n  \t\tnode.setAttribute('style', style);\n  \t} else {\n  \t\t// Next line is necessary, to remove empty style attribute!\n  \t\t// See http://stackoverflow.com/a/7167553\n  \t\tnode.getAttribute('style');\n  \t\tnode.removeAttribute('style');\n  \t}\n  }\n\n  var getComputedStyle = win && (win.getComputedStyle || legacy.getComputedStyle);\n  var resolved = Promise$1.resolve();\n\n  var Transition = function () {\n  \tfunction Transition(ractive, node, name, params, eventName) {\n  \t\tbabelHelpers.classCallCheck(this, Transition);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.node = node;\n  \t\tthis.name = name;\n  \t\tthis.params = params;\n\n  \t\t// TODO this will need to change...\n  \t\tthis.eventName = eventName;\n  \t\tthis.isIntro = eventName !== 'outro';\n\n  \t\tif (typeof name === 'function') {\n  \t\t\tthis._fn = name;\n  \t\t} else {\n  \t\t\tthis._fn = findInViewHierarchy('transitions', ractive, name);\n\n  \t\t\tif (!this._fn) {\n  \t\t\t\twarnOnceIfDebug(missingPlugin(name, 'transition'), { ractive: ractive });\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tTransition.prototype.animateStyle = function animateStyle(style, value, options) {\n  \t\tvar _this = this;\n\n  \t\tif (arguments.length === 4) {\n  \t\t\tthrow new Error('t.animateStyle() returns a promise - use .then() instead of passing a callback');\n  \t\t}\n\n  \t\t// Special case - page isn't visible. Don't animate anything, because\n  \t\t// that way you'll never get CSS transitionend events\n  \t\tif (!visible) {\n  \t\t\tthis.setStyle(style, value);\n  \t\t\treturn resolved;\n  \t\t}\n\n  \t\tvar to = void 0;\n\n  \t\tif (typeof style === 'string') {\n  \t\t\tto = {};\n  \t\t\tto[style] = value;\n  \t\t} else {\n  \t\t\tto = style;\n\n  \t\t\t// shuffle arguments\n  \t\t\toptions = value;\n  \t\t}\n\n  \t\t// As of 0.3.9, transition authors should supply an `option` object with\n  \t\t// `duration` and `easing` properties (and optional `delay`), plus a\n  \t\t// callback function that gets called after the animation completes\n\n  \t\t// TODO remove this check in a future version\n  \t\tif (!options) {\n  \t\t\twarnOnceIfDebug('The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name);\n  \t\t\toptions = this;\n  \t\t}\n\n  \t\treturn new Promise$1(function (fulfil) {\n  \t\t\t// Edge case - if duration is zero, set style synchronously and complete\n  \t\t\tif (!options.duration) {\n  \t\t\t\t_this.setStyle(to);\n  \t\t\t\tfulfil();\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\t// Get a list of the properties we're animating\n  \t\t\tvar propertyNames = Object.keys(to);\n  \t\t\tvar changedProperties = [];\n\n  \t\t\t// Store the current styles\n  \t\t\tvar computedStyle = getComputedStyle(_this.node);\n\n  \t\t\tvar i = propertyNames.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tvar prop = propertyNames[i];\n  \t\t\t\tvar current = computedStyle[prefix$1(prop)];\n\n  \t\t\t\tif (current === '0px') current = 0;\n\n  \t\t\t\t// we need to know if we're actually changing anything\n  \t\t\t\tif (current != to[prop]) {\n  \t\t\t\t\t// use != instead of !==, so we can compare strings with numbers\n  \t\t\t\t\tchangedProperties.push(prop);\n\n  \t\t\t\t\t// make the computed style explicit, so we can animate where\n  \t\t\t\t\t// e.g. height='auto'\n  \t\t\t\t\t_this.node.style[prefix$1(prop)] = current;\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\t// If we're not actually changing anything, the transitionend event\n  \t\t\t// will never fire! So we complete early\n  \t\t\tif (!changedProperties.length) {\n  \t\t\t\tfulfil();\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tcreateTransitions$1(_this, to, options, changedProperties, fulfil);\n  \t\t});\n  \t};\n\n  \tTransition.prototype.getStyle = function getStyle(props) {\n  \t\tvar computedStyle = getComputedStyle(this.node);\n\n  \t\tif (typeof props === 'string') {\n  \t\t\tvar value = computedStyle[prefix$1(props)];\n  \t\t\treturn value === '0px' ? 0 : value;\n  \t\t}\n\n  \t\tif (!isArray(props)) {\n  \t\t\tthrow new Error('Transition$getStyle must be passed a string, or an array of strings representing CSS properties');\n  \t\t}\n\n  \t\tvar styles = {};\n\n  \t\tvar i = props.length;\n  \t\twhile (i--) {\n  \t\t\tvar prop = props[i];\n  \t\t\tvar _value = computedStyle[prefix$1(prop)];\n\n  \t\t\tif (_value === '0px') _value = 0;\n  \t\t\tstyles[prop] = _value;\n  \t\t}\n\n  \t\treturn styles;\n  \t};\n\n  \tTransition.prototype.processParams = function processParams(params, defaults) {\n  \t\tif (typeof params === 'number') {\n  \t\t\tparams = { duration: params };\n  \t\t} else if (typeof params === 'string') {\n  \t\t\tif (params === 'slow') {\n  \t\t\t\tparams = { duration: 600 };\n  \t\t\t} else if (params === 'fast') {\n  \t\t\t\tparams = { duration: 200 };\n  \t\t\t} else {\n  \t\t\t\tparams = { duration: 400 };\n  \t\t\t}\n  \t\t} else if (!params) {\n  \t\t\tparams = {};\n  \t\t}\n\n  \t\treturn extendObj({}, defaults, params);\n  \t};\n\n  \tTransition.prototype.setStyle = function setStyle(style, value) {\n  \t\tif (typeof style === 'string') {\n  \t\t\tthis.node.style[prefix$1(style)] = value;\n  \t\t} else {\n  \t\t\tvar prop = void 0;\n  \t\t\tfor (prop in style) {\n  \t\t\t\tif (style.hasOwnProperty(prop)) {\n  \t\t\t\t\tthis.node.style[prefix$1(prop)] = style[prop];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn this;\n  \t};\n\n  \tTransition.prototype.start = function start() {\n  \t\tvar _this2 = this;\n\n  \t\tvar node = this.node;\n  \t\tvar originalStyle = node.getAttribute('style');\n\n  \t\tvar completed = void 0;\n\n  \t\t// create t.complete() - we don't want this on the prototype,\n  \t\t// because we don't want `this` silliness when passing it as\n  \t\t// an argument\n  \t\tthis.complete = function (noReset) {\n  \t\t\tif (completed) {\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tif (!noReset && _this2.eventName === 'intro') {\n  \t\t\t\tresetStyle(node, originalStyle);\n  \t\t\t}\n\n  \t\t\t_this2._manager.remove(_this2);\n\n  \t\t\tcompleted = true;\n  \t\t};\n\n  \t\t// If the transition function doesn't exist, abort\n  \t\tif (!this._fn) {\n  \t\t\tthis.complete();\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar promise = this._fn.apply(this.ractive, [this].concat(this.params));\n  \t\tif (promise) promise.then(this.complete);\n  \t};\n\n  \treturn Transition;\n  }();\n\n  function updateLiveQueries$1(element) {\n  \t// Does this need to be added to any live queries?\n  \tvar node = element.node;\n  \tvar instance = element.ractive;\n\n  \tdo {\n  \t\tvar liveQueries = instance._liveQueries;\n\n  \t\tvar i = liveQueries.length;\n  \t\twhile (i--) {\n  \t\t\tvar selector = liveQueries[i];\n  \t\t\tvar query = liveQueries[\"_\" + selector];\n\n  \t\t\tif (query.test(node)) {\n  \t\t\t\tquery.add(node);\n  \t\t\t\t// keep register of applicable selectors, for when we teardown\n  \t\t\t\telement.liveQueries.push(query);\n  \t\t\t}\n  \t\t}\n  \t} while (instance = instance.parent);\n  }\n\n  // TODO element.parent currently undefined\n  function findParentForm(element) {\n  \twhile (element = element.parent) {\n  \t\tif (element.name === 'form') {\n  \t\t\treturn element;\n  \t\t}\n  \t}\n  }\n\n  function warnAboutAmbiguity(description, ractive) {\n  \twarnOnceIfDebug('The ' + description + ' being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity', { ractive: ractive });\n  }\n\n  var Binding = function () {\n  \tfunction Binding(element) {\n  \t\tvar name = arguments.length <= 1 || arguments[1] === undefined ? 'value' : arguments[1];\n  \t\tbabelHelpers.classCallCheck(this, Binding);\n\n  \t\tthis.element = element;\n  \t\tthis.ractive = element.ractive;\n  \t\tthis.attribute = element.attributeByName[name];\n\n  \t\tvar interpolator = this.attribute.interpolator;\n  \t\tinterpolator.twowayBinding = this;\n\n  \t\tvar model = interpolator.model;\n\n  \t\t// not bound?\n  \t\tif (!model) {\n  \t\t\t// try to force resolution\n  \t\t\tinterpolator.resolver.forceResolution();\n  \t\t\tmodel = interpolator.model;\n\n  \t\t\twarnAboutAmbiguity('\\'' + interpolator.template.r + '\\' reference', this.ractive);\n  \t\t} else if (model.isUnresolved) {\n  \t\t\t// reference expressions (e.g. foo[bar])\n  \t\t\tmodel.forceResolution();\n  \t\t\twarnAboutAmbiguity('expression', this.ractive);\n  \t\t}\n\n  \t\t// TODO include index/key/keypath refs as read-only\n  \t\telse if (model.isReadonly) {\n  \t\t\t\tvar keypath = model.getKeypath().replace(/^@/, '');\n  \t\t\t\twarnOnceIfDebug('Cannot use two-way binding on <' + element.name + '> element: ' + keypath + ' is read-only. To suppress this warning use <' + element.name + ' twoway=\\'false\\'...>', { ractive: this.ractive });\n  \t\t\t\treturn false;\n  \t\t\t}\n\n  \t\tthis.attribute.isTwoway = true;\n  \t\tthis.model = model;\n\n  \t\t// initialise value, if it's undefined\n  \t\tvar value = model.get();\n  \t\tthis.wasUndefined = value === undefined;\n\n  \t\tif (value === undefined && this.getInitialValue) {\n  \t\t\tvalue = this.getInitialValue();\n  \t\t\tmodel.set(value);\n  \t\t}\n\n  \t\tvar parentForm = findParentForm(element);\n  \t\tif (parentForm) {\n  \t\t\tthis.resetValue = value;\n  \t\t\tparentForm.formBindings.push(this);\n  \t\t}\n  \t}\n\n  \tBinding.prototype.bind = function bind() {\n  \t\tthis.model.registerTwowayBinding(this);\n  \t};\n\n  \tBinding.prototype.handleChange = function handleChange() {\n  \t\tvar _this = this;\n\n  \t\trunloop.start(this.root);\n  \t\tthis.attribute.locked = true;\n  \t\tthis.model.set(this.getValue());\n  \t\trunloop.scheduleTask(function () {\n  \t\t\treturn _this.attribute.locked = false;\n  \t\t});\n  \t\trunloop.end();\n  \t};\n\n  \tBinding.prototype.rebind = function rebind() {\n  \t\t// TODO what does this work with CheckboxNameBinding et al?\n  \t\tthis.unbind();\n  \t\tthis.model = this.attribute.interpolator.model;\n  \t\tthis.bind();\n  \t};\n\n  \tBinding.prototype.render = function render() {\n  \t\tthis.node = this.element.node;\n  \t\tthis.node._ractive.binding = this;\n  \t\tthis.rendered = true; // TODO is this used anywhere?\n  \t};\n\n  \tBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.value);\n  \t};\n\n  \tBinding.prototype.unbind = function unbind() {\n  \t\tthis.model.unregisterTwowayBinding(this);\n  \t};\n\n  \tBinding.prototype.unrender = function unrender() {\n  \t\t// noop?\n  \t};\n\n  \treturn Binding;\n  }();\n\n  // This is the handler for DOM events that would lead to a change in the model\n  // (i.e. change, sometimes, input, and occasionally click and keyup)\n  function handleDomEvent() {\n  \tthis._ractive.binding.handleChange();\n  }\n\n  var CheckboxBinding = function (_Binding) {\n  \tbabelHelpers.inherits(CheckboxBinding, _Binding);\n\n  \tfunction CheckboxBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, CheckboxBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'checked'));\n  \t}\n\n  \tCheckboxBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (this.node.attachEvent) {\n  \t\t\tthis.node.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tCheckboxBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t\tthis.node.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \tCheckboxBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn !!this.element.getAttribute('checked');\n  \t};\n\n  \tCheckboxBinding.prototype.getValue = function getValue() {\n  \t\treturn this.node.checked;\n  \t};\n\n  \tCheckboxBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.checked);\n  \t};\n\n  \treturn CheckboxBinding;\n  }(Binding);\n\n  function getBindingGroup(group, model, getValue) {\n  \tvar hash = group + '-bindingGroup';\n  \treturn model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n  }\n\n  var BindingGroup = function () {\n  \tfunction BindingGroup(hash, model, getValue) {\n  \t\tvar _this = this;\n\n  \t\tbabelHelpers.classCallCheck(this, BindingGroup);\n\n  \t\tthis.model = model;\n  \t\tthis.hash = hash;\n  \t\tthis.getValue = function () {\n  \t\t\t_this.value = getValue.call(_this);\n  \t\t\treturn _this.value;\n  \t\t};\n\n  \t\tthis.bindings = [];\n  \t}\n\n  \tBindingGroup.prototype.add = function add(binding) {\n  \t\tthis.bindings.push(binding);\n  \t};\n\n  \tBindingGroup.prototype.bind = function bind() {\n  \t\tthis.value = this.model.get();\n  \t\tthis.model.registerTwowayBinding(this);\n  \t\tthis.bound = true;\n  \t};\n\n  \tBindingGroup.prototype.remove = function remove(binding) {\n  \t\tremoveFromArray(this.bindings, binding);\n  \t\tif (!this.bindings.length) {\n  \t\t\tthis.unbind();\n  \t\t}\n  \t};\n\n  \tBindingGroup.prototype.unbind = function unbind() {\n  \t\tthis.model.unregisterTwowayBinding(this);\n  \t\tthis.bound = false;\n  \t\tdelete this.model[this.hash];\n  \t};\n\n  \treturn BindingGroup;\n  }();\n\n  var push$1 = [].push;\n\n  function getValue$1() {\n  \tvar all = this.bindings.filter(function (b) {\n  \t\treturn b.node && b.node.checked;\n  \t}).map(function (b) {\n  \t\treturn b.element.getAttribute('value');\n  \t});\n  \tvar res = [];\n  \tall.forEach(function (v) {\n  \t\tif (!arrayContains(res, v)) res.push(v);\n  \t});\n  \treturn res;\n  }\n\n  var CheckboxNameBinding = function (_Binding) {\n  \tbabelHelpers.inherits(CheckboxNameBinding, _Binding);\n\n  \tfunction CheckboxNameBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, CheckboxNameBinding);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'name'));\n\n  \t\t_this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n  \t\t// Each input has a reference to an array containing it and its\n  \t\t// group, as two-way binding depends on being able to ascertain\n  \t\t// the status of all inputs within the group\n  \t\t_this.group = getBindingGroup('checkboxes', _this.model, getValue$1);\n  \t\t_this.group.add(_this);\n\n  \t\tif (_this.noInitialValue) {\n  \t\t\t_this.group.noInitialValue = true;\n  \t\t}\n\n  \t\t// If no initial value was set, and this input is checked, we\n  \t\t// update the model\n  \t\tif (_this.group.noInitialValue && _this.element.getAttribute('checked')) {\n  \t\t\tvar existingValue = _this.model.get();\n  \t\t\tvar bindingValue = _this.element.getAttribute('value');\n\n  \t\t\tif (!arrayContains(existingValue, bindingValue)) {\n  \t\t\t\tpush$1.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n  \t\t\t}\n  \t\t}\n  \t\treturn _this;\n  \t}\n\n  \tCheckboxNameBinding.prototype.bind = function bind() {\n  \t\tif (!this.group.bound) {\n  \t\t\tthis.group.bind();\n  \t\t}\n  \t};\n\n  \tCheckboxNameBinding.prototype.changed = function changed() {\n  \t\tvar wasChecked = !!this.isChecked;\n  \t\tthis.isChecked = this.node.checked;\n  \t\treturn this.isChecked === wasChecked;\n  \t};\n\n  \tCheckboxNameBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\t// This only gets called once per group (of inputs that\n  \t\t// share a name), because it only gets called if there\n  \t\t// isn't an initial value. By the same token, we can make\n  \t\t// a note of that fact that there was no initial value,\n  \t\t// and populate it using any `checked` attributes that\n  \t\t// exist (which users should avoid, but which we should\n  \t\t// support anyway to avoid breaking expectations)\n  \t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n  \t\treturn [];\n  \t};\n\n  \tCheckboxNameBinding.prototype.getValue = function getValue() {\n  \t\treturn this.group.value;\n  \t};\n\n  \tCheckboxNameBinding.prototype.handleChange = function handleChange() {\n  \t\tthis.isChecked = this.element.node.checked;\n  \t\tthis.group.value = this.model.get();\n  \t\tvar value = this.element.getAttribute('value');\n  \t\tif (this.isChecked && !arrayContains(this.group.value, value)) {\n  \t\t\tthis.group.value.push(value);\n  \t\t} else if (!this.isChecked && arrayContains(this.group.value, value)) {\n  \t\t\tremoveFromArray(this.group.value, value);\n  \t\t}\n  \t\t_Binding.prototype.handleChange.call(this);\n  \t};\n\n  \tCheckboxNameBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tvar node = this.node;\n\n  \t\tvar existingValue = this.model.get();\n  \t\tvar bindingValue = this.element.getAttribute('value');\n\n  \t\tif (isArray(existingValue)) {\n  \t\t\tthis.isChecked = arrayContains(existingValue, bindingValue);\n  \t\t} else {\n  \t\t\tthis.isChecked = existingValue == bindingValue;\n  \t\t}\n\n  \t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n  \t\tnode.checked = this.isChecked;\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n\n  \t\t// in case of IE emergency, bind to click event as well\n  \t\tif (node.attachEvent) {\n  \t\t\tnode.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tCheckboxNameBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.group.bindings.forEach(function (binding) {\n  \t\t\treturn binding.wasUndefined = true;\n  \t\t});\n\n  \t\tif (node.checked) {\n  \t\t\tvar valueSoFar = this.group.getValue();\n  \t\t\tvalueSoFar.push(this.element.getAttribute('value'));\n\n  \t\t\tthis.group.model.set(valueSoFar);\n  \t\t}\n  \t};\n\n  \tCheckboxNameBinding.prototype.unbind = function unbind() {\n  \t\tthis.group.remove(this);\n  \t};\n\n  \tCheckboxNameBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.element.node;\n\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \treturn CheckboxNameBinding;\n  }(Binding);\n\n  var ContentEditableBinding = function (_Binding) {\n  \tbabelHelpers.inherits(ContentEditableBinding, _Binding);\n\n  \tfunction ContentEditableBinding() {\n  \t\tbabelHelpers.classCallCheck(this, ContentEditableBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tContentEditableBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n  \t};\n\n  \tContentEditableBinding.prototype.getValue = function getValue() {\n  \t\treturn this.element.node.innerHTML;\n  \t};\n\n  \tContentEditableBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tvar node = this.node;\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n  \t\tnode.addEventListener('blur', handleDomEvent, false);\n\n  \t\tif (!this.ractive.lazy) {\n  \t\t\tnode.addEventListener('input', handleDomEvent, false);\n\n  \t\t\tif (node.attachEvent) {\n  \t\t\t\tnode.addEventListener('keyup', handleDomEvent, false);\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tContentEditableBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.innerHTML);\n  \t};\n\n  \tContentEditableBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.node;\n\n  \t\tnode.removeEventListener('blur', handleDomEvent, false);\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('input', handleDomEvent, false);\n  \t\tnode.removeEventListener('keyup', handleDomEvent, false);\n  \t};\n\n  \treturn ContentEditableBinding;\n  }(Binding);\n\n  function handleBlur() {\n  \thandleDomEvent.call(this);\n\n  \tvar value = this._ractive.binding.model.get();\n  \tthis.value = value == undefined ? '' : value;\n  }\n\n  function handleDelay(delay) {\n  \tvar timeout = void 0;\n\n  \treturn function () {\n  \t\tvar _this = this;\n\n  \t\tif (timeout) clearTimeout(timeout);\n\n  \t\ttimeout = setTimeout(function () {\n  \t\t\tvar binding = _this._ractive.binding;\n  \t\t\tif (binding.rendered) handleDomEvent.call(_this);\n  \t\t\ttimeout = null;\n  \t\t}, delay);\n  \t};\n  }\n\n  var GenericBinding = function (_Binding) {\n  \tbabelHelpers.inherits(GenericBinding, _Binding);\n\n  \tfunction GenericBinding() {\n  \t\tbabelHelpers.classCallCheck(this, GenericBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tGenericBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn '';\n  \t};\n\n  \tGenericBinding.prototype.getValue = function getValue() {\n  \t\treturn this.node.value;\n  \t};\n\n  \tGenericBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\t// any lazy setting for this element overrides the root\n  \t\t// if the value is a number, it's a timeout\n  \t\tvar lazy = this.ractive.lazy;\n  \t\tvar timeout = false;\n\n  \t\t// TODO handle at parse time\n  \t\tif (this.element.template.a && 'lazy' in this.element.template.a) {\n  \t\t\tlazy = this.element.template.a.lazy;\n  \t\t\tif (lazy === 0) lazy = true; // empty attribute\n  \t\t}\n\n  \t\t// TODO handle this at parse time as well?\n  \t\tif (lazy === 'false') lazy = false;\n\n  \t\tif (isNumeric(lazy)) {\n  \t\t\ttimeout = +lazy;\n  \t\t\tlazy = false;\n  \t\t}\n\n  \t\tthis.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n  \t\tvar node = this.node;\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (!lazy) {\n  \t\t\tnode.addEventListener('input', this.handler, false);\n\n  \t\t\tif (node.attachEvent) {\n  \t\t\t\tnode.addEventListener('keyup', this.handler, false);\n  \t\t\t}\n  \t\t}\n\n  \t\tnode.addEventListener('blur', handleBlur, false);\n  \t};\n\n  \tGenericBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.element.node;\n  \t\tthis.rendered = false;\n\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('input', this.handler, false);\n  \t\tnode.removeEventListener('keyup', this.handler, false);\n  \t\tnode.removeEventListener('blur', handleBlur, false);\n  \t};\n\n  \treturn GenericBinding;\n  }(Binding);\n\n  function getSelectedOptions(select) {\n  \treturn select.selectedOptions ? toArray(select.selectedOptions) : select.options ? toArray(select.options).filter(function (option) {\n  \t\treturn option.selected;\n  \t}) : [];\n  }\n\n  var MultipleSelectBinding = function (_Binding) {\n  \tbabelHelpers.inherits(MultipleSelectBinding, _Binding);\n\n  \tfunction MultipleSelectBinding() {\n  \t\tbabelHelpers.classCallCheck(this, MultipleSelectBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tMultipleSelectBinding.prototype.forceUpdate = function forceUpdate() {\n  \t\tvar _this2 = this;\n\n  \t\tvar value = this.getValue();\n\n  \t\tif (value !== undefined) {\n  \t\t\tthis.attribute.locked = true;\n  \t\t\trunloop.scheduleTask(function () {\n  \t\t\t\treturn _this2.attribute.locked = false;\n  \t\t\t});\n  \t\t\tthis.model.set(value);\n  \t\t}\n  \t};\n\n  \tMultipleSelectBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn this.element.options.filter(function (option) {\n  \t\t\treturn option.getAttribute('selected');\n  \t\t}).map(function (option) {\n  \t\t\treturn option.getAttribute('value');\n  \t\t});\n  \t};\n\n  \tMultipleSelectBinding.prototype.getValue = function getValue() {\n  \t\tvar options = this.element.node.options;\n  \t\tvar len = options.length;\n\n  \t\tvar selectedValues = [];\n\n  \t\tfor (var i = 0; i < len; i += 1) {\n  \t\t\tvar option = options[i];\n\n  \t\t\tif (option.selected) {\n  \t\t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value;\n  \t\t\t\tselectedValues.push(optionValue);\n  \t\t\t}\n  \t\t}\n\n  \t\treturn selectedValues;\n  \t};\n\n  \tMultipleSelectBinding.prototype.handleChange = function handleChange() {\n  \t\tvar attribute = this.attribute;\n  \t\tvar previousValue = attribute.getValue();\n\n  \t\tvar value = this.getValue();\n\n  \t\tif (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n  \t\t\t_Binding.prototype.handleChange.call(this);\n  \t\t}\n\n  \t\treturn this;\n  \t};\n\n  \tMultipleSelectBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (this.model.get() === undefined) {\n  \t\t\t// get value from DOM, if possible\n  \t\t\tthis.handleChange();\n  \t\t}\n  \t};\n\n  \tMultipleSelectBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tvar selectedOptions = getSelectedOptions(node);\n  \t\tvar i = selectedOptions.length;\n  \t\tvar result = new Array(i);\n\n  \t\twhile (i--) {\n  \t\t\tvar option = selectedOptions[i];\n  \t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\n  \t\t}\n\n  \t\tthis.model.set(result);\n  \t};\n\n  \tMultipleSelectBinding.prototype.setValue = function setValue() {\n  \t\tthrow new Error('TODO not implemented yet');\n  \t};\n\n  \tMultipleSelectBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t};\n\n  \tMultipleSelectBinding.prototype.updateModel = function updateModel() {\n  \t\tif (this.attribute.value === undefined || !this.attribute.value.length) {\n  \t\t\tthis.keypath.set(this.initialValue);\n  \t\t}\n  \t};\n\n  \treturn MultipleSelectBinding;\n  }(Binding);\n\n  var NumericBinding = function (_GenericBinding) {\n  \tbabelHelpers.inherits(NumericBinding, _GenericBinding);\n\n  \tfunction NumericBinding() {\n  \t\tbabelHelpers.classCallCheck(this, NumericBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _GenericBinding.apply(this, arguments));\n  \t}\n\n  \tNumericBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn undefined;\n  \t};\n\n  \tNumericBinding.prototype.getValue = function getValue() {\n  \t\tvar value = parseFloat(this.node.value);\n  \t\treturn isNaN(value) ? undefined : value;\n  \t};\n\n  \tNumericBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tvar value = parseFloat(node.value);\n  \t\tif (!isNaN(value)) this.model.set(value);\n  \t};\n\n  \treturn NumericBinding;\n  }(GenericBinding);\n\n  var siblings = {};\n\n  function getSiblings(hash) {\n  \treturn siblings[hash] || (siblings[hash] = []);\n  }\n\n  var RadioBinding = function (_Binding) {\n  \tbabelHelpers.inherits(RadioBinding, _Binding);\n\n  \tfunction RadioBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, RadioBinding);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'checked'));\n\n  \t\t_this.siblings = getSiblings(_this.ractive._guid + _this.element.getAttribute('name'));\n  \t\t_this.siblings.push(_this);\n  \t\treturn _this;\n  \t}\n\n  \tRadioBinding.prototype.getValue = function getValue() {\n  \t\treturn this.node.checked;\n  \t};\n\n  \tRadioBinding.prototype.handleChange = function handleChange() {\n  \t\trunloop.start(this.root);\n\n  \t\tthis.siblings.forEach(function (binding) {\n  \t\t\tbinding.model.set(binding.getValue());\n  \t\t});\n\n  \t\trunloop.end();\n  \t};\n\n  \tRadioBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (this.node.attachEvent) {\n  \t\t\tthis.node.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tRadioBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.checked);\n  \t};\n\n  \tRadioBinding.prototype.unbind = function unbind() {\n  \t\tremoveFromArray(this.siblings, this);\n  \t};\n\n  \tRadioBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t\tthis.node.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \treturn RadioBinding;\n  }(Binding);\n\n  function getValue$2() {\n  \tvar checked = this.bindings.filter(function (b) {\n  \t\treturn b.node.checked;\n  \t});\n  \tif (checked.length > 0) {\n  \t\treturn checked[0].element.getAttribute('value');\n  \t}\n  }\n\n  var RadioNameBinding = function (_Binding) {\n  \tbabelHelpers.inherits(RadioNameBinding, _Binding);\n\n  \tfunction RadioNameBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, RadioNameBinding);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'name'));\n\n  \t\t_this.group = getBindingGroup('radioname', _this.model, getValue$2);\n  \t\t_this.group.add(_this);\n\n  \t\tif (element.checked) {\n  \t\t\t_this.group.value = _this.getValue();\n  \t\t}\n  \t\treturn _this;\n  \t}\n\n  \tRadioNameBinding.prototype.bind = function bind() {\n  \t\tvar _this2 = this;\n\n  \t\tif (!this.group.bound) {\n  \t\t\tthis.group.bind();\n  \t\t}\n\n  \t\t// update name keypath when necessary\n  \t\tthis.nameAttributeBinding = {\n  \t\t\thandleChange: function handleChange() {\n  \t\t\t\treturn _this2.node.name = '{{' + _this2.model.getKeypath() + '}}';\n  \t\t\t}\n  \t\t};\n\n  \t\tthis.model.getKeypathModel().register(this.nameAttributeBinding);\n  \t};\n\n  \tRadioNameBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\tif (this.element.getAttribute('checked')) {\n  \t\t\treturn this.element.getAttribute('value');\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.getValue = function getValue() {\n  \t\treturn this.element.getAttribute('value');\n  \t};\n\n  \tRadioNameBinding.prototype.handleChange = function handleChange() {\n  \t\t// If this <input> is the one that's checked, then the value of its\n  \t\t// `name` model gets set to its value\n  \t\tif (this.node.checked) {\n  \t\t\tthis.group.value = this.getValue();\n  \t\t\t_Binding.prototype.handleChange.call(this);\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tvar node = this.node;\n\n  \t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n  \t\tnode.checked = this.model.get() == this.element.getAttribute('value');\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (node.attachEvent) {\n  \t\t\tnode.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tif (node.checked) {\n  \t\t\tthis.group.model.set(this.element.getAttribute('value'));\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.unbind = function unbind() {\n  \t\tthis.group.remove(this);\n\n  \t\tthis.model.getKeypathModel().unregister(this.nameAttributeBinding);\n  \t};\n\n  \tRadioNameBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.node;\n\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \treturn RadioNameBinding;\n  }(Binding);\n\n  var SingleSelectBinding = function (_Binding) {\n  \tbabelHelpers.inherits(SingleSelectBinding, _Binding);\n\n  \tfunction SingleSelectBinding() {\n  \t\tbabelHelpers.classCallCheck(this, SingleSelectBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tSingleSelectBinding.prototype.forceUpdate = function forceUpdate() {\n  \t\tvar _this2 = this;\n\n  \t\tvar value = this.getValue();\n\n  \t\tif (value !== undefined) {\n  \t\t\tthis.attribute.locked = true;\n  \t\t\trunloop.scheduleTask(function () {\n  \t\t\t\treturn _this2.attribute.locked = false;\n  \t\t\t});\n  \t\t\tthis.model.set(value);\n  \t\t}\n  \t};\n\n  \tSingleSelectBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\tif (this.element.getAttribute('value') !== undefined) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar options = this.element.options;\n  \t\tvar len = options.length;\n\n  \t\tif (!len) return;\n\n  \t\tvar value = void 0;\n  \t\tvar optionWasSelected = void 0;\n  \t\tvar i = len;\n\n  \t\t// take the final selected option...\n  \t\twhile (i--) {\n  \t\t\tvar option = options[i];\n\n  \t\t\tif (option.getAttribute('selected')) {\n  \t\t\t\tif (!option.getAttribute('disabled')) {\n  \t\t\t\t\tvalue = option.getAttribute('value');\n  \t\t\t\t}\n\n  \t\t\t\toptionWasSelected = true;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n\n  \t\t// or the first non-disabled option, if none are selected\n  \t\tif (!optionWasSelected) {\n  \t\t\twhile (++i < len) {\n  \t\t\t\tif (!options[i].getAttribute('disabled')) {\n  \t\t\t\t\tvalue = options[i].getAttribute('value');\n  \t\t\t\t\tbreak;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\t// This is an optimisation (aka hack) that allows us to forgo some\n  \t\t// other more expensive work\n  \t\t// TODO does it still work? seems at odds with new architecture\n  \t\tif (value !== undefined) {\n  \t\t\tthis.element.attributeByName.value.value = value;\n  \t\t}\n\n  \t\treturn value;\n  \t};\n\n  \tSingleSelectBinding.prototype.getValue = function getValue() {\n  \t\tvar options = this.node.options;\n  \t\tvar len = options.length;\n\n  \t\tvar i = void 0;\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar option = options[i];\n\n  \t\t\tif (options[i].selected && !options[i].disabled) {\n  \t\t\t\treturn option._ractive ? option._ractive.value : option.value;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tSingleSelectBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n  \t};\n\n  \tSingleSelectBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tvar option = getSelectedOptions(node)[0];\n  \t\tthis.model.set(option._ractive ? option._ractive.value : option.value);\n  \t};\n\n  \t// TODO this method is an anomaly... is it necessary?\n\n\n  \tSingleSelectBinding.prototype.setValue = function setValue(value) {\n  \t\tthis.model.set(value);\n  \t};\n\n  \tSingleSelectBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t};\n\n  \treturn SingleSelectBinding;\n  }(Binding);\n\n  function isBindable(attribute) {\n  \treturn attribute && attribute.template.length === 1 && attribute.template[0].t === INTERPOLATOR && !attribute.template[0].s;\n  }\n\n  function selectBinding(element) {\n  \tvar attributes = element.attributeByName;\n\n  \t// contenteditable - bind if the contenteditable attribute is true\n  \t// or is bindable and may thus become true...\n  \tif (element.getAttribute('contenteditable') || isBindable(attributes.contenteditable)) {\n  \t\t// ...and this element also has a value attribute to bind\n  \t\treturn isBindable(attributes.value) ? ContentEditableBinding : null;\n  \t}\n\n  \t// <input>\n  \tif (element.name === 'input') {\n  \t\tvar type = element.getAttribute('type');\n\n  \t\tif (type === 'radio' || type === 'checkbox') {\n  \t\t\tvar bindName = isBindable(attributes.name);\n  \t\t\tvar bindChecked = isBindable(attributes.checked);\n\n  \t\t\t// for radios we can either bind the name attribute, or the checked attribute - not both\n  \t\t\tif (bindName && bindChecked) {\n  \t\t\t\tif (type === 'radio') {\n  \t\t\t\t\twarnIfDebug('A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n  \t\t\t\t} else {\n  \t\t\t\t\t// A checkbox with bindings for both name and checked - see https://github.com/ractivejs/ractive/issues/1749\n  \t\t\t\t\treturn CheckboxBinding;\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tif (bindName) {\n  \t\t\t\treturn type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n  \t\t\t}\n\n  \t\t\tif (bindChecked) {\n  \t\t\t\treturn type === 'radio' ? RadioBinding : CheckboxBinding;\n  \t\t\t}\n  \t\t}\n\n  \t\tif (type === 'file' && isBindable(attributes.value)) {\n  \t\t\treturn Binding;\n  \t\t}\n\n  \t\tif (isBindable(attributes.value)) {\n  \t\t\treturn type === 'number' || type === 'range' ? NumericBinding : GenericBinding;\n  \t\t}\n\n  \t\treturn null;\n  \t}\n\n  \t// <select>\n  \tif (element.name === 'select' && isBindable(attributes.value)) {\n  \t\treturn element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  \t}\n\n  \t// <textarea>\n  \tif (element.name === 'textarea' && isBindable(attributes.value)) {\n  \t\treturn GenericBinding;\n  \t}\n  }\n\n  function makeDirty$1(query) {\n  \tquery.makeDirty();\n  }\n\n  var Element = function (_Item) {\n  \tbabelHelpers.inherits(Element, _Item);\n\n  \tfunction Element(options) {\n  \t\tbabelHelpers.classCallCheck(this, Element);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.liveQueries = []; // TODO rare case. can we handle differently?\n\n  \t\t_this.name = options.template.e.toLowerCase();\n  \t\t_this.isVoid = voidElementNames.test(_this.name);\n\n  \t\t// find parent element\n  \t\tvar fragment = _this.parentFragment;\n  \t\twhile (fragment) {\n  \t\t\tif (fragment.owner.type === ELEMENT) {\n  \t\t\t\t_this.parent = fragment.owner;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n\n  \t\tif (_this.parent && _this.parent.name === 'option') {\n  \t\t\tthrow new Error('An <option> element cannot contain other elements (encountered <' + _this.name + '>)');\n  \t\t}\n\n  \t\t// create attributes\n  \t\t_this.attributeByName = {};\n  \t\t_this.attributes = [];\n\n  \t\tif (_this.template.a) {\n  \t\t\tObject.keys(_this.template.a).forEach(function (name) {\n  \t\t\t\t// TODO process this at parse time\n  \t\t\t\tif (name === 'twoway' || name === 'lazy') return;\n\n  \t\t\t\tvar attribute = new Attribute({\n  \t\t\t\t\tname: name,\n  \t\t\t\t\telement: _this,\n  \t\t\t\t\tparentFragment: _this.parentFragment,\n  \t\t\t\t\ttemplate: _this.template.a[name]\n  \t\t\t\t});\n\n  \t\t\t\t_this.attributeByName[name] = attribute;\n\n  \t\t\t\tif (name !== 'value' && name !== 'type') _this.attributes.push(attribute);\n  \t\t\t});\n\n  \t\t\tif (_this.attributeByName.type) _this.attributes.unshift(_this.attributeByName.type);\n  \t\t\tif (_this.attributeByName.value) _this.attributes.push(_this.attributeByName.value);\n  \t\t}\n\n  \t\t// create conditional attributes\n  \t\t_this.conditionalAttributes = (_this.template.m || []).map(function (template) {\n  \t\t\treturn new ConditionalAttribute({\n  \t\t\t\towner: _this,\n  \t\t\t\tparentFragment: _this.parentFragment,\n  \t\t\t\ttemplate: template\n  \t\t\t});\n  \t\t});\n\n  \t\t// create decorator\n  \t\tif (_this.template.o) {\n  \t\t\t_this.decorator = new Decorator(_this, _this.template.o);\n  \t\t}\n\n  \t\t// attach event handlers\n  \t\t_this.eventHandlers = [];\n  \t\tif (_this.template.v) {\n  \t\t\tObject.keys(_this.template.v).forEach(function (key) {\n  \t\t\t\tvar eventNames = key.split('-');\n  \t\t\t\tvar template = _this.template.v[key];\n\n  \t\t\t\teventNames.forEach(function (eventName) {\n  \t\t\t\t\tvar fn = findInViewHierarchy('events', _this.ractive, eventName);\n  \t\t\t\t\t// we need to pass in \"this\" in order to get\n  \t\t\t\t\t// access to node when it is created.\n  \t\t\t\t\tvar event = fn ? new CustomEvent(fn, _this) : new DOMEvent(eventName, _this);\n  \t\t\t\t\t_this.eventHandlers.push(new EventDirective(_this, event, template));\n  \t\t\t\t});\n  \t\t\t});\n  \t\t}\n\n  \t\t// create children\n  \t\tif (options.template.f && !options.noContent) {\n  \t\t\t_this.fragment = new Fragment({\n  \t\t\t\ttemplate: options.template.f,\n  \t\t\t\towner: _this,\n  \t\t\t\tcssIds: null\n  \t\t\t});\n  \t\t}\n\n  \t\t_this.binding = null; // filled in later\n  \t\treturn _this;\n  \t}\n\n  \tElement.prototype.bind = function bind() {\n  \t\tthis.attributes.forEach(_bind);\n  \t\tthis.conditionalAttributes.forEach(_bind);\n  \t\tthis.eventHandlers.forEach(_bind);\n\n  \t\tif (this.decorator) this.decorator.bind();\n  \t\tif (this.fragment) this.fragment.bind();\n\n  \t\t// create two-way binding if necessary\n  \t\tif (this.binding = this.createTwowayBinding()) this.binding.bind();\n  \t};\n\n  \tElement.prototype.createTwowayBinding = function createTwowayBinding() {\n  \t\tvar attributes = this.template.a;\n\n  \t\tif (!attributes) return null;\n\n  \t\tvar shouldBind = 'twoway' in attributes ? attributes.twoway === 0 || attributes.twoway === 'true' : // covers `twoway` and `twoway='true'`\n  \t\tthis.ractive.twoway;\n\n  \t\tif (!shouldBind) return null;\n\n  \t\tvar Binding = selectBinding(this);\n\n  \t\tif (!Binding) return null;\n\n  \t\tvar binding = new Binding(this);\n\n  \t\treturn binding && binding.model ? binding : null;\n  \t};\n\n  \tElement.prototype.detach = function detach() {\n  \t\tif (this.decorator) this.decorator.unrender();\n  \t\treturn detachNode(this.node);\n  \t};\n\n  \tElement.prototype.find = function find(selector) {\n  \t\tif (matches(this.node, selector)) return this.node;\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.find(selector);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findAll = function findAll(selector, query) {\n  \t\t// Add this node to the query, if applicable, and register the\n  \t\t// query on this element\n  \t\tvar matches = query.test(this.node);\n  \t\tif (matches) {\n  \t\t\tquery.add(this.node);\n  \t\t\tif (query.live) this.liveQueries.push(query);\n  \t\t}\n\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findComponent = function findComponent(name) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findNextNode = function findNextNode() {\n  \t\treturn null;\n  \t};\n\n  \tElement.prototype.firstNode = function firstNode() {\n  \t\treturn this.node;\n  \t};\n\n  \tElement.prototype.getAttribute = function getAttribute(name) {\n  \t\tvar attribute = this.attributeByName[name];\n  \t\treturn attribute ? attribute.getValue() : undefined;\n  \t};\n\n  \tElement.prototype.rebind = function rebind() {\n  \t\tthis.attributes.forEach(_rebind);\n  \t\tthis.conditionalAttributes.forEach(_rebind);\n  \t\tthis.eventHandlers.forEach(_rebind);\n  \t\tif (this.decorator) this.decorator.rebind();\n  \t\tif (this.fragment) this.fragment.rebind();\n  \t\tif (this.binding) this.binding.rebind();\n\n  \t\tthis.liveQueries.forEach(makeDirty$1);\n  \t};\n\n  \tElement.prototype.render = function render(target, occupants) {\n  \t\tvar _this2 = this;\n\n  \t\t// TODO determine correct namespace\n  \t\tthis.namespace = getNamespace(this);\n\n  \t\tvar node = void 0;\n  \t\tvar existing = false;\n\n  \t\tif (occupants) {\n  \t\t\tvar n = void 0;\n  \t\t\twhile (n = occupants.shift()) {\n  \t\t\t\tif (n.nodeName === this.template.e.toUpperCase() && n.namespaceURI === this.namespace) {\n  \t\t\t\t\tthis.node = node = n;\n  \t\t\t\t\texisting = true;\n  \t\t\t\t\tbreak;\n  \t\t\t\t} else {\n  \t\t\t\t\tdetachNode(n);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tif (!node) {\n  \t\t\tnode = createElement(this.template.e, this.namespace, this.getAttribute('is'));\n  \t\t\tthis.node = node;\n  \t\t}\n\n  \t\tdefineProperty(node, '_ractive', {\n  \t\t\tvalue: {\n  \t\t\t\tproxy: this,\n  \t\t\t\tfragment: this.parentFragment\n  \t\t\t}\n  \t\t});\n\n  \t\t// Is this a top-level node of a component? If so, we may need to add\n  \t\t// a data-ractive-css attribute, for CSS encapsulation\n  \t\tif (this.parentFragment.cssIds) {\n  \t\t\tnode.setAttribute('data-ractive-css', this.parentFragment.cssIds.map(function (x) {\n  \t\t\t\treturn '{' + x + '}';\n  \t\t\t}).join(' '));\n  \t\t}\n\n  \t\tif (existing && this.foundNode) this.foundNode(node);\n\n  \t\tif (this.fragment) {\n  \t\t\tvar children = existing ? toArray(node.childNodes) : undefined;\n  \t\t\tthis.fragment.render(node, children);\n\n  \t\t\t// clean up leftover children\n  \t\t\tif (children) {\n  \t\t\t\tchildren.forEach(detachNode);\n  \t\t\t}\n  \t\t}\n\n  \t\tif (existing) {\n  \t\t\t// store initial values for two-way binding\n  \t\t\tif (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n\n  \t\t\t// remove unused attributes\n  \t\t\tvar i = node.attributes.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tvar name = node.attributes[i].name;\n  \t\t\t\tif (!this.template.a || !(name in this.template.a)) node.removeAttribute(name);\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.attributes.forEach(_render);\n  \t\tthis.conditionalAttributes.forEach(_render);\n\n  \t\tif (this.decorator) runloop.scheduleTask(function () {\n  \t\t\treturn _this2.decorator.render();\n  \t\t}, true);\n  \t\tif (this.binding) this.binding.render();\n\n  \t\tthis.eventHandlers.forEach(_render);\n\n  \t\tupdateLiveQueries$1(this);\n\n  \t\t// store so we can abort if it gets removed\n  \t\tthis._introTransition = getTransition(this, this.template.t0 || this.template.t1, 'intro');\n\n  \t\tif (!existing) {\n  \t\t\ttarget.appendChild(node);\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tElement.prototype.toString = function toString() {\n  \t\tvar tagName = this.template.e;\n\n  \t\tvar attrs = this.attributes.map(stringifyAttribute).join('') + this.conditionalAttributes.map(stringifyAttribute).join('');\n\n  \t\t// Special case - selected options\n  \t\tif (this.name === 'option' && this.isSelected()) {\n  \t\t\tattrs += ' selected';\n  \t\t}\n\n  \t\t// Special case - two-way radio name bindings\n  \t\tif (this.name === 'input' && inputIsCheckedRadio(this)) {\n  \t\t\tattrs += ' checked';\n  \t\t}\n\n  \t\tvar str = '<' + tagName + attrs + '>';\n\n  \t\tif (this.isVoid) return str;\n\n  \t\t// Special case - textarea\n  \t\tif (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n  \t\t\tstr += escapeHtml(this.getAttribute('value'));\n  \t\t}\n\n  \t\t// Special case - contenteditable\n  \t\telse if (this.getAttribute('contenteditable') !== undefined) {\n  \t\t\t\tstr += this.getAttribute('value') || '';\n  \t\t\t}\n\n  \t\tif (this.fragment) {\n  \t\t\tstr += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n  \t\t}\n\n  \t\tstr += '</' + tagName + '>';\n  \t\treturn str;\n  \t};\n\n  \tElement.prototype.unbind = function unbind() {\n  \t\tthis.attributes.forEach(_unbind);\n  \t\tthis.conditionalAttributes.forEach(_unbind);\n\n  \t\tif (this.decorator) this.decorator.unbind();\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tElement.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (!this.rendered) return;\n  \t\tthis.rendered = false;\n\n  \t\t// unrendering before intro completed? complete it now\n  \t\t// TODO should be an API for aborting transitions\n  \t\tvar transition = this._introTransition;\n  \t\tif (transition) transition.complete();\n\n  \t\t// Detach as soon as we can\n  \t\tif (this.name === 'option') {\n  \t\t\t// <option> elements detach immediately, so that\n  \t\t\t// their parent <select> element syncs correctly, and\n  \t\t\t// since option elements can't have transitions anyway\n  \t\t\tthis.detach();\n  \t\t} else if (shouldDestroy) {\n  \t\t\trunloop.detachWhenReady(this);\n  \t\t}\n\n  \t\tif (this.fragment) this.fragment.unrender();\n\n  \t\tthis.eventHandlers.forEach(_unrender);\n\n  \t\tif (this.binding) this.binding.unrender();\n  \t\tif (!shouldDestroy && this.decorator) this.decorator.unrender();\n\n  \t\t// outro transition\n  \t\tgetTransition(this, this.template.t0 || this.template.t2, 'outro');\n\n  \t\t// special case\n  \t\tvar id = this.attributeByName.id;\n  \t\tif (id) {\n  \t\t\tdelete this.ractive.nodes[id.getValue()];\n  \t\t}\n\n  \t\tremoveFromLiveQueries(this);\n  \t\t// TODO forms are a special case\n  \t};\n\n  \tElement.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tthis.attributes.forEach(_update);\n  \t\t\tthis.conditionalAttributes.forEach(_update);\n  \t\t\tthis.eventHandlers.forEach(_update);\n\n  \t\t\tif (this.decorator) this.decorator.update();\n  \t\t\tif (this.fragment) this.fragment.update();\n  \t\t}\n  \t};\n\n  \treturn Element;\n  }(Item);\n\n  function getTransition(owner, template, eventName) {\n  \tif (!template || !owner.ractive.transitionsEnabled) return;\n\n  \tvar name = getTransitionName(owner, template);\n  \tif (!name) return;\n\n  \tvar params = getTransitionParams(owner, template);\n  \tvar transition = new Transition(owner.ractive, owner.node, name, params, eventName);\n  \trunloop.registerTransition(transition);\n  \treturn transition;\n  }\n\n  function getTransitionName(owner, template) {\n  \tvar name = template.n || template;\n\n  \tif (typeof name === 'string') return name;\n\n  \tvar fragment = new Fragment({\n  \t\towner: owner,\n  \t\ttemplate: name\n  \t}).bind(); // TODO need a way to capture values without bind()\n\n  \tname = fragment.toString();\n  \tfragment.unbind();\n\n  \treturn name;\n  }\n\n  function getTransitionParams(owner, template) {\n  \tif (template.a) return template.a;\n  \tif (!template.d) return;\n\n  \t// TODO is there a way to interpret dynamic arguments without all the\n  \t// 'dependency thrashing'?\n  \tvar fragment = new Fragment({\n  \t\towner: owner,\n  \t\ttemplate: template.d\n  \t}).bind();\n\n  \tvar params = fragment.getArgsList();\n  \tfragment.unbind();\n\n  \treturn params;\n  }\n\n  function inputIsCheckedRadio(element) {\n  \tvar attributes = element.attributeByName;\n\n  \tvar typeAttribute = attributes.type;\n  \tvar valueAttribute = attributes.value;\n  \tvar nameAttribute = attributes.name;\n\n  \tif (!typeAttribute || typeAttribute.value !== 'radio' || !valueAttribute || !nameAttribute.interpolator) {\n  \t\treturn;\n  \t}\n\n  \tif (valueAttribute.getValue() === nameAttribute.interpolator.model.get()) {\n  \t\treturn true;\n  \t}\n  }\n\n  function stringifyAttribute(attribute) {\n  \tvar str = attribute.toString();\n  \treturn str ? ' ' + str : '';\n  }\n\n  function removeFromLiveQueries(element) {\n  \tvar i = element.liveQueries.length;\n  \twhile (i--) {\n  \t\tvar query = element.liveQueries[i];\n  \t\tquery.remove(element.node);\n  \t}\n  }\n\n  function getNamespace(element) {\n  \t// Use specified namespace...\n  \tvar xmlns = element.getAttribute('xmlns');\n  \tif (xmlns) return xmlns;\n\n  \t// ...or SVG namespace, if this is an <svg> element\n  \tif (element.name === 'svg') return svg$1;\n\n  \tvar parent = element.parent;\n\n  \tif (parent) {\n  \t\t// ...or HTML, if the parent is a <foreignObject>\n  \t\tif (parent.name === 'foreignobject') return html;\n\n  \t\t// ...or inherit from the parent node\n  \t\treturn parent.node.namespaceURI;\n  \t}\n\n  \treturn element.ractive.el.namespaceURI;\n  }\n\n  var Form = function (_Element) {\n  \tbabelHelpers.inherits(Form, _Element);\n\n  \tfunction Form(options) {\n  \t\tbabelHelpers.classCallCheck(this, Form);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Element.call(this, options));\n\n  \t\t_this.formBindings = [];\n  \t\treturn _this;\n  \t}\n\n  \tForm.prototype.render = function render(target, occupants) {\n  \t\t_Element.prototype.render.call(this, target, occupants);\n  \t\tthis.node.addEventListener('reset', handleReset, false);\n  \t};\n\n  \tForm.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.node.removeEventListener('reset', handleReset, false);\n  \t\t_Element.prototype.unrender.call(this, shouldDestroy);\n  \t};\n\n  \treturn Form;\n  }(Element);\n\n  function handleReset() {\n  \tvar element = this._ractive.proxy;\n\n  \trunloop.start();\n  \telement.formBindings.forEach(updateModel);\n  \trunloop.end();\n  }\n\n  function updateModel(binding) {\n  \tbinding.model.set(binding.resetValue);\n  }\n\n  var Mustache = function (_Item) {\n  \tbabelHelpers.inherits(Mustache, _Item);\n\n  \tfunction Mustache(options) {\n  \t\tbabelHelpers.classCallCheck(this, Mustache);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.parentFragment = options.parentFragment;\n  \t\t_this.template = options.template;\n  \t\t_this.index = options.index;\n\n  \t\t_this.isStatic = !!options.template.s;\n\n  \t\t_this.model = null;\n  \t\t_this.dirty = false;\n  \t\treturn _this;\n  \t}\n\n  \tMustache.prototype.bind = function bind() {\n  \t\tvar _this2 = this;\n\n  \t\t// try to find a model for this view\n  \t\tvar model = resolve$1(this.parentFragment, this.template);\n  \t\tvar value = model ? model.get() : undefined;\n\n  \t\tif (this.isStatic) {\n  \t\t\tthis.model = { get: function get() {\n  \t\t\t\t\treturn value;\n  \t\t\t\t} };\n  \t\t\treturn;\n  \t\t}\n\n  \t\tif (model) {\n  \t\t\tmodel.register(this);\n  \t\t\tthis.model = model;\n  \t\t} else {\n  \t\t\tthis.resolver = this.parentFragment.resolve(this.template.r, function (model) {\n  \t\t\t\t_this2.model = model;\n  \t\t\t\tmodel.register(_this2);\n\n  \t\t\t\t_this2.handleChange();\n  \t\t\t\t_this2.resolver = null;\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tMustache.prototype.handleChange = function handleChange() {\n  \t\tthis.bubble();\n  \t};\n\n  \tMustache.prototype.rebind = function rebind() {\n  \t\tif (this.isStatic || !this.model) return;\n\n  \t\tvar model = resolve$1(this.parentFragment, this.template);\n\n  \t\tif (model === this.model) return;\n\n  \t\tthis.model.unregister(this);\n\n  \t\tthis.model = model;\n\n  \t\tif (model) {\n  \t\t\tmodel.register(this);\n  \t\t\tthis.handleChange();\n  \t\t}\n  \t};\n\n  \tMustache.prototype.unbind = function unbind() {\n  \t\tif (!this.isStatic) {\n  \t\t\tthis.model && this.model.unregister(this);\n  \t\t\tthis.model = undefined;\n  \t\t\tthis.resolver && this.resolver.unbind();\n  \t\t}\n  \t};\n\n  \treturn Mustache;\n  }(Item);\n\n  var Interpolator = function (_Mustache) {\n  \tbabelHelpers.inherits(Interpolator, _Mustache);\n\n  \tfunction Interpolator() {\n  \t\tbabelHelpers.classCallCheck(this, Interpolator);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Mustache.apply(this, arguments));\n  \t}\n\n  \tInterpolator.prototype.detach = function detach() {\n  \t\treturn detachNode(this.node);\n  \t};\n\n  \tInterpolator.prototype.firstNode = function firstNode() {\n  \t\treturn this.node;\n  \t};\n\n  \tInterpolator.prototype.getString = function getString() {\n  \t\treturn this.model ? safeToStringValue(this.model.get()) : '';\n  \t};\n\n  \tInterpolator.prototype.render = function render(target, occupants) {\n  \t\tvar value = this.getString();\n\n  \t\tthis.rendered = true;\n\n  \t\tif (occupants) {\n  \t\t\tvar n = occupants[0];\n  \t\t\tif (n && n.nodeType === 3) {\n  \t\t\t\toccupants.shift();\n  \t\t\t\tif (n.nodeValue !== value) {\n  \t\t\t\t\tn.nodeValue = value;\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tn = this.node = doc.createTextNode(value);\n  \t\t\t\tif (occupants[0]) {\n  \t\t\t\t\ttarget.insertBefore(n, occupants[0]);\n  \t\t\t\t} else {\n  \t\t\t\t\ttarget.appendChild(n);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.node = n;\n  \t\t} else {\n  \t\t\tthis.node = doc.createTextNode(value);\n  \t\t\ttarget.appendChild(this.node);\n  \t\t}\n  \t};\n\n  \tInterpolator.prototype.toString = function toString(escape) {\n  \t\tvar string = this.getString();\n  \t\treturn escape ? escapeHtml(string) : string;\n  \t};\n\n  \tInterpolator.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (shouldDestroy) this.detach();\n  \t\tthis.rendered = false;\n  \t};\n\n  \tInterpolator.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tif (this.rendered) {\n  \t\t\t\tthis.node.data = this.getString();\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tInterpolator.prototype.valueOf = function valueOf() {\n  \t\treturn this.model ? this.model.get() : undefined;\n  \t};\n\n  \treturn Interpolator;\n  }(Mustache);\n\n  var Input = function (_Element) {\n  \tbabelHelpers.inherits(Input, _Element);\n\n  \tfunction Input() {\n  \t\tbabelHelpers.classCallCheck(this, Input);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Element.apply(this, arguments));\n  \t}\n\n  \tInput.prototype.render = function render(target, occupants) {\n  \t\t_Element.prototype.render.call(this, target, occupants);\n  \t\tthis.node.defaultValue = this.node.value;\n  \t};\n\n  \treturn Input;\n  }(Element);\n\n  function findParentSelect(element) {\n  \twhile (element) {\n  \t\tif (element.name === 'select') return element;\n  \t\telement = element.parent;\n  \t}\n  }\n\n  var Option = function (_Element) {\n  \tbabelHelpers.inherits(Option, _Element);\n\n  \tfunction Option(options) {\n  \t\tbabelHelpers.classCallCheck(this, Option);\n\n  \t\tvar template = options.template;\n  \t\tif (!template.a) template.a = {};\n\n  \t\t// If the value attribute is missing, use the element's content,\n  \t\t// as long as it isn't disabled\n  \t\tif (template.a.value === undefined && !('disabled' in template.a)) {\n  \t\t\ttemplate.a.value = template.f || '';\n  \t\t}\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Element.call(this, options));\n\n  \t\t_this.select = findParentSelect(_this.parent);\n  \t\treturn _this;\n  \t}\n\n  \tOption.prototype.bind = function bind() {\n  \t\tif (!this.select) {\n  \t\t\t_Element.prototype.bind.call(this);\n  \t\t\treturn;\n  \t\t}\n\n  \t\t// If the select has a value, it overrides the `selected` attribute on\n  \t\t// this option - so we delete the attribute\n  \t\tvar selectedAttribute = this.attributeByName.selected;\n  \t\tif (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n  \t\t\tvar index = this.attributes.indexOf(selectedAttribute);\n  \t\t\tthis.attributes.splice(index, 1);\n  \t\t\tdelete this.attributeByName.selected;\n  \t\t}\n\n  \t\t_Element.prototype.bind.call(this);\n  \t\tthis.select.options.push(this);\n  \t};\n\n  \tOption.prototype.isSelected = function isSelected() {\n  \t\tvar optionValue = this.getAttribute('value');\n\n  \t\tif (optionValue === undefined || !this.select) {\n  \t\t\treturn false;\n  \t\t}\n\n  \t\tvar selectValue = this.select.getAttribute('value');\n\n  \t\tif (selectValue == optionValue) {\n  \t\t\treturn true;\n  \t\t}\n\n  \t\tif (this.select.getAttribute('multiple') && isArray(selectValue)) {\n  \t\t\tvar i = selectValue.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tif (selectValue[i] == optionValue) {\n  \t\t\t\t\treturn true;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tOption.prototype.unbind = function unbind() {\n  \t\t_Element.prototype.unbind.call(this);\n\n  \t\tif (this.select) {\n  \t\t\tremoveFromArray(this.select.options, this);\n  \t\t}\n  \t};\n\n  \treturn Option;\n  }(Element);\n\n  function getPartialTemplate(ractive, name, parentFragment) {\n  \t// If the partial in instance or view heirarchy instances, great\n  \tvar partial = getPartialFromRegistry(ractive, name, parentFragment || {});\n  \tif (partial) return partial;\n\n  \t// Does it exist on the page as a script tag?\n  \tpartial = parser.fromId(name, { noThrow: true });\n  \tif (partial) {\n  \t\t// parse and register to this ractive instance\n  \t\tvar parsed = parser.parseFor(partial, ractive);\n\n  \t\t// register extra partials on the ractive instance if they don't already exist\n  \t\tif (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n  \t\t// register (and return main partial if there are others in the template)\n  \t\treturn ractive.partials[name] = parsed.t;\n  \t}\n  }\n\n  function getPartialFromRegistry(ractive, name, parentFragment) {\n  \t// if there was an instance up-hierarchy, cool\n  \tvar partial = findParentPartial(name, parentFragment.owner);\n  \tif (partial) return partial;\n\n  \t// find first instance in the ractive or view hierarchy that has this partial\n  \tvar instance = findInstance('partials', ractive, name);\n\n  \tif (!instance) {\n  \t\treturn;\n  \t}\n\n  \tpartial = instance.partials[name];\n\n  \t// partial is a function?\n  \tvar fn = void 0;\n  \tif (typeof partial === 'function') {\n  \t\tfn = partial.bind(instance);\n  \t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n  \t\tpartial = fn.call(ractive, parser);\n  \t}\n\n  \tif (!partial && partial !== '') {\n  \t\twarnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', { ractive: ractive });\n  \t\treturn;\n  \t}\n\n  \t// If this was added manually to the registry,\n  \t// but hasn't been parsed, parse it now\n  \tif (!parser.isParsed(partial)) {\n  \t\t// use the parseOptions of the ractive instance on which it was found\n  \t\tvar parsed = parser.parseFor(partial, instance);\n\n  \t\t// Partials cannot contain nested partials!\n  \t\t// TODO add a test for this\n  \t\tif (parsed.p) {\n  \t\t\twarnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive: ractive });\n  \t\t}\n\n  \t\t// if fn, use instance to store result, otherwise needs to go\n  \t\t// in the correct point in prototype chain on instance or constructor\n  \t\tvar target = fn ? instance : findOwner(instance, name);\n\n  \t\t// may be a template with partials, which need to be registered and main template extracted\n  \t\ttarget.partials[name] = partial = parsed.t;\n  \t}\n\n  \t// store for reset\n  \tif (fn) partial._fn = fn;\n\n  \treturn partial.v ? partial.t : partial;\n  }\n\n  function findOwner(ractive, key) {\n  \treturn ractive.partials.hasOwnProperty(key) ? ractive : findConstructor(ractive.constructor, key);\n  }\n\n  function findConstructor(constructor, key) {\n  \tif (!constructor) {\n  \t\treturn;\n  \t}\n  \treturn constructor.partials.hasOwnProperty(key) ? constructor : findConstructor(constructor._Parent, key);\n  }\n\n  function findParentPartial(name, parent) {\n  \tif (parent) {\n  \t\tif (parent.template && parent.template.p && parent.template.p[name]) {\n  \t\t\treturn parent.template.p[name];\n  \t\t} else if (parent.parentFragment && parent.parentFragment.owner) {\n  \t\t\treturn findParentPartial(name, parent.parentFragment.owner);\n  \t\t}\n  \t}\n  }\n\n  var Partial = function (_Mustache) {\n  \tbabelHelpers.inherits(Partial, _Mustache);\n\n  \tfunction Partial() {\n  \t\tbabelHelpers.classCallCheck(this, Partial);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Mustache.apply(this, arguments));\n  \t}\n\n  \tPartial.prototype.bind = function bind() {\n  \t\t// keep track of the reference name for future resets\n  \t\tthis.refName = this.template.r;\n\n  \t\t// name matches take priority over expressions\n  \t\tvar template = this.refName ? getPartialTemplate(this.ractive, this.refName, this.parentFragment) || null : null;\n  \t\tvar templateObj = void 0;\n\n  \t\tif (template) {\n  \t\t\tthis.named = true;\n  \t\t\tthis.setTemplate(this.template.r, template);\n  \t\t}\n\n  \t\tif (!template) {\n  \t\t\t_Mustache.prototype.bind.call(this);\n  \t\t\tif (this.model && (templateObj = this.model.get()) && (typeof templateObj === 'undefined' ? 'undefined' : babelHelpers.typeof(templateObj)) === 'object' && (typeof templateObj.template === 'string' || isArray(templateObj.t))) {\n  \t\t\t\tif (templateObj.template) {\n  \t\t\t\t\ttemplateObj = parsePartial(this.template.r, templateObj.template, this.ractive);\n  \t\t\t\t}\n  \t\t\t\tthis.setTemplate(this.template.r, templateObj.t);\n  \t\t\t} else if ((!this.model || typeof this.model.get() !== 'string') && this.refName) {\n  \t\t\t\tthis.setTemplate(this.refName, template);\n  \t\t\t} else {\n  \t\t\t\tthis.setTemplate(this.model.get());\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\ttemplate: this.partialTemplate\n  \t\t}).bind();\n  \t};\n\n  \tPartial.prototype.detach = function detach() {\n  \t\treturn this.fragment.detach();\n  \t};\n\n  \tPartial.prototype.find = function find(selector) {\n  \t\treturn this.fragment.find(selector);\n  \t};\n\n  \tPartial.prototype.findAll = function findAll(selector, query) {\n  \t\tthis.fragment.findAll(selector, query);\n  \t};\n\n  \tPartial.prototype.findComponent = function findComponent(name) {\n  \t\treturn this.fragment.findComponent(name);\n  \t};\n\n  \tPartial.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tthis.fragment.findAllComponents(name, query);\n  \t};\n\n  \tPartial.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment.firstNode(skipParent);\n  \t};\n\n  \tPartial.prototype.forceResetTemplate = function forceResetTemplate() {\n  \t\tthis.partialTemplate = undefined;\n\n  \t\t// on reset, check for the reference name first\n  \t\tif (this.refName) {\n  \t\t\tthis.partialTemplate = getPartialTemplate(this.ractive, this.refName, this.parentFragment);\n  \t\t}\n\n  \t\t// then look for the resolved name\n  \t\tif (!this.partialTemplate) {\n  \t\t\tthis.partialTemplate = getPartialTemplate(this.ractive, this.name, this.parentFragment);\n  \t\t}\n\n  \t\tif (!this.partialTemplate) {\n  \t\t\twarnOnceIfDebug('Could not find template for partial \\'' + this.name + '\\'');\n  \t\t\tthis.partialTemplate = [];\n  \t\t}\n\n  \t\tthis.fragment.resetTemplate(this.partialTemplate);\n  \t\tthis.bubble();\n  \t};\n\n  \tPartial.prototype.rebind = function rebind() {\n  \t\t_Mustache.prototype.unbind.call(this);\n  \t\t_Mustache.prototype.bind.call(this);\n  \t\tthis.fragment.rebind();\n  \t};\n\n  \tPartial.prototype.render = function render(target, occupants) {\n  \t\tthis.fragment.render(target, occupants);\n  \t};\n\n  \tPartial.prototype.setTemplate = function setTemplate(name, template) {\n  \t\tthis.name = name;\n\n  \t\tif (!template && template !== null) template = getPartialTemplate(this.ractive, name, this.parentFragment);\n\n  \t\tif (!template) {\n  \t\t\twarnOnceIfDebug('Could not find template for partial \\'' + name + '\\'');\n  \t\t}\n\n  \t\tthis.partialTemplate = template || [];\n  \t};\n\n  \tPartial.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment.toString(escape);\n  \t};\n\n  \tPartial.prototype.unbind = function unbind() {\n  \t\t_Mustache.prototype.unbind.call(this);\n  \t\tthis.fragment.unbind();\n  \t};\n\n  \tPartial.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.fragment.unrender(shouldDestroy);\n  \t};\n\n  \tPartial.prototype.update = function update() {\n  \t\tvar template = void 0;\n\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tif (!this.named) {\n  \t\t\t\tif (this.model) {\n  \t\t\t\t\ttemplate = this.model.get();\n  \t\t\t\t}\n\n  \t\t\t\tif (template && typeof template === 'string' && template !== this.name) {\n  \t\t\t\t\tthis.setTemplate(template);\n  \t\t\t\t\tthis.fragment.resetTemplate(this.partialTemplate);\n  \t\t\t\t} else if (template && (typeof template === 'undefined' ? 'undefined' : babelHelpers.typeof(template)) === 'object' && (typeof template.template === 'string' || isArray(template.t))) {\n  \t\t\t\t\tif (template.template) {\n  \t\t\t\t\t\ttemplate = parsePartial(this.name, template.template, this.ractive);\n  \t\t\t\t\t}\n  \t\t\t\t\tthis.setTemplate(this.name, template.t);\n  \t\t\t\t\tthis.fragment.resetTemplate(this.partialTemplate);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.fragment.update();\n  \t\t}\n  \t};\n\n  \treturn Partial;\n  }(Mustache);\n\n  function parsePartial(name, partial, ractive) {\n  \tvar parsed = void 0;\n\n  \ttry {\n  \t\tparsed = parser.parse(partial, parser.getParseOptions(ractive));\n  \t} catch (e) {\n  \t\twarnIfDebug('Could not parse partial from expression \\'' + name + '\\'\\n' + e.message);\n  \t}\n\n  \treturn parsed || { t: [] };\n  }\n\n  var RepeatedFragment = function () {\n  \tfunction RepeatedFragment(options) {\n  \t\tbabelHelpers.classCallCheck(this, RepeatedFragment);\n\n  \t\tthis.parent = options.owner.parentFragment;\n\n  \t\t// bit of a hack, so reference resolution works without another\n  \t\t// layer of indirection\n  \t\tthis.parentFragment = this;\n  \t\tthis.owner = options.owner;\n  \t\tthis.ractive = this.parent.ractive;\n\n  \t\t// encapsulated styles should be inherited until they get applied by an element\n  \t\tthis.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n  \t\tthis.context = null;\n  \t\tthis.rendered = false;\n  \t\tthis.iterations = [];\n\n  \t\tthis.template = options.template;\n\n  \t\tthis.indexRef = options.indexRef;\n  \t\tthis.keyRef = options.keyRef;\n\n  \t\tthis.pendingNewIndices = null;\n  \t\tthis.previousIterations = null;\n\n  \t\t// track array versus object so updates of type rest\n  \t\tthis.isArray = false;\n  \t}\n\n  \tRepeatedFragment.prototype.bind = function bind(context) {\n  \t\tvar _this = this;\n\n  \t\tthis.context = context;\n  \t\tvar value = context.get();\n\n  \t\t// {{#each array}}...\n  \t\tif (this.isArray = isArray(value)) {\n  \t\t\t// we can't use map, because of sparse arrays\n  \t\t\tthis.iterations = [];\n  \t\t\tfor (var i = 0; i < value.length; i += 1) {\n  \t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t}\n  \t\t}\n\n  \t\t// {{#each object}}...\n  \t\telse if (isObject(value)) {\n  \t\t\t\tthis.isArray = false;\n\n  \t\t\t\t// TODO this is a dreadful hack. There must be a neater way\n  \t\t\t\tif (this.indexRef) {\n  \t\t\t\t\tvar refs = this.indexRef.split(',');\n  \t\t\t\t\tthis.keyRef = refs[0];\n  \t\t\t\t\tthis.indexRef = refs[1];\n  \t\t\t\t}\n\n  \t\t\t\tthis.iterations = Object.keys(value).map(function (key, index) {\n  \t\t\t\t\treturn _this.createIteration(key, index);\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\treturn this;\n  \t};\n\n  \tRepeatedFragment.prototype.bubble = function bubble() {\n  \t\tthis.owner.bubble();\n  \t};\n\n  \tRepeatedFragment.prototype.createIteration = function createIteration(key, index) {\n  \t\tvar fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\ttemplate: this.template\n  \t\t});\n\n  \t\t// TODO this is a bit hacky\n  \t\tfragment.key = key;\n  \t\tfragment.index = index;\n  \t\tfragment.isIteration = true;\n\n  \t\tvar model = this.context.joinKey(key);\n\n  \t\t// set up an iteration alias if there is one\n  \t\tif (this.owner.template.z) {\n  \t\t\tfragment.aliases = {};\n  \t\t\tfragment.aliases[this.owner.template.z[0].n] = model;\n  \t\t}\n\n  \t\treturn fragment.bind(model);\n  \t};\n\n  \tRepeatedFragment.prototype.detach = function detach() {\n  \t\tvar docFrag = createDocumentFragment();\n  \t\tthis.iterations.forEach(function (fragment) {\n  \t\t\treturn docFrag.appendChild(fragment.detach());\n  \t\t});\n  \t\treturn docFrag;\n  \t};\n\n  \tRepeatedFragment.prototype.find = function find(selector) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.iterations[i].find(selector);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findAll = function findAll(selector, query) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tthis.iterations[i].findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findComponent = function findComponent(name) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.iterations[i].findComponent(name);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tthis.iterations[i].findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findNextNode = function findNextNode(iteration) {\n  \t\tif (iteration.index < this.iterations.length - 1) {\n  \t\t\tfor (var i = iteration.index + 1; i < this.iterations.length; i++) {\n  \t\t\t\tvar node = this.iterations[i].firstNode(true);\n  \t\t\t\tif (node) return node;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn this.owner.findNextNode();\n  \t};\n\n  \tRepeatedFragment.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  \t};\n\n  \tRepeatedFragment.prototype.rebind = function rebind(context) {\n  \t\tvar _this2 = this;\n\n  \t\tthis.context = context;\n\n  \t\tthis.iterations.forEach(function (fragment) {\n  \t\t\tvar model = context.joinKey(fragment.key || fragment.index);\n  \t\t\tif (_this2.owner.template.z) {\n  \t\t\t\tfragment.aliases = {};\n  \t\t\t\tfragment.aliases[_this2.owner.template.z[0].n] = model;\n  \t\t\t}\n  \t\t\tfragment.rebind(model);\n  \t\t});\n  \t};\n\n  \tRepeatedFragment.prototype.render = function render(target, occupants) {\n  \t\t// TODO use docFrag.cloneNode...\n\n  \t\tif (this.iterations) {\n  \t\t\tthis.iterations.forEach(function (fragment) {\n  \t\t\t\treturn fragment.render(target, occupants);\n  \t\t\t});\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tRepeatedFragment.prototype.shuffle = function shuffle(newIndices) {\n  \t\tvar _this3 = this;\n\n  \t\tif (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n  \t\tif (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n  \t\tthis.pendingNewIndices.push(newIndices);\n\n  \t\tvar iterations = [];\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\tif (newIndex === -1) return;\n\n  \t\t\tvar fragment = _this3.iterations[oldIndex];\n  \t\t\titerations[newIndex] = fragment;\n\n  \t\t\tif (newIndex !== oldIndex && fragment) fragment.dirty = true;\n  \t\t});\n\n  \t\tthis.iterations = iterations;\n\n  \t\tthis.bubble();\n  \t};\n\n  \tRepeatedFragment.prototype.toString = function toString(escape) {\n  \t\treturn this.iterations ? this.iterations.map(escape ? toEscapedString : _toString).join('') : '';\n  \t};\n\n  \tRepeatedFragment.prototype.unbind = function unbind() {\n  \t\tthis.iterations.forEach(_unbind);\n  \t\treturn this;\n  \t};\n\n  \tRepeatedFragment.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.iterations.forEach(shouldDestroy ? unrenderAndDestroy : _unrender);\n  \t\tif (this.pendingNewIndices && this.previousIterations) {\n  \t\t\tthis.previousIterations.forEach(function (fragment) {\n  \t\t\t\tif (fragment.rendered) shouldDestroy ? unrenderAndDestroy(fragment) : _unrender(fragment);\n  \t\t\t});\n  \t\t}\n  \t\tthis.rendered = false;\n  \t};\n\n  \t// TODO smart update\n\n\n  \tRepeatedFragment.prototype.update = function update() {\n  \t\tvar _this4 = this;\n\n  \t\t// skip dirty check, since this is basically just a facade\n\n  \t\tif (this.pendingNewIndices) {\n  \t\t\tthis.updatePostShuffle();\n  \t\t\treturn;\n  \t\t}\n\n  \t\tif (this.updating) return;\n  \t\tthis.updating = true;\n\n  \t\tvar value = this.context.get(),\n  \t\t    wasArray = this.isArray;\n\n  \t\tvar toRemove = void 0;\n  \t\tvar oldKeys = void 0;\n  \t\tvar reset = true;\n  \t\tvar i = void 0;\n\n  \t\tif (this.isArray = isArray(value)) {\n  \t\t\tif (wasArray) {\n  \t\t\t\treset = false;\n  \t\t\t\tif (this.iterations.length > value.length) {\n  \t\t\t\t\ttoRemove = this.iterations.splice(value.length);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t} else if (isObject(value) && !wasArray) {\n  \t\t\treset = false;\n  \t\t\ttoRemove = [];\n  \t\t\toldKeys = {};\n  \t\t\ti = this.iterations.length;\n\n  \t\t\twhile (i--) {\n  \t\t\t\tvar _fragment = this.iterations[i];\n  \t\t\t\tif (_fragment.key in value) {\n  \t\t\t\t\toldKeys[_fragment.key] = true;\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.iterations.splice(i, 1);\n  \t\t\t\t\ttoRemove.push(_fragment);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tif (reset) {\n  \t\t\ttoRemove = this.iterations;\n  \t\t\tthis.iterations = [];\n  \t\t}\n\n  \t\tif (toRemove) {\n  \t\t\ttoRemove.forEach(function (fragment) {\n  \t\t\t\tfragment.unbind();\n  \t\t\t\tfragment.unrender(true);\n  \t\t\t});\n  \t\t}\n\n  \t\t// update the remaining ones\n  \t\tthis.iterations.forEach(_update);\n\n  \t\t// add new iterations\n  \t\tvar newLength = isArray(value) ? value.length : isObject(value) ? Object.keys(value).length : 0;\n\n  \t\tvar docFrag = void 0;\n  \t\tvar fragment = void 0;\n\n  \t\tif (newLength > this.iterations.length) {\n  \t\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\n  \t\t\ti = this.iterations.length;\n\n  \t\t\tif (isArray(value)) {\n  \t\t\t\twhile (i < value.length) {\n  \t\t\t\t\tfragment = this.createIteration(i, i);\n\n  \t\t\t\t\tthis.iterations.push(fragment);\n  \t\t\t\t\tif (this.rendered) fragment.render(docFrag);\n\n  \t\t\t\t\ti += 1;\n  \t\t\t\t}\n  \t\t\t} else if (isObject(value)) {\n  \t\t\t\t// TODO this is a dreadful hack. There must be a neater way\n  \t\t\t\tif (this.indexRef && !this.keyRef) {\n  \t\t\t\t\tvar refs = this.indexRef.split(',');\n  \t\t\t\t\tthis.keyRef = refs[0];\n  \t\t\t\t\tthis.indexRef = refs[1];\n  \t\t\t\t}\n\n  \t\t\t\tObject.keys(value).forEach(function (key) {\n  \t\t\t\t\tif (!oldKeys || !(key in oldKeys)) {\n  \t\t\t\t\t\tfragment = _this4.createIteration(key, i);\n\n  \t\t\t\t\t\t_this4.iterations.push(fragment);\n  \t\t\t\t\t\tif (_this4.rendered) fragment.render(docFrag);\n\n  \t\t\t\t\t\ti += 1;\n  \t\t\t\t\t}\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\t\tif (this.rendered) {\n  \t\t\t\tvar parentNode = this.parent.findParentNode();\n  \t\t\t\tvar anchor = this.parent.findNextNode(this.owner);\n\n  \t\t\t\tparentNode.insertBefore(docFrag, anchor);\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.updating = false;\n  \t};\n\n  \tRepeatedFragment.prototype.updatePostShuffle = function updatePostShuffle() {\n  \t\tvar _this5 = this;\n\n  \t\tvar newIndices = this.pendingNewIndices[0];\n\n  \t\t// map first shuffle through\n  \t\tthis.pendingNewIndices.slice(1).forEach(function (indices) {\n  \t\t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\t\tnewIndices[oldIndex] = indices[newIndex];\n  \t\t\t});\n  \t\t});\n\n  \t\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n  \t\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n  \t\t// but it seems to work for now\n  \t\tvar len = this.context.get().length;\n  \t\tvar i = void 0,\n  \t\t    maxIdx = 0,\n  \t\t    merged = false;\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\tvar fragment = _this5.previousIterations[oldIndex];\n\n  \t\t\t// check for merged shuffles\n  \t\t\tif (!merged && newIndex !== -1) {\n  \t\t\t\tif (newIndex < maxIdx) merged = true;\n  \t\t\t\tif (newIndex > maxIdx) maxIdx = newIndex;\n  \t\t\t}\n\n  \t\t\tif (newIndex === -1) {\n  \t\t\t\tfragment.unbind().unrender(true);\n  \t\t\t} else {\n  \t\t\t\tfragment.index = newIndex;\n  \t\t\t\tvar model = _this5.context.joinKey(newIndex);\n  \t\t\t\tif (_this5.owner.template.z) {\n  \t\t\t\t\tfragment.aliases = {};\n  \t\t\t\t\tfragment.aliases[_this5.owner.template.z[0].n] = model;\n  \t\t\t\t}\n  \t\t\t\tfragment.rebind(model);\n  \t\t\t}\n  \t\t});\n\n  \t\t// create new iterations\n  \t\tvar docFrag = this.rendered ? createDocumentFragment() : null;\n  \t\tvar parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n  \t\tif (merged) {\n  \t\t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t\tvar frag = this.iterations[i];\n\n  \t\t\t\tif (this.rendered) {\n  \t\t\t\t\tif (frag) {\n  \t\t\t\t\t\tdocFrag.appendChild(frag.detach());\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t\t\tthis.iterations[i].render(docFrag);\n  \t\t\t\t\t}\n  \t\t\t\t}\n\n  \t\t\t\tif (!this.rendered) {\n  \t\t\t\t\tif (!frag) {\n  \t\t\t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n  \t\t} else {\n  \t\t\tfor (i = 0; i < len; i++) {\n  \t\t\t\tvar _frag = this.iterations[i];\n\n  \t\t\t\tif (this.rendered) {\n  \t\t\t\t\tif (_frag && docFrag.childNodes.length) {\n  \t\t\t\t\t\tparentNode.insertBefore(docFrag, _frag.firstNode());\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (!_frag) {\n  \t\t\t\t\t\t_frag = this.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t\t\t_frag.render(docFrag);\n  \t\t\t\t\t}\n  \t\t\t\t} else if (!_frag) {\n  \t\t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tif (this.rendered && docFrag.childNodes.length) {\n  \t\t\tparentNode.insertBefore(docFrag, this.owner.findNextNode());\n  \t\t}\n\n  \t\tthis.iterations.forEach(_update);\n\n  \t\tthis.pendingNewIndices = null;\n  \t};\n\n  \treturn RepeatedFragment;\n  }();\n\n  function isEmpty(value) {\n  \treturn !value || isArray(value) && value.length === 0 || isObject(value) && Object.keys(value).length === 0;\n  }\n\n  function getType(value, hasIndexRef) {\n  \tif (hasIndexRef || isArray(value)) return SECTION_EACH;\n  \tif (isObject(value) || typeof value === 'function') return SECTION_IF_WITH;\n  \tif (value === undefined) return null;\n  \treturn SECTION_IF;\n  }\n\n  var Section = function (_Mustache) {\n  \tbabelHelpers.inherits(Section, _Mustache);\n\n  \tfunction Section(options) {\n  \t\tbabelHelpers.classCallCheck(this, Section);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Mustache.call(this, options));\n\n  \t\t_this.sectionType = options.template.n || null;\n  \t\t_this.templateSectionType = _this.sectionType;\n  \t\t_this.fragment = null;\n  \t\treturn _this;\n  \t}\n\n  \tSection.prototype.bind = function bind() {\n  \t\t_Mustache.prototype.bind.call(this);\n\n  \t\t// if we managed to bind, we need to create children\n  \t\tif (this.model) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.update();\n  \t\t} else if (this.sectionType && this.sectionType === SECTION_UNLESS) {\n  \t\t\tthis.fragment = new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: this.template.f\n  \t\t\t}).bind();\n  \t\t}\n  \t};\n\n  \tSection.prototype.detach = function detach() {\n  \t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n  \t};\n\n  \tSection.prototype.find = function find(selector) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.find(selector);\n  \t\t}\n  \t};\n\n  \tSection.prototype.findAll = function findAll(selector, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tSection.prototype.findComponent = function findComponent(name) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tSection.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tSection.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment && this.fragment.firstNode(skipParent);\n  \t};\n\n  \tSection.prototype.rebind = function rebind() {\n  \t\t_Mustache.prototype.rebind.call(this);\n\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.rebind(this.sectionType === SECTION_IF || this.sectionType === SECTION_UNLESS ? null : this.model);\n  \t\t}\n  \t};\n\n  \tSection.prototype.render = function render(target, occupants) {\n  \t\tthis.rendered = true;\n  \t\tif (this.fragment) this.fragment.render(target, occupants);\n  \t};\n\n  \tSection.prototype.shuffle = function shuffle(newIndices) {\n  \t\tif (this.fragment && this.sectionType === SECTION_EACH) {\n  \t\t\tthis.fragment.shuffle(newIndices);\n  \t\t}\n  \t};\n\n  \tSection.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment ? this.fragment.toString(escape) : '';\n  \t};\n\n  \tSection.prototype.unbind = function unbind() {\n  \t\t_Mustache.prototype.unbind.call(this);\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tSection.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n  \t\tthis.rendered = false;\n  \t};\n\n  \tSection.prototype.update = function update() {\n  \t\tif (!this.dirty) return;\n  \t\tif (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n  \t\tthis.dirty = false;\n\n  \t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n  \t\tvar lastType = this.sectionType;\n\n  \t\t// watch for switching section types\n  \t\tif (this.sectionType === null || this.templateSectionType === null) this.sectionType = getType(value, this.template.i);\n  \t\tif (lastType && lastType !== this.sectionType && this.fragment) {\n  \t\t\tif (this.rendered) {\n  \t\t\t\tthis.fragment.unbind().unrender(true);\n  \t\t\t}\n\n  \t\t\tthis.fragment = null;\n  \t\t}\n\n  \t\tvar newFragment = void 0;\n\n  \t\tif (this.sectionType === SECTION_EACH) {\n  \t\t\tif (this.fragment) {\n  \t\t\t\tthis.fragment.update();\n  \t\t\t} else {\n  \t\t\t\t// TODO can this happen?\n  \t\t\t\tnewFragment = new RepeatedFragment({\n  \t\t\t\t\towner: this,\n  \t\t\t\t\ttemplate: this.template.f,\n  \t\t\t\t\tindexRef: this.template.i\n  \t\t\t\t}).bind(this.model);\n  \t\t\t}\n  \t\t}\n\n  \t\t// WITH is now IF_WITH; WITH is only used for {{>partial context}}\n  \t\telse if (this.sectionType === SECTION_WITH) {\n  \t\t\t\tif (this.fragment) {\n  \t\t\t\t\tthis.fragment.update();\n  \t\t\t\t} else {\n  \t\t\t\t\tnewFragment = new Fragment({\n  \t\t\t\t\t\towner: this,\n  \t\t\t\t\t\ttemplate: this.template.f\n  \t\t\t\t\t}).bind(this.model);\n  \t\t\t\t}\n  \t\t\t} else if (this.sectionType === SECTION_IF_WITH) {\n  \t\t\t\tif (this.fragment) {\n  \t\t\t\t\tif (isEmpty(value)) {\n  \t\t\t\t\t\tif (this.rendered) {\n  \t\t\t\t\t\t\tthis.fragment.unbind().unrender(true);\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tthis.fragment = null;\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tthis.fragment.update();\n  \t\t\t\t\t}\n  \t\t\t\t} else if (!isEmpty(value)) {\n  \t\t\t\t\tnewFragment = new Fragment({\n  \t\t\t\t\t\towner: this,\n  \t\t\t\t\t\ttemplate: this.template.f\n  \t\t\t\t\t}).bind(this.model);\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tvar fragmentShouldExist = this.sectionType === SECTION_UNLESS ? isEmpty(value) : !!value && !isEmpty(value);\n\n  \t\t\t\tif (this.fragment) {\n  \t\t\t\t\tif (fragmentShouldExist) {\n  \t\t\t\t\t\tthis.fragment.update();\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tif (this.rendered) {\n  \t\t\t\t\t\t\tthis.fragment.unbind().unrender(true);\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tthis.fragment = null;\n  \t\t\t\t\t}\n  \t\t\t\t} else if (fragmentShouldExist) {\n  \t\t\t\t\tnewFragment = new Fragment({\n  \t\t\t\t\t\towner: this,\n  \t\t\t\t\t\ttemplate: this.template.f\n  \t\t\t\t\t}).bind(null);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\tif (newFragment) {\n  \t\t\tif (this.rendered) {\n  \t\t\t\tvar parentNode = this.parentFragment.findParentNode();\n  \t\t\t\tvar anchor = this.parentFragment.findNextNode(this);\n\n  \t\t\t\tif (anchor) {\n  \t\t\t\t\tvar docFrag = createDocumentFragment();\n  \t\t\t\t\tnewFragment.render(docFrag);\n\n  \t\t\t\t\t// we use anchor.parentNode, not parentNode, because the sibling\n  \t\t\t\t\t// may be temporarily detached as a result of a shuffle\n  \t\t\t\t\tanchor.parentNode.insertBefore(docFrag, anchor);\n  \t\t\t\t} else {\n  \t\t\t\t\tnewFragment.render(parentNode);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.fragment = newFragment;\n  \t\t}\n  \t};\n\n  \treturn Section;\n  }(Mustache);\n\n  function valueContains(selectValue, optionValue) {\n  \tvar i = selectValue.length;\n  \twhile (i--) {\n  \t\tif (selectValue[i] == optionValue) return true;\n  \t}\n  }\n\n  var Select = function (_Element) {\n  \tbabelHelpers.inherits(Select, _Element);\n\n  \tfunction Select(options) {\n  \t\tbabelHelpers.classCallCheck(this, Select);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Element.call(this, options));\n\n  \t\t_this.options = [];\n  \t\treturn _this;\n  \t}\n\n  \tSelect.prototype.foundNode = function foundNode(node) {\n  \t\tif (this.binding) {\n  \t\t\tvar selectedOptions = getSelectedOptions(node);\n\n  \t\t\tif (selectedOptions.length > 0) {\n  \t\t\t\tthis.selectedOptions = selectedOptions;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tSelect.prototype.render = function render(target, occupants) {\n  \t\t_Element.prototype.render.call(this, target, occupants);\n  \t\tthis.sync();\n\n  \t\tvar node = this.node;\n\n  \t\tvar i = node.options.length;\n  \t\twhile (i--) {\n  \t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tSelect.prototype.sync = function sync() {\n  \t\tvar _this2 = this;\n\n  \t\tvar selectNode = this.node;\n\n  \t\tif (!selectNode) return;\n\n  \t\tvar options = toArray(selectNode.options);\n\n  \t\tif (this.selectedOptions) {\n  \t\t\toptions.forEach(function (o) {\n  \t\t\t\tif (_this2.selectedOptions.indexOf(o) >= 0) o.selected = true;else o.selected = false;\n  \t\t\t});\n  \t\t\tthis.binding.setFromNode(selectNode);\n  \t\t\tdelete this.selectedOptions;\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar selectValue = this.getAttribute('value');\n  \t\tvar isMultiple = this.getAttribute('multiple');\n\n  \t\t// If the <select> has a specified value, that should override\n  \t\t// these options\n  \t\tif (selectValue !== undefined) {\n  \t\t\tvar optionWasSelected = void 0;\n\n  \t\t\toptions.forEach(function (o) {\n  \t\t\t\tvar optionValue = o._ractive ? o._ractive.value : o.value;\n  \t\t\t\tvar shouldSelect = isMultiple ? valueContains(selectValue, optionValue) : selectValue == optionValue;\n\n  \t\t\t\tif (shouldSelect) {\n  \t\t\t\t\toptionWasSelected = true;\n  \t\t\t\t}\n\n  \t\t\t\to.selected = shouldSelect;\n  \t\t\t});\n\n  \t\t\tif (!optionWasSelected && !isMultiple) {\n  \t\t\t\tif (this.binding) {\n  \t\t\t\t\tthis.binding.forceUpdate();\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\t// Otherwise the value should be initialised according to which\n  \t\t// <option> element is selected, if twoway binding is in effect\n  \t\telse if (this.binding) {\n  \t\t\t\tthis.binding.forceUpdate();\n  \t\t\t}\n  \t};\n\n  \tSelect.prototype.update = function update() {\n  \t\t_Element.prototype.update.call(this);\n  \t\tthis.sync();\n  \t};\n\n  \treturn Select;\n  }(Element);\n\n  var Textarea = function (_Input) {\n  \tbabelHelpers.inherits(Textarea, _Input);\n\n  \tfunction Textarea(options) {\n  \t\tbabelHelpers.classCallCheck(this, Textarea);\n\n  \t\tvar template = options.template;\n\n  \t\t// if there is a bindable value, there should be no body\n  \t\tif (template.a && template.a.value && isBindable({ template: template.a.value })) {\n  \t\t\toptions.noContent = true;\n  \t\t}\n\n  \t\t// otherwise, if there is a single bindable interpolator as content, move it to the value attr\n  \t\telse if (template.f && (!template.a || !template.a.value) && isBindable({ template: template.f })) {\n  \t\t\t\tif (!template.a) template.a = {};\n  \t\t\t\ttemplate.a.value = template.f;\n  \t\t\t\toptions.noContent = true;\n  \t\t\t}\n\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Input.call(this, options));\n  \t}\n\n  \tTextarea.prototype.bubble = function bubble() {\n  \t\tvar _this2 = this;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.rendered && !this.binding && this.fragment) {\n  \t\t\t\trunloop.scheduleTask(function () {\n  \t\t\t\t\t_this2.dirty = false;\n  \t\t\t\t\t_this2.node.value = _this2.fragment.toString();\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\t\tthis.parentFragment.bubble(); // default behaviour\n  \t\t}\n  \t};\n\n  \treturn Textarea;\n  }(Input);\n\n  var Text = function (_Item) {\n  \tbabelHelpers.inherits(Text, _Item);\n\n  \tfunction Text(options) {\n  \t\tbabelHelpers.classCallCheck(this, Text);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.type = TEXT;\n  \t\treturn _this;\n  \t}\n\n  \tText.prototype.bind = function bind() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.detach = function detach() {\n  \t\treturn detachNode(this.node);\n  \t};\n\n  \tText.prototype.firstNode = function firstNode() {\n  \t\treturn this.node;\n  \t};\n\n  \tText.prototype.rebind = function rebind() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.render = function render(target, occupants) {\n  \t\tthis.rendered = true;\n\n  \t\tif (occupants) {\n  \t\t\tvar n = occupants[0];\n  \t\t\tif (n && n.nodeType === 3) {\n  \t\t\t\toccupants.shift();\n  \t\t\t\tif (n.nodeValue !== this.template) {\n  \t\t\t\t\tn.nodeValue = this.template;\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tn = this.node = doc.createTextNode(this.template);\n  \t\t\t\tif (occupants[0]) {\n  \t\t\t\t\ttarget.insertBefore(n, occupants[0]);\n  \t\t\t\t} else {\n  \t\t\t\t\ttarget.appendChild(n);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.node = n;\n  \t\t} else {\n  \t\t\tthis.node = doc.createTextNode(this.template);\n  \t\t\ttarget.appendChild(this.node);\n  \t\t}\n  \t};\n\n  \tText.prototype.toString = function toString(escape) {\n  \t\treturn escape ? escapeHtml(this.template) : this.template;\n  \t};\n\n  \tText.prototype.unbind = function unbind() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (this.rendered && shouldDestroy) this.detach();\n  \t\tthis.rendered = false;\n  \t};\n\n  \tText.prototype.update = function update() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.valueOf = function valueOf() {\n  \t\treturn this.template;\n  \t};\n\n  \treturn Text;\n  }(Item);\n\n  var elementCache = {};\n\n  var ieBug = void 0;\n  var ieBlacklist = void 0;\n\n  try {\n  \tcreateElement('table').innerHTML = 'foo';\n  } catch (err) {\n  \tieBug = true;\n\n  \tieBlacklist = {\n  \t\tTABLE: ['<table class=\"x\">', '</table>'],\n  \t\tTHEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n  \t\tTBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n  \t\tTR: ['<table><tr class=\"x\">', '</tr></table>'],\n  \t\tSELECT: ['<select class=\"x\">', '</select>']\n  \t};\n  }\n\n  function insertHtml (html, node, docFrag) {\n  \tvar nodes = [];\n\n  \t// render 0 and false\n  \tif (html == null || html === '') return nodes;\n\n  \tvar container = void 0;\n  \tvar wrapper = void 0;\n  \tvar selectedOption = void 0;\n\n  \tif (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n  \t\tcontainer = element('DIV');\n  \t\tcontainer.innerHTML = wrapper[0] + html + wrapper[1];\n  \t\tcontainer = container.querySelector('.x');\n\n  \t\tif (container.tagName === 'SELECT') {\n  \t\t\tselectedOption = container.options[container.selectedIndex];\n  \t\t}\n  \t} else if (node.namespaceURI === svg$1) {\n  \t\tcontainer = element('DIV');\n  \t\tcontainer.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n  \t\tcontainer = container.querySelector('.x');\n  \t} else if (node.tagName === 'TEXTAREA') {\n  \t\tcontainer = createElement('div');\n\n  \t\tif (typeof container.textContent !== 'undefined') {\n  \t\t\tcontainer.textContent = html;\n  \t\t} else {\n  \t\t\tcontainer.innerHTML = html;\n  \t\t}\n  \t} else {\n  \t\tcontainer = element(node.tagName);\n  \t\tcontainer.innerHTML = html;\n\n  \t\tif (container.tagName === 'SELECT') {\n  \t\t\tselectedOption = container.options[container.selectedIndex];\n  \t\t}\n  \t}\n\n  \tvar child = void 0;\n  \twhile (child = container.firstChild) {\n  \t\tnodes.push(child);\n  \t\tdocFrag.appendChild(child);\n  \t}\n\n  \t// This is really annoying. Extracting <option> nodes from the\n  \t// temporary container <select> causes the remaining ones to\n  \t// become selected. So now we have to deselect them. IE8, you\n  \t// amaze me. You really do\n  \t// ...and now Chrome too\n  \tvar i = void 0;\n  \tif (node.tagName === 'SELECT') {\n  \t\ti = nodes.length;\n  \t\twhile (i--) {\n  \t\t\tif (nodes[i] !== selectedOption) {\n  \t\t\t\tnodes[i].selected = false;\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \treturn nodes;\n  }\n\n  function element(tagName) {\n  \treturn elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n  }\n\n  var Triple = function (_Mustache) {\n  \tbabelHelpers.inherits(Triple, _Mustache);\n\n  \tfunction Triple(options) {\n  \t\tbabelHelpers.classCallCheck(this, Triple);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Mustache.call(this, options));\n  \t}\n\n  \tTriple.prototype.detach = function detach() {\n  \t\tvar docFrag = createDocumentFragment();\n  \t\tthis.nodes.forEach(function (node) {\n  \t\t\treturn docFrag.appendChild(node);\n  \t\t});\n  \t\treturn docFrag;\n  \t};\n\n  \tTriple.prototype.find = function find(selector) {\n  \t\tvar len = this.nodes.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar node = this.nodes[i];\n\n  \t\t\tif (node.nodeType !== 1) continue;\n\n  \t\t\tif (matches(node, selector)) return node;\n\n  \t\t\tvar queryResult = node.querySelector(selector);\n  \t\t\tif (queryResult) return queryResult;\n  \t\t}\n\n  \t\treturn null;\n  \t};\n\n  \tTriple.prototype.findAll = function findAll(selector, query) {\n  \t\tvar len = this.nodes.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar node = this.nodes[i];\n\n  \t\t\tif (node.nodeType !== 1) continue;\n\n  \t\t\tif (query.test(node)) query.add(node);\n\n  \t\t\tvar queryAllResult = node.querySelectorAll(selector);\n  \t\t\tif (queryAllResult) {\n  \t\t\t\tvar numNodes = queryAllResult.length;\n  \t\t\t\tvar j = void 0;\n\n  \t\t\t\tfor (j = 0; j < numNodes; j += 1) {\n  \t\t\t\t\tquery.add(queryAllResult[j]);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tTriple.prototype.findComponent = function findComponent() {\n  \t\treturn null;\n  \t};\n\n  \tTriple.prototype.firstNode = function firstNode() {\n  \t\treturn this.nodes[0];\n  \t};\n\n  \tTriple.prototype.render = function render(target) {\n  \t\tvar html = this.model ? this.model.get() : '';\n  \t\tthis.nodes = insertHtml(html, this.parentFragment.findParentNode(), target);\n  \t\tthis.rendered = true;\n  \t};\n\n  \tTriple.prototype.toString = function toString() {\n  \t\treturn this.model && this.model.get() != null ? decodeCharacterReferences('' + this.model.get()) : '';\n  \t};\n\n  \tTriple.prototype.unrender = function unrender() {\n  \t\tif (this.nodes) this.nodes.forEach(function (node) {\n  \t\t\treturn detachNode(node);\n  \t\t});\n  \t\tthis.rendered = false;\n  \t};\n\n  \tTriple.prototype.update = function update() {\n  \t\tif (this.rendered && this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tthis.unrender();\n  \t\t\tvar docFrag = createDocumentFragment();\n  \t\t\tthis.render(docFrag);\n\n  \t\t\tvar parentNode = this.parentFragment.findParentNode();\n  \t\t\tvar anchor = this.parentFragment.findNextNode(this);\n\n  \t\t\tparentNode.insertBefore(docFrag, anchor);\n  \t\t}\n  \t};\n\n  \treturn Triple;\n  }(Mustache);\n\n  var Yielder = function (_Item) {\n  \tbabelHelpers.inherits(Yielder, _Item);\n\n  \tfunction Yielder(options) {\n  \t\tbabelHelpers.classCallCheck(this, Yielder);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.container = options.parentFragment.ractive;\n  \t\t_this.component = _this.container.component;\n\n  \t\t_this.containerFragment = options.parentFragment;\n  \t\t_this.parentFragment = _this.component.parentFragment;\n\n  \t\t// {{yield}} is equivalent to {{yield content}}\n  \t\t_this.name = options.template.n || '';\n  \t\treturn _this;\n  \t}\n\n  \tYielder.prototype.bind = function bind() {\n  \t\tvar name = this.name;\n\n  \t\t(this.component.yielders[name] || (this.component.yielders[name] = [])).push(this);\n\n  \t\t// TODO don't parse here\n  \t\tvar template = this.container._inlinePartials[name || 'content'];\n\n  \t\tif (typeof template === 'string') {\n  \t\t\ttemplate = parse(template).t;\n  \t\t}\n\n  \t\tif (!template) {\n  \t\t\twarnIfDebug('Could not find template for partial \"' + name + '\"', { ractive: this.ractive });\n  \t\t\ttemplate = [];\n  \t\t}\n\n  \t\tthis.fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\tractive: this.container.parent,\n  \t\t\ttemplate: template\n  \t\t}).bind();\n  \t};\n\n  \tYielder.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.containerFragment.bubble();\n  \t\t\tthis.dirty = true;\n  \t\t}\n  \t};\n\n  \tYielder.prototype.detach = function detach() {\n  \t\treturn this.fragment.detach();\n  \t};\n\n  \tYielder.prototype.find = function find(selector) {\n  \t\treturn this.fragment.find(selector);\n  \t};\n\n  \tYielder.prototype.findAll = function findAll(selector, queryResult) {\n  \t\tthis.fragment.find(selector, queryResult);\n  \t};\n\n  \tYielder.prototype.findComponent = function findComponent(name) {\n  \t\treturn this.fragment.findComponent(name);\n  \t};\n\n  \tYielder.prototype.findAllComponents = function findAllComponents(name, queryResult) {\n  \t\tthis.fragment.findAllComponents(name, queryResult);\n  \t};\n\n  \tYielder.prototype.findNextNode = function findNextNode() {\n  \t\treturn this.containerFragment.findNextNode(this);\n  \t};\n\n  \tYielder.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment.firstNode(skipParent);\n  \t};\n\n  \tYielder.prototype.rebind = function rebind() {\n  \t\tthis.fragment.rebind();\n  \t};\n\n  \tYielder.prototype.render = function render(target, occupants) {\n  \t\treturn this.fragment.render(target, occupants);\n  \t};\n\n  \tYielder.prototype.setTemplate = function setTemplate(name) {\n  \t\tvar template = this.parentFragment.ractive.partials[name];\n\n  \t\tif (typeof template === 'string') {\n  \t\t\ttemplate = parse(template).t;\n  \t\t}\n\n  \t\tthis.partialTemplate = template || []; // TODO warn on missing partial\n  \t};\n\n  \tYielder.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment.toString(escape);\n  \t};\n\n  \tYielder.prototype.unbind = function unbind() {\n  \t\tthis.fragment.unbind();\n  \t\tremoveFromArray(this.component.yielders[this.name], this);\n  \t};\n\n  \tYielder.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.fragment.unrender(shouldDestroy);\n  \t};\n\n  \tYielder.prototype.update = function update() {\n  \t\tthis.dirty = false;\n  \t\tthis.fragment.update();\n  \t};\n\n  \treturn Yielder;\n  }(Item);\n\n  // finds the component constructor in the registry or view hierarchy registries\n  function getComponentConstructor(ractive, name) {\n  \tvar instance = findInstance('components', ractive, name);\n  \tvar Component = void 0;\n\n  \tif (instance) {\n  \t\tComponent = instance.components[name];\n\n  \t\t// best test we have for not Ractive.extend\n  \t\tif (!Component._Parent) {\n  \t\t\t// function option, execute and store for reset\n  \t\t\tvar fn = Component.bind(instance);\n  \t\t\tfn.isOwner = instance.components.hasOwnProperty(name);\n  \t\t\tComponent = fn();\n\n  \t\t\tif (!Component) {\n  \t\t\t\twarnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', { ractive: ractive });\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tif (typeof Component === 'string') {\n  \t\t\t\t// allow string lookup\n  \t\t\t\tComponent = getComponentConstructor(ractive, Component);\n  \t\t\t}\n\n  \t\t\tComponent._fn = fn;\n  \t\t\tinstance.components[name] = Component;\n  \t\t}\n  \t}\n\n  \treturn Component;\n  }\n\n  var constructors = {};\n  constructors[ALIAS] = Alias;\n  constructors[DOCTYPE] = Doctype;\n  constructors[INTERPOLATOR] = Interpolator;\n  constructors[PARTIAL] = Partial;\n  constructors[SECTION] = Section;\n  constructors[TRIPLE] = Triple;\n  constructors[YIELDER] = Yielder;\n\n  var specialElements = {\n  \tdoctype: Doctype,\n  \tform: Form,\n  \tinput: Input,\n  \toption: Option,\n  \tselect: Select,\n  \ttextarea: Textarea\n  };\n\n  function createItem(options) {\n  \tif (typeof options.template === 'string') {\n  \t\treturn new Text(options);\n  \t}\n\n  \tif (options.template.t === ELEMENT) {\n  \t\t// could be component or element\n  \t\tvar ComponentConstructor = getComponentConstructor(options.parentFragment.ractive, options.template.e);\n  \t\tif (ComponentConstructor) {\n  \t\t\treturn new Component(options, ComponentConstructor);\n  \t\t}\n\n  \t\tvar tagName = options.template.e.toLowerCase();\n\n  \t\tvar ElementConstructor = specialElements[tagName] || Element;\n  \t\treturn new ElementConstructor(options);\n  \t}\n\n  \tvar Item = constructors[options.template.t];\n\n  \tif (!Item) throw new Error('Unrecognised item type ' + options.template.t);\n\n  \treturn new Item(options);\n  }\n\n  var ReferenceResolver = function () {\n  \tfunction ReferenceResolver(fragment, reference, callback) {\n  \t\tbabelHelpers.classCallCheck(this, ReferenceResolver);\n\n  \t\tthis.fragment = fragment;\n  \t\tthis.reference = normalise(reference);\n  \t\tthis.callback = callback;\n\n  \t\tthis.keys = splitKeypathI(reference);\n  \t\tthis.resolved = false;\n\n  \t\t// TODO the consumer should take care of addUnresolved\n  \t\t// we attach to all the contexts between here and the root\n  \t\t// - whenever their values change, they can quickly\n  \t\t// check to see if we can resolve\n  \t\twhile (fragment) {\n  \t\t\tif (fragment.context) {\n  \t\t\t\tfragment.context.addUnresolved(this.keys[0], this);\n  \t\t\t}\n\n  \t\t\tfragment = fragment.componentParent || fragment.parent;\n  \t\t}\n  \t}\n\n  \tReferenceResolver.prototype.attemptResolution = function attemptResolution() {\n  \t\tif (this.resolved) return;\n\n  \t\tvar model = resolveAmbiguousReference(this.fragment, this.reference);\n\n  \t\tif (model) {\n  \t\t\tthis.resolved = true;\n  \t\t\tthis.callback(model);\n  \t\t}\n  \t};\n\n  \tReferenceResolver.prototype.forceResolution = function forceResolution() {\n  \t\tif (this.resolved) return;\n\n  \t\tvar model = this.fragment.findContext().joinAll(this.keys);\n  \t\tthis.callback(model);\n  \t\tthis.resolved = true;\n  \t};\n\n  \tReferenceResolver.prototype.unbind = function unbind() {\n  \t\tremoveFromArray(this.fragment.unresolved, this);\n  \t};\n\n  \treturn ReferenceResolver;\n  }();\n\n  // TODO all this code needs to die\n  function processItems(items, values, guid) {\n  \tvar counter = arguments.length <= 3 || arguments[3] === undefined ? 0 : arguments[3];\n\n  \treturn items.map(function (item) {\n  \t\tif (item.type === TEXT) {\n  \t\t\treturn item.template;\n  \t\t}\n\n  \t\tif (item.fragment) {\n  \t\t\tif (item.fragment.iterations) {\n  \t\t\t\treturn item.fragment.iterations.map(function (fragment) {\n  \t\t\t\t\treturn processItems(fragment.items, values, guid, counter);\n  \t\t\t\t}).join('');\n  \t\t\t} else {\n  \t\t\t\treturn processItems(item.fragment.items, values, guid, counter);\n  \t\t\t}\n  \t\t}\n\n  \t\tvar placeholderId = guid + '-' + counter++;\n\n  \t\tvalues[placeholderId] = item.model ? item.model.wrapper ? item.model.wrapper.value : item.model.get() : undefined;\n\n  \t\treturn '${' + placeholderId + '}';\n  \t}).join('');\n  }\n\n  function unrenderAndDestroy$1(item) {\n  \titem.unrender(true);\n  }\n\n  var Fragment = function () {\n  \tfunction Fragment(options) {\n  \t\tbabelHelpers.classCallCheck(this, Fragment);\n\n  \t\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n  \t\tthis.isRoot = !options.owner.parentFragment;\n  \t\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n  \t\tthis.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n  \t\tthis.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.parentFragment : null;\n\n  \t\tthis.context = null;\n  \t\tthis.rendered = false;\n\n  \t\t// encapsulated styles should be inherited until they get applied by an element\n  \t\tthis.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n  \t\tthis.resolvers = [];\n\n  \t\tthis.dirty = false;\n  \t\tthis.dirtyArgs = this.dirtyValue = true; // TODO getArgsList is nonsense - should deprecate legacy directives style\n\n  \t\tthis.template = options.template || [];\n  \t\tthis.createItems();\n  \t}\n\n  \tFragment.prototype.bind = function bind(context) {\n  \t\tthis.context = context;\n  \t\tthis.items.forEach(_bind);\n  \t\tthis.bound = true;\n\n  \t\t// in rare cases, a forced resolution (or similar) will cause the\n  \t\t// fragment to be dirty before it's even finished binding. In those\n  \t\t// cases we update immediately\n  \t\tif (this.dirty) this.update();\n\n  \t\treturn this;\n  \t};\n\n  \tFragment.prototype.bubble = function bubble() {\n  \t\tthis.dirtyArgs = this.dirtyValue = true;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.isRoot) {\n  \t\t\t\t// TODO encapsulate 'is component root, but not overall root' check?\n  \t\t\t\tif (this.ractive.component) {\n  \t\t\t\t\tthis.ractive.component.bubble();\n  \t\t\t\t} else if (this.bound) {\n  \t\t\t\t\trunloop.addFragment(this);\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tthis.owner.bubble();\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tFragment.prototype.createItems = function createItems() {\n  \t\tvar _this = this;\n\n  \t\tthis.items = this.template.map(function (template, index) {\n  \t\t\treturn createItem({ parentFragment: _this, template: template, index: index });\n  \t\t});\n  \t};\n\n  \tFragment.prototype.detach = function detach() {\n  \t\tvar docFrag = createDocumentFragment();\n  \t\tthis.items.forEach(function (item) {\n  \t\t\treturn docFrag.appendChild(item.detach());\n  \t\t});\n  \t\treturn docFrag;\n  \t};\n\n  \tFragment.prototype.find = function find(selector) {\n  \t\tvar len = this.items.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.items[i].find(selector);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tFragment.prototype.findAll = function findAll(selector, query) {\n  \t\tif (this.items) {\n  \t\t\tvar len = this.items.length;\n  \t\t\tvar i = void 0;\n\n  \t\t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t\tvar item = this.items[i];\n\n  \t\t\t\tif (item.findAll) {\n  \t\t\t\t\titem.findAll(selector, query);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn query;\n  \t};\n\n  \tFragment.prototype.findComponent = function findComponent(name) {\n  \t\tvar len = this.items.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.items[i].findComponent(name);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tFragment.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.items) {\n  \t\t\tvar len = this.items.length;\n  \t\t\tvar i = void 0;\n\n  \t\t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t\tvar item = this.items[i];\n\n  \t\t\t\tif (item.findAllComponents) {\n  \t\t\t\t\titem.findAllComponents(name, query);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn query;\n  \t};\n\n  \tFragment.prototype.findContext = function findContext() {\n  \t\tvar fragment = this;\n  \t\twhile (!fragment.context) {\n  \t\t\tfragment = fragment.parent;\n  \t\t}return fragment.context;\n  \t};\n\n  \tFragment.prototype.findNextNode = function findNextNode(item) {\n  \t\t// search for the next node going forward\n  \t\tfor (var i = item.index + 1; i < this.items.length; i++) {\n  \t\t\tif (!this.items[i]) continue;\n\n  \t\t\tvar node = this.items[i].firstNode(true);\n  \t\t\tif (node) return node;\n  \t\t}\n\n  \t\t// if this is the root fragment, and there are no more items,\n  \t\t// it means we're at the end...\n  \t\tif (this.isRoot) {\n  \t\t\tif (this.ractive.component) {\n  \t\t\t\treturn this.ractive.component.parentFragment.findNextNode(this.ractive.component);\n  \t\t\t}\n\n  \t\t\t// TODO possible edge case with other content\n  \t\t\t// appended to this.ractive.el?\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  \t};\n\n  \tFragment.prototype.findParentNode = function findParentNode() {\n  \t\tvar fragment = this;\n\n  \t\tdo {\n  \t\t\tif (fragment.owner.type === ELEMENT) {\n  \t\t\t\treturn fragment.owner.node;\n  \t\t\t}\n\n  \t\t\tif (fragment.isRoot && !fragment.ractive.component) {\n  \t\t\t\t// TODO encapsulate check\n  \t\t\t\treturn fragment.ractive.el;\n  \t\t\t}\n\n  \t\t\tif (fragment.owner.type === YIELDER) {\n  \t\t\t\tfragment = fragment.owner.containerFragment;\n  \t\t\t} else {\n  \t\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n  \t\t\t}\n  \t\t} while (fragment);\n\n  \t\tthrow new Error('Could not find parent node'); // TODO link to issue tracker\n  \t};\n\n  \tFragment.prototype.findRepeatingFragment = function findRepeatingFragment() {\n  \t\tvar fragment = this;\n  \t\t// TODO better check than fragment.parent.iterations\n  \t\twhile (fragment.parent && !fragment.isIteration) {\n  \t\t\tfragment = fragment.parent || fragment.componentParent;\n  \t\t}\n\n  \t\treturn fragment;\n  \t};\n\n  \tFragment.prototype.firstNode = function firstNode(skipParent) {\n  \t\tvar node = void 0;\n  \t\tfor (var i = 0; i < this.items.length; i++) {\n  \t\t\tnode = this.items[i].firstNode(true);\n\n  \t\t\tif (node) {\n  \t\t\t\treturn node;\n  \t\t\t}\n  \t\t}\n\n  \t\tif (skipParent) return null;\n\n  \t\treturn this.parent.findNextNode(this.owner);\n  \t};\n\n  \t// TODO ideally, this would be deprecated in favour of an\n  \t// expression-like approach\n\n\n  \tFragment.prototype.getArgsList = function getArgsList() {\n  \t\tif (this.dirtyArgs) {\n  \t\t\tvar values = {};\n  \t\t\tvar source = processItems(this.items, values, this.ractive._guid);\n  \t\t\tvar parsed = parseJSON('[' + source + ']', values);\n\n  \t\t\tthis.argsList = parsed ? parsed.value : [this.toString()];\n\n  \t\t\tthis.dirtyArgs = false;\n  \t\t}\n\n  \t\treturn this.argsList;\n  \t};\n\n  \tFragment.prototype.rebind = function rebind(context) {\n  \t\tthis.context = context;\n\n  \t\tthis.items.forEach(_rebind);\n  \t};\n\n  \tFragment.prototype.render = function render(target, occupants) {\n  \t\tif (this.rendered) throw new Error('Fragment is already rendered!');\n  \t\tthis.rendered = true;\n\n  \t\tthis.items.forEach(function (item) {\n  \t\t\treturn item.render(target, occupants);\n  \t\t});\n  \t};\n\n  \tFragment.prototype.resetTemplate = function resetTemplate(template) {\n  \t\tvar wasBound = this.bound;\n  \t\tvar wasRendered = this.rendered;\n\n  \t\t// TODO ensure transitions are disabled globally during reset\n\n  \t\tif (wasBound) {\n  \t\t\tif (wasRendered) this.unrender(true);\n  \t\t\tthis.unbind();\n  \t\t}\n\n  \t\tthis.template = template;\n  \t\tthis.createItems();\n\n  \t\tif (wasBound) {\n  \t\t\tthis.bind(this.context);\n\n  \t\t\tif (wasRendered) {\n  \t\t\t\tvar parentNode = this.findParentNode();\n  \t\t\t\tvar anchor = this.parent ? this.parent.findNextNode(this.owner) : null;\n\n  \t\t\t\tif (anchor) {\n  \t\t\t\t\tvar docFrag = createDocumentFragment();\n  \t\t\t\t\tthis.render(docFrag);\n  \t\t\t\t\tparentNode.insertBefore(docFrag, anchor);\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.render(parentNode);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tFragment.prototype.resolve = function resolve(template, callback) {\n  \t\tif (!this.context) {\n  \t\t\treturn this.parent.resolve(template, callback);\n  \t\t}\n\n  \t\tvar resolver = new ReferenceResolver(this, template, callback);\n  \t\tthis.resolvers.push(resolver);\n\n  \t\treturn resolver; // so we can e.g. force resolution\n  \t};\n\n  \tFragment.prototype.toHtml = function toHtml() {\n  \t\treturn this.toString();\n  \t};\n\n  \tFragment.prototype.toString = function toString(escape) {\n  \t\treturn this.items.map(escape ? toEscapedString : _toString).join('');\n  \t};\n\n  \tFragment.prototype.unbind = function unbind() {\n  \t\tthis.items.forEach(_unbind);\n  \t\tthis.bound = false;\n\n  \t\treturn this;\n  \t};\n\n  \tFragment.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.items.forEach(shouldDestroy ? unrenderAndDestroy$1 : _unrender);\n  \t\tthis.rendered = false;\n  \t};\n\n  \tFragment.prototype.update = function update() {\n  \t\tif (this.dirty && !this.updating) {\n  \t\t\tthis.dirty = false;\n  \t\t\tthis.updating = true;\n  \t\t\tthis.items.forEach(_update);\n  \t\t\tthis.updating = false;\n  \t\t}\n  \t};\n\n  \tFragment.prototype.valueOf = function valueOf() {\n  \t\tif (this.items.length === 1) {\n  \t\t\treturn this.items[0].valueOf();\n  \t\t}\n\n  \t\tif (this.dirtyValue) {\n  \t\t\tvar values = {};\n  \t\t\tvar source = processItems(this.items, values, this.ractive._guid);\n  \t\t\tvar parsed = parseJSON(source, values);\n\n  \t\t\tthis.value = parsed ? parsed.value : this.toString();\n\n  \t\t\tthis.dirtyValue = false;\n  \t\t}\n\n  \t\treturn this.value;\n  \t};\n\n  \treturn Fragment;\n  }();\n\n  // TODO should resetTemplate be asynchronous? i.e. should it be a case\n  // of outro, update template, intro? I reckon probably not, since that\n  // could be achieved with unrender-resetTemplate-render. Also, it should\n  // conceptually be similar to resetPartial, which couldn't be async\n\n  function Ractive$resetTemplate(template) {\n  \ttemplateConfigurator.init(null, this, { template: template });\n\n  \tvar transitionsEnabled = this.transitionsEnabled;\n  \tthis.transitionsEnabled = false;\n\n  \t// Is this is a component, we need to set the `shouldDestroy`\n  \t// flag, otherwise it will assume by default that a parent node\n  \t// will be detached, and therefore it doesn't need to bother\n  \t// detaching its own nodes\n  \tvar component = this.component;\n  \tif (component) component.shouldDestroy = true;\n  \tthis.unrender();\n  \tif (component) component.shouldDestroy = false;\n\n  \t// remove existing fragment and create new one\n  \tthis.fragment.unbind().unrender(true);\n\n  \tthis.fragment = new Fragment({\n  \t\ttemplate: this.template,\n  \t\troot: this,\n  \t\towner: this\n  \t});\n\n  \tvar docFrag = createDocumentFragment();\n  \tthis.fragment.bind(this.viewmodel).render(docFrag);\n  \tthis.el.insertBefore(docFrag, this.anchor);\n\n  \tthis.transitionsEnabled = transitionsEnabled;\n  }\n\n  var reverse = makeArrayMethod('reverse');\n\n  function Ractive$set(keypath, value) {\n  \tvar promise = runloop.start(this, true);\n\n  \t// Set multiple keypaths in one go\n  \tif (isObject(keypath)) {\n  \t\tvar map = keypath;\n\n  \t\tfor (var k in map) {\n  \t\t\tif (map.hasOwnProperty(k)) {\n  \t\t\t\tset(this, k, map[k]);\n  \t\t\t}\n  \t\t}\n  \t}\n  \t// Set a single keypath\n  \telse {\n  \t\t\tset(this, keypath, value);\n  \t\t}\n\n  \trunloop.end();\n\n  \treturn promise;\n  }\n\n  function set(ractive, keypath, value) {\n  \tif (typeof value === 'function') value = bind(value, ractive);\n\n  \tif (/\\*/.test(keypath)) {\n  \t\tractive.viewmodel.findMatches(splitKeypathI(keypath)).forEach(function (model) {\n  \t\t\tmodel.set(value);\n  \t\t});\n  \t} else {\n  \t\tvar model = ractive.viewmodel.joinAll(splitKeypathI(keypath));\n  \t\tmodel.set(value);\n  \t}\n  }\n\n  var shift = makeArrayMethod('shift');\n\n  var sort = makeArrayMethod('sort');\n\n  var splice = makeArrayMethod('splice');\n\n  function Ractive$subtract(keypath, d) {\n  \treturn add(this, keypath, d === undefined ? -1 : -d);\n  }\n\n  var teardownHook$1 = new Hook('teardown');\n\n  // Teardown. This goes through the root fragment and all its children, removing observers\n  // and generally cleaning up after itself\n\n  function Ractive$teardown() {\n  \tvar _this = this;\n\n  \tthis.fragment.unbind();\n  \tthis.viewmodel.teardown();\n\n  \tthis._observers.forEach(cancel);\n\n  \tif (this.fragment.rendered && this.el.__ractive_instances__) {\n  \t\tremoveFromArray(this.el.__ractive_instances__, this);\n  \t}\n\n  \tthis.shouldDestroy = true;\n  \tvar promise = this.fragment.rendered ? this.unrender() : Promise$1.resolve();\n\n  \tObject.keys(this._links).forEach(function (k) {\n  \t\treturn _this._links[k].unlink();\n  \t});\n\n  \tteardownHook$1.fire(this);\n\n  \treturn promise;\n  }\n\n  function Ractive$toggle(keypath) {\n  \tif (typeof keypath !== 'string') {\n  \t\tthrow new TypeError(badArguments);\n  \t}\n\n  \tvar changes = void 0;\n\n  \tif (/\\*/.test(keypath)) {\n  \t\tchanges = {};\n\n  \t\tthis.viewmodel.findMatches(splitKeypathI(keypath)).forEach(function (model) {\n  \t\t\tchanges[model.getKeypath()] = !model.get();\n  \t\t});\n\n  \t\treturn this.set(changes);\n  \t}\n\n  \treturn this.set(keypath, !this.get(keypath));\n  }\n\n  function Ractive$toCSS() {\n  \tvar cssIds = [this.cssId].concat(babelHelpers.toConsumableArray(this.findAllComponents().map(function (c) {\n  \t\treturn c.cssId;\n  \t})));\n  \tvar uniqueCssIds = Object.keys(cssIds.reduce(function (ids, id) {\n  \t\treturn ids[id] = true, ids;\n  \t}, {}));\n  \treturn getCSS(uniqueCssIds);\n  }\n\n  function Ractive$toHTML() {\n  \treturn this.fragment.toString(true);\n  }\n\n  function Ractive$transition(name, node, params) {\n\n  \tif (node instanceof HTMLElement) {\n  \t\t// good to go\n  \t} else if (isObject(node)) {\n  \t\t\t// omitted, use event node\n  \t\t\tparams = node;\n  \t\t}\n\n  \t// if we allow query selector, then it won't work\n  \t// simple params like \"fast\"\n\n  \t// else if ( typeof node === 'string' ) {\n  \t// \t// query selector\n  \t// \tnode = this.find( node )\n  \t// }\n\n  \tnode = node || this.event.node;\n\n  \tif (!node) {\n  \t\tfatal('No node was supplied for transition ' + name);\n  \t}\n\n  \tvar transition = new Transition(this, node, name, params);\n  \tvar promise = runloop.start(this, true);\n  \trunloop.registerTransition(transition);\n  \trunloop.end();\n  \treturn promise;\n  }\n\n  function unlink(here) {\n  \tvar ln = this._links[here];\n\n  \tif (ln) {\n  \t\tln.unlink();\n  \t\tdelete this._links[here];\n  \t\treturn this.set(here, ln.intialValue);\n  \t} else {\n  \t\treturn Promise$1.resolve(true);\n  \t}\n  }\n\n  var unrenderHook$1 = new Hook('unrender');\n\n  function Ractive$unrender() {\n  \tif (!this.fragment.rendered) {\n  \t\twarnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n  \t\treturn Promise$1.resolve();\n  \t}\n\n  \tvar promise = runloop.start(this, true);\n\n  \t// If this is a component, and the component isn't marked for destruction,\n  \t// don't detach nodes from the DOM unnecessarily\n  \tvar shouldDestroy = !this.component || this.component.shouldDestroy || this.shouldDestroy;\n  \tthis.fragment.unrender(shouldDestroy);\n\n  \tremoveFromArray(this.el.__ractive_instances__, this);\n\n  \tunrenderHook$1.fire(this);\n\n  \trunloop.end();\n  \treturn promise;\n  }\n\n  var unshift = makeArrayMethod('unshift');\n\n  var updateHook = new Hook('update');\n\n  function Ractive$update(keypath) {\n  \tif (keypath) keypath = splitKeypathI(keypath);\n\n  \tvar model = keypath ? this.viewmodel.joinAll(keypath) : this.viewmodel;\n\n  \tvar promise = runloop.start(this, true);\n\n  \tmodel.mark();\n\n  \tif (keypath) {\n  \t\t// there may be unresolved refs that are now resolvable up the context tree\n  \t\tvar _parent = model.parent;\n  \t\twhile (keypath.length && _parent) {\n  \t\t\tif (_parent.clearUnresolveds) _parent.clearUnresolveds(keypath.pop());\n  \t\t\t_parent = _parent.parent;\n  \t\t}\n  \t}\n\n  \t// notify upstream\n  \tvar parent = model.parent;\n  \twhile (parent) {\n  \t\tvar i = parent.deps.length;\n  \t\twhile (i--) {\n  \t\t\tparent.deps[i].handleChange();\n  \t\t}parent = parent.parent;\n  \t}\n\n  \trunloop.end();\n\n  \tupdateHook.fire(this, model);\n\n  \treturn promise;\n  }\n\n  function Ractive$updateModel(keypath, cascade) {\n  \tvar promise = runloop.start(this, true);\n\n  \tif (!keypath) {\n  \t\tthis.viewmodel.updateFromBindings(true);\n  \t} else {\n  \t\tthis.viewmodel.joinAll(splitKeypathI(keypath)).updateFromBindings(cascade !== false);\n  \t}\n\n  \trunloop.end();\n\n  \treturn promise;\n  }\n\n  var proto = {\n  \tadd: Ractive$add,\n  \tanimate: Ractive$animate,\n  \tdetach: Ractive$detach,\n  \tfind: Ractive$find,\n  \tfindAll: Ractive$findAll,\n  \tfindAllComponents: Ractive$findAllComponents,\n  \tfindComponent: Ractive$findComponent,\n  \tfindContainer: Ractive$findContainer,\n  \tfindParent: Ractive$findParent,\n  \tfire: Ractive$fire,\n  \tget: Ractive$get,\n  \tinsert: Ractive$insert,\n  \tlink: link,\n  \tmerge: Ractive$merge,\n  \tobserve: observe,\n  \tobserveList: observeList,\n  \tobserveOnce: observeOnce,\n  \t// TODO reinstate these\n  \t// observeListOnce,\n  \toff: Ractive$off,\n  \ton: Ractive$on,\n  \tonce: Ractive$once,\n  \tpop: pop,\n  \tpush: push,\n  \trender: Ractive$render,\n  \treset: Ractive$reset,\n  \tresetPartial: resetPartial,\n  \tresetTemplate: Ractive$resetTemplate,\n  \treverse: reverse,\n  \tset: Ractive$set,\n  \tshift: shift,\n  \tsort: sort,\n  \tsplice: splice,\n  \tsubtract: Ractive$subtract,\n  \tteardown: Ractive$teardown,\n  \ttoggle: Ractive$toggle,\n  \ttoCSS: Ractive$toCSS,\n  \ttoCss: Ractive$toCSS,\n  \ttoHTML: Ractive$toHTML,\n  \ttoHtml: Ractive$toHTML,\n  \ttransition: Ractive$transition,\n  \tunlink: unlink,\n  \tunrender: Ractive$unrender,\n  \tunshift: unshift,\n  \tupdate: Ractive$update,\n  \tupdateModel: Ractive$updateModel\n  };\n\n  function wrap$1 (method, superMethod, force) {\n\n  \tif (force || needsSuper(method, superMethod)) {\n\n  \t\treturn function () {\n\n  \t\t\tvar hasSuper = '_super' in this,\n  \t\t\t    _super = this._super,\n  \t\t\t    result;\n\n  \t\t\tthis._super = superMethod;\n\n  \t\t\tresult = method.apply(this, arguments);\n\n  \t\t\tif (hasSuper) {\n  \t\t\t\tthis._super = _super;\n  \t\t\t}\n\n  \t\t\treturn result;\n  \t\t};\n  \t} else {\n  \t\treturn method;\n  \t}\n  }\n\n  function needsSuper(method, superMethod) {\n  \treturn typeof superMethod === 'function' && /_super/.test(method);\n  }\n\n  function unwrap(Child) {\n  \tvar options = {};\n\n  \twhile (Child) {\n  \t\taddRegistries(Child, options);\n  \t\taddOtherOptions(Child, options);\n\n  \t\tif (Child._Parent !== Ractive) {\n  \t\t\tChild = Child._Parent;\n  \t\t} else {\n  \t\t\tChild = false;\n  \t\t}\n  \t}\n\n  \treturn options;\n  }\n\n  function addRegistries(Child, options) {\n  \tregistries.forEach(function (r) {\n  \t\taddRegistry(r.useDefaults ? Child.prototype : Child, options, r.name);\n  \t});\n  }\n\n  function addRegistry(target, options, name) {\n  \tvar registry,\n  \t    keys = Object.keys(target[name]);\n\n  \tif (!keys.length) {\n  \t\treturn;\n  \t}\n\n  \tif (!(registry = options[name])) {\n  \t\tregistry = options[name] = {};\n  \t}\n\n  \tkeys.filter(function (key) {\n  \t\treturn !(key in registry);\n  \t}).forEach(function (key) {\n  \t\treturn registry[key] = target[name][key];\n  \t});\n  }\n\n  function addOtherOptions(Child, options) {\n  \tObject.keys(Child.prototype).forEach(function (key) {\n  \t\tif (key === 'computed') {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar value = Child.prototype[key];\n\n  \t\tif (!(key in options)) {\n  \t\t\toptions[key] = value._method ? value._method : value;\n  \t\t}\n\n  \t\t// is it a wrapped function?\n  \t\telse if (typeof options[key] === 'function' && typeof value === 'function' && options[key]._method) {\n\n  \t\t\t\tvar result = void 0,\n  \t\t\t\t    needsSuper = value._method;\n\n  \t\t\t\tif (needsSuper) {\n  \t\t\t\t\tvalue = value._method;\n  \t\t\t\t}\n\n  \t\t\t\t// rewrap bound directly to parent fn\n  \t\t\t\tresult = wrap$1(options[key]._method, value);\n\n  \t\t\t\tif (needsSuper) {\n  \t\t\t\t\tresult._method = result;\n  \t\t\t\t}\n\n  \t\t\t\toptions[key] = result;\n  \t\t\t}\n  \t});\n  }\n\n  function extend() {\n  \tfor (var _len = arguments.length, options = Array(_len), _key = 0; _key < _len; _key++) {\n  \t\toptions[_key] = arguments[_key];\n  \t}\n\n  \tif (!options.length) {\n  \t\treturn extendOne(this);\n  \t} else {\n  \t\treturn options.reduce(extendOne, this);\n  \t}\n  }\n\n  function extendOne(Parent) {\n  \tvar options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  \tvar _Child, proto;\n\n  \t// if we're extending with another Ractive instance...\n  \t//\n  \t//   var Human = Ractive.extend(...), Spider = Ractive.extend(...);\n  \t//   var Spiderman = Human.extend( Spider );\n  \t//\n  \t// ...inherit prototype methods and default options as well\n  \tif (options.prototype instanceof Ractive) {\n  \t\toptions = unwrap(options);\n  \t}\n\n  \t_Child = function Child(options) {\n  \t\tif (!(this instanceof _Child)) return new _Child(options);\n\n  \t\tconstruct(this, options || {});\n  \t\tinitialise(this, options || {}, {});\n  \t};\n\n  \tproto = create(Parent.prototype);\n  \tproto.constructor = _Child;\n\n  \t// Static properties\n  \tdefineProperties(_Child, {\n  \t\t// alias prototype as defaults\n  \t\tdefaults: { value: proto },\n\n  \t\t// extendable\n  \t\textend: { value: extend, writable: true, configurable: true },\n\n  \t\t// Parent - for IE8, can't use Object.getPrototypeOf\n  \t\t_Parent: { value: Parent }\n  \t});\n\n  \t// extend configuration\n  \tconfig.extend(Parent, proto, options);\n\n  \tdataConfigurator.extend(Parent, proto, options);\n\n  \tif (options.computed) {\n  \t\tproto.computed = extendObj(create(Parent.prototype.computed), options.computed);\n  \t}\n\n  \t_Child.prototype = proto;\n\n  \treturn _Child;\n  }\n\n  function getNodeInfo (node) {\n  \tif (!node || !node._ractive) return {};\n\n  \tvar storage = node._ractive;\n  \tvar ractive = storage.fragment.ractive;\n\n  \tvar _gatherRefs = gatherRefs(storage.fragment);\n\n  \tvar key = _gatherRefs.key;\n  \tvar index = _gatherRefs.index;\n\n  \tvar context = storage.fragment.findContext();\n\n  \treturn {\n  \t\tractive: ractive,\n  \t\tkeypath: context.getKeypath(ractive),\n  \t\trootpath: context.getKeypath(),\n  \t\tindex: index,\n  \t\tkey: key\n  \t};\n  }\n\n  function joinKeys() {\n  \tfor (var _len = arguments.length, keys = Array(_len), _key = 0; _key < _len; _key++) {\n  \t\tkeys[_key] = arguments[_key];\n  \t}\n\n  \treturn keys.map(escapeKey).join('.');\n  }\n\n  function splitKeypath(keypath) {\n  \treturn splitKeypathI(keypath).map(unescapeKey);\n  }\n\n  // Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n  // older browsers, these are made available via a shim - here, we do a quick\n  // pre-flight check to make sure that either a) we're not in a shit browser,\n  // or b) we're using a Ractive-legacy.js build\n  var FUNCTION = 'function';\n\n  if (babelHelpers.typeof(Date.now) !== FUNCTION || babelHelpers.typeof(String.prototype.trim) !== FUNCTION || babelHelpers.typeof(Object.keys) !== FUNCTION || babelHelpers.typeof(Array.prototype.indexOf) !== FUNCTION || babelHelpers.typeof(Array.prototype.forEach) !== FUNCTION || babelHelpers.typeof(Array.prototype.map) !== FUNCTION || babelHelpers.typeof(Array.prototype.filter) !== FUNCTION || win && babelHelpers.typeof(win.addEventListener) !== FUNCTION) {\n  \tthrow new Error('It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.');\n  }\n\n  function Ractive(options) {\n  \tif (!(this instanceof Ractive)) return new Ractive(options);\n\n  \tconstruct(this, options || {});\n  \tinitialise(this, options || {}, {});\n  }\n\n  extendObj(Ractive.prototype, proto, defaults);\n  Ractive.prototype.constructor = Ractive;\n\n  // alias prototype as `defaults`\n  Ractive.defaults = Ractive.prototype;\n\n  // static properties\n  defineProperties(Ractive, {\n\n  \t// debug flag\n  \tDEBUG: { writable: true, value: true },\n  \tDEBUG_PROMISES: { writable: true, value: true },\n\n  \t// static methods:\n  \textend: { value: extend },\n  \tescapeKey: { value: escapeKey },\n  \tgetNodeInfo: { value: getNodeInfo },\n  \tjoinKeys: { value: joinKeys },\n  \tparse: { value: parse },\n  \tsplitKeypath: { value: splitKeypath },\n  \tunescapeKey: { value: unescapeKey },\n  \tgetCSS: { value: getCSS },\n\n  \t// namespaced constructors\n  \tPromise: { value: Promise$1 },\n\n  \t// support\n  \tenhance: { writable: true, value: false },\n  \tsvg: { value: svg },\n  \tmagic: { value: magicSupported },\n\n  \t// version\n  \tVERSION: { value: '0.8.0-edge' },\n\n  \t// plugins\n  \tadaptors: { writable: true, value: {} },\n  \tcomponents: { writable: true, value: {} },\n  \tdecorators: { writable: true, value: {} },\n  \teasing: { writable: true, value: easing },\n  \tevents: { writable: true, value: {} },\n  \tinterpolators: { writable: true, value: interpolators },\n  \tpartials: { writable: true, value: {} },\n  \ttransitions: { writable: true, value: {} }\n  });\n\n  return Ractive;\n\n}));"],"names":["this","binding","createTwowayBinding","bind","Element","prototype","attributes","template","a","shouldBind","twoway","ractive","Binding","selectBinding","model","detach","decorator","unrender","detachNode","node","find","selector","matches","fragment","findAll","query","test","add","live","liveQueries","push","findComponent","name","findAllComponents","findNextNode","firstNode","getAttribute","attribute","attributeByName","getValue","undefined","rebind","forEach","_rebind","conditionalAttributes","eventHandlers","makeDirty$1","render","target","occupants","_this2","namespace","getNamespace","existing","n","shift","nodeName","e","toUpperCase","namespaceURI","createElement","defineProperty","value","proxy","parentFragment","cssIds","setAttribute","map","x","join","foundNode","children","toArray","childNodes","wasUndefined","setFromNode","i","length","removeAttribute","_render","runloop","scheduleTask","updateLiveQueries$1","_introTransition","getTransition","t0","t1","appendChild","rendered","toString","tagName","attrs","stringifyAttribute","isSelected","inputIsCheckedRadio","str","isVoid","escapeHtml","unbind","_unbind","shouldDestroy","transition","complete","detachWhenReady","_unrender","t2","id","nodes","removeFromLiveQueries","update","dirty","_update","Item","Form","_Element","options","babelHelpers","classCallCheck","_this","possibleConstructorReturn","call","formBindings","inherits","addEventListener","handleReset","removeEventListener","Mustache","_Item","index","isStatic","s","resolve$1","get","register","resolver","resolve","r","handleChange","bubble","unregister","Interpolator","_Mustache","apply","arguments","getString","safeToStringValue","nodeType","nodeValue","doc","createTextNode","insertBefore","escape","string","data","valueOf","Input","defaultValue","Option","f","select","findParentSelect","parent","selectedAttribute","selected","indexOf","splice","optionValue","selectValue","isArray","removeFromArray","Partial","refName","getPartialTemplate","templateObj","named","setTemplate","t","parsePartial","Fragment","owner","partialTemplate","skipParent","forceResetTemplate","warnOnceIfDebug","resetTemplate","RepeatedFragment","context","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","createIteration","isObject","refs","split","Object","keys","key","isIteration","joinKey","z","aliases","docFrag","createDocumentFragment","len","found","iteration","shuffle","newIndices","_this3","slice","newIndex","oldIndex","toEscapedString","_toString","unrenderAndDestroy","_this4","updatePostShuffle","updating","wasArray","toRemove","oldKeys","reset","_fragment","newLength","parentNode","findParentNode","anchor","_this5","indices","maxIdx","merged","frag","_frag","Section","sectionType","templateSectionType","SECTION_UNLESS","SECTION_IF","SECTION_EACH","isRoot","lastType","getType","newFragment","SECTION_WITH","SECTION_IF_WITH","isEmpty","fragmentShouldExist","Select","selectedOptions","getSelectedOptions","sync","defaultSelected","selectNode","o","isMultiple","optionWasSelected","_ractive","shouldSelect","valueContains","forceUpdate","Textarea","_Input","isBindable","noContent","Text","type","TEXT","elementCache","ieBug","ieBlacklist","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","Triple","queryResult","querySelector","queryAllResult","querySelectorAll","numNodes","j","html","insertHtml","decodeCharacterReferences","Yielder","container","component","containerFragment","yielders","_inlinePartials","parse","warnIfDebug","partials","constructors","ALIAS","Alias","DOCTYPE","Doctype","INTERPOLATOR","PARTIAL","SECTION","TRIPLE","YIELDER","specialElements","doctype","form","input","option","textarea","ReferenceResolver","reference","callback","normalise","splitKeypathI","resolved","addUnresolved","componentParent","attemptResolution","resolveAmbiguousReference","forceResolution","findContext","joinAll","unresolved","resolvers","dirtyArgs","dirtyValue","createItems","items","_bind","bound","addFragment","createItem","item","ELEMENT","el","Error","findRepeatingFragment","getArgsList","values","source","processItems","_guid","parsed","parseJSON","argsList","wasBound","wasRendered","toHtml","unrenderAndDestroy$1","reverse","makeArrayMethod","sort","teardownHook$1","Hook","unrenderHook$1","unshift","updateHook","proto","Ractive$add","animate","Ractive$animate","Ractive$detach","Ractive$find","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","findContainer","Ractive$findContainer","findParent","Ractive$findParent","fire","Ractive$fire","Ractive$get","insert","Ractive$insert","link","merge","Ractive$merge","observe","observeList","observeOnce","off","Ractive$off","on","Ractive$on","once","Ractive$once","pop","Ractive$render","Ractive$reset","resetPartial","Ractive$resetTemplate","set","Ractive$set","subtract","Ractive$subtract","teardown","Ractive$teardown","toggle","Ractive$toggle","toCSS","Ractive$toCSS","toCss","toHTML","Ractive$toHTML","Ractive$transition","unlink","Ractive$unrender","Ractive$update","updateModel","Ractive$updateModel","FUNCTION","Date","now","String","trim","Array","filter","win","extendObj","Ractive","defaults","constructor","defineProperties","DEBUG","writable","DEBUG_PROMISES","extend","escapeKey","getNodeInfo","joinKeys","splitKeypath","unescapeKey","getCSS","Promise","Promise$1","enhance","svg","magic","magicSupported","VERSION","adaptors","components","decorators","easing","events","interpolators","transitions","viewmodel","localKey","instance","childData","complexMappings","initialise","_partials","Component","checkYielders","end","makeDirty","mappings","updateLiveQueries","setupEvents","handlers","v","eventNames","eventName","event","RactiveEvent","EventDirective","_observers","cancel","removeFromLiveComponentQueries","__ractive_instances__","_links","k","teardownHook","_this6","remove","textTypes","propertyNames","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","booleanAttributes","voidElementNames","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","prop","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","RegExp","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","Attribute","element","updateDelegate","interpolator","namespaces","propertyName","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","getKeypath","replace","div$1","ConditionalAttribute","isSvg","svg$1","parseAttributes","notIn","missingDecorator","noop","Decorator","dynamicName","dynamicArgs","d","nameFragment","argsFragment","args","intermediary","fn","findInViewHierarchy","warnOnce","missingPlugin","concat","nameChanged","DOMEvent","fatal","handler","listen","directive","original","unlisten","CustomEvent","eventPlugin","prefix","isClient","prefixCache","testStyle","style","camelCase","capped","charAt","substring","vendors","vendor","prefix$1","visible","hidden","prefix$2","i$1","onChange","onHide","onShow","unprefixPattern","vendorPattern","createTransitions","linear","canUseCssTransitions","cannotUseCssTransitions","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","webkitTransition","to","changedProperties","setTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","isIntro","transitionEndHandler","unprefix","previous","property","duration","timing","hashPrefix","hyphenate","hash","originalValue","propertiesToTransitionInJs","suffix","getStyle","exec","interpolate","parseFloat","Ticker","step","pos","_prop","delay","createTransitions$1","getComputedStyle","legacy","Transition","params","_fn","animateStyle","setStyle","fulfil","computedStyle","current","props","styles","_value","processParams","hasOwnProperty","start","originalStyle","completed","noReset","resetStyle","_manager","promise","then","twowayBinding","isUnresolved","warnAboutAmbiguity","isReadonly","keypath","getInitialValue","parentForm","findParentForm","resetValue","registerTwowayBinding","root","locked","unregisterTwowayBinding","CheckboxBinding","_Binding","handleDomEvent","attachEvent","checked","BindingGroup","bindings","push$1","CheckboxNameBinding","checkboxName","group","getBindingGroup","getValue$1","noInitialValue","existingValue","bindingValue","arrayContains","changed","wasChecked","isChecked","valueSoFar","ContentEditableBinding","lazy","GenericBinding","timeout","isNumeric","handleDelay","handleBlur","MultipleSelectBinding","selectedValues","previousValue","arrayContentsMatch","result","setValue","initialValue","NumericBinding","_GenericBinding","isNaN","siblings","RadioBinding","getSiblings","RadioNameBinding","getValue$2","nameAttributeBinding","getKeypathModel","SingleSelectBinding","disabled","toLowerCase","m","Link","side","dest","LinkSide","comparators","Observer","oldValue","newValue","defer","strict","init","dispatch","addObserver","PatternObserver","baseModel","pattern","baseKeypath","oldValues","newValues","models","findMatches","newKeys","isEqual","wildcards","base","max","_i","touchedFrom","ListObserver","pending","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","notEmptyString","arrayProto","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","getElementsByTagName","styleSheet","renderHook","completeHook","adaptConfigurator","Parent","adapt","combine","ensureArray","selectorsPattern","commentsPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","cssConfigurator","css","uuid","noCssTransform","transformCss","cssId","addCSS","dataConfigurator","combine$1","TEMPLATE_VERSION","functions","create","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","parser","fromId","noThrow","getElementById","textContent","isParsed","getParseOptions","reduce","val","throwNoParse","addFunctions","parseFor","templateConfigurator","parseTemplate","getDynamicTemplate","_config","p","extendPartials","registryNames","Registry","useDefaults","configure","registry","isOwner","registries","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","c","shouldRerender","completeHook$1","resetHook","renderHook$1","unrenderHook","COMPONENT","NUMBER_LITERAL","STRING_LITERAL","REFERENCE","ComputationChild","_Model","shouldCapture","capture","parentValue","deps","_handleChange","clearUnresolveds","childByKey","child","Model","ExpressionProxy","getFunction","computation","ref","resolveReference","match","signature","getter","getterString","compute","mark","retrieve","dep","ReferenceExpressionChild","applyValue","ReferenceExpressionProxy","_Model2","baseResolver","members","keypathModel","resolveAliases","mutatorMethods","patchedArrayProto","methodName","method","_len","_key","getNewIndices","setting","wrappers","processWrapper","patchArrayMethods","unpatchArrayMethods","__proto__","array","configurable","unpatch","patch","errorMessage$1","arrayAdaptor","object","wrap","ArrayWrapper","__model","instances","storage","magicAdaptor","MagicWrapper","Parser","ParseError","magicAdaptor$1","originalDescriptors","originalDescriptor","getOwnPropertyDescriptor","childKeypath","descriptor","createOrWrapDescriptor","__magic","revert","dependants","MagicArrayWrapper","magicWrapper","arrayWrapper","magicArrayAdaptor","Computation","isExpression","setter","computationContext","dependencies","boundsSensitive","startCapturing","message","hasConsole","console","groupCollapsed","functionBody","prettify","stack","getterUseStack","truncateStack","error","groupEnd","stopCapturing","setDependencies","_model","computations","RactiveModel","changes","hasProp$1","RootModel","applyChanges","_changeHash","flush","extendChildren","getRactiveModel","ractiveModel","getValueChildren","has","Function","GlobalModel$1","origin","wrapper","shouldTeardown","updateFromBindings","cascade","constructHook","registryNames$1","uid","HookQueue","hook","inProcess","queue","begin","getChildQueue","configHook","initHook","leadingWhitespace","lineStart","lines","lineEnds","line","lineEnd","read","leftover","remaining","postProcess","converters","getLinePos","char","columnNum","lineNum","numTabs","annotation","character","shortMessage","matchString","substr","matchPattern","allowWhitespace","nextChar","Child","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","Parser$1","getSingleQuotedString","makeQuotedStringMatcher","getDoubleQuotedString","numberPattern$1","identifier","specials","true","false","null","specialsPattern","numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","placeholder","special","number","stringLiteral","readStringLiteral","$1","pair","getKeyValuePair","valueToken","eventPattern","argumentsPattern","dollarArgsPattern","passthru","argsFn","action","g","argMatch","argument","dollarMatch","passedArgs","gatherRefs","rootpath","obj","oldEvent","preventDefault","stopPropagation","_args","fireEvent","ComponentConstructor","content","construct","code","qualified","hasAttribute","haystack","needle","hyphenatedStr","_liveQueries","description","all","b","res","clearTimeout","bindName","bindChecked","transitionsEnabled","getTransitionName","getTransitionParams","registerTransition","typeAttribute","valueAttribute","nameAttribute","xmlns","partial","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","_Parent","hasIndexRef","selectedOption","selectedIndex","firstChild","getComponentConstructor","ElementConstructor","guid","counter","placeholderId","TypeError","badArguments","toConsumableArray","uniqueCssIds","ids","HTMLElement","here","ln","intialValue","_parent","wrap$1","superMethod","force","needsSuper","hasSuper","_super","unwrap","addRegistries","addOtherOptions","addRegistry","_method","extendOne","_Child","computed","_gatherRefs","Symbol","iterator","Constructor","subClass","superClass","enumerable","setPrototypeOf","self","ReferenceError","arr","arr2","from","append","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","sanitize","stripComments","modifyArrays","isolated","noIntro","easeIn","Math","pow","easeOut","easeInOut","window","document","navigator","appName","warn","div","methodNames","unprefixed","prefixed","makeFunction","implementation","hasFeature","mathml","xlink","xml","ns","createElementNS","cloneNode","desc","F","log","printWarning","welcome","alreadyWarned","welcomeIntro","welcomeMessage","hasGroup","_Promise2","intermediate","min","properties","snap","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","errorMessage","deprecations","deprecated","replacement","deprecate","arg","PENDING","FULFILLED","REJECTED","dispatchHandlers","makeResolver","reject","fulfilledHandlers","rejectedHandlers","state","newState","makeDispatcher","wait","onFulfilled","onRejected","promise2","processResolutionHandler","forward","p1result","promises","processPromise","reason","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","addChild","list","decrementOutros","check","decrementTotal","detachNodes","_detachNodes","ready","changeHook","batch","returnPromise","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","addToArray","observer","thing","task","postRender","_batch","noAnimation","requestAnimationFrame","detachHook","Query","isComponentQuery","_root","nodeOrComponent","sortByItemPosition","sortByDocumentPosition","starMaps","wildcardCache","captureGroup","lastTime","currTime","timeToCall","rAF","getTime","performance","tickers","running","tick","elapsed","eased","stop","abort","prefixers","KeyModel","dependant","KeypathModel","keypathModels","removeChild","hasProp","originatingModel","indexModels","unresolvedByKey","ticker","adaptor","getPrefixer","createBranch","_parentValue","previousOriginatingModel","specificKey","hasKey","branch","existingMatches","_loop","getIndexModel","fragmentIndex","getKeyModel","mapped","old","comparator","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","_merged","updateKeypathDependants","_updateFromBindings","_updateKeypathDependants","GlobalModel","global","insertHook","factory","exports","module","define","amd","getElement","output","sources","_len2","_key2","isFinite","format","logIfDebug","_len3","_key3","registryName","interpol","lastItem","member","arrayLike","called","resolvePromise","rejectPromise","y","tm","which","getOptions","isDetached","otherNode","compareDocumentPosition","bitmask","ancestryA","getAncestry","ancestryB","oldestA","oldestB","mutualAncestor","fragmentA","fragmentB","indexA","indexB","_indexA","_indexB","getParent","ancestry","ancestor","_liveComponentQueries","enqueue","_eventQueue","dequeue","getPotentialWildcardMatches","starMap","mapper","wildcardKeypath","getStarMap","star","num","binary","l","ones","parseInt","digit","_noArg","getWildcardNames","fireEventAs","subscribers","initialFire","_subs","notifySubscribers","fullName","originalEvent","stopEvent","badReference","localViewmodel","hasContextChain","crossedComponentBoundary","prefixKeypath","rootKeypath","rootDot","relativeKeypath","repeater","parts","fireInsertHook","there","run","sourcePath","getComparator","JSON","stringify","compare","observers","createObserver","keypaths","wildcardIndex","_ret","listeners","listener","spliceArguments","removeStart","removeEnd","balance","getSpliceEquivalent","styleDefinition","applyCSS","cssText","filteredStyleDefinitions","others","trim$1","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","dataAttr","selectors","s4","floor","random","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","fromExpression","body","fromComputationString","bindTo","hasThis","createFunction","exp","instructions","createFunctionFromString","initial","parseAsString","validate$1","existingPartials","newPartials","overwrite","getSuperMethod","oldSuper","getMessage","correct","isError","deprecateOption","deprecatedOption","extendOtherMethods","rerender","collect","collection","rx","section","_ref","fnBody","tabs","minIndent","prev","Infinity","truncated","getComputationSignature","setterString","initialiseProperties","deprecateRactiveData","getAdaptors","combine$2","protoAdapt","lookup","hookQueue","childQueue","userOptions","okQuote","literal","done","next","charCodeAt","readNumberLiteral","readKey","token","updateId","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateIEStyleAttribute","updateBoolean","updateNamespacedAttribute","updateAttribute","updateClassName","className","setAttributeNS","entity","validateCode"],"mappings":";CAWC,SAAUw/C,EAAQE,GACE,gBAAZC,UAA0C,mBAAXC,QAAyBA,OAAOD,QAAUD,IAC9D,kBAAXG,SAAyBA,OAAOC,IAAMD,OAAOH,GACnDF,EAAO/kC,QAAUilC,KAClB1/C,KAAM,WAAc,YA+LpB,SAAS4M,KACR,MAAOxD,IAAIwD,yBAGZ,QAASmzC,GAAWxsC,GACnB,GAAIysC,EAEJ,IAAKzsC,GAA0B,iBAAVA,GAIrB,MAAKgH,KAAQnR,IAAQmK,EAKjBA,EAAMrK,SACFqK,EAIa,gBAAVA,KAEVysC,EAAS52C,GAAIu3B,eAAeptB,IAGvBysC,GAAU52C,GAAIqI,gBAClBuuC,EAAS52C,GAAIqI,cAAc8B,IAIxBysC,GAAUA,EAAO92C,UACb82C,EAKLzsC,EAAM,IAAMA,EAAM,GAAGrK,SACjBqK,EAAM,GAGP,KA7BC,KA+FT,QAASrS,GAAWC,GAKnB,MAJIA,IAAmC,iBAApBA,GAAK+M,YAA4B/M,EAAK+M,YACxD/M,EAAK+M,WAAWsvC,YAAYr8C,GAGtBA,EAGR,QAAS8H,GAAkBnF,GAC1B,MAAgB,OAATA,GAAkBA,EAAM2B,SAAgB,GAAK3B,EAAV,GA8E3C,QAAS0W,GAAUxX,GAGlB,IAAK,GAFDoqB,GAEKkY,EAAOv8B,UAAUlE,OAAQo7C,EAAU5lC,MAAMirB,EAAO,EAAIA,EAAO,EAAI,GAAIC,EAAO,EAAUD,EAAPC,EAAaA,IAClG0a,EAAQ1a,EAAO,GAAKx8B,UAAUw8B,EAW/B,OARA0a,GAAQv9C,QAAQ,SAAU8S,GACzB,IAAK4X,IAAQ5X,GACRk3B,GAAOllC,KAAKgO,EAAQ4X,KACvBpqB,EAAOoqB,GAAQ5X,EAAO4X,MAKlBpqB,EAGR,QAASquC,GAASruC,GACjB,IAAK,GAAIk9C,GAAQn3C,UAAUlE,OAAQo7C,EAAU5lC,MAAM6lC,EAAQ,EAAIA,EAAQ,EAAI,GAAIC,EAAQ,EAAWD,EAARC,EAAeA,IACxGF,EAAQE,EAAQ,GAAKp3C,UAAUo3C,EAWhC,OARAF,GAAQv9C,QAAQ,SAAUwF,GACzB,IAAK,GAAIoE,KAAOpE,IACXwkC,GAAOllC,KAAKU,EAAGoE,IAAUA,IAAOtJ,KACnCA,EAAOsJ,GAAOpE,EAAEoE,MAKZtJ,EAOR,QAASwH,GAAQ8wC,GAChB,MAAgC,mBAAzB71C,GAAS+B,KAAK8zC,GAGtB,QAAShe,GAAQ98B,EAAG8vC,GACnB,MAAU,QAAN9vC,GAAoB,OAAN8vC,GACV,EAGkE,YAAxD,mBAAN9vC,GAAoB,YAAc4G,GAAAA,UAAoB5G,KAA0F,YAAxD,mBAAN8vC,GAAoB,YAAclpC,GAAAA,UAAoBkpC,KAC5I,EAGD9vC,IAAM8vC,EAId,QAAS9V,GAAU8gB,GAClB,OAAQlgB,MAAMhF,WAAWklB,KAAW8E,SAAS9E,GAG9C,QAASrvC,GAASqvC,GACjB,MAAOA,IAAkC,oBAAzB71C,GAAS+B,KAAK8zC,GAG/B,QAAShqB,MAwDT,QAAS+uB,GAAOjY,EAASvW,GACxB,MAAOuW,GAAQtX,QAAQ,MAAO,WAC7B,MAAOe,GAAKtuB,UAId,QAAS+uB,GAAM8V,GACd,IAAK,GAAI9C,GAAOv8B,UAAUlE,OAAQgtB,EAAOxX,MAAMirB,EAAO,EAAIA,EAAO,EAAI,GAAIC,EAAO,EAAUD,EAAPC,EAAaA,IAC/F1T,EAAK0T,EAAO,GAAKx8B,UAAUw8B,EAI5B,MADA6C,GAAUiY,EAAOjY,EAASvW,GACpB,GAAIzc,OAAMgzB,GAGjB,QAASkY,KACJ7lC,GAAQI,OACXk8B,GAAIjuC,MAAM,KAAMC,WAIlB,QAASgtC,GAAK3N,GACb,IAAK,GAAI8X,GAAQn3C,UAAUlE,OAAQgtB,EAAOxX,MAAM6lC,EAAQ,EAAIA,EAAQ,EAAI,GAAIC,EAAQ,EAAWD,EAARC,EAAeA,IACrGtuB,EAAKsuB,EAAQ,GAAKp3C,UAAUo3C,EAG7B/X,GAAUiY,EAAOjY,EAASvW,GAC1BmlB,GAAa5O,EAASvW,GAGvB,QAASI,GAASmW,GACjB,IAAK,GAAImY,GAAQx3C,UAAUlE,OAAQgtB,EAAOxX,MAAMkmC,EAAQ,EAAIA,EAAQ,EAAI,GAAIC,EAAQ,EAAWD,EAARC,EAAeA,IACrG3uB,EAAK2uB,EAAQ,GAAKz3C,UAAUy3C,EAG7BpY,GAAUiY,EAAOjY,EAASvW,GAEtBqlB,GAAc9O,KAIlB8O,GAAc9O,IAAW,EACzB4O,GAAa5O,EAASvW,IAGvB,QAASrf,KACJiI,GAAQI,OACXk7B,EAAKjtC,MAAM,KAAMC,WAInB,QAASwC,KACJkP,GAAQI,OACXoX,EAASnpB,MAAM,KAAMC,WAWvB,QAASipB,GAAoByuB,EAAc9/C,EAASqB,GACnD,GAAIua,GAAWg1B,EAAakP,EAAc9/C,EAASqB,EACnD,OAAOua,GAAWA,EAASkkC,GAAcz+C,GAAQ,KAGlD,QAASuvC,GAAakP,EAAc9/C,EAASqB,GAC5C,KAAOrB,GAAS,CACf,GAAIqB,IAAQrB,GAAQ8/C,GACnB,MAAO9/C,EAGR,IAAIA,EAAQy0C,SACX,MAAO,KAGRz0C,GAAUA,EAAQsJ,QAIpB,QAASksB,GAAYse,EAAM3f,EAAIn0B,EAASgQ,GACvC,GAAI8jC,IAAS3f,EAAI,MAAO,KAExB,IAAInkB,EAAM,CACT,GAAI+vC,GAAW1uB,EAAoB,gBAAiBrxB,EAASgQ,EAC7D,IAAI+vC,EAAU,MAAOA,GAASjM,EAAM3f,IAAO,IAE3CxC,GAAMJ,GAAcvhB,EAAM,iBAG3B,MAAOwL,IAAc6xB,OAAOyG,EAAM3f,IAAO3Y,GAAc4pB,MAAM0O,EAAM3f,IAAO3Y,GAAckqB,OAAOoO,EAAM3f,IAAO,KAG7G,QAAS4iB,GAAK5iB,GACb,MAAO,YACN,MAAOA,IAiHT,QAAS7Z,GAAU3O,GAClB,MAAmB,gBAARA,GACHA,EAAIwkB,QAAQ+mB,GAAkB,QAG/BvrC,EAGR,QAASuH,GAAUmwB,GAClB,MAAOA,GAAMA,EAAIlT,QAAQ6mB,GAAY,OAAS,GAG/C,QAAS7jC,GAAcwkB,GACtB,GAAIyC,MACAmJ,EAAQ,MAIZ,KAFA5L,EAAUzkB,EAAUykB,GAEb4L,EAAQ0T,GAAa1hB,KAAKoC,IAAU,CAC1C,GAAItwB,GAAQk8B,EAAMl8B,MAAQk8B,EAAM,GAAGr/B,MACnCk2B,GAAOj5B,KAAKw2B,EAAQ+T,OAAO,EAAGrkC,IAC9BswB,EAAUA,EAAQ+T,OAAOrkC,EAAQ,GAKlC,MAFA+yB,GAAOj5B,KAAKw2B,GAELyC,EAGR,QAAS1f,GAAY/O,GACpB,MAAmB,gBAARA,GACHA,EAAIwkB,QAAQgnB,GAAoB,QAGjCxrC,EAKR,QAAS3K,GAAIhB,EAAS23B,EAAS5G,GAC9B,GAAuB,gBAAZ4G,KAAyBkC,EAAU9I,GAC7C,KAAM,IAAItc,OAAM,gBAGjB,IAAIg0B,GAAU,MAEd,IAAI,KAAK1nC,KAAK42B,GAWb,MAVA8Q,MAEAzoC,EAAQ0b,UAAU+gB,YAAYtpB,EAAcwkB,IAAU51B,QAAQ,SAAU5B,GACvE,GAAIgD,GAAQhD,EAAMsH,KAElB,KAAKoyB,EAAU12B,GAAQ,KAAM,IAAIsR,OAAM2iC,GAEvC3O,GAAQtoC,EAAM+vB,cAAgB/sB,EAAQ4tB,IAGhC/wB,EAAQkY,IAAIuwB,EAGpB,IAAItlC,GAAQnD,EAAQyH,IAAIkwB,EAExB,KAAKkC,EAAU12B,GACd,KAAM,IAAIsR,OAAM2iC,GAGjB,OAAOp3C,GAAQkY,IAAIyf,GAAUx0B,EAAQ4tB,GAGtC,QAAS/a,GAAY2hB,EAAS5G,GAC7B,MAAO/vB,GAAI3B,KAAMs4B,EAAe91B,SAANkvB,EAAkB,GAAKA,GAsDlD,QAAS0pB,GAAWrV,EAAOjiC,GAC1B,GAAIkE,GAAQ+9B,EAAM37B,QAAQtG,EAEZ,MAAVkE,GACH+9B,EAAMjkC,KAAKgC,GAIb,QAASi2B,GAAcgM,EAAOjiC,GAC7B,IAAK,GAAIc,GAAI,EAAG49B,EAAIuD,EAAMlhC,OAAY29B,EAAJ59B,EAAOA,IACxC,GAAImhC,EAAMnhC,IAAMd,EACf,OAAO,CAIT,QAAO,EAGR,QAASg3B,GAAmBt6B,EAAG8vC,GAC9B,GAAI1rC,EAEJ,KAAK4F,EAAQhK,KAAOgK,EAAQ8lC,GAC3B,OAAO,CAGR,IAAI9vC,EAAEqE,SAAWyrC,EAAEzrC,OAClB,OAAO,CAIR,KADAD,EAAIpE,EAAEqE,OACCD,KACN,GAAIpE,EAAEoE,KAAO0rC,EAAE1rC,GACd,OAAO,CAIT,QAAO,EAGR,QAASu6B,GAAY/6B,GACpB,MAAiB,gBAANA,IACFA,GAGC5B,SAAN4B,KAIGA,EAGR,QAASu8C,GAAS5a,GACjB,MAAOA,GAAMA,EAAMlhC,OAAS,GAG7B,QAAS4F,GAAgBs7B,EAAO6a,GAC/B,GAAK7a,EAAL,CAIA,GAAI/9B,GAAQ+9B,EAAM37B,QAAQw2C,EAEZ,MAAV54C,GACH+9B,EAAM17B,OAAOrC,EAAO,IAItB,QAASxD,GAAQq8C,GAGhB,IAFA,GAAI9a,MACAnhC,EAAIi8C,EAAUh8C,OACXD,KACNmhC,EAAMnhC,GAAKi8C,EAAUj8C,EAGtB,OAAOmhC,GA6IR,QAASiT,GAAKplC,GACbohB,WAAWphB,EAAU,GAGtB,QAASmlC,GAAe57B,EAAU4d,GACjC,MAAO,YAGN,IAFA,GAAIxI,GAEGA,EAAUpV,EAAS5Z,SACzBgvB,EAAQwI,IAKX,QAASxyB,GAAQyvB,EAAS5zB,EAAG8yB,EAAQwhB,GAEpC,GAAIzgB,EAGJ,IAAI7zB,IAAM4zB,EACT,KAAM,IAAIqa,WAAU,iEAIrB,IAAIjuC,YAAakzC,IAChBlzC,EAAE6zB,KAAKf,EAAQwhB,OAIX,KAAIt0C,GAA4E,YAAxD,mBAANA,GAAoB,YAAcgD,GAAAA,UAAoBhD,KAAiC,kBAANA,GA0CtG8yB,EAAO9yB,OA1CkH,CACzH,IACC6zB,EAAO7zB,EAAE6zB,KACR,MAAOx0B,GAER,WADAi1C,GAAOj1C,GAKR,GAAoB,kBAATw0B,GAAqB,CAC/B,GAAI6oB,GAAQC,EAAgBC,CAE5BD,GAAiB,SAAwBE,GACpCH,IAGJA,GAAS,EACTv4C,EAAQyvB,EAASipB,EAAG/pB,EAAQwhB,KAG7BsI,EAAgB,SAAuBx4C,GAClCs4C,IAGJA,GAAS,EACTpI,EAAOlwC,IAGR,KACCyvB,EAAKzwB,KAAKpD,EAAG28C,EAAgBC,GAC5B,MAAOv9C,GACR,IAAKq9C,EAIJ,MAFApI,GAAOj1C,QACPq9C,GAAS,QAKX5pB,GAAO9yB,IAwEX,QAASrD,GAAOovB,GACfA,EAAQpvB,SAGT,QAASw5C,GAAa2G,GAErBA,EAAG5G,cAGJ,QAASF,GAAM8G,IACTA,EAAG1G,OAAS0G,EAAGtH,OAAO/0C,QAAUq8C,EAAGpH,gBAKnCoH,EAAGlH,iBACHkH,EAAGj3C,SAAWi3C,EAAGj3C,OAAO+vC,eAC3BkH,EAAGj3C,OAAOkwC,gBAAgB+G,GAE1BA,EAAG5G,cAGJ4G,EAAGlH,gBAAiB,GAKhBkH,EAAGvH,OAAO90C,QAAWq8C,EAAGrH,gBACD,kBAAhBqH,GAAGttC,UACbstC,EAAGttC,WAGAstC,EAAGj3C,QACNi3C,EAAGj3C,OAAOowC,mBAsEb,QAAS1d,GAAS0e,GACjBA,EAAS1e,WAGV,QAASwe,KACR,GAAIgG,GAAQzG,GAAMO,kBAClBP,IAAMO,sBACNkG,EAAMz+C,QAAQi6B,EAId,IAAI/3B,GAAI81C,GAAMK,UAAUl2C,OACpBtD,EAAW,MAKf,KAHA4/C,EAAQzG,GAAMK,UACdL,GAAMK,aAECn2C,KAAK,CACXrD,EAAW4/C,EAAMv8C,EAGjB,IAAIjE,GAAUY,EAASZ,OACvB85C,IAAWljC,KAAK5W,EAASA,EAAQ0b,UAAU+sB,SAC3CzoC,EAAQ0b,UAAU+sB,WAElB7nC,EAASsF,SAGV6zC,GAAMI,kBAAkBpjB,QAExBypB,EAAQzG,GAAMQ,kBACdR,GAAMQ,qBACNiG,EAAMz+C,QAAQi6B,EAEd,IAAIqe,GAAQN,GAAMM,KAGlB,KAFAN,GAAMM,SAEDp2C,EAAI,EAAGA,EAAIo2C,EAAMn2C,OAAQD,GAAK,EAClCo2C,EAAMp2C,IAMP,OAAI81C,IAAMK,UAAUl2C,QAAU61C,GAAMO,mBAAmBp2C,QAAU61C,GAAMQ,kBAAkBr2C,OAAes2C,IAAxG,OAQD,QAASiG,GAAWj6C,EAASoV,GAC5BpV,EAAUA,KAEV,IAAI8U,GAAS,MAKb,OAJI9U,GAAQ8U,SACXA,EAAmC,kBAAnB9U,GAAQ8U,OAAwB9U,EAAQ8U,OAASM,EAASN,OAAO9U,EAAQ8U,UAIzFA,OAAQA,GAAUmY,GAClBqB,SAAU,YAActuB,GAAUA,EAAQsuB,SAAW,IACrDnvB,SAAUa,EAAQb,UAAYgrB,EAC9BgF,KAAMnvB,EAAQmvB,MAAQhF,GAIxB,QAASza,GAAgByhB,EAASxD,EAAI3tB,GACrC,GAAsF,YAA9D,mBAAZmxB,GAA0B,YAAclxB,GAAAA,UAAoBkxB,IAAwB,CAC/F,GAAIjsB,GAAOD,OAAOC,KAAKisB,EAEvB,MAAM,IAAIljB,OAAM,oFAAsF/I,EAAKlI,IAAI,SAAUmI,GACxH,MAAO,IAAOA,EAAM,MAASgsB,EAAQhsB,KACnCjI,KAAK,QAAU,sBAAwBgI,EAAKlI,IAAI,SAAUmI,GAC5D,MAAO,oBAAuBA,EAAM,MAASgsB,EAAQhsB,GAAO,cAC1DjI,KAAK,MAAQ,MAGjB8C,EAAUi6C,EAAWj6C,EAASnH,KAE9B,IAAIc,GAAQd,KAAKqc,UAAU/H,QAAQR,EAAcwkB,IAC7Cmc,EAAO3zC,EAAMsH,KAGjB,IAAIk1B,EAAQmX,EAAM3f,GAEjB,MADA3tB,GAAQb,SAASa,EAAQ2tB,IAClB4mB,EAGR,IAAIrrB,GAAe8F,EAAYse,EAAM3f,EAAI90B,KAAMmH,EAAQkpB,aAGvD,OAAKA,GAQEvvB,EAAM8V,QAAQ69B,EAAM3f,EAAI3tB,EAASkpB,IAPvCrrB,GAAQ0yB,QACR52B,EAAM+X,IAAIic,GACV9vB,GAAQ8X,MAED4+B,IAQT,QAAS5kC,KACR,MAAI9W,MAAKqhD,WACDrhD,KAAKmV,IAGTnV,KAAKmV,IACR1K,EAAgBzK,KAAKmV,GAAG0I,sBAAuB7d,MAGhDA,KAAKmV,GAAKnV,KAAKuB,SAASR,SACxBf,KAAKqhD,YAAa,EAElBzF,GAAWrkC,KAAKvX,MACTA,KAAKmV,IAGb,QAAS4B,GAAa1V,GACrB,IAAKrB,KAAKmV,GAAI,KAAM,IAAIC,OAAM,6BAA+B/T,EAAW,4CAExE,OAAOrB,MAAKuB,SAASH,KAAKC,GAG3B,QAAS66C,GAAuB/6C,EAAMmgD,GACrC,GAAIngD,EAAKogD,wBAAyB,CACjC,GAAIC,GAAUrgD,EAAKogD,wBAAwBD,EAC3C,OAAiB,GAAVE,EAAc,EAAI,GAK1B,MAAOvF,GAAmB96C,EAAMmgD,GAGjC,QAASrF,GAAmBz7C,EAAG8vC,GAU9B,IATA,GAAImR,GAAYC,EAAYlhD,EAAE2R,WAAa3R,EAAE0P,SAASnM,OAClD49C,EAAYD,EAAYpR,EAAEn+B,WAAam+B,EAAEpgC,SAASnM,OAElD69C,EAAUjB,EAASc,GACnBI,EAAUlB,EAASgB,GACnBG,EAAiB,OAIdF,GAAWA,IAAYC,GAC7BJ,EAAUjpC,MACVmpC,EAAUnpC,MAEVspC,EAAiBF,EAEjBA,EAAUjB,EAASc,GACnBI,EAAUlB,EAASgB,EAIpBC,GAAUA,EAAQzvC,WAAayvC,EAC/BC,EAAUA,EAAQ1vC,WAAa0vC,CAE/B,IAAIE,GAAYH,EAAQ59C,eACpBg+C,EAAYH,EAAQ79C,cAGxB,IAAI+9C,IAAcC,EAAW,CAC5B,GAAIC,GAASF,EAAUntC,MAAMxK,QAAQw3C,GACjCM,EAASF,EAAUptC,MAAMxK,QAAQy3C,EAIrC,OAAOI,GAASC,GAAUT,EAAU58C,OAAS88C,EAAU98C,OAKxD,GAAIk2C,GAAY+G,EAAen2C,UAC/B,IAAIovC,EAAW,CACd,GAAIoH,GAAUpH,EAAU3wC,QAAQ23C,GAC5BK,EAAUrH,EAAU3wC,QAAQ43C,EAEhC,OAAOG,GAAUC,GAAWX,EAAU58C,OAAS88C,EAAU98C,OAG1D,KAAM,IAAIuQ,OAAM,iKAGjB,QAASitC,GAAUptC,GAClB,GAAIjR,GAAiBiR,EAAKjR,cAE1B,OAAIA,GAAuBA,EAAemH,MAEtC8J,EAAK9C,YAAcnO,EAAiBiR,EAAK9C,UAAUnO,gBAC/CA,EAAemH,MADvB,OAKD,QAASu2C,GAAYzsC,GAIpB,IAHA,GAAIqtC,IAAYrtC,GACZstC,EAAWF,EAAUptC,GAElBstC,GACND,EAASxgD,KAAKygD,GACdA,EAAWF,EAAUE,EAGtB,OAAOD,GAqER,QAAStrC,GAAgB3V,EAAU8F,GAClC,IAAKnH,KAAKmV,GAAI,KAAM,IAAIC,OAAM,gCAAmC/T,EAAW,iDAE5E8F,GAAUA,KACV,IAAItF,GAAc7B,KAAKmwC,aAInB1uC,EAAQI,EAAYR,EACxB,OAAII,GAEI0F,GAAWA,EAAQvF,KAAOH,EAAQA,EAAM0L,SAGhD1L,EAAQ,GAAIo6C,IAAM77C,KAAMqB,IAAY8F,EAAQvF,MAAM,GAI9CH,EAAMG,OACTC,EAAYC,KAAKT,GACjBQ,EAAY,IAAMR,GAAYI,GAG/BzB,KAAKuB,SAASC,QAAQH,EAAUI,GAEhCA,EAAMi7B,OACCj7B,EAAMs5B,QAGd,QAAS9jB,GAA0B5V,EAAU8F,GAC5CA,EAAUA,KACV,IAAItF,GAAc7B,KAAKwiD,sBAInB/gD,EAAQI,EAAYR,EACxB,OAAII,GAEI0F,GAAWA,EAAQvF,KAAOH,EAAQA,EAAM0L,SAGhD1L,EAAQ,GAAIo6C,IAAM77C,KAAMqB,IAAY8F,EAAQvF,MAAM,GAI9CH,EAAMG,OACTC,EAAYC,KAAKT,GACjBQ,EAAY,IAAMR,GAAYI,GAG/BzB,KAAKuB,SAASU,kBAAkBZ,EAAUI,GAE1CA,EAAMi7B,OACCj7B,EAAMs5B,QAGd,QAAS7jB,GAAsB7V,GAC9B,MAAOrB,MAAKuB,SAASQ,cAAcV,GAGpC,QAAS+V,IAAsB/V,GAC9B,MAAIrB,MAAKkS,UACJlS,KAAKkS,UAAUC,WAAanS,KAAKkS,UAAUC,UAAUnQ,OAASX,EAC1DrB,KAAKkS,UAELlS,KAAKkS,UAAUiF,cAAc9V,GAI/B,KAGR,QAASiW,IAAmBjW,GAE3B,MAAIrB,MAAKiK,OACJjK,KAAKiK,OAAOkI,WAAanS,KAAKiK,OAAOkI,UAAUnQ,OAASX,EACpDrB,KAAKiK,OAELjK,KAAKiK,OAAOoN,WAAWhW,GAIzB,KAGR,QAASohD,IAAQ9hD,EAAS4c,GACrB5c,EAAQ4c,OACX5c,EAAQ+hD,YAAY5gD,KAAKnB,EAAQ4c,OAGlC5c,EAAQ4c,MAAQA,EAGjB,QAASolC,IAAQhiD,GACZA,EAAQ+hD,YAAY79C,OACvBlE,EAAQ4c,MAAQ5c,EAAQ+hD,YAAYlqC,MAEpC7X,EAAQ4c,MAAQ,KAYlB,QAASqlC,IAA4BtqB,GACpC,GAAIjsB,GAAMw2C,EAASC,EAAQl+C,EAAGm2B,EAAQgoB,CActC,KAZA12C,EAAOyH,EAAcwkB,IACfuqB,EAAU1G,GAAS9vC,EAAKxH,WAC7Bg+C,EAAUG,GAAW32C,EAAKxH,SAG3Bk2B,KAEA+nB,EAAS,SAAgBG,EAAMr+C,GAC9B,MAAOq+C,GAAO,IAAM52C,EAAKzH,IAG1BA,EAAIi+C,EAAQh+C,OACLD,KACNm+C,EAAkBF,EAAQj+C,GAAGT,IAAI2+C,GAAQz+C,KAAK,KAEzC02B,EAAOtD,eAAesrB,KAC1BhoB,EAAOj5B,KAAKihD,GACZhoB,EAAOgoB,IAAmB,EAI5B,OAAOhoB,GAOR,QAASioB,IAAWE,GACnB,GACIzlB,GACA0lB,EACAN,EACAC,EACAl+C,EACAiN,EACAuxC,EACAj/C,EARAk/C,EAAO,EAUX,KAAKlH,GAAS+G,GAAM,CAGnB,IAFAL,KAEOQ,EAAKx+C,OAASq+C,GACpBG,GAAQ,CAST,KANA5lB,EAAM6lB,SAASD,EAAM,GAErBP,EAAS,SAAgBS,GACxB,MAAiB,MAAVA,GAGH3+C,EAAI,EAAQ64B,GAAL74B,EAAUA,GAAK,EAAG,CAE7B,IADAu+C,EAASv+C,EAAEa,SAAS,GACb09C,EAAOt+C,OAASq+C,GACtBC,EAAS,IAAMA,CAKhB,KAFAh/C,KACAi/C,EAAID,EAAOt+C,OACNgN,EAAI,EAAOuxC,EAAJvxC,EAAOA,IAClB1N,EAAIrC,KAAKghD,EAAOK,EAAOtxC,IAExBgxC,GAAQj+C,GAAKT,EAGdg4C,GAAS+G,GAAOL,EAGjB,MAAO1G,IAAS+G,GAKjB,QAASzT,IAAU9uC,EAAS2c,GAC3B,GAAInW,GAAU4B,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,MAAwBA,UAAU,EAEnF,IAAKuU,EAAL,CAIKnW,EAAQoW,MAOZpW,EAAQoW,MAAMvb,KAAOsb,EANrBnW,EAAQoW,OACPvb,KAAMsb,EAENkmC,QAAQ,EAMV,IAAInmC,GAAaomC,GAAiBnmC,EAElComC,IAAY/iD,EAAS0c,EAAYlW,EAAQoW,MAAOpW,EAAQ0qB,MAAM,IAG/D,QAAS4xB,IAAiBnmC,GACzB,MAAI8+B,IAAc3kB,eAAena,GACzB8+B,GAAc9+B,GAEd8+B,GAAc9+B,GAAaslC,GAA4BtlC,GAIhE,QAASomC,IAAY/iD,EAAS0c,EAAYE,EAAOsU,GAChD,GAGI8xB,GACA/+C,EAJAg/C,EAAc76C,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,IAAmB,EAAQA,UAAU,GAKtFL,GAAS,CAIb,KAFA+5C,GAAQ9hD,EAAS4c,GAEZ3Y,EAAIyY,EAAWxY,OAAQD,GAAK,EAAGA,IACnC++C,EAAchjD,EAAQkjD,MAAMxmC,EAAWzY,IAEnC++C,IACHj7C,EAASo7C,GAAkBnjD,EAASgjD,EAAapmC,EAAOsU,IAASnpB,EAMnE,IAFAi6C,GAAQhiD,GAEJA,EAAQsJ,QAAUvB,EAAQ,CAE7B,GAAIk7C,GAAejjD,EAAQwR,UAAW,CACrC,GAAI4xC,GAAWpjD,EAAQwR,UAAUnQ,KAAO,IAAMqb,EAAWA,EAAWxY,OAAS,EAC7EwY,GAAaomC,GAAiBM,GAE1BxmC,IAAUA,EAAMpL,YACnBoL,EAAMpL,UAAYxR,GAIpB+iD,GAAY/iD,EAAQsJ,OAAQoT,EAAYE,EAAOsU,IAIjD,QAASiyB,IAAkBnjD,EAASgjD,EAAapmC,EAAOsU,GACvD,GAAImyB,GAAgB,KAChBC,GAAY,CAEZ1mC,KAAUA,EAAMimC,SACnB3xB,GAAQtU,GAAO4U,OAAON,IAKvB8xB,EAAcA,EAAYx2C,OAE1B,KAAK,GAAIvI,GAAI,EAAGiI,EAAM82C,EAAY9+C,OAAYgI,EAAJjI,EAASA,GAAK,EACnD++C,EAAY/+C,GAAGkE,MAAMnI,EAASkxB,MAAU,IAC3CoyB,GAAY,EASd,OALI1mC,KAAUA,EAAMimC,QAAUS,IAAcD,EAAgBzmC,EAAMmV,YACjEsxB,EAAc1U,gBAAkB0U,EAAc1U,iBAC9C0U,EAAczU,iBAAmByU,EAAczU,oBAGxC0U,EAGT,QAASzsC,IAAa8F,GACrB,IAAK,GAAIgoB,GAAOv8B,UAAUlE,OAAQgtB,EAAOxX,MAAMirB,EAAO,EAAIA,EAAO,EAAI,GAAIC,EAAO,EAAUD,EAAPC,EAAaA,IAC/F1T,EAAK0T,EAAO,GAAKx8B,UAAUw8B,EAG5BkK,IAAUzvC,KAAMsd,GAAauU,KAAMA,IAGpC,QAASqyB,IAAa53C,GACrB,KAAM,IAAI8I,OAAM,8BAAgC9I,EAAM,kCAGvD,QAAS6H,IAA0B5S,EAAUyiC,GAS5C,IARA,GAAImgB,GAAiB5iD,EAAS8S,cAAcukB,KACxCvsB,EAAOyH,EAAckwB,GACrB13B,EAAMD,EAAK,GAEX+3C,EAAkB,OAClBC,EAA2B,OAC3B33C,EAAU,OAEPnL,GAAU,CAEhB,GAAIA,EAASgL,YAAa,CACzB,GAAID,IAAQ/K,EAAS0I,OAAO4B,OAE3B,MADIQ,GAAKxH,OAAS,GAAGq/C,GAAa53C,GAC3B/K,EAASmK,QAAQgzC,aAGzB,IAAIpyC,IAAQ/K,EAAS0I,OAAO2B,SAE3B,MADIS,GAAKxH,OAAS,GAAGq/C,GAAa53C,GAC3B/K,EAASmK,QAAQ8yC,cAAcj9C,EAASyG,OAKjD,KAAM0E,EAAUnL,EAAS4J,MAAMuB,WAAaA,EAAUnL,EAASmL,WAAaA,EAAQ+qB,eAAenrB,GAAM,CACxG,GAAIxL,GAAQ4L,EAAQJ,EAEpB,IAAoB,IAAhBD,EAAKxH,OAAc,MAAO/D,EAAW,IAA6B,kBAAlBA,GAAMwT,QACzD,MAAOxT,GAAMwT,QAAQjI,EAAKc,MAAM,IAIlC,GAAI5L,EAASmK,UAEPnK,EAAS0N,SAAU1N,EAASZ,QAAQwR,YAAWiyC,GAAkB,GAElE7iD,EAASmK,QAAQo+B,IAAIx9B,IAKxB,MAJI+3C,IACHF,EAAehgD,IAAImI,EAAK/K,EAASmK,QAAQc,QAAQF,IAG3C/K,EAASmK,QAAQ4I,QAAQjI,EAI9B9K,GAAS0S,kBAAoB1S,EAASZ,QAAQy0C,UAEjD7zC,EAAWA,EAAS0S,gBACpBowC,GAA2B,GAE3B9iD,EAAWA,EAAS0I,OAItB,MAAKm6C,GAAL,OACQD,EAAe7vC,QAAQjI,GAOhC,QAAS87B,MACRO,GAAM5mC,KAAKu6C,OAGZ,QAAStT,MACR,GAAId,GAAeS,GAAMlwB,KAEzB,OADA6jC,IAAe3T,GAAMA,GAAM7jC,OAAS,GAC7BojC,EAGR,QAAS5E,IAAQviC,GACZu7C,IACHA,GAAav6C,KAAKhB,GAIpB,QAAS+T,IAAMzQ,GACbA,EAAEjE,OAEJ,QAASwd,IAAOvZ,GACdA,EAAEuZ,SAEJ,QAAS6lB,IAAcp/B,GACrBA,EAAEqE,eAEJ,QAAS87B,IAAKngC,GACZA,EAAEmgC,OAEJ,QAASx/B,IAAQX,GACfA,EAAErB,SAEJ,QAASJ,IAAQyB,GACfA,EAAE3B,SAEJ,QAASwW,IAAS7U,GAChBA,EAAE6U,WAEJ,QAAS9S,IAAQ/B,GACfA,EAAE8B,SAEJ,QAASM,IAAUpC,GACjBA,EAAEnD,WAEJ,QAASuM,IAAmBpJ,GAC1BA,EAAEnD,UAAS,GAEb,QAAS8F,IAAQ3C,GACfA,EAAEyC,SAEJ,QAAS0G,IAAUnJ,GACjB,MAAOA,GAAEqB,WAEX,QAAS6H,IAAgBlJ,GACvB,MAAOA,GAAEqB,UAAS,GAwDpB,QAASq3C,MACR93C,GAAQ0yB,OAER,IAAIxd,GAAMwiC,KAEN93C,EAAI,OACJi5C,EAAS,MAEb,KAAKj5C,EAAI,EAAGA,EAAIg4C,GAAQ/3C,OAAQD,GAAK,EACpCi5C,EAASjB,GAAQh4C,GAEZi5C,EAAOf,KAAK5iC,IAEhB0iC,GAAQvyC,OAAOzF,IAAK,EAItBI,IAAQ8X,MAEJ8/B,GAAQ/3C,OACX43C,GAAIK,IAEJD,IAAU,EAmDZ,QAASyH,IAAclV,EAAKtc,GAC3B,GACIxmB,GADA6pC,IAGJ,KAAKrjB,EACJ,MAAOsc,EAGRtc,IAAU,GAEV,KAAKxmB,IAAO8iC,GACPA,EAAI3X,eAAenrB,KACtB6pC,EAASrjB,EAASxmB,GAAO8iC,EAAI9iC,GAI/B,OAAO6pC,GAGR,QAAS4H,IAAYwG,GACpB,GAAIC,EAqBJ,OAnBKrH,IAAUoH,KACdC,EAAUD,EAAcA,EAAc,IAAM,GAE5CpH,GAAUoH,GAAe,SAAUE,EAAiB3gD,GACnD,GAAIsrC,EAEJ,OAA+B,gBAApBqV,IACVrV,KACAA,EAAIoV,EAAUC,GAAmB3gD,EAC1BsrC,GAG8F,YAAtE,mBAApBqV,GAAkC,YAAcr9C,GAAAA,UAAoBq9C,IAExED,EAAUF,GAAcG,EAAiBF,GAAeE,EAFhE,SAOKtH,GAAUoH,GA2FlB,QAASlF,IAAoBv+C,GAC5BA,EAAMspC,oBAAmB,GAG1B,QAASkV,IAAyBx+C,GACjCA,EAAMs+C,0BAogBP,QAASnb,IAAiB1iC,EAAUyiC,GACnC,GAAIt4B,GAAUnK,EAAS8S,aAIvB,IAAY,MAAR2vB,GAAuB,SAARA,EAAgB,MAAOt4B,EAC1C,IAAY,aAARs4B,EAAoB,MAAOt4B,GAAQiwB,gBAAgBp6B,EAASZ,QAChE,IAAY,cAARqjC,EAAqB,MAAOt4B,GAAQiwB,iBACxC,IAAY,WAARqI,EAAkB,CACrB,GAAI0gB,GAAWnjD,EAAS8T,uBAExB,KAAKqvC,EAASn4C,YAAa,MAC3B,OAAOm4C,GAASh5C,QAAQ8yC,cAAckG,EAAS18C,OAEhD,GAAY,SAARg8B,EAAgB,MAAOziC,GAAS8T,wBAAwB3J,QAAQgzC,aACpE,IAAY,aAAR1a,EACH,MAAOziC,GAASZ,QAAQ0b,UAAUstB,iBAEnC,IAAY,YAAR3F,EACH,MAAOgG,GAIR,IAAe,MAAXhG,EAAI,GAAY,MAAOziC,GAASZ,QAAQ0b,UAAU/H,QAAQR,EAAckwB,EAAI72B,MAAM,IACtF,IAAe,MAAX62B,EAAI,GAAY,CAGnB,IAFA,GAAI2gB,GAAQ3gB,EAAI73B,MAAM,KAEF,MAAbw4C,EAAM,IAA2B,OAAbA,EAAM,IAAa,CAC7C,GAAIn4B,GAAOm4B,EAAMphD,OAEJ,QAATipB,IACH9gB,EAAUA,EAAQzB,QAQpB,MAJA+5B,GAAM2gB,EAAMtgD,KAAK,KAGF,MAAX2/B,EAAI,KAAYA,EAAMA,EAAI72B,MAAM,IAC7BzB,EAAQ4I,QAAQR,EAAckwB,IAGtC,MAAO7vB,IAA0B5S,EAAUyiC,GAG5C,QAASvsB,IAAY6gB,GACpB,IAAKA,EAAS,MAAOt4B,MAAKqc,UAAUjU,KAAI,EAExC,IAAIiE,GAAOyH,EAAcwkB,GACrBhsB,EAAMD,EAAK,GAEXvL,EAAQ,MAeZ,OAbKd,MAAKqc,UAAUytB,IAAIx9B,IAGnBtM,KAAKmS,YAAcnS,KAAKo1C,WAC3Bt0C,EAAQmjC,GAAiBjkC,KAAKmS,UAAUnO,eAAgBsI,GAEpDxL,GACHd,KAAKqc,UAAUlY,IAAImI,EAAKxL,IAK3BA,EAAQd,KAAKqc,UAAU/H,QAAQjI,GACxBvL,EAAMsH,KAAI,GAKlB,QAASuP,IAAe3U,EAAQoL,GAC/B,IAAKpO,KAAKuB,SAASiE,SAElB,KAAM,IAAI4P,OAAM,wJAMjB,IAHApS,EAAS+8C,EAAW/8C,GACpBoL,EAAS2xC,EAAW3xC,IAAW,MAE1BpL,EACJ,KAAM,IAAIoS,OAAM,iDAGjBpS,GAAOsG,aAAatJ,KAAKe,SAAUqN,GACnCpO,KAAKmV,GAAKnS,GAETA,EAAO6a,wBAA0B7a,EAAO6a,2BAA6B/b,KAAK9B,MAC3EA,KAAKqhD,YAAa,EAElBuD,GAAe5kD,MAGhB,QAAS4kD,IAAejkD,GACvB8+C,GAAWloC,KAAK5W,GAEhBA,EAAQsB,kBAAkB,KAAKS,QAAQ,SAAUihC,GAChDihB,GAAejhB,EAAMpnB,YAIvB,QAAS3E,IAAKitC,EAAOlS,GACpB,GAAIA,IAASkS,GAA+C,KAArCA,EAAQ,KAAKz6C,QAAQuoC,EAAO,MAAoD,KAArCA,EAAO,KAAKvoC,QAAQy6C,EAAQ,KAC7F,KAAM,IAAIzvC,OAAM,wCAGjB,IAAIuE,GAAS,OACTmrC,EAAM,OACNhkD,EAAQ,OAER8xC,EAAK5yC,KAAK8d,OAAO60B,EAErB,IAAIC,EAAI,CACP,GAAIA,EAAGp9B,OAAO1U,MAAMiF,MAAQ8+C,GAASjS,EAAG1W,KAAKp7B,MAAMiF,MAAQ4sC,EAG1D,MAAOn3B,IAAUjT,SAAQ,EAFzBoR,GAAS3Z,KAAK2Z,OAAOg5B,GAMvBmS,EAAM9/C,GAAQ0yB,OAGd,IAAIqtB,GAAajxC,EAAc+wC,EAe/B,QAdK7kD,KAAKqc,UAAUytB,IAAIib,EAAW,KAAO/kD,KAAKmS,YAC9CrR,EAAQmjC,GAAiBjkC,KAAKmS,UAAUnO,eAAgB+gD,EAAW,IAE/DjkD,GACHd,KAAKqc,UAAUlY,IAAI4gD,EAAW,GAAIjkD,IAIpC8xC,EAAK,GAAI5W,IAAKh8B,KAAKqc,UAAU/H,QAAQywC,GAAa/kD,KAAKqc,UAAU/H,QAAQR,EAAc6+B,IAAQ3yC,MAC/FA,KAAK8d,OAAO60B,GAAQC,EACpBA,EAAGp9B,OAAO/M,eAEVzD,GAAQ8X,MAEDtB,GAAU60B,KAAK12B,EAAQmrC,IAsD/B,QAASE,IAAcxxC,GACtB,IAAKA,EAAQ,MAAO,KACpB,IAAIA,KAAW,EAAM,MAAOyxC,MAAKC,SACjC,IAAsB,kBAAX1xC,GAAuB,MAAOA,EAEzC,IAAsB,gBAAXA,GACV,MAAO4oB,IAAY5oB,KAAY4oB,GAAY5oB,GAAU,SAAU8nC,GAC9D,MAAOA,GAAM9nC,IAIf,MAAM,IAAI4B,OAAM,sEAGjB,QAAS0C,IAAcwgB,EAASyN,EAAO5+B,GACtC,GAAIrG,GAAQd,KAAKqc,UAAU/H,QAAQR,EAAcwkB,IAC7CN,EAAUhzB,GAAQ0yB,MAAM13B,MAAM,GAC9B8D,EAAQhD,EAAMsH,KAElB,IAAI29B,IAAUjiC,EACb,KAAM,IAAIsR,OAAM,wCACV,KAAK5K,EAAQ1G,KAAW0G,EAAQu7B,GACrC,KAAM,IAAI3wB,OAAM,6CAGlB,IAAIypC,GAAamG,GAAc79C,GAAWA,EAAQg+C,QAIlD,OAHArkD,GAAM+W,MAAMkuB,EAAO8Y,GAEnB75C,GAAQ8X,MACDkb,EAGR,QAASjgB,IAAQugB,EAAS1kB,EAAUzM,GACnC,GAAIG,GAAQtH,KAERolD,KACAjhD,EAAM,MAEV,IAAI8H,EAASqsB,GACZn0B,EAAMm0B,EACNnxB,EAAUyM,MAEVxH,OAAOC,KAAKlI,GAAKzB,QAAQ,SAAU41B,GAClC,GAAI1kB,GAAWzP,EAAIm0B,EAEnBA,GAAQnsB,MAAM,KAAKzJ,QAAQ,SAAU41B,GACpC8sB,EAAUtjD,KAAKujD,GAAe/9C,EAAOgxB,EAAS1kB,EAAUzM,YAGpD,CACN,GAAIm+C,GAAW,MAEQ,mBAAZhtB,IACVnxB,EAAUyM,EACVA,EAAW0kB,EACXgtB,GAAY,KAEZA,EAAWhtB,EAAQnsB,MAAM,KAG1Bm5C,EAAS5iD,QAAQ,SAAU41B,GAC1B8sB,EAAUtjD,KAAKujD,GAAe/9C,EAAOgxB,EAAS1kB,EAAUzM,UAQ1D,MAFAnH,MAAK0d,WAAW5b,KAAKgH,MAAM9I,KAAK0d,WAAY0nC,IAG3CznC,OAAQ,WACPynC,EAAU1iD,QAAQ,SAAU24C,GAC3B5wC,EAAgBnD,EAAMoW,WAAY29B,GAClCA,EAAS19B,aAMb,QAAS0nC,IAAe1kD,EAAS23B,EAAS1kB,EAAUzM,GACnD,GAAIkV,GAAY1b,EAAQ0b,UAEpBhQ,EAAOyH,EAAcwkB,GACrBitB,EAAgBl5C,EAAKjC,QAAQ,IAGjC,MAAOm7C,EAAe,CACrB,GAAIj5C,GAAMD,EAAK,EAGf,IAAY,KAARC,IAAe+P,EAAUytB,IAAIx9B,IAE5B3L,EAAQwR,UAAW,CACtB,GAAI82B,GAAShF,GAAiBtjC,EAAQwR,UAAUnO,eAAgBsI,EAC5D28B,IAAQ5sB,EAAUlY,IAAImI,EAAK28B,GAIjC,GAAInoC,GAAQub,EAAU/H,QAAQjI,EAC9B,OAAO,IAAIgwB,IAAS17B,EAASG,EAAO8S,EAAUzM,GAI/C,GAAI21B,GAA8B,IAAlByoB,EAAsBlpC,EAAYA,EAAU/H,QAAQjI,EAAKc,MAAM,EAAGo4C,GAElF,OAAO,IAAI1oB,IAAgBl8B,EAASm8B,EAAWzwB,EAAKhC,OAAOk7C,GAAgB3xC,EAAUzM,GA4KtF,QAAS6Q,IAAYsgB,EAAS1kB,EAAUzM,GACvC,GAAuB,gBAAZmxB,GACV,KAAM,IAAIljB,OAAM,sEAGjB,IAAItU,GAAQd,KAAKqc,UAAU/H,QAAQR,EAAcwkB,IAC7C+iB,EAAW,GAAIzd,IAAa59B,KAAMc,EAAO8S,EAAUzM,MAMvD,OAFAnH,MAAK0d,WAAW5b,KAAKu5C,IAGpB19B,OAAQ,WACP09B,EAAS19B,WAKZ,QAASogB,MACR,MAAO,GAiFR,QAAS9lB,IAAYqgB,EAAS1kB,EAAUzM,GACvC,MAAI8E,GAASqsB,IAA+B,kBAAZA,IAC/BnxB,EAAUqT,EAAU5G,MAAgBuqB,IAC7Bn+B,KAAK+X,QAAQugB,EAASnxB,KAG9BA,EAAUqT,EAAUrT,MAAeg3B,IAC5Bn+B,KAAK+X,QAAQugB,EAAS1kB,EAAUzM,IAWxC,QAASgR,IAAYmF,EAAW1J,GAC/B,GAAItM,GAAQtH,IAGZ,IAAKsd,EAQE,CAEN,GAAID,GAAaC,EAAUnR,MAAM,KAAKhI,IAAIiW,IAAME,OAAO8jB,GAEvD/gB,GAAW3a,QAAQ,SAAU4a,GAC5B,GAAIqmC,GAAcr8C,EAAMu8C,MAAMvmC,EAG9B,IAAIqmC,EAEH,GAAI/vC,EAAU,CACb,GAAI5L,GAAQ27C,EAAYv5C,QAAQwJ,EAClB,MAAV5L,GACH27C,EAAYt5C,OAAOrC,EAAO,OAM1BV,GAAMu8C,MAAMvmC,YAtBhB,KAAKA,IAAatd,MAAK6jD,YACf7jD,MAAK6jD,MAAMvmC,EA2BpB,OAAOtd,MAGR,QAASqY,IAAWiF,EAAW1J,GAC9B,GAAItM,GAAQtH,IAGZ,IAA0F,YAAhE,mBAAdsd,GAA4B,YAAclW,GAAAA,UAAoBkW,IAA0B,CACnG,GAAIkoC,GAAO,WACV,GAAIC,MACAniD,EAAI,MAER,KAAKA,IAAKga,GACLA,EAAUma,eAAen0B,IAC5BmiD,EAAU3jD,KAAKwF,EAAM8Q,GAAG9U,EAAGga,EAAUha,IAIvC,QACC8Z,GACCO,OAAQ,WAEP,IADA,GAAI+nC,GAAW,OACRA,EAAWD,EAAUjtC,OAC3BktC,EAAS/nC,cAOd,IAAgF,YAA3D,mBAAT6nC,GAAuB,YAAcp+C,GAAAA,UAAoBo+C,IAAqB,MAAOA,GAAKpoC,EAIvG,GAAIC,GAAaC,EAAUnR,MAAM,KAAKhI,IAAIiW,IAAME,OAAO8jB,GAMvD,OAJA/gB,GAAW3a,QAAQ,SAAU4a,IAC3BhW,EAAMu8C,MAAMvmC,KAAehW,EAAMu8C,MAAMvmC,QAAkBxb,KAAK8R,MAI/D+J,OAAQ,WACP,MAAOrW,GAAM4Q,IAAIoF,EAAW1J,KAK/B,QAAS2E,IAAa+E,EAAWiV,GAChC,GAAImzB,GAAW1lD,KAAKoY,GAAGkF,EAAW,WACjCiV,EAAQzpB,MAAM9I,KAAM+I,WACpB28C,EAAS/nC,UAIV,OAAO+nC,GA4BR,QAASlgB,IAAc3gC,EAAQugC,EAAYvT,GAC1C,GAAI8zB,GAEAC,EACAC,EACAC,EACAlhD,EAJAqI,IAQJ,IAFA04C,EAAkBI,GAAoBlhD,EAAQugC,EAAYvT,IAErD8zB,EACJ,MAAO,KAQR,KALAG,EAAUH,EAAgB9gD,OAAS,EAAI8gD,EAAgB,GAEvDC,EAAcrQ,KAAKiC,IAAI3yC,EAAQ8gD,EAAgB,IAC/CE,EAAYD,EAAcD,EAAgB,GAErC/gD,EAAI,EAAOghD,EAAJhhD,EAAiBA,GAAK,EACjCqI,EAAWnL,KAAK8C,EAGjB,MAAWihD,EAAJjhD,EAAeA,GAAK,EAC1BqI,EAAWnL,KAAK,GAGjB,MAAW+C,EAAJD,EAAYA,GAAK,EACvBqI,EAAWnL,KAAK8C,EAAIkhD,EAUrB,OANgB,KAAZA,EACH74C,EAAW0wB,YAAcgoB,EAAgB,GAEzC14C,EAAW0wB,YAAc94B,EAGnBoI,EAKR,QAAS84C,IAAoBlhD,EAAQugC,EAAYvT,GAChD,OAAQuT,GACP,IAAK,SAKJ,IAJgB5iC,SAAZqvB,EAAK,IAAoBA,EAAK,GAAK,IACtCA,EAAK,GAAKhtB,EAAS0wC,KAAK9X,IAAI5L,EAAK,IAAKhtB,IAGhCgtB,EAAKhtB,OAAS,GACpBgtB,EAAK/vB,KAAK+C,EAASgtB,EAAK,GAMzB,OAFAA,GAAK,GAAK0jB,KAAKiC,IAAI3lB,EAAK,GAAIhtB,EAASgtB,EAAK,IAEnCA,CAER,KAAK,OACL,IAAK,UACJ,MAAO,KAER,KAAK,MACJ,MAAIhtB,IACKA,EAAS,EAAG,IAEb,EAAG,EAEZ,KAAK,OACJ,OAAQA,EAAQ,GAAGstB,OAAON,EAE3B,KAAK,QACJ,OAAQ,EAAGhtB,EAAS,EAAI,EAEzB,KAAK,UACJ,OAAQ,EAAG,GAAGstB,OAAON,IAMxB,QAAS1b,IAAiBivB,GACzB,MAAO,UAAU9M,GAChB,GAAIx3B,GAAQd,KAAKqc,UAAU/H,QAAQR,EAAcwkB,IAC7CyN,EAAQjlC,EAAMsH,KAElB,KAAKoC,EAAQu7B,GACZ,KAAM,IAAI3wB,OAAM,wBAA0BgwB,EAAa,2BAA6BtkC,EAAM+vB,aAG3F,KAAK,GAAIyU,GAAOv8B,UAAUlE,OAAQgtB,EAAOxX,MAAMirB,EAAO,EAAIA,EAAO,EAAI,GAAIC,EAAO,EAAUD,EAAPC,EAAaA,IAC/F1T,EAAK0T,EAAO,GAAKx8B,UAAUw8B,EAG5B,IAAIt4B,GAAau4B,GAAcO,EAAMlhC,OAAQugC,EAAYvT,GACrDkJ,EAASsD,GAAW+G,GAAYt8B,MAAMi9B,EAAOlU,GAE7CmG,EAAUhzB,GAAQ0yB,MAAM13B,MAAM,GAAMi4B,KAAK,WAC5C,MAAO8C,IAWR,OARI9tB,GACHnM,EAAMkM,QAAQC,GAEdnM,EAAM+X,IAAIkiB,GAGX/1B,GAAQ8X,MAEDkb,GAoBT,QAAS+H,IAAOimB,GACfznB,GAAiBz8B,KAAKkkD,GACtBxnB,IAAU,EAGX,QAASynB,MAIH78C,IAAQo1B,KAETE,GACHD,GAAaG,WAAWsnB,QAAU5qC,GAAO,MAEzCmjB,GAAaztB,UAAYsK,GAAO,MAGjCkjB,IAAU,GAGX,QAASljB,IAAOrX,GAEf,GAAIkiD,GAA2BliD,EAASs6B,GAAiBjkB,OAAO,SAAU4Y,GACzE,OAAQjvB,EAAOmG,QAAQ8oB,EAAMxsB,MACzB63B,EAEL,OAAO4nB,GAAyBplB,OAAO,SAAUzJ,EAAQpE,GACxD,MAAOoE,GAAS,WAAapE,EAAMxsB,GAAK,SAAWwsB,EAAMoE,QACvDgH,IAiBJ,QAASv7B,IAAOpC,EAASqC,EAAQoL,EAAQnL,GAExC,GAAI0tC,GAAqBhwC,EAAQgwC,kBAC7BhwC,GAAQ00C,UAAS10C,EAAQgwC,oBAAqB,EAElD,IAAI3Y,GAAUhzB,GAAQ0yB,MAAM/2B,GAAS,EAKrC,IAJAqE,GAAQC,aAAa,WACpB,MAAO45B,IAAWtnB,KAAK5W,KACrB,GAECA,EAAQY,SAASiE,SACpB,KAAM,IAAI4P,OAAM,kGAWjB,IARAhH,EAAS2xC,EAAW3xC,IAAWzN,EAAQyN,OAEvCzN,EAAQwU,GAAKnS,EACbrC,EAAQyN,OAASA,EAGbzN,EAAQm/B,OAAOmmB,KAEfjjD,EAGH,IAFCA,EAAO6a,wBAA0B7a,EAAO6a,2BAA6B/b,KAAKnB,GAEvEyN,EAAQ,CACX,GAAIzB,GAAUvD,GAAIwD,wBAClBjM,GAAQY,SAASwB,OAAO4J,GACxB3J,EAAOsG,aAAaqD,EAASyB,OAE7BzN,GAAQY,SAASwB,OAAOC,EAAQC,EAOlC,OAHA+B,IAAQ8X,MACRnc,EAAQgwC,mBAAqBA,EAEtB3Y,EAAQC,KAAK,WACnB,MAAO6G,IAAavnB,KAAK5W,KAI3B,QAAS8X,IAAezV,EAAQoL,GAG/B,GAFApL,EAAS+8C,EAAW/8C,IAAWhD,KAAKmV,IAE/BnV,KAAK00C,QAAU1xC,EAAQ,CAG3B,GAAIojD,GAASpjD,EAAO6a,qBAChBuoC,IAAQA,EAAO1jD,QAAQuW,IAGtBjZ,KAAKyb,UACTzY,EAAOgO,UAAY,IAIrB,GAAI/N,GAAYjD,KAAKyb,QAAUjX,EAAQxB,EAAOyB,YAAc,KACxDuzB,EAAUj1B,GAAO/C,KAAMgD,EAAQoL,EAAQnL,EAE3C,IAAIA,EACH,KAAOA,EAAU4B,QAChB7B,EAAOw6C,YAAYv6C,EAAUuV,MAI/B,OAAOwf,GAWR,QAASkH,IAAQ1+B,EAAG8vC,GAInB,IAHA,GAAI9N,GAAIhiC,EAAE2M,QACNvI,EAAI0rC,EAAEzrC,OAEHD,MACC49B,EAAEp4B,QAAQkmC,EAAE1rC,KAClB49B,EAAE1gC,KAAKwuC,EAAE1rC,GAIX,OAAO49B,GASR,QAAS6jB,IAAOtgD,GACf,MAAOA,GAAIqU,OAGZ,QAASksC,IAAcC,GACtB,MAAOA,GAAKxgD,IAGb,QAASygD,IAAkBnlD,EAAU4I,GAIpC,IAHA,GAAIw8C,MACAviB,EAAQ,OAELA,EAAQ5E,GAAoBpJ,KAAK70B,IACvColD,EAAc3kD,MACbiE,IAAKm+B,EAAM,GACX1G,KAAM0G,EAAM,GACZwiB,UAAWxiB,EAAM,IAWnB,KALA,GAAI1G,GAAOipB,EAActiD,IAAImiD,IAEzBK,KACA/hD,EAAI6hD,EAAc5hD,OAEfD,KAAK,CACX,GAAIgiD,GAAWppB,EAAKrwB,QAGhBo5C,EAAOE,EAAc7hD,EACzBgiD,GAAShiD,GAAK2hD,EAAK/oB,KAAOvzB,EAASs8C,EAAKG,WAAa,EAErD,IAAIG,GAAYrpB,EAAKrwB,OACrB05C,GAAUjiD,GAAKqF,EAAS,IAAM48C,EAAUjiD,GAExC+hD,EAAY7kD,KAAK8kD,EAASviD,KAAK,KAAMwiD,EAAUxiD,KAAK,MAGrD,MAAOsiD,GAAYtiD,KAAK,MAGzB,QAASw7B,IAAaH,EAAKh5B,GAC1B,GAAIogD,GAAW,wBAA0BpgD,EAAK,MAE1CigD,EAAc,MAkBlB,OAfCA,GADGnnB,GAAmB99B,KAAKg+B,GACbA,EAAI5O,QAAQ0O,GAAoBsnB,GAEhCpnB,EAAI5O,QAAQuO,GAAiB,IAAIvO,QAAQsO,GAAkB,SAAU8E,EAAOiK,GAEzF,GAAI5O,GAAe79B,KAAKysC,GAAK,MAAOjK,EAEpC,IAAI6iB,GAAY5Y,EAAGhiC,MAAM,KAAKhI,IAAIkiD,IAC9BM,EAAcI,EAAU5iD,IAAI,SAAU9C,GACzC,MAAOmlD,IAAkBnlD,EAAUylD,KACjCziD,KAAK,MAAQ,GAEhB,OAAO6/B,GAAMpT,QAAQqd,EAAIwY,KAO5B,QAASK,MACR,MAAOzR,MAAK0R,MAA4B,OAArB,EAAI1R,KAAK2R,WAAqBzhD,SAAS,IAAI6tB,UAAU,GAGzE,QAASqM,MACR,MAAOqnB,MAAOA,KAAO,IAAMA,KAAO,IAAMA,KAAO,IAAMA,KAAO,IAAMA,KAAOA,KAAOA,KA2BjF,QAAS7mD,IAAK4xB,EAAIrmB,GACjB,IAAK,OAAOhK,KAAKqwB,EAAGtsB,YAAa,MAAOssB,EAExC,IAAIjd,GAAQid,EAAG5xB,KAAKuL,EACpB,KAAK,GAAI0hB,KAAQ2E,GAChBjd,EAAMsY,GAAQ2E,EAAG3E,EACjB,OAAOtY,GAGT,QAASqyC,IAAS19C,GAEbA,GAAQA,EAAKkR,cAAgBvO,SACZ,kBAAT3C,KAE4E,YAA3D,mBAATA,GAAuB,YAAcrC,GAAAA,UAAoBqC,IAC1E6oB,EAAM,iDAAmD7oB,EAAO,kBAEhE+I,EAAY,sIAmDhB,QAASytB,IAAUqD,EAAa8jB,GAC/BD,GAASC,EAET,IAAIC,GAAoC,kBAAhB/jB,GACpBgkB,EAAkC,kBAAfF,EAWvB,OANKA,IAAeC,IACnBD,MAKIC,GAAeC,EAIb,WACN,GAAI3jB,GAAQ2jB,EAAYC,GAAiBH,EAAYpnD,MAAQonD,EACzDn9C,EAASo9C,EAAaE,GAAiBjkB,EAAatjC,MAAQsjC,CAEhE,OAAOkkB,IAAe7jB,EAAO15B,IAPtBu9C,GAAeJ,EAAY9jB,GAWpC,QAASikB,IAAiBx1B,EAAIrmB,GAC7B,GAAIjC,GAAOsoB,EAAGvqB,KAAKkE,EAEnB,IAAKjC,EAUL,MARgF,YAA3D,mBAATA,GAAuB,YAAcrC,GAAAA,UAAoBqC,KACpE6oB,EAAM,uCAGH7oB,EAAKkR,cAAgBvO,QACxBb,EAAgB,uHAGV9B,EAGR,QAAS+9C,IAAeC,EAASC,GAChC,GAAID,GAAWC,EAAW,CACzB,IAAK,GAAIp7C,KAAOo7C,GACTp7C,IAAOm7C,KACZA,EAAQn7C,GAAOo7C,EAAUp7C,GAI3B,OAAOm7C,GAGR,MAAOA,IAAWC,EAOnB,QAASC,IAAeC,GAKvB,IAJA,GAAI/iD,GAASkE,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,GAAmB,EAAIA,UAAU,GAE7E8oB,EAAO,GAAIxX,OAAMxV,GAEdA,KACNgtB,EAAKhtB,GAAU,IAAMA,CAQtB,OAAO,IAAIklC,aAAa,oBAAsBlY,EAAKxtB,KAAK,KAAO,YAAcujD,EAAO,UAGrF,QAASC,IAAsB9hD,EAAK+hD,GACnC,GAAIC,GAAU,OAEVvf,EAAe,WAAaziC,EAAI+qB,QAAQiM,GAAS,SAAUmH,EAAO5L,GAErE,MADAyvB,IAAU,EACH,kBAAoBzvB,EAAU,OACjC,IAEDyvB,KAASvf,EAAe,yBAA2BA,EACvD,IAAIzW,GAAK,GAAIgY,UAASvB,EACtB,OAAOuf,GAAUh2B,EAAG5xB,KAAK2nD,GAAU/1B,EAKpC,QAAS+R,IAAY/9B,EAAKnB,GACzB,MAAIu7B,IAAUp6B,GAAao6B,GAAUp6B,GAC9Bo6B,GAAUp6B,GAAOiiD,GAAejiD,EAAKnB,GAG7C,QAASs8B,IAAa3gC,GACrB,GAAKA,EAAL,CAEA,GAAI0nD,GAAM1nD,EAASkD,CAEdwkD,IAEL77C,OAAOC,KAAK47C,GAAKvlD,QAAQ,SAAUqD,GAC9Bo6B,GAAUp6B,KACdo6B,GAAUp6B,GAAOkiD,EAAIliD,OAYvB,QAASk7B,IAAaoE,EAAQwD,EAAOqf,GAC/B7iB,GACJ/S,EAAM,wCAA0CuW,EAAQ,KAAOqf,GAIjE,QAASF,IAAeJ,EAAM/iD,GAE7B,MADAo8B,IAAa0mB,GAAgB,0BAA2BrnB,IACjDqnB,GAAeC,EAAM/iD,GAG7B,QAASsjD,IAAyBpiD,EAAK+hD,GAEtC,MADA7mB,IAAa4mB,GAAuB,4BAA6BtnB,IAC1DsnB,GAAsB9hD,EAAK+hD,GAmHnC,QAASpvB,IAAW/3B,GACnB,GAAIynD,GAAUznD,EAAQ4gC,QAAQhhC,QAG9B,IAAK6nD,GAAYA,EAAQr2B,GAAzB,CAIA,GAAIgJ,GAASuG,GAAmB3gC,EAASynD,EAAQr2B,GAIjD,OAAIgJ,KAAWqtB,EAAQrtB,QACtBqtB,EAAQrtB,OAASA,EACVA,GAFR,QAMD,QAASuG,IAAmB3gC,EAASoxB,GACpC,MAAOA,GAAGvqB,KAAK7G,GACd8/B,OAAQD,GAAOC,OACfI,SAAUL,GAAOK,SACjBtuB,MAAO,SAAehS,GACrB,GAAI4G,GAAU4B,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,GAAmBy3B,GAAOM,gBAAgBngC,GAAWoI,UAAU,EAEhH,OAAOy3B,IAAOjuB,MAAMhS,EAAU4G,MAKjC,QAASk6B,IAAc9gC,EAAUI,GAUhC,MATwB,gBAAbJ,GAEVA,EAAW8nD,GAAc9nD,EAAUI,IAGnC2nD,GAAW/nD,GACX2gC,GAAa3gC,IAGPA,EAGR,QAAS8nD,IAAc9nD,EAAUI,GAMhC,MAJoB,MAAhBJ,EAAS,KACZA,EAAWigC,GAAOC,OAAOlgC,IAGnBigC,GAAOW,SAAS5gC,EAAUI,GAGlC,QAAS2nD,IAAW/nD,GAGnB,GAAgBiC,QAAZjC,EACH,KAAM,IAAI6U,OAAM,0BAA4B7U,EAAW,IAInD,IAA0B,gBAAfA,GAAS6c,EACvB,KAAM,IAAIhI,OAAM,8JAIZ,IAAI7U,EAAS6c,IAAM8iB,GACtB,KAAM,IAAI9qB,OAAM,yCAA2C8qB,GAAmB,SAAW3/B,EAAS6c,EAAI,+GAI1G,QAASqkB,IAAe8mB,EAAkBC,EAAaC,GACtD,GAAKD,EAKL,IAAK,GAAIl8C,KAAOk8C,IACXC,GAAcF,EAAiB9wB,eAAenrB,KACjDi8C,EAAiBj8C,GAAOk8C,EAAYl8C,IA+DvC,QAASg6B,IAAKr8B,EAAQjI,EAAMqjC,GAG3B,QAAS6E,KACR,GAAI8I,GAAc0V,GAAexe,EAAQ4I,QAAS9wC,GAC9CmxC,EAAW,UAAYnzC,MACvB2oD,EAAW3oD,KAAKozC,MAEpBpzC,MAAKozC,OAASJ,CAEd,IAAIjY,GAASsK,EAAOv8B,MAAM9I,KAAM+I,UAQhC,OANIoqC,GACHnzC,KAAKozC,OAASuV,QAEP3oD,MAAKozC,OAGNrY,EAjBR,MAAK,SAASr5B,KAAK2jC,IAoBnB6E,EAAQ4I,QAAU7oC,EAClBigC,EAAQuJ,QAAUpO,EAEX6E,GAvB4B7E,EA0BpC,QAASqjB,IAAez+C,EAAQjI,GAC/B,GAAIA,IAAQiI,GAAQ,CACnB,GAAIu7C,GAAO,WACV,GAAI1hD,GAAQmG,EAAOjI,EAEnB,QACCob,EAAoB,kBAAVtZ,GAAuBA,EAAQ,WACxC,MAAOA,OAKV,IAAgF,YAA3D,mBAAT0hD,GAAuB,YAAcp+C,GAAAA,UAAoBo+C,IAAqB,MAAOA,GAAKpoC,EAGvG,MAAOkU,GAGR,QAASs3B,IAAW3Q,EAAY4Q,EAASC,GACxC,MAAO,WAAa7Q,EAAa,6CAA+C4Q,EAAU,KAAOC,EAAU,wDAA0DD,EAAU,IAAM,IAGtL,QAASE,IAAgB5hD,EAAS6hD,EAAkBH,GACnD,GAAIG,IAAoB7hD,GAAS,CAChC,GAAM0hD,IAAW1hD,GAIhB,KAAM,IAAIiO,OAAMwzC,GAAWI,EAAkBH,GAAS,GAHtDr2C,GAAYo2C,GAAWI,EAAkBH,IACzC1hD,EAAQ0hD,GAAW1hD,EAAQ6hD,IAO9B,QAAS7Q,IAAUhxC,GAClB4hD,GAAgB5hD,EAAS,aAAc,eACvC4hD,GAAgB5hD,EAAS,OAAQ,YACjC4hD,GAAgB5hD,EAAS,WAAY,cACrC4hD,GAAgB5hD,EAAS,mBAAoB,UAKzCqD,EAAQrD,EAAQ2U,WACnBitC,GAAgB5hD,EAAS,WAAY,SAkDvC,QAAS06B,IAAUwD,EAAQrG,EAAQh8B,EAAQmE,GAC1CgxC,GAAUhxC,EAEV,KAAK,GAAImF,KAAOnF,GACf,GAAIg7B,GAAc1K,eAAenrB,GAAM,CACtC,GAAIxI,GAAQqD,EAAQmF,EAOR,QAARA,GAAiC,kBAAVxI,GAC1B0O,EAAYlG,EAAM,2EAAuF,SAAX+4B,EAAoBriC,EAAS,MAE3HA,EAAOsJ,GAAOxI,EAMjB,GAAIqD,EAAQutC,QAAUvtC,EAAQsU,QAC7B,KAAM,IAAIrG,OAAM,iDAGjB4sB,IAAWt/B,QAAQ,SAAUo/B,GAC5BA,EAASuD,GAAQrG,EAAQh8B,EAAQmE,KAGlC43B,GAAkBsG,GAAQrG,EAAQh8B,EAAQmE,GAC1Ci6B,GAAqBiE,GAAQrG,EAAQh8B,EAAQmE,GAC7Cs4B,GAAgB4F,GAAQrG,EAAQh8B,EAAQmE,GAExC8hD,GAAmBjqB,EAAO3+B,UAAW2C,EAAQmE,GAG9C,QAAS8hD,IAAmBh/C,EAAQjH,EAAQmE,GAC3C,IAAK,GAAImF,KAAOnF,GACf,IAAKk7B,GAAc/1B,IAAQnF,EAAQswB,eAAenrB,GAAM,CACvD,GAAIs0C,GAASz5C,EAAQmF,EAGC,mBAAXs0C,KACVA,EAASta,GAAKr8B,EAAQqC,EAAKs0C,IAG5B59C,EAAOsJ,GAAOs0C,GAKjB,QAASxe,IAAQ2D,GAChB,GAAIqJ,KAIJ,OAHArJ,GAAMrjC,QAAQ,SAAU0B,GACvB,MAAOgrC,GAAIhrC,IAAK,IAEVgrC,EAUR,QAAS12B,IAAcjP,GAGtB,GAFAA,EAAOA,MAEyE,YAA3D,mBAATA,GAAuB,YAAcrC,GAAAA,UAAoBqC,IACpE,KAAM,IAAI2L,OAAM,+EAIjB3L,GAAOu2B,GAAiBtD,KAAK18B,KAAK2a,YAAa3a,MAAQyJ,KAAMA,GAE7D,IAAIuuB,GAAUhzB,GAAQ0yB,MAAM13B,MAAM,GAG9BkqC,EAAUlqC,KAAKqc,UAAU6tB,OACzBA,IAAWA,EAAQn8B,MAClBm8B,EAAQn8B,MAAMtE,MAAU,GAE3BzJ,KAAKqc,UAAUxD,IAAIpP,GAGpBzJ,KAAKqc,UAAUxD,IAAIpP,EAQpB,KAJA,GAAI2/B,GAAU7G,GAAOx0B,MAAM/N,MACvBkpD,EAAW,OAEXtkD,EAAIwkC,EAAQvkC,OACTD,KACN,GAAI69B,GAAer4B,QAAQg/B,EAAQxkC,IAAM,GAAI,CAC5CskD,GAAW,CACX,OAeF,MAXIA,KACHrmB,GAAatrB,KAAKvX,MAClBA,KAAKuB,SAASiK,cAAcxL,KAAKO,UACjCqiC,GAAarrB,KAAKvX,MAClB0iC,GAAenrB,KAAKvX,OAGrBgF,GAAQ8X,MAER6lB,GAAUprB,KAAKvX,KAAMyJ,GAEduuB,EAuBR,QAASmxB,IAAQ3zC,EAAQxT,EAAMk6B,GAC9B1mB,EAAO9S,QAAQ,SAAUuS,GAExB,GAAIA,EAAKtE,OAASqC,KAAYiC,EAAKtK,UAAY3I,GAAQiT,EAAKjT,OAASA,GAEpE,WADAk6B,GAAKp6B,KAAKmT,EAKX,IAAIA,EAAK1T,SACR4nD,GAAQl0C,EAAK1T,SAASoK,YAAcsJ,EAAK1T,SAASqT,MAAO5S,EAAMk6B,OAI3D,IAAI1xB,EAAQyK,EAAKL,OACpBu0C,GAAQl0C,EAAKL,MAAO5S,EAAMk6B,OAItB,IAAIjnB,EAAKtE,OAASmyB,IAAa7tB,EAAKsH,SAAU,CAEjD,GAAItH,EAAKsH,SAAS9J,SAASzQ,GAAO,MAClCmnD,IAAQl0C,EAAKsH,SAAShb,SAASqT,MAAO5S,EAAMk6B,GAI3CjnB,EAAKtE,OAASuE,KACb1K,EAAQyK,EAAK3U,aAChB6oD,GAAQl0C,EAAK3U,WAAY0B,EAAMk6B,GAG5B1xB,EAAQyK,EAAKrS,wBAChBumD,GAAQl0C,EAAKrS,sBAAuBZ,EAAMk6B,MAM9C,QAAS5wB,IAAmB6lC,GAC3BA,EAAQ7lC,qBAGT,QAASqN,IAAc3W,EAAMmvC,GAC5B,GAAIiY,KACJD,IAAQnpD,KAAKuB,SAASqT,MAAO5S,EAAMonD,EAEnC,IAAIpxB,GAAUhzB,GAAQ0yB,MAAM13B,MAAM,EAOlC,OALAA,MAAKyS,SAASzQ,GAAQmvC,EACtBiY,EAAW1mD,QAAQ4I,IAEnBtG,GAAQ8X,MAEDkb,EA+FR,QAASz1B,IAASzB,GACjB,MAAOA,GAAQA,EAAMsH,KAAI,GAAQ5F,OA4VlC,QAAS2F,IAAU5G,EAAUhB,GAC5B,MAAIA,GAASiI,EACLy7B,GAAiB1iC,EAAUhB,EAASiI,GACjCjI,EAAS6D,EACZ,GAAIy/B,IAAgBtiC,EAAUhB,EAAS6D,GAEvC,GAAIwgC,IAAyBrjC,EAAUhB,EAAS8oD,IAIzD,QAASpkB,IAAeqkB,GACvB,GAAIA,EAAQ/oD,SAASkM,EAAG,CACvB68C,EAAQ58C,UAGR,KAAK,GADDR,GAAOo9C,EAAQ/oD,SAASkM,EACnB7H,EAAI,EAAGA,EAAIsH,EAAKrH,OAAQD,IAChC0kD,EAAQ58C,QAAQR,EAAKtH,GAAGtB,GAAK6E,GAAUmhD,EAAQtlD,eAAgBkI,EAAKtH,GAAGR,IA4F1E,QAASuhC,IAAgBuE,EAASnE,EAAOX,EAAYn4B,GACpD,GAAIu5B,GAAU0D,EAAQ1D,OAGlBv5B,IACHu5B,EAAQx5B,QAAQC,GAoMlB,QAASo6B,IAAuBJ,EAAoBtmC,EAAS23B,GAC5D,GAAI2O,EAAmBpuB,KAAOouB,EAAmBpuB,IAAIyuB,QAEpD,MADAL,GAAmBpuB,IAAIyuB,QAAQE,WAAW1lC,MAAOnB,QAASA,EAAS23B,QAASA,IACrE2O,CAGR,IAAIxB,GAAU,OAEV+B,IAAgB7mC,QAASA,EAAS23B,QAASA,IAE3C8O,GACHh/B,IAAK,WACJ,MAAO,SAAW6+B,GAAqBA,EAAmBnjC,MAAQmjC,EAAmB7+B,OAEtFyQ,IAAK,SAAa/U,GACb2hC,IAEA,SAAWwB,GACdA,EAAmBnjC,MAAQA,EAE3BmjC,EAAmBpuB,IAAI/U,GAGxB2hC,GAAU,EACV+B,EAAW9kC,QAAQ,SAAU6mD,GAC5B,GAAI5oD,GAAU4oD,EAAK5oD,QACf23B,EAAUixB,EAAKjxB,OAEnB33B,GAAQkY,IAAIyf,EAASx0B,KAEtB2hC,GAAU,IAEX0O,YAAY,EAKb,OAFA/M,GAAWvuB,IAAIyuB,SAAYE,WAAYA,EAAYP,mBAAoBA,GAEhEG,EAGR,QAASG,IAAOH,EAAYzmC,EAAS23B,GACpC,IAAK8O,EAAWvuB,MAAQuuB,EAAWvuB,IAAIyuB,QAAS,OAAO,CAIvD,KAFA,GAAIE,GAAaJ,EAAWvuB,IAAIyuB,QAC5B1iC,EAAI4iC,EAAW3iC,OACZD,KAAK,CACX,GAAIy4C,GAAY7V,EAAW5iC,EAC3B,IAAIy4C,EAAU18C,UAAYA,GAAW08C,EAAU/kB,UAAYA,EAE1D,MADAkP,GAAWn9B,OAAOzF,EAAG,IACd,GA4GV,QAAS6jC,IAAS+gB,GACjB,GAAIre,GAAQqe,EAAO14B,QAAQ,SAAU,SAAU24B,GAC9C,MAAOA,GAAKt9C,MAAM,KAAM9H,KAAK,QAC3B8H,MAAM,MAELu9C,EAAYve,EAAMtmC,OAAS,EAAI,EAAIsmC,EAAMh+B,MAAM,GAAG4zB,OAAO,SAAU4oB,EAAMte,GAC5E,MAAOkK,MAAKiC,IAAImS,EAAM,OAAOzzB,KAAKmV,GAAM,GAAGxmC,SACzC+kD,EAAAA,EAEH,OAAOze,GAAMhnC,IAAI,SAAUknC,EAAMzmC,GAChC,MAAO,QAAUA,EAAIymC,EAAK/X,UAAUo2B,GAAare,KAC/ChnC,KAAK,MAIT,QAASukC,IAAcF,GACtB,IAAKA,EAAO,MAAO,EAQnB,KAAK,GANDyC,GAAQzC,EAAMv8B,MAAM,MACpBnK,EAAO6lC,GAAY7lC,KAAO,YAE1B6nD,KAEAh9C,EAAMs+B,EAAMtmC,OACPD,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAChC,GAAIymC,GAAOF,EAAMvmC,EAEjB,KAAKymC,EAAKjhC,QAAQpI,GACjB,MAAO6nD,GAAUxlD,KAAK,KAEtBwlD,GAAU/nD,KAAKupC,IAwVlB,QAASye,IAAwBnpD,EAAS2L,EAAK63B,GAC9C,GAAIC,GAAS,OACT2D,EAAS,OAGT1D,EAAe,OACfsE,EAAiB,OACjBohB,EAAe,MA+BnB,OA7ByB,kBAAd5lB,KACVC,EAASjkC,GAAKgkC,EAAWxjC,GACzB0jC,EAAeF,EAAU1+B,WACzBkjC,GAAiB,GAGO,gBAAdxE,KACVC,EAAS+jB,GAAyBhkB,EAAWxjC,GAC7C0jC,EAAeF,GAG0E,YAAhE,mBAAdA,GAA4B,YAAc/8B,GAAAA,UAAoB+8B,MAC5C,gBAAlBA,GAAU/7B,KACpBg8B,EAAS+jB,GAAyBhkB,EAAU/7B,IAAKzH,GACjD0jC,EAAeF,EAAU/7B,KACU,kBAAlB+7B,GAAU/7B,KAC3Bg8B,EAASjkC,GAAKgkC,EAAU/7B,IAAKzH,GAC7B0jC,EAAeF,EAAU/7B,IAAI3C,WAC7BkjC,GAAiB,GAEjBrW,EAAM,8CAA+ChmB,GAGzB,kBAAlB63B,GAAUtrB,MACpBkvB,EAAS5nC,GAAKgkC,EAAUtrB,IAAKlY,GAC7BopD,EAAe5lB,EAAUtrB,IAAIpT,cAK9B2+B,OAAQA,EACR2D,OAAQA,EACR1D,aAAcA,EACd0lB,aAAcA,EACdphB,eAAgBA,GAUlB,QAASiH,IAAUjvC,EAASwG,GACvBsT,GAAQI,OAAOo8B,KAEnB+S,GAAqBrpD,GAGrBkD,GAAelD,EAAS,QAAUyH,IAAK6hD,KAGvC3f,GAAc/yB,KAAK5W,EAASwG,GAG5BojC,GAAgB7nC,QAAQ,SAAUV,GACjCrB,EAAQqB,GAAQwY,EAAU4lB,GAAOz/B,EAAQga,YAAY3Y,IAAS,MAAOmF,EAAQnF,KAI9E,IAAIqa,GAAY,GAAIitB,KACnBrK,MAAOirB,GAAYvpD,EAASA,EAAQs+B,MAAO93B,GAC3CsC,KAAMu2B,GAAiBtD,KAAK/7B,EAAQga,YAAaha,EAASwG,GAC1DxG,QAASA,GAGVA,GAAQ0b,UAAYA,CAGpB,IAAIu3B,GAAWp5B,EAAU4lB,GAAOz/B,EAAQga,YAAYta,UAAUuzC,UAAWzsC,EAAQysC,SAEjF,KAAK,GAAItnC,KAAOsnC,GAAU,CACzB,GAAIzP,GAAY2lB,GAAwBnpD,EAAS2L,EAAKsnC,EAAStnC,GAC/D+P,GAAUioB,QAAQh4B,EAAK63B,IAIzB,QAASgmB,IAAU3pD,EAAG8vC,GAIrB,IAHA,GAAI9N,GAAIhiC,EAAE2M,QACNvI,EAAI0rC,EAAEzrC,OAEHD,MACC49B,EAAEp4B,QAAQkmC,EAAE1rC,KAClB49B,EAAE1gC,KAAKwuC,EAAE1rC,GAIX,OAAO49B,GAGR,QAAS0nB,IAAYvpD,EAASypD,EAAYjjD,GA2BzC,QAASkjD,GAAOvM,GASf,MARuB,gBAAZA,KACVA,EAAU9rB,EAAoB,WAAYrxB,EAASm9C,GAE9CA,GACJxrB,EAAMJ,GAAc4rB,EAAS,aAIxBA,EAnCRsM,EAAaA,EAAWjmD,IAAIkmD,EAC5B,IAAIprB,GAAQE,EAAYh4B,EAAQ83B,OAAO96B,IAAIkmD,EAE3CprB,GAAQkrB,GAAUC,EAAYnrB,EAE9B,IAAItjB,GAAQ,SAAWxU,GAAUA,EAAQwU,MAAQhb,EAAQgb,MACrDw5B,EAAe,gBAAkBhuC,GAAUA,EAAQguC,aAAex0C,EAAQw0C,YAE9E,IAAIx5B,EAAO,CACV,IAAKC,GACJ,KAAM,IAAIxG,OAAM,qEAGb+/B,IACHlW,EAAMn9B,KAAK8lC,IAGZ3I,EAAMn9B,KAAKilC,IAOZ,MAJIoO,IACHlW,EAAMn9B,KAAKskC,IAGLnH,EAeR,QAAS+qB,IAAqBrpD,GAG7BA,EAAQ+U,MAAQ,KAAO80B,KAGvB7pC,EAAQkjD,MAAQzjB,GAAO,MAIvBz/B,EAAQ4gC,WAGR5gC,EAAQgG,SAGRhG,EAAQ4c,MAAQ,KAChB5c,EAAQ+hD,eAGR/hD,EAAQwvC,gBACRxvC,EAAQ6hD,yBAGR7hD,EAAQ+c,cAGR/c,EAAQmd,UAEHnd,EAAQwR,YACZxR,EAAQi4B,KAAOj4B,EACfA,EAAQsJ,OAAStJ,EAAQuR,UAAY,MAIvC,QAAS+3C,MACR,KAAM,IAAI70C,OAAM,8FAGjB,QAAS01B,IAAcF,EAAOjqC,GAC7B,MAAOiqC,GAAMjqC,EAAQ+U,SAAWk1B,EAAMjqC,EAAQ+U,WAG/C,QAAS6B,IAAK+yC,EAAW3pD,GACxB,GAAI4pD,GAAazf,GAAcwf,EAAU1f,MAAOjqC,EAMhD,KAJA2pD,EAAU5f,KAAKnzB,KAAK5W,GAIb4pD,EAAW1lD,QACjB0S,GAAK+yC,EAAWC,EAAWhnD,eAGrB+mD,GAAU1f,MAAMjqC,EAAQ+U,OAsChC,QAASgH,IAAW/b,EAAS6pD,EAAarjD,GACzCiF,OAAOC,KAAK1L,EAAQ0b,UAAU6sB,cAAcxmC,QAAQ,SAAU4J,GAC7D,GAAIy3B,GAAcpjC,EAAQ0b,UAAU6sB,aAAa58B,EAE7C3L,GAAQ0b,UAAUvY,MAAM2zB,eAAenrB,IAC1Cy3B,EAAYlrB,IAAIlY,EAAQ0b,UAAUvY,MAAMwI,MAK1Ci2B,GAAO7F,KAAK/7B,EAAQga,YAAaha,EAAS6pD,GAE1Czf,GAAWxzB,KAAK5W,GAChBqqC,GAASH,MAAMlqC,EAEf,IAAIY,GAAW,MAGf,IAAIZ,EAAQJ,SAAU,CACrB,GAAI0D,GAAS,QAETkD,EAAQlD,QAAUtD,EAAQm/B,SAC7B77B,EAASkD,EAAQlD,OAASkD,EAAQlD,OAAOkJ,WAErCxM,EAAQm/B,OACX77B,EAAOnC,KAAKnB,EAAQm/B,QAItBn/B,EAAQY,SAAWA,EAAW,GAAI2J,KACjCC,MAAOxK,EACPJ,SAAUI,EAAQJ,SAClB0D,OAAQA,IACN9D,KAAKQ,EAAQ0b,WAKjB,GAFA2uB,GAASluB,IAAInc,GAETY,EAAU,CAEb,GAAI4T,GAAK4qC,EAAWp/C,EAAQwU,GAC5B,IAAIA,EAAI,CACP,GAAI6iB,GAAUr3B,EAAQoC,OAAOoS,EAAIxU,EAAQ+zC,OAErCj6B,IAAQM,gBACXid,EAAAA,SAAc,SAAU/mB,GAKvB,KAJA1F,GAAgB,kOAChBiH,EAAY,sCAAwC7R,QAASA,IAC7D2/C,EAAWrvC,GAELA,MAgLX,QAAS+7B,IAAyByd,GACjC,MAAO,UAAUjqB,GAKhB,IAJA,GAAIkqB,GAAU,IACVC,GAAO,EACPC,EAAO,QAEHD,GACPC,EAAOpqB,EAAO8L,aAAaK,KAAwBnM,EAAO8L,aAAaM,KAA0BpM,EAAO4L,YAAYqe,GAChHG,EAEFF,GADY,MAATE,EACQ,MACQ,QAATA,EACC,IAEAA,GAGZA,EAAOpqB,EAAO8L,aAAaO,IACvB+d,EAEHF,GAAW,OAAS,MAAQE,EAAKC,WAAW,GAAGplD,SAAS,KAAK0H,MAAM,IAEnEw9C,GAAO,EAQV,OAHAD,IAAW,IAGJzF,KAAK1yC,MAAMm4C,IAOpB,QAASxc,IAAmB1N,GAC3B,GAAI9I,GAAOluB,CAIX,OAFAkuB,GAAQ8I,EAAOjK,IAEXiK,EAAO4L,YAAY,MACtB5iC,EAASyjC,GAAsBzM,GAE1BA,EAAO4L,YAAY,MAMvBphC,EAAGg4B,GACH5lB,EAAG5T,IANHg3B,EAAOjK,IAAMmB,EACN,OASL8I,EAAO4L,YAAY,MACtB5iC,EAASujC,GAAsBvM,GAE1BA,EAAO4L,YAAY,MAMvBphC,EAAGg4B,GACH5lB,EAAG5T,IANHg3B,EAAOjK,IAAMmB,EACN,OASF,KAMR,QAASozB,IAAkBtqB,GAC1B,GAAIzF,EAEJ,QAAIA,EAASyF,EAAO8L,aAAaY,MAE/BliC,EAAG+3B,GACH3lB,EAAG2d,GAIE,KASR,QAASgwB,IAAQvqB,GAChB,GAAIwqB,EAEJ,QAAIA,EAAQ9c,GAAkB1N,IACtB2M,GAAWzrC,KAAKspD,EAAM5tC,GAAK4tC,EAAM5tC,EAAI,IAAM4tC,EAAM5tC,EAAE0T,QAAQ,KAAM,OAAS,KAG9Ek6B,EAAQF,GAAkBtqB,IACtBwqB,EAAM5tC,GAGV4tC,EAAQxqB,EAAO8L,aAAatqC,KACxBgpD,EAGD,KA0HR,QAAS3c,IAAgB7N,GACxBA,EAAO+L,iBAEP,IAAIjgC,GAAMy+C,GAAQvqB,EAElB,KAAKl0B,EAAK,MAAO,KAEjB,IAAI8hC,IAAS9hC,IAAKA,EAGlB,IADAk0B,EAAO+L,mBACF/L,EAAO4L,YAAY,KACvB,MAAO,KAER5L,GAAO+L,iBAEP,IAAI+B,GAAa9N,EAAO+K,MAExB,OAAK+C,IAELF,EAAKtqC,MAAQwqC,EAAWlxB,EACjBgxB,GAHiB,KAMzB,QAASx4B,IAAW7P,EAAKwP,GACxB,GAAIirB,GAAS,GAAIqN,IAAW9nC,GAAOwP,OAAQA,GAC3C,OAAOirB,GAAOzF,OAGf,QAASmU,IAAW3tC,GAKnB,IAJA,GAAI+K,MACAtE,KAGGzG,GAAU,CAChB,GAAIA,EAAS0I,SAAW1I,EAAS0I,OAAO2B,UAAYrK,EAAS0I,OAAO4B,QAAS,CAC5E,GAAIm4B,GAAMziC,EAAS0I,OAAO2B,UACtBo4B,GAASA,IAAOh8B,KAAQA,EAAMg8B,GAAOziC,EAASyG,OAClDg8B,EAAMziC,EAAS0I,OAAO4B,QAClBm4B,GAASA,IAAO13B,KAAMA,EAAI03B,GAAOziC,EAAS+K,KAI9C/K,EADGA,EAAS0S,kBAAoB1S,EAASZ,QAAQy0C,SACtC7zC,EAAS0S,gBAET1S,EAAS0I,OAItB,OAASqC,IAAKA,EAAKtE,MAAOA,GA4R3B,QAASiV,IAAkB9K,GAE1B,GAAIoK,GAAWpK,EAAUxR,OAEzB,GAIC,KAHA,GAAIkB,GAAc0a,EAASimC,sBAEvB59C,EAAI/C,EAAYgD,OACbD,KAAK,CACX,GAAI5C,GAAOH,EAAY+C,GACnBnD,EAAQI,EAAY,IAAMG,EAE1BP,GAAMC,KAAKyQ,KACd1Q,EAAME,IAAIwQ,EAAUoK,UAEpBpK,EAAUtQ,YAAYC,KAAKL,UAGrB8a,EAAWA,EAAStS,QAG9B,QAAS2T,IAA+BzL,GAGvC,IAFA,GAAIoK,GAAWpK,EAAUxR,QAElB4b,GAAU,CAChB,GAAI9a,GAAQ8a,EAASimC,sBAAsB,IAAMrwC,EAAUnQ,KACvDP,IAAOA,EAAMyc,OAAO/L,GAExBoK,EAAWA,EAAStS,QAItB,QAAS8S,IAAUtb,GAClBA,EAAMsb,YAuUP,QAAS6T,IAAkBvuB,GAC1B,GAAI8tB,GAAU9tB,EAAU8tB,QACpBnuB,EAAOK,EAAUL,IAGrB,IAAa,OAATA,EAAe,MAAOipD,GAE1B,IAAa,UAATjpD,EAAkB,CAErB,GAAqB,WAAjBmuB,EAAQnuB,MAA8B,UAATA,EAChC,MAAOmuB,GAAQ/tB,aAAa,YAAc8oD,GAA4BC,EAGvE,IAAqB,aAAjBh7B,EAAQnuB,KAAqB,MAAOopD,GAGxC,IAA+C,MAA3Cj7B,EAAQ/tB,aAAa,mBAA4B,MAAOipD,GAG5D,IAAqB,UAAjBl7B,EAAQnuB,KAAkB,CAC7B,GAAI2O,GAAOwf,EAAQ/tB,aAAa,OAGhC,IAAa,SAATuO,EAAiB,MAAO2gB,EAG5B,IAAa,UAAT3gB,GAAoBwf,EAAQlwB,SAA8C,SAAnCkwB,EAAQlwB,QAAQoC,UAAUL,KAAiB,MAAOspD,GAE7F,KAAKntC,GAAU/T,QAAQuG,GAAO,MAAOy6C,IAGtC,MAAOG,IAGR,GAAIpqD,GAAOgvB,EAAQhvB,IAGnB,IAAIkB,EAAUouB,UAAqB,SAATzuB,EAAiB,CAC1C,GAAkB,UAAdb,EAAKwP,KAAkB,MAAO66C,GAClC,IAAkB,aAAdrqD,EAAKwP,KAAqB,MAAO86C,IAItC,MAAa,UAATzpD,GAAoBb,EAAK+xB,MAAMhvB,aAAqBwnD,GAG3C,UAAT1pD,GAAsBb,EAAKwC,cAAgBxC,EAAKwC,eAAiBmO,GAEjEzP,EAAUquB,UAAkBi7B,GAE5BtpD,EAAUc,WAAad,EAAUc,YAAcd,EAAUlB,KAAKwC,aAAqBioD,GAEhFC,GAN4EC,GASpF,QAASb,MACR,GAAI9pD,GAAOnB,KAAKmB,KAEZ2C,EAAQ9D,KAAKuC,iBAEVvC,MAAKW,QAAQgG,MAAMxF,EAAKuF,IAC/B1G,KAAKW,QAAQgG,MAAM7C,GAAS3C,EAE5BA,EAAKuF,GAAK5C,EAGX,QAASonD,MACR,GAAIpnD,GAAQ9D,KAAKuC,UAEZiI,GAAQ1G,KAAQA,GAASA,GAK9B,KAHA,GAAIqD,GAAUnH,KAAKmB,KAAKgG,QACpBvC,EAAIuC,EAAQtC,OAETD,KAAK,CACX,GAAI4O,GAASrM,EAAQvC,GACjB0F,EAAckJ,EAAOtD,SAAWsD,EAAOtD,SAASpM,MAAQ0P,EAAO1P,KAEnE0P,GAAOrJ,SAAW4vB,EAAcj2B,EAAOwG,IAIzC,QAAS6gD,MACR,GAAIrnD,GAAQ9D,KAAKuC,UAEjB,KAAKvC,KAAK64B,OAAQ,CAEjB74B,KAAKmB,KAAK+O,SAASpM,MAAQA,CAK3B,KAHA,GAAIqD,GAAUnH,KAAKmB,KAAKgG,QACpBvC,EAAIuC,EAAQtC,OAETD,KAAK,CACX,GAAI4O,GAASrM,EAAQvC,GACjB0F,EAAckJ,EAAOtD,SAAWsD,EAAOtD,SAASpM,MAAQ0P,EAAO1P,KAEnE,IAAIwG,GAAexG,EAGlB,YADA0P,EAAOrJ,UAAW,GAKpBnK,KAAKmB,KAAK2wC,cAAgB,IAI5B,QAASuZ,MACR,GAAIvnD,GAAQ9D,KAAKuC,UAEZvC,MAAK64B,SACT74B,KAAKmB,KAAK6P,UAAsBxO,SAAVsB,EAAsB,GAAKA,GAInD,QAASwnD,MACR,GAAInqD,GAAOnB,KAAKmB,KACZ84B,EAAa94B,EAAKg4B,QAElBr1B,EAAQ9D,KAAKuC,UAGjBpB,GAAK2C,MAAQ9D,KAAKmB,KAAK+O,SAASpM,MAAQA,EACxC3C,EAAKg4B,QAAUr1B,IAAU9D,KAAKmwB,QAAQ/tB,aAAa,QAM/C63B,IAAe94B,EAAKg4B,SAAWn5B,KAAKmwB,QAAQlwB,SAAWD,KAAKmwB,QAAQlwB,QAAQuF,UAC/ExF,KAAKmwB,QAAQlwB,QAAQw5B,MAAM34B,MAAM+X,IAAI7Y,KAAKmwB,QAAQlwB,QAAQw5B,MAAMl3B,YAIlE,QAASgpD,MACR,IAAKvrD,KAAK64B,OAAQ,CACjB,GAAI/0B,GAAQ9D,KAAKuC,UAEjBvC,MAAKmB,KAAK2C,MAAQ9D,KAAKmB,KAAK+O,SAASpM,MAAQA,EAC7C9D,KAAKmB,KAAK+C,aAAa,QAASJ,IAIlC,QAASsnD,MACR,IAAKprD,KAAK64B,OAAQ,CACjB,GAAI/0B,GAAQ9D,KAAKuC,UAEjBvC,MAAKmB,KAAK+O,SAASpM,MAAQA,EAE3B9D,KAAKmB,KAAK2C,MAAQmF,EAAkBnF,GACpC9D,KAAKmB,KAAK+C,aAAa,QAAS+E,EAAkBnF,KAIpD,QAAS0nD,MACRxrD,KAAKmB,KAAKg4B,QAAUn5B,KAAKuC,YAAcvC,KAAKmB,KAAK+O,SAASpM,MAG3D,QAAS2nD,MACR,GAAIt7B,GAAUnwB,KAAKmwB,QACfhvB,EAAOnB,KAAKmB,KAEZlB,EAAUkwB,EAAQlwB,QAElB6D,EAAQ9D,KAAKuC,WACbyuC,EAAiB7gB,EAAQ/tB,aAAa,QAE1C,IAAKoI,EAAQ1G,GAEN,CAEN,IADA,GAAIc,GAAId,EAAMe,OACPD,KACN,GAAIosC,GAAkBltC,EAAMc,GAE3B,YADA3E,EAAQi6B,UAAY/4B,EAAKg4B,SAAU,EAIrCl5B,GAAQi6B,UAAY/4B,EAAKg4B,SAAU,MATnCl5B,GAAQi6B,UAAY/4B,EAAKg4B,QAAUr1B,GAASktC,EAa9C,QAAS0a,MACR1rD,KAAKmB,KAAK+xB,MAAMhvB,aAAa,UAAWlE,KAAKuC,YAAc,IAG5D,QAASupD,MACR9rD,KAAKmB,KAAK4qD,UAAY9iD,EAAkBjJ,KAAKuC,YAG9C,QAASopD,MAGH3rD,KAAK64B,SACL74B,KAAKwwB,YACRxwB,KAAKmB,KAAKnB,KAAKuwB,cAAgBvwB,KAAKuC,WAEhCvC,KAAKuC,WACRvC,KAAKmB,KAAK+C,aAAalE,KAAKuwB,aAAc,IAE1CvwB,KAAKmB,KAAK2D,gBAAgB9E,KAAKuwB,eAMnC,QAASs7B,MACR7rD,KAAKmB,KAAK+C,aAAalE,KAAKgC,KAAMiH,EAAkBjJ,KAAKgJ,cAG1D,QAAS4iD,MACR5rD,KAAKmB,KAAK6qD,eAAehsD,KAAKmD,UAAWnD,KAAKgC,KAAKmL,MAAMnN,KAAKgC,KAAKoI,QAAQ,KAAO,GAAInB,EAAkBjJ,KAAKgJ,cAmC9G,QAASgJ,IAA0BF,GAClC,MAAOA,GAAKgf,QAAQrB,GAAe,SAAUyU,EAAO+nB,GACnD,GAAIpc,EAWJ,OAPCA,GADiB,MAAdoc,EAAO,GACHvsC,GAAausC,GACI,MAAdA,EAAO,GACV3I,SAAS2I,EAAO34B,UAAU,GAAI,IAE9BgwB,SAAS2I,EAAO34B,UAAU,GAAI,IAGjCuc,EAIEhgB,GAAWq8B,GAAarc,IAHvB3L,IAYV,QAASj+B,IAAWF,GACnB,MAAOA,GAAI+qB,QAAQlR,GAAK,SAASkR,QAAQf,GAAU,QAAQe,QAAQd,GAAa,QAQjF,QAASk8B,IAAarc;AACrB,MAAKA,GAKQ,KAATA,EACI,GAIG,IAAPA,EACIA,EAKI,KAARA,EACIrgB,GAAkBqgB,EAAO,KAItB,MAAPA,EACIA,EAII,OAARA,EACI5f,GAII,OAAR4f,EACIA,EACIlgB,GAKRkgB,GAAQ,OAAiB,QAARA,EACbA,EAIJA,GAAQ,QAAkB,QAARA,EACdA,EAGD5f,GAbCA,GAjCAA,GAiDT,QAASU,IAAgBxvB,EAAM2xB,GAG9B,IAFA,GAAIgd,GAAY,SAAWhd,EAEpB3xB,GAAM,CACZ,GAAIA,EAAK4uC,aAAaD,GAAY,MAAO3uC,GAAKiB,aAAa0tC,EAC3D3uC,GAAOA,EAAK+M,WAGb,MAAOoiB,IAAWwC,GA2OnB,QAAS3B,IAAgBprB,EAAKkrB,GAC7B,GAAIvrB,GAAUurB,EAAQ,MAAQ,KAC9B,OAAOlrB,IAAOgrB,GAAM/f,UAAY,IAAMtL,EAAU,IAAMK,EAAM,MAAQL,EAAU,MAAQlB,EAAQusB,GAAMtsB,WAAW,GAAGnE,eAGnH,QAAS8wB,IAAM4e,EAAUC,GAGxB,IAFA,GAAIrrC,GAAIorC,EAASnrC,OAEVD,KACN,GAAIorC,EAASprC,GAAG5C,OAASiuC,EAAOjuC,KAC/B,OAAO,CAIT,QAAO,EAwMR,QAASmxB,IAAW+c,GACnB,MAAOA,GAAcpf,QAAQ,eAAgB,SAAUoT,EAAOiK,GAC7D,MAAOA,GAAGzqC,gBAkFZ,QAASowB,MACRJ,IAAWtqB,GAAIuqB,IAGhB,QAASI,MACRL,IAAU,EAGX,QAASM,MACRN,IAAU,EAKX,QAAS4B,IAAUlI,GAClB,MAAOA,GAAK0D,QAAQmD,GAAiB,IAKtC,QAAS2B,IAAW7vB,GACnB,MAAKA,IAEDmuB,GAAcxyB,KAAKqE,KAAMA,EAAM,IAAMA,GAElCA,EAAI+qB,QAAQ,SAAU,SAAUoT,GACtC,MAAO,IAAMA,EAAMpI,iBALH,GA6NlB,QAAShE,IAAW32B,EAAM+xB,GACrBA,EACH/xB,EAAK+C,aAAa,QAASgvB,IAI3B/xB,EAAKiB,aAAa,SAClBjB,EAAK2D,gBAAgB,UAgNvB,QAASI,IAAoBirB,GAE5B,GAAIhvB,GAAOgvB,EAAQhvB,KACfob,EAAW4T,EAAQxvB,OAEvB,GAIC,KAHA,GAAIkB,GAAc0a,EAAS4zB,aAEvBvrC,EAAI/C,EAAYgD,OACbD,KAAK,CACX,GAAIvD,GAAWQ,EAAY+C,GACvBnD,EAAQI,EAAY,IAAMR,EAE1BI,GAAMC,KAAKP,KACdM,EAAME,IAAIR,GAEVgvB,EAAQtuB,YAAYC,KAAKL,UAGnB8a,EAAWA,EAAStS,QAI9B,QAASwuB,IAAetI,GACvB,KAAOA,EAAUA,EAAQlmB,QACxB,GAAqB,SAAjBkmB,EAAQnuB,KACX,MAAOmuB,GAKV,QAASiI,IAAmBgY,EAAazvC,GACxC4K,EAAgB,OAAS6kC,EAAc,8IAAgJzvC,QAASA,IAsGjM,QAASs4B,MACRj5B,KAAKkQ,SAASjQ,QAAQwI,eAyCvB,QAASixB,IAAgBD,EAAO34B,EAAOyB,GACtC,GAAIszB,GAAO4D,EAAQ,eACnB,OAAO34B,GAAM+0B,KAAU/0B,EAAM+0B,GAAQ,GAAIuD,IAAavD,EAAM/0B,EAAOyB,IA+CpE,QAASo3B,MACR,GAAI0W,GAAMrwC,KAAKq5B,SAAS/e,OAAO,SAAUg2B,GACxC,MAAOA,GAAEnvC,MAAQmvC,EAAEnvC,KAAKg4B,UACtBh1B,IAAI,SAAUmsC,GAChB,MAAOA,GAAEngB,QAAQ/tB,aAAa,WAE3BmuC,IAIJ,OAHAF,GAAI3tC,QAAQ,SAAU0a,GAChB2c,EAAcwW,EAAKnzB,IAAImzB,EAAIzuC,KAAKsb,KAE/BmzB,EAiLR,QAAS7V,MACRzB,GAAezxB,KAAKxH,KAEpB,IAAI8D,GAAQ9D,KAAKkQ,SAASjQ,QAAQa,MAAMsH,KACxCpI,MAAK8D,MAAiBtB,QAATsB,EAAqB,GAAKA,EAGxC,QAAS22B,IAAYhE,GACpB,GAAI8D,GAAU,MAEd,OAAO,YACN,GAAIjzB,GAAQtH,IAERu6B,IAASiW,aAAajW,GAE1BA,EAAUvF,WAAW,WACpB,GAAI/0B,GAAUqH,EAAM4I,SAASjQ,OACzBA,GAAQuF,UAAUyzB,GAAezxB,KAAKF,GAC1CizB,EAAU,MACR9D,IAwEL,QAAS9mB,IAAmB5F,GAC3B,MAAOA,GAAO2F,gBAAkBlL,EAAQuF,EAAO2F,iBAAmB3F,EAAO5C,QAAU3C,EAAQuF,EAAO5C,SAASmT,OAAO,SAAU9G,GAC3H,MAAOA,GAAOrJ,cAqIhB,QAASoxB,IAAY1F,GACpB,MAAOwF,IAASxF,KAAUwF,GAASxF,OAwDpC,QAAS4F,MACR,GAAItC,GAAUn5B,KAAKq5B,SAAS/e,OAAO,SAAUg2B,GAC5C,MAAOA,GAAEnvC,KAAKg4B,SAEf,OAAIA,GAAQt0B,OAAS,EACbs0B,EAAQ,GAAGhJ,QAAQ/tB,aAAa,SADxC,OA2MD,QAASoO,IAAWnO,GACnB,MAAOA,IAA2C,IAA9BA,EAAU9B,SAASsE,QAAgBxC,EAAU9B,SAAS,GAAGyK,IAAM+H,KAAiB1Q,EAAU9B,SAAS,GAAG2H,EAG3H,QAASrH,IAAcsvB,GACtB,GAAI7vB,GAAa6vB,EAAQ7tB,eAIzB,IAAI6tB,EAAQ/tB,aAAa,oBAAsBoO,GAAWlQ,EAAWqe,iBAEpE,MAAOnO,IAAWlQ,EAAWwD,OAASs2B,GAAyB,IAIhE,IAAqB,UAAjBjK,EAAQnuB,KAAkB,CAC7B,GAAI2O,GAAOwf,EAAQ/tB,aAAa,OAEhC,IAAa,UAATuO,GAA6B,aAATA,EAAqB,CAC5C,GAAI8/B,GAAWjgC,GAAWlQ,EAAW0B,MACjC0uC,EAAclgC,GAAWlQ,EAAW64B,QAGxC,IAAIsX,GAAYC,EAAa,CAC5B,GAAa,UAAT//B,EAIH,MAAOooB,GAHPvmB,GAAY,qGAAuG7R,QAASwvB,EAAQyI,OAOtI,GAAI6X,EACH,MAAgB,UAAT9/B,EAAmB6qB,GAAmBjC,EAG9C,IAAImX,EACH,MAAgB,UAAT//B,EAAmB2qB,GAAevC,GAI3C,MAAa,SAATpoB,GAAmBH,GAAWlQ,EAAWwD,OACrClD,GAGJ4P,GAAWlQ,EAAWwD,OACT,WAAT6M,GAA8B,UAATA,EAAmBuqB,GAAiBZ,GAG1D,KAIR,MAAqB,WAAjBnK,EAAQnuB,MAAqBwO,GAAWlQ,EAAWwD,OAC/CqsB,EAAQ/tB,aAAa,YAAcu4B,GAAwBiB,GAI9C,aAAjBzL,EAAQnuB,MAAuBwO,GAAWlQ,EAAWwD,OACjDw2B,GADR,OAKD,QAASx3B,IAAYrB,GACpBA,EAAMsb,YA4XP,QAAS3X,IAAc+F,EAAO5K,EAAU+c,GACvC,GAAK/c,GAAa4K,EAAMxK,QAAQgwC,mBAAhC,CAEA,GAAI3uC,GAAO4uC,GAAkBzlC,EAAO5K,EACpC,IAAKyB,EAAL,CAEA,GAAI80B,GAAS+Z,GAAoB1lC,EAAO5K,GACpC8F,EAAa,GAAIwwB,IAAW1rB,EAAMxK,QAASwK,EAAMhK,KAAMa,EAAM80B,EAAQxZ,EAEzE,OADAtY,IAAQ8rC,mBAAmBzqC,GACpBA,IAGR,QAASuqC,IAAkBzlC,EAAO5K,GACjC,GAAIyB,GAAOzB,EAAS+C,GAAK/C,CAEzB,IAAoB,gBAATyB,GAAmB,MAAOA,EAErC,IAAIT,GAAW,GAAI2J,KAClBC,MAAOA,EACP5K,SAAUyB,IACR7B,MAKH,OAHA6B,GAAOT,EAASkE,WAChBlE,EAAS2E,SAEFlE,EAGR,QAAS6uC,IAAoB1lC,EAAO5K,GACnC,GAAIA,EAASC,EAAG,MAAOD,GAASC,CAChC,IAAKD,EAASmxB,EAAd,CAIA,GAAInwB,GAAW,GAAI2J,KAClBC,MAAOA,EACP5K,SAAUA,EAASmxB,IACjBvxB,OAEC22B,EAASv1B,EAAS+T,aAGtB,OAFA/T,GAAS2E,SAEF4wB,GAGR,QAAShxB,IAAoBqqB,GAC5B,GAAI7vB,GAAa6vB,EAAQ7tB,gBAErByuC,EAAgBzwC,EAAWqQ,KAC3BqgC,EAAiB1wC,EAAWwD,MAC5BmtC,EAAgB3wC,EAAW0B,IAE/B,OAAK+uC,IAAyC,UAAxBA,EAAcjtC,OAAsBktC,GAAmBC,EAAc5gB,cAIvF2gB,EAAezuC,aAAe0uC,EAAc5gB,aAAavvB,MAAMsH,OAC3D,EALR,OASD,QAASxC,IAAmBvD,GAC3B,GAAI0D,GAAM1D,EAAUoD,UACpB,OAAOM,GAAM,IAAMA,EAAM,GAG1B,QAASa,IAAsBupB,GAE9B,IADA,GAAIvrB,GAAIurB,EAAQtuB,YAAYgD,OACrBD,KAAK,CACX,GAAInD,GAAQ0uB,EAAQtuB,YAAY+C,EAChCnD,GAAMyc,OAAOiS,EAAQhvB,OAIvB,QAASiC,IAAa+sB,GAErB,GAAI+gB,GAAQ/gB,EAAQ/tB,aAAa,QACjC,IAAI8uC,EAAO,MAAOA,EAGlB,IAAqB,QAAjB/gB,EAAQnuB,KAAgB,MAAOkvB,GAEnC,IAAIjnB,GAASkmB,EAAQlmB,MAErB,OAAIA,GAEiB,kBAAhBA,EAAOjI,KAAiC8P,GAGrC7H,EAAO9I,KAAKwC,aAGbwsB,EAAQxvB,QAAQwU,GAAGxR,aA4B3B,QAASiE,MACR,GAAIuoB,GAAUnwB,KAAKkQ,SAASnM,KAE5BiB,IAAQ0yB,QACRvH,EAAQ1oB,aAAa/E,QAAQoX,IAC7B9U,GAAQ8X,MAGT,QAAShD,IAAY7Z,GACpBA,EAAQa,MAAM+X,IAAI5Y,EAAQy4B,YA4K3B,QAAS1uB,IAAiBmmB,GACzB,KAAOA,GAAS,CACf,GAAqB,WAAjBA,EAAQnuB,KAAmB,MAAOmuB,EACtCA,GAAUA,EAAQlmB,QA8EpB,QAASW,IAAmBjK,EAASqB,EAAMgC,GAE1C,GAAImtC,GAAUC,GAAuBzwC,EAASqB,EAAMgC,MACpD,IAAImtC,EAAS,MAAOA,EAIpB,IADAA,EAAU3Q,GAAOC,OAAOz+B,GAAQ0+B,SAAS,IAC5B,CAEZ,GAAI/qB,GAAS6qB,GAAOW,SAASgQ,EAASxwC,EAMtC,OAHIgV,GAAO6rB,GAAG6P,EAAS1wC,EAAQ8R,SAAUkD,EAAO6rB,GAGzC7gC,EAAQ8R,SAASzQ,GAAQ2T,EAAO3K,GAIzC,QAASomC,IAAuBzwC,EAASqB,EAAMgC,GAE9C,GAAImtC,GAAUG,GAAkBtvC,EAAMgC,EAAemH,MACrD,IAAIgmC,EAAS,MAAOA,EAGpB,IAAI50B,GAAWg1B,EAAa,WAAY5wC,EAASqB,EAEjD,IAAKua,EAAL,CAIA40B,EAAU50B,EAAS9J,SAASzQ,EAG5B,IAAI+vB,GAAK,MAOT,IANuB,kBAAZof,KACVpf,EAAKof,EAAQhxC,KAAKoc,GAClBwV,EAAGgQ,QAAUxlB,EAAS9J,SAASglB,eAAez1B,GAC9CmvC,EAAUpf,EAAGvqB,KAAK7G,EAAS6/B,MAGvB2Q,GAAuB,KAAZA,EAEf,WADA3+B,GAAYg/B,GAA0BxvC,EAAM,UAAW,WAAarB,QAASA,GAM9E,KAAK6/B,GAAOK,SAASsQ,GAAU,CAE9B,GAAIx7B,GAAS6qB,GAAOW,SAASgQ,EAAS50B,EAIlC5G,GAAO6rB,GACVhvB,EAAY,2DAA4DxQ,GAAQrB,QAASA,GAK1F,IAAIqC,GAAS+uB,EAAKxV,EAAWk1B,GAAUl1B,EAAUva,EAGjDgB,GAAOyP,SAASzQ,GAAQmvC,EAAUx7B,EAAO3K,EAM1C,MAFI+mB,KAAIof,EAAQpa,IAAMhF,GAEfof,EAAQ/zB,EAAI+zB,EAAQnmC,EAAImmC,GAGhC,QAASM,IAAU9wC,EAAS2L,GAC3B,MAAO3L,GAAQ8R,SAASglB,eAAenrB,GAAO3L,EAAU+wC,GAAgB/wC,EAAQga,YAAarO,GAG9F,QAASolC,IAAgB/2B,EAAarO,GACrC,MAAKqO,GAGEA,EAAYlI,SAASglB,eAAenrB,GAAOqO,EAAc+2B,GAAgB/2B,EAAYg3B,QAASrlC,GAHrG,OAMD,QAASglC,IAAkBtvC,EAAMiI,GAChC,GAAIA,EAAQ,CACX,GAAIA,EAAO1J,UAAY0J,EAAO1J,SAASihC,GAAKv3B,EAAO1J,SAASihC,EAAEx/B,GAC7D,MAAOiI,GAAO1J,SAASihC,EAAEx/B,EACnB,IAAIiI,EAAOjG,gBAAkBiG,EAAOjG,eAAemH,MACzD,MAAOmmC,IAAkBtvC,EAAMiI,EAAOjG,eAAemH,QA6JxD,QAASF,IAAajJ,EAAMmvC,EAASxwC,GACpC,GAAIgV,GAAS,MAEb,KACCA,EAAS6qB,GAAOjuB,MAAM4+B,EAAS3Q,GAAOM,gBAAgBngC,IACrD,MAAO8C,GACR+O,EAAY,4CAA+CxQ,EAAO,MAASyB,EAAE2kC,SAG9E,MAAOzyB,KAAY3K,MAmbpB,QAASuE,IAAQzL,GAChB,OAAQA,GAAS0G,EAAQ1G,IAA2B,IAAjBA,EAAMe,QAAgBoH,EAASnI,IAAwC,IAA9BsI,OAAOC,KAAKvI,GAAOe,OAGhG,QAASsK,IAAQrL,EAAO8tC,GACvB,MAAIA,IAAepnC,EAAQ1G,GAAekL,GACtC/C,EAASnI,IAA2B,kBAAVA,GAA6BwL,GAC7C9M,SAAVsB,EAA4B,KACzBiL,GA2MR,QAASqB,IAAc7F,EAAaD,GAEnC,IADA,GAAI1F,GAAI2F,EAAY1F,OACbD,KACN,GAAI2F,EAAY3F,IAAM0F,EAAa,OAAO,EA+O5C,QAASyH,IAAYD,EAAM3Q,EAAMwL,GAChC,GAAIhG,KAGJ,IAAY,MAARmL,GAAyB,KAATA,EAAa,MAAOnL,EAExC,IAAIuL,GAAY,OACZg4B,EAAU,OACV2H,EAAiB,MAEjB/gC,MAAUo5B,EAAUn5B,GAAY5P,EAAKuE,WACxCwM,EAAYie,GAAQ,OACpBje,EAAUlB,UAAYk5B,EAAQ,GAAKp4B,EAAOo4B,EAAQ,GAClDh4B,EAAYA,EAAUT,cAAc,MAEV,WAAtBS,EAAUxM,UACbmsC,EAAiB3/B,EAAU/K,QAAQ+K,EAAU4/B,iBAEpC3wC,EAAKwC,eAAiButB,IAChChf,EAAYie,GAAQ,OACpBje,EAAUlB,UAAY,kBAAoBc,EAAO,SACjDI,EAAYA,EAAUT,cAAc,OACT,aAAjBtQ,EAAKuE,SACfwM,EAAYtO,GAAc,OAEW,mBAA1BsO,GAAU0uB,YACpB1uB,EAAU0uB,YAAc9uB,EAExBI,EAAUlB,UAAYc,IAGvBI,EAAYie,GAAQhvB,EAAKuE,SACzBwM,EAAUlB,UAAYc,EAEI,WAAtBI,EAAUxM,UACbmsC,EAAiB3/B,EAAU/K,QAAQ+K,EAAU4/B,gBAK/C,KADA,GAAInO,GAAQ,OACLA,EAAQzxB,EAAU6/B,YACxBprC,EAAM7E,KAAK6hC,GACXh3B,EAAQpH,YAAYo+B,EAQrB,IAAI/+B,GAAI,MACR,IAAqB,WAAjBzD,EAAKuE,QAER,IADAd,EAAI+B,EAAM9B,OACHD,KACF+B,EAAM/B,KAAOitC,IAChBlrC,EAAM/B,GAAGuF,UAAW,EAKvB,OAAOxD,GAGR,QAASwpB,IAAQzqB,GAChB,MAAOmL,IAAanL,KAAamL,GAAanL,GAAW9B,GAAc8B,IA6NxE,QAASssC,IAAwBrxC,EAASqB,GACzC,GAAIua,GAAWg1B,EAAa,aAAc5wC,EAASqB,GAC/C4a,EAAY,MAEhB,IAAIL,IACHK,EAAYL,EAASR,WAAW/Z,IAG3B4a,EAAU+0B,SAAS,CAEvB,GAAI5f,GAAKnV,EAAUzc,KAAKoc,EAIxB,IAHAwV,EAAGgQ,QAAUxlB,EAASR,WAAW0b,eAAez1B,GAChD4a,EAAYmV,KAEPnV,EAEJ,WADApK,GAAYg/B,GAA0BxvC,EAAM,YAAa,aAAerB,QAASA,GAIzD,iBAAdic,KAEVA,EAAYo1B,GAAwBrxC,EAASic,IAG9CA,EAAUma,IAAMhF,EAChBxV,EAASR,WAAW/Z,GAAQ4a,EAI9B,MAAOA,GAqBR,QAAS5H,IAAW7N,GACnB,GAAgC,gBAArBA,GAAQ5G,SAClB,MAAO,IAAImQ,IAAKvJ,EAGjB,IAAIA,EAAQ5G,SAASyK,IAAMkK,GAAS,CAEnC,GAAIw6B,GAAuBsC,GAAwB7qC,EAAQnD,eAAerD,QAASwG,EAAQ5G,SAASkD,EACpG,IAAIisC,EACH,MAAO,IAAI9yB,IAAUzV,EAASuoC,EAG/B,IAAIhqC,GAAUyB,EAAQ5G,SAASkD,EAAEq4B,cAE7BmW,EAAqB7+B,GAAgB1N,IAAYtF,EACrD,OAAO,IAAI6xC,GAAmB9qC,GAG/B,GAAIH,GAAO0L,GAAavL,EAAQ5G,SAASyK,EAEzC,KAAKhE,EAAM,KAAM,IAAIoO,OAAM,0BAA4BjO,EAAQ5G,SAASyK,EAExE,OAAO,IAAIhE,GAAKG,GAsDjB,QAASsO,IAAab,EAAOW,EAAQ28B,GACpC,GAAIC,GAAUppC,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,GAAmB,EAAIA,UAAU,EAElF,OAAO6L,GAAMzQ,IAAI,SAAU8Q,GAC1B,GAAIA,EAAKtE,OAASC,GACjB,MAAOqE,GAAK1U,QAGb,IAAI0U,EAAK1T,SACR,MAAI0T,GAAK1T,SAASoK,WACVsJ,EAAK1T,SAASoK,WAAWxH,IAAI,SAAU5C,GAC7C,MAAOkU,IAAalU,EAASqT,MAAOW,EAAQ28B,EAAMC,KAChD9tC,KAAK,IAEDoR,GAAaR,EAAK1T,SAASqT,MAAOW,EAAQ28B,EAAMC,EAIzD,IAAIC,GAAgBF,EAAO,IAAMC,GAIjC,OAFA58B,GAAO68B,GAAiBn9B,EAAKnU,MAAQmU,EAAKnU,MAAMopC,QAAUj1B,EAAKnU,MAAMopC,QAAQpmC,MAAQmR,EAAKnU,MAAMsH,MAAQ5F,OAEjG,KAAO4vC,EAAgB,MAC5B/tC,KAAK,IAGT,QAAS4R,IAAqBhB,GAC7BA,EAAKhU,UAAS,GAsVf,QAAS2X,IAAsBrY,GAC9B6gC,GAAqB1E,KAAK,KAAM18B,MAAQO,SAAUA,GAElD,IAAIowC,GAAqB3wC,KAAK2wC,kBAC9B3wC,MAAK2wC,oBAAqB,CAM1B,IAAIx+B,GAAYnS,KAAKmS,SACjBA,KAAWA,EAAU/L,eAAgB,GACzCpG,KAAKiB,WACDkR,IAAWA,EAAU/L,eAAgB,GAGzCpG,KAAKuB,SAAS2E,SAASjF,UAAS,GAEhCjB,KAAKuB,SAAW,GAAI2J,KACnB3K,SAAUP,KAAKO,SACfq4B,KAAM54B,KACNmL,MAAOnL,MAGR,IAAI2M,GAAUC,GACd5M,MAAKuB,SAASpB,KAAKH,KAAKqc,WAAWtZ,OAAO4J,GAC1C3M,KAAKmV,GAAG7L,aAAaqD,EAAS3M,KAAKoO,QAEnCpO,KAAK2wC,mBAAqBA,EAK3B,QAAS73B,IAAYwf,EAASx0B,GAC7B,GAAIk0B,GAAUhzB,GAAQ0yB,MAAM13B,MAAM,EAGlC,IAAIiM,EAASqsB,GAAU,CACtB,GAAIn0B,GAAMm0B,CAEV,KAAK,GAAIva,KAAK5Z,GACTA,EAAIszB,eAAe1Z,IACtBlF,GAAI7Y,KAAM+d,EAAG5Z,EAAI4Z,QAMlBlF,IAAI7Y,KAAMs4B,EAASx0B,EAKrB,OAFAkB,IAAQ8X,MAEDkb,EAGR,QAASnf,IAAIlY,EAAS23B,EAASx0B,GAG9B,GAFqB,kBAAVA,KAAsBA,EAAQ3D,GAAK2D,EAAOnD,IAEjD,KAAKe,KAAK42B,GACb33B,EAAQ0b,UAAU+gB,YAAYtpB,EAAcwkB,IAAU51B,QAAQ,SAAU5B,GACvEA,EAAM+X,IAAI/U,SAEL,CACN,GAAIhD,GAAQH,EAAQ0b,UAAU/H,QAAQR,EAAcwkB,GACpDx3B,GAAM+X,IAAI/U,IAUZ,QAASkV,IAAiBsf,EAAS5G,GAClC,MAAO/vB,GAAI3B,KAAMs4B,EAAe91B,SAANkvB,EAAkB,IAAMA,GAQnD,QAASxY,MACR,GAAI5R,GAAQtH,IAEZA,MAAKuB,SAAS2E,SACdlG,KAAKqc,UAAUpD,WAEfjZ,KAAK0d,WAAWhb,QAAQib,IAEpB3d,KAAKuB,SAASiE,UAAYxF,KAAKmV,GAAG0I,uBACrCpT,EAAgBzK,KAAKmV,GAAG0I,sBAAuB7d,MAGhDA,KAAKoG,eAAgB,CACrB,IAAI4xB,GAAUh4B,KAAKuB,SAASiE,SAAWxF,KAAKiB,WAAaua,GAAUjT,SAQnE,OANA6D,QAAOC,KAAKrM,KAAK8d,QAAQpb,QAAQ,SAAUqb,GAC1C,MAAOzW,GAAMwW,OAAOC,GAAGpE,WAGxBtD,GAAekB,KAAKvX,MAEbg4B,EAGR,QAAS5e,IAAekf,GACvB,GAAuB,gBAAZA,GACV,KAAM,IAAI+Z,WAAUC,GAGrB,IAAIlJ,GAAU,MAEd,OAAI,KAAK1nC,KAAK42B,IACb8Q,KAEAppC,KAAKqc,UAAU+gB,YAAYtpB,EAAcwkB,IAAU51B,QAAQ,SAAU5B,GACpEsoC,EAAQtoC,EAAM+vB,eAAiB/vB,EAAMsH,QAG/BpI,KAAK6Y,IAAIuwB,IAGVppC,KAAK6Y,IAAIyf,GAAUt4B,KAAKoI,IAAIkwB,IAGpC,QAAShf,MACR,GAAIrV,IAAUjE,KAAK8/B,OAAO3N,OAAO/qB,GAAamrC,kBAAkBvyC,KAAKiC,oBAAoBkC,IAAI,SAAUq+B,GACtG,MAAOA,GAAE1C,UAEN0S,EAAepmC,OAAOC,KAAKpI,EAAO88B,OAAO,SAAU0R,EAAK/rC,GAC3D,MAAO+rC,GAAI/rC,IAAM,EAAM+rC,OAExB,OAAOn3B,IAAOk3B,GAGf,QAAS/4B,MACR,MAAOzZ,MAAKuB,SAASkE,UAAS,GAG/B,QAASiU,IAAmB1X,EAAMb,EAAM21B,GAEnC31B,YAAgBuxC,cAETzmC,EAAS9K,KAElB21B,EAAS31B,GAWXA,EAAOA,GAAQnB,KAAKud,MAAMpc,KAErBA,GACJmxB,EAAM,uCAAyCtwB,EAGhD,IAAIqE,GAAa,GAAIwwB,IAAW72B,KAAMmB,EAAMa,EAAM80B,GAC9CkB,EAAUhzB,GAAQ0yB,MAAM13B,MAAM,EAGlC,OAFAgF,IAAQ8rC,mBAAmBzqC,GAC3BrB,GAAQ8X,MACDkb,EAGR,QAASre,IAAOg5B,GACf,GAAIC,GAAK5yC,KAAK8d,OAAO60B,EAErB,OAAIC,IACHA,EAAGj5B,eACI3Z,MAAK8d,OAAO60B,GACZ3yC,KAAK6Y,IAAI85B,EAAMC,EAAGC,cAElBr3B,GAAUjT,SAAQ,GAM3B,QAASqR,MACR,IAAK5Z,KAAKuB,SAASiE,SAElB,MADAgN,GAAY,6EACLgJ,GAAUjT,SAGlB,IAAIyvB,GAAUhzB,GAAQ0yB,MAAM13B,MAAM,GAI9BoG,GAAiBpG,KAAKmS,WAAanS,KAAKmS,UAAU/L,eAAiBpG,KAAKoG,aAQ5E,OAPApG,MAAKuB,SAASN,SAASmF,GAEvBqE,EAAgBzK,KAAKmV,GAAG0I,sBAAuB7d,MAE/CuW,GAAegB,KAAKvX,MAEpBgF,GAAQ8X,MACDkb,EAOR,QAASne,IAAeye,GACnBA,IAASA,EAAUxkB,EAAcwkB,GAErC,IAAIx3B,GAAQw3B,EAAUt4B,KAAKqc,UAAU/H,QAAQgkB,GAAWt4B,KAAKqc,UAEzD2b,EAAUhzB,GAAQ0yB,MAAM13B,MAAM,EAIlC,IAFAc,EAAMyjC,OAEFjM,EAGH,IADA,GAAIwa,GAAUhyC,EAAMmJ,OACbquB,EAAQzzB,QAAUiuC,GACpBA,EAAQrP,kBAAkBqP,EAAQrP,iBAAiBnL,EAAQ9f,OAC/Ds6B,EAAUA,EAAQ7oC,MAMpB,KADA,GAAIA,GAASnJ,EAAMmJ,OACZA,GAAQ,CAEd,IADA,GAAIrF,GAAIqF,EAAOs5B,KAAK1+B,OACbD,KACNqF,EAAOs5B,KAAK3+B,GAAG6D,cACfwB,GAASA,EAAOA,OAOlB,MAJAjF,IAAQ8X,MAERrG,GAAWc,KAAKvX,KAAMc,GAEfk3B,EAGR,QAASje,IAAoBue,EAAS+R,GACrC,GAAIrS,GAAUhzB,GAAQ0yB,MAAM13B,MAAM,EAUlC,OARKs4B,GAGJt4B,KAAKqc,UAAU/H,QAAQR,EAAcwkB,IAAU8R,mBAAmBC,KAAY,GAF9ErqC,KAAKqc,UAAU+tB,oBAAmB,GAKnCplC,GAAQ8X,MAEDkb,EAoDR,QAAS+a,IAAQ1N,EAAQ2N,EAAaC,GAErC,MAAIA,IAASC,GAAW7N,EAAQ2N,GAExB,WAEN,GAEIjY,GAFAoY,EAAW,UAAYnzC,MACvBozC,EAASpzC,KAAKozC,MAWlB,OARApzC,MAAKozC,OAASJ,EAEdjY,EAASsK,EAAOv8B,MAAM9I,KAAM+I,WAExBoqC,IACHnzC,KAAKozC,OAASA,GAGRrY,GAGDsK,EAIT,QAAS6N,IAAW7N,EAAQ2N,GAC3B,MAA8B,kBAAhBA,IAA8B,SAAStxC,KAAK2jC,GAG3D,QAASgO,IAAO5G,GAGf,IAFA,GAAItlC,MAEGslC,GACN6G,GAAc7G,EAAOtlC,GACrBosC,GAAgB9G,EAAOtlC,GAGtBslC,EADGA,EAAMkF,UAAYl3B,GACbgyB,EAAMkF,SAEN,CAIV,OAAOxqC,GAGR,QAASmsC,IAAc7G,EAAOtlC,GAC7B66B,GAAWt/B,QAAQ,SAAU8F,GAC5BgrC,GAAYhrC,EAAEo5B,YAAc6K,EAAMpsC,UAAYosC,EAAOtlC,EAASqB,EAAExG,QAIlE,QAASwxC,IAAYxwC,EAAQmE,EAASnF,GACrC,GAAI8/B,GACAz1B,EAAOD,OAAOC,KAAKrJ,EAAOhB,GAEzBqK,GAAKxH,UAIJi9B,EAAW36B,EAAQnF,MACxB8/B,EAAW36B,EAAQnF,OAGpBqK,EAAKiO,OAAO,SAAUhO,GACrB,QAASA,IAAOw1B,MACdp/B,QAAQ,SAAU4J,GACpB,MAAOw1B,GAASx1B,GAAOtJ,EAAOhB,GAAMsK,MAItC,QAASinC,IAAgB9G,EAAOtlC,GAC/BiF,OAAOC,KAAKogC,EAAMpsC,WAAWqC,QAAQ,SAAU4J,GAC9C,GAAY,aAARA,EAAJ,CAIA,GAAIxI,GAAQ2oC,EAAMpsC,UAAUiM,EAE5B,IAAMA,IAAOnF,IAKR,GAA4B,kBAAjBA,GAAQmF,IAAwC,kBAAVxI,IAAwBqD,EAAQmF,GAAKmnC,QAAS,CAElG,GAAI1Y,GAAS,OACTmY,EAAapvC,EAAM2vC,OAEnBP,KACHpvC,EAAQA,EAAM2vC,SAIf1Y,EAASgY,GAAO5rC,EAAQmF,GAAKmnC,QAAS3vC,GAElCovC,IACHnY,EAAO0Y,QAAU1Y,GAGlB5zB,EAAQmF,GAAOyuB,OApBhB5zB,GAAQmF,GAAOxI,EAAM2vC,QAAU3vC,EAAM2vC,QAAU3vC,KAyBlD,QAASkX,MACR,IAAK,GAAIsqB,GAAOv8B,UAAUlE,OAAQsC,EAAUkT,MAAMirB,GAAOC,EAAO,EAAUD,EAAPC,EAAaA,IAC/Ep+B,EAAQo+B,GAAQx8B,UAAUw8B,EAG3B,OAAKp+B,GAAQtC,OAGLsC,EAAQ45B,OAAO2S,GAAW1zC,MAF1B0zC,GAAU1zC,MAMnB,QAAS0zC,IAAU1U,GAClB,GAEI2U,GAAQj9B,EAFRvP,EAAU4B,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,MAAwBA,UAAU,EA+CnF,OArCI5B,GAAQ9G,oBAAqBoa,MAChCtT,EAAUksC,GAAOlsC,IAGlBwsC,EAAS,SAAexsC,GACvB,MAAMnH,gBAAgB2zC,IAEtB/D,GAAU5vC,KAAMmH,WAChBuV,IAAW1c,KAAMmH,WAHqB,GAAIwsC,GAAOxsC,IAMlDuP,EAAQ0pB,GAAOpB,EAAO3+B,WACtBqW,EAAMiE,YAAcg5B,EAGpB/4B,GAAiB+4B,GAEhBj5B,UAAY5W,MAAO4S,GAGnBsE,QAAUlX,MAAOkX,GAAQF,UAAU,EAAMkrB,cAAc,GAGvD2L,SAAW7tC,MAAOk7B,KAInBuD,GAAOvnB,OAAOgkB,EAAQtoB,EAAOvP,GAE7B64B,GAAiBhlB,OAAOgkB,EAAQtoB,EAAOvP,GAEnCA,EAAQysC,WACXl9B,EAAMk9B,SAAWp5B,EAAU4lB,GAAOpB,EAAO3+B,UAAUuzC,UAAWzsC,EAAQysC,WAGvED,EAAOtzC,UAAYqW,EAEZi9B,EAGR,QAASz4B,IAAa/Z,GACrB,IAAKA,IAASA,EAAK+O,SAAU,QAE7B,IAAIw2B,GAAUvlC,EAAK+O,SACfvP,EAAU+lC,EAAQnlC,SAASZ,QAE3BkzC,EAAc3E,GAAWxI,EAAQnlC,UAEjC+K,EAAMunC,EAAYvnC,IAClBtE,EAAQ6rC,EAAY7rC,MAEpB0D,EAAUg7B,EAAQnlC,SAAS8S,aAE/B,QACC1T,QAASA,EACT23B,QAAS5sB,EAAQmlB,WAAWlwB,GAC5BwuC,SAAUzjC,EAAQmlB,aAClB7oB,MAAOA,EACPsE,IAAKA,GAIP,QAAS6O,MACR,IAAK,GAAImqB,GAAOv8B,UAAUlE,OAAQwH,EAAOgO,MAAMirB,GAAOC,EAAO,EAAUD,EAAPC,EAAaA,IAC5El5B,EAAKk5B,GAAQx8B,UAAUw8B,EAGxB,OAAOl5B,GAAKlI,IAAI8W,GAAW5W,KAAK,KAGjC,QAAS+W,IAAakd,GACrB,MAAOxkB,GAAcwkB,GAASn0B,IAAIkX,GAanC,QAASZ,IAAQtT,GAChB,MAAMnH,gBAAgBya,KAEtBm1B,GAAU5vC,KAAMmH,WAChBuV,IAAW1c,KAAMmH,WAHsB,GAAIsT,IAAQtT,GA79YpD,GAAIC,MACJA,IAAAA,UAAwC,kBAAX0sC,SAAoD,gBAApBA,QAAOC,SAAwB,SAAU3E,GACpG,aAAcA,IACZ,SAAUA,GACZ,MAAOA,IAAyB,kBAAX0E,SAAyB1E,EAAIz0B,cAAgBm5B,OAAS,eAAkB1E,IAG/FhoC,GAAaC,eAAiB,SAAUkV,EAAUy3B,GAChD,KAAMz3B,YAAoBy3B,IACxB,KAAM,IAAI3B,WAAU,sCAIxBjrC,GAAaM,SAAW,SAAUusC,EAAUC,GAC1C,GAA0B,kBAAfA,IAA4C,OAAfA,EACtC,KAAM,IAAI7B,WAAU,iEAAoE6B,GAG1FD,GAAS5zC,UAAY+L,OAAOg0B,OAAO8T,GAAcA,EAAW7zC,WAC1Dsa,aACE7W,MAAOmwC,EACPE,YAAY,EACZr5B,UAAU,EACVkrB,cAAc,KAGdkO,IAAY9nC,OAAOgoC,eAAiBhoC,OAAOgoC,eAAeH,EAAUC,GAAcD,EAASnO,UAAYoO,IAG7G9sC,GAAaG,0BAA4B,SAAU8sC,EAAM7sC,GACvD,IAAK6sC,EACH,KAAM,IAAIC,gBAAe,4DAG3B,QAAO9sC,GAAyB,gBAATA,IAAqC,kBAATA,GAA8B6sC,EAAP7sC,GAG5EJ,GAAamrC,kBAAoB,SAAUgC,GACzC,GAAIl6B,MAAM7P,QAAQ+pC,GAAM,CACtB,IAAK,GAAI3vC,GAAI,EAAG4vC,EAAOn6B,MAAMk6B,EAAI1vC,QAASD,EAAI2vC,EAAI1vC,OAAQD,IAAK4vC,EAAK5vC,GAAK2vC,EAAI3vC,EAE7E,OAAO4vC,GAEP,MAAOn6B,OAAMo6B,KAAKF,GAMtB,IAAI75B,KAEHvF,GAAI,OACJu/B,QAAQ,EAGRn0C,SAAU,KAGVo0C,YAAa,KAAM,MACnBC,kBAAmB,MAAO,OAC1BC,kBAAmB,KAAM,MACzBC,wBAAyB,MAAO,OAChCC,KAAK,EACL5e,aAAa,EACb6e,oBAAoB,EACpBC,UAAU,EACVC,eAAe,EAGfzrC,QACAmqC,YACAj4B,OAAO,EACPw5B,cAAc,EACdlW,SACAmW,UAAU,EACV10C,QAAQ,EACR25B,MAAM,EAGNgb,SAAS,EACT1E,oBAAoB,EACpBrqC,SAAU,OAGVo5B,IAAK,KACLE,gBAAgB,GA0Bb3jB,IACHmY,OAAQ,SAAgBmC,GACvB,MAAOA,IAER+e,OAAQ,SAAgB/e,GACvB,MAAOgf,MAAKC,IAAIjf,EAAK,IAEtBkf,QAAS,SAAiBlf,GACzB,MAAOgf,MAAKC,IAAIjf,EAAM,EAAG,GAAK,GAE/Bmf,UAAW,SAAmBnf,GAC7B,OAAKA,GAAO,IAAO,EACX,GAAMgf,KAAKC,IAAIjf,EAAK,GAErB,IAAOgf,KAAKC,IAAIjf,EAAM,EAAG,GAAK,KAInCK,GAAS,KAITrc,GAAwB,mBAAXo7B,QAAyBA,OAAS,KAC/CvsC,GAAMmR,GAAMq7B,SAAW,KAEvB7iB,KAAa3pB,GAEbi/B,IAD+B,mBAAdwN,YAA6B,QAAQn0C,KAAKm0C,UAAUC,SACrC,mBAAZxN,UAAmD,kBAAjBA,SAAQyN,MAAqD,kBAAvBzN,SAAQyN,KAAKjtC,OAEzG8S,GAAiB,MACrB,KACCxP,OAAOvI,kBAAmB,QAAUC,MAAO,IAC3C8X,IAAiB,EAChB,MAAOnY,IACRmY,IAAiB,EAGlB,GAaIhY,IACAtC,GACA00C,GACAC,GACAC,GACAC,GACAvxC,GACAiN,GACAukC,GArBA16B,GAAMtS,GAAMA,GAAIitC,eAAeC,WAAW,oDAAqD,QAAS,EAExG/iB,IAAW,IAAK,KAAM,MAAO,UAE7BzhB,GAAO,+BACPykC,GAAS,qCACTrlB,GAAQ,6BACRslB,GAAQ,+BACRC,GAAM,uCACNvF,GAAQ,+BAER5gB,IAAexe,KAAMA,GAAMykC,OAAQA,GAAQ76B,IAAKwV,GAAOslB,MAAOA,GAAOC,IAAKA,GAAKvF,MAAOA,GA0E1F,IArDCttC,GATI8X,GASY,SAAuB/K,EAAM+lC,EAAI17B,GAChD,MAAK07B,IAAMA,IAAO5kC,GAIXkJ,EAAS5R,GAAIutC,gBAAgBD,EAAI/lC,EAAMqK,GAAU5R,GAAIutC,gBAAgBD,EAAI/lC,GAHxEqK,EAAS5R,GAAIxF,cAAc+M,EAAMqK,GAAU5R,GAAIxF,cAAc+M,IAVtD,SAAuBA,EAAM+lC,EAAI17B,GAChD,GAAI07B,GAAMA,IAAO5kC,GAChB,KAAM,iQAGP,OAAOkJ,GAAS5R,GAAIxF,cAAc+M,EAAMqK,GAAU5R,GAAIxF,cAAc+M,IAwDjEoiB,GAEE,CAYN,IAXAijB,GAAMpyC,GAAc,OACpBqyC,IAAe,UAAW,mBAE1BG,GAAe,SAAsBhR,GACpC,MAAO,UAAUjkC,EAAME,GACtB,MAAOF,GAAKikC,GAAY/jC,KAI1BuD,GAAIqxC,GAAYpxC,OAETD,OAAQtD,IAGd,GAFA40C,GAAaD,GAAYrxC,IAErBoxC,GAAIE,IACP50C,GAAU80C,GAAaF,QAGvB,KADArkC,GAAI0hB,GAAQ1uB,OACLgN,MAGN,GAFAskC,GAAW5iB,GAAQ3uB,IAAKsxC,GAAW7J,OAAO,EAAG,GAAG3oC,cAAgBwyC,GAAW5iB,UAAU,GAEjF0iB,GAAIG,IAAW,CAClB70C,GAAU80C,GAAaD,GACvB,OAOC70C,KACJA,GAAU,SAAiBH,EAAME,GAChC,GAAIsF,GAAOuH,EAAYtJ,CAiBvB,KAfAsJ,EAAa/M,EAAK+M,WAEbA,IAEJ8nC,GAAIhlC,UAAY,GAEhB9C,EAAa8nC,GACb70C,EAAOA,EAAKy1C,YAEZZ,GAAIzwC,YAAYpE,IAGjBwF,EAAQuH,EAAWyD,iBAAiBtQ,GAEpCuD,EAAI+B,EAAM9B,OACHD,KACN,GAAI+B,EAAM/B,KAAOzD,EAChB,OAAO,CAIT,QAAO,QAzDTG,IAAU,IA0EX,IAAI8+B,IACAv8B,GACA+W,EACJ,KACCxO,OAAOvI,kBAAmB,QACzBuE,IAAK,aACLyQ,IAAK,eAGFzP,IACHgD,OAAOvI,eAAeD,GAAc,OAAQ,QAAUE,MAAO,IAG9DD,GAAiBuI,OAAOvI,eACvB,MAAOoN,IAGRpN,GAAiB,SAAwBurC,EAAKhiB,EAAMypB,GACnDzH,EAAIhiB,GAAQypB,EAAK/yC,OAInB,IACC,IACCsI,OAAOwO,qBAAuBlZ,MAAQoC,MAAO,KAC5C,MAAOmN,IAER,KAAMA,IAGH7H,IACHgD,OAAOwO,iBAAiBhX,GAAc,QAAUlC,MAAQoC,MAAO,KAGhE8W,GAAmBxO,OAAOwO,iBACzB,MAAO3J,IACR2J,GAAmB,SAA0Bw0B,EAAK/X,GACjD,GAAIjK,EAEJ,KAAKA,IAAQiK,GACRA,EAAMI,eAAerK,IACxBvpB,GAAeurC,EAAKhiB,EAAMiK,EAAMjK,KAMpC,IACChhB,OAAOg0B,OAAO,MAEdA,GAASh0B,OAAOg0B,OACf,MAAOnvB,IAERmvB,GAAS,WACR,GAAI0W,GAAI,YAER,OAAO,UAAUpgC,EAAO2gB,GACvB,GAAI+X,EAEJ,OAAc,QAAV14B,MAIJogC,EAAEz2C,UAAYqW,EACd04B,EAAM,GAAI0H,GAENzf,GACHjrB,OAAOwO,iBAAiBw0B,EAAK/X,GAGvB+X,OAuCV,GAgCI2H,IACAC,GACAC,GAlCAvK,GAAStgC,OAAO/L,UAAUo3B,eAE1BhyB,GAAW2G,OAAO/L,UAAUoF,SA6B5ByxC,KAIA7O,KACH,WACC,GAAI8O,IAAgB,uDAAwD,iDAAkD,+CAAgD,+CAAgD,8EAC1NC,EAAiB,4oBAErBH,IAAU,WACT,GAAII,KAAa/O,QAAQC,cACzBD,SAAQ+O,EAAW,iBAAmB,OAAOvuC,MAAMw/B,QAAS6O,GAC5D7O,QAAQyO,IAAIK,GACRC,GACH/O,QAAQQ,SAASqO,GAGlBF,GAAU3lB,GAGX0lB,GAAe,SAAsB5O,EAASvW,GAI7C,GAHAolB,KAGmD,WAA/C7vC,GAAAA,UAAoByqB,EAAKA,EAAKhtB,OAAS,IAAkB,CAC5D,GAAIsC,GAAU0qB,EAAKrZ,MACf7X,EAAUwG,EAAUA,EAAQxG,QAAU,IAE1C,IAAIA,EAAS,CAGZ,GAAIqB,GAAO,MACPrB,GAAQwR,YAAcnQ,EAAOrB,EAAQwR,UAAUnQ,QAClDomC,EAAU,IAAMpmC,EAAO,KAAOomC,EAG/B,IAAIjnC,GAAO,QACPA,EAAOgG,EAAQhG,MAAQR,EAAQY,UAAYZ,EAAQY,SAASiE,UAAY7E,EAAQS,KAAK,OACxFywB,EAAK/vB,KAAKX,IAKbmnC,QAAQyN,KAAKjtC,MAAMw/B,SAAU,mBAAqBF,EAAS,4BAA6B,2BAA2BjW,OAAON,KAG3HklB,GAAM,WACLzO,QAAQyO,IAAIjuC,MAAMw/B,QAASv/B,eAI7BiuC,GAAeD,GAAME,GAAU3lB,CA6DhC,IAkWIgmB,IAlWAhF,GAAe,gBACfd,GAA2B,+DAC3Btf,GAAgB,SAAuBlwB,EAAM2O,GAC/C,MAAO,YAAc3O,EAAO,KAAO2O,EAAO,2FAA6FA,EAAO,KAyC5IwL,IACH6xB,OAAQ,SAAgByG,EAAM3f,GAC7B,GAAI3M,EAEJ,OAAKqS,GAAUia,IAAUja,EAAU1F,IAInC2f,GAAQA,EACR3f,GAAMA,EAEN3M,EAAQ2M,EAAK2f,EAERtsB,EAME,SAAUnd,GAChB,MAAOypC,GAAOzpC,EAAImd,GANX,WACN,MAAOssB,KAVD,MAmBT1O,MAAO,SAAe0O,EAAM3f,GAC3B,GAAIyiB,GAAcp7B,EAAetP,EAAKjI,CAEtC,KAAK4F,EAAQiqC,KAAUjqC,EAAQsqB,GAC9B,MAAO,KAOR,KAJAyiB,KACAp7B,KAEAvX,EAAIiI,EAAM0oC,KAAKiC,IAAI/C,EAAK5vC,OAAQiwB,EAAGjwB,QAC5BD,KACNuX,EAAcvX,GAAKuxB,EAAYse,EAAK7vC,GAAIkwB,EAAGlwB,GAI5C,KAAKA,EAAIiI,EAAKjI,EAAI6vC,EAAK5vC,OAAQD,GAAK,EACnC2yC,EAAa3yC,GAAK6vC,EAAK7vC,EAGxB,KAAKA,EAAIiI,EAAKjI,EAAIkwB,EAAGjwB,OAAQD,GAAK,EACjC2yC,EAAa3yC,GAAKkwB,EAAGlwB,EAGtB,OAAO,UAAUoG,GAGhB,IAFA,GAAIpG,GAAIiI,EAEDjI,KACN2yC,EAAa3yC,GAAKuX,EAAcvX,GAAGoG,EAGpC,OAAOusC,KAITlR,OAAQ,SAAgBoO,EAAM3f,GAC7B,GAAI2iB,GAAY5qC,EAAKsP,EAAeo7B,EAAcnqB,CAElD,KAAKnhB,EAASwoC,KAAUxoC,EAAS6oB,GAChC,MAAO,KAGR2iB,MACAF,KACAp7B,IAEA,KAAKiR,IAAQqnB,GACR/H,GAAOllC,KAAKitC,EAAMrnB,KACjBsf,GAAOllC,KAAKstB,EAAI1H,IACnBqqB,EAAW31C,KAAKsrB,GAChBjR,EAAciR,GAAQ+I,EAAYse,EAAKrnB,GAAO0H,EAAG1H,KAAUsqB,EAAK5iB,EAAG1H,KAEnEmqB,EAAanqB,GAAQqnB,EAAKrnB,GAK7B,KAAKA,IAAQ0H,GACR4X,GAAOllC,KAAKstB,EAAI1H,KAAUsf,GAAOllC,KAAKitC,EAAMrnB,KAC/CmqB,EAAanqB,GAAQ0H,EAAG1H,GAM1B,OAFAvgB,GAAM4qC,EAAW5yC,OAEV,SAAUmG,GAIhB,IAHA,GACIoiB,GADAxoB,EAAIiI,EAGDjI,KACNwoB,EAAOqqB,EAAW7yC,GAElB2yC,EAAanqB,GAAQjR,EAAciR,GAAMpiB,EAG1C,OAAOusC,MAKNI,GAAa,oCACbC,GAAe,qBACfC,GAAmB,SACnBC,GAAqB,sBAuCrBC,GAAe,oCAqCfC,IACHpI,WACCqI,WAAY,aACZC,YAAa,eAEdn1C,QACCk1C,WAAY,OACZ7P,QAAS,6WAEV9hC,UACC2xC,WAAY,WACZC,YAAa,eAIX5hC,GAAO,WACV,QAASA,GAAKiH,GACbnW,GAAaC,eAAerH,KAAMsW,GAElCtW,KAAKud,MAAQA,EACbvd,KAAKqlC,OAAS,KAAO9nB,EACrBvd,KAAKm4C,UAAYH,GAAaz6B,GA0B/B,MAvBAjH,GAAKjW,UAAUmH,KAAO,SAAc69B,EAAQ1kC,EAASy3C,GACpD,MAAIz3C,GAAQ0kC,IACX+S,EAAMz3C,EAAQ0kC,GAAQ+S,GAAOz3C,EAAQ0kC,MAC9B,GAFR,QAMD/uB,EAAKjW,UAAUkX,KAAO,SAAc5W,EAASy3C,GAC5Cp4C,KAAKwH,KAAKxH,KAAKqlC,OAAQ1kC,EAASy3C,IAG3Bz3C,EAAQX,KAAKqlC,SAAWrlC,KAAKm4C,WAAan4C,KAAKwH,KAAKxH,KAAKm4C,UAAUF,WAAYt3C,EAASy3C,KACxFp4C,KAAKm4C,UAAU/P,QAClB51B,EAAYxS,KAAKm4C,UAAU/P,SAE3B51B,EAAY,4KAA6KxS,KAAKm4C,UAAUF,WAAYj4C,KAAKm4C,UAAUD,cAKrOE,EAAMz3C,EAAQ4W,KAAKvX,KAAKud,MAAO66B,GAAOz3C,EAAQ4W,KAAKvX,KAAKud,QAGlDjH,KAiFJ+hC,MACAC,MACAC,KACmB,mBAAZh9B,SAEV+7B,GAAY/7B,SAEZ+7B,GAAY,SAAkB1jC,GAC7B,GAGImnB,GACAyd,EACAC,EACAvhB,EACAwhB,EACA1gB,EARA2gB,KACAC,KACAC,EAAQR,EAQZI,GAAe,SAAsBK,GACpC,MAAO,UAAUh1C,GACZ+0C,IAAUR,KAIdtd,EAASj3B,EACT+0C,EAAQC,EAERN,EAAmBO,EAAeF,IAAUP,GAAYK,EAAoBC,EAAkB7d,GAG9Fie,EAAKR,MAIPthB,EAASuhB,EAAaH,IACtBI,EAASD,EAAaF,GAEtB,KACC3kC,EAASsjB,EAAQwhB,GAChB,MAAOznC,GACRynC,EAAOznC,GA+CR,MA5CA+mB,IAECC,KAAM,SAAcghB,EAAaC,GAChC,GAAIC,GAAW,GAAI7B,IAAU,SAAUpgB,EAAQwhB,GAE9C,GAAIU,GAA2B,SAAkC7mB,EAASpV,EAAUk8B,GAG5D,kBAAZ9mB,GACVpV,EAASrb,KAAK,SAAUw3C,GACvB,GAAIl1C,EAEJ,KACCA,EAAImuB,EAAQ+mB,GACZ/wC,EAAQ4wC,EAAU/0C,EAAG8yB,EAAQwhB,GAC5B,MAAOznC,GACRynC,EAAOznC,MAMTkM,EAASrb,KAAKu3C,GAKhBD,GAAyBH,EAAaN,EAAmBzhB,GACzDkiB,EAAyBF,EAAYN,EAAkBF,GAEnDG,IAAUR,IAEbW,EAAKR,IAIP,OAAOW,KAITnhB,EAAQ,SAAW,SAAUkhB,GAC5B,MAAOl5C,MAAKi4B,KAAK,KAAMihB,IAGjBlhB,GAGRsf,GAAUjH,IAAM,SAAUkJ,GACzB,MAAO,IAAIjC,IAAU,SAAUpgB,EAAQwhB,GACtC,GACI7a,GACAj5B,EACA40C,EAHAze,IAKJ,KAAKwe,EAAS10C,OAEb,WADAqyB,GAAO6D,EAiBR,KAbAye,EAAiB,SAAwBxhB,EAASpzB,GAC7CozB,GAAmC,kBAAjBA,GAAQC,KAC7BD,EAAQC,KAAK,SAAUn0B,GACtBi3B,EAAOn2B,GAAKd,IACV+5B,GAAW3G,EAAO6D,IAClB2d,IAEH3d,EAAOn2B,GAAKozB,IACV6F,GAAW3G,EAAO6D,KAItB8C,EAAUj5B,EAAI20C,EAAS10C,OAChBD,KACN40C,EAAeD,EAAS30C,GAAIA,MAK/B0yC,GAAU/uC,QAAU,SAAUzE,GAC7B,MAAO,IAAIwzC,IAAU,SAAUpgB,GAC9BA,EAAOpzB,MAITwzC,GAAUoB,OAAS,SAAUe,GAC5B,MAAO,IAAInC,IAAU,SAAUpgB,EAAQwhB,GACtCA,EAAOe,MAKV,IAAIj+B,IAAY87B,GA8EZoC,GAAoB,WACvB,QAASA,GAAkB9lC,EAAU3J,GACpC7C,GAAaC,eAAerH,KAAM05C,GAElC15C,KAAK4T,SAAWA,EAChB5T,KAAKiK,OAASA,EAEdjK,KAAK25C,UACL35C,KAAK45C,UAEL55C,KAAKuE,YACLvE,KAAK65C,cAAgB75C,KAAK85C,cAAgB,EAE1C95C,KAAK+5C,eACL/5C,KAAKg6C,gBAAiB,EAElB/vC,GACHA,EAAOgwC,SAASj6C,MA6ClB,MAzCA05C,GAAkBr5C,UAAUsB,IAAM,SAAa0E,GAC9C,GAAI6zC,GAAO7zC,EAAW+uB,QAAUp1B,KAAK25C,OAAS35C,KAAK45C,MACnDM,GAAKp4C,KAAKuE,IAGXqzC,EAAkBr5C,UAAU45C,SAAW,SAAkBtW,GACxD3jC,KAAKuE,SAASzC,KAAK6hC,GAEnB3jC,KAAK65C,eAAiB,EACtB75C,KAAK85C,eAAiB,GAGvBJ,EAAkBr5C,UAAU85C,gBAAkB,WAC7Cn6C,KAAK85C,eAAiB,EACtBM,EAAMp6C,OAGP05C,EAAkBr5C,UAAUg6C,eAAiB,WAC5Cr6C,KAAK65C,eAAiB,EACtBO,EAAMp6C,OAGP05C,EAAkBr5C,UAAUi6C,YAAc,WACzCt6C,KAAK+5C,YAAYr3C,QAAQ3B,GACzBf,KAAKuE,SAAS7B,QAAQ63C,IAGvBb,EAAkBr5C,UAAU6d,OAAS,SAAgB7X,GACpD,GAAI6zC,GAAO7zC,EAAW+uB,QAAUp1B,KAAK25C,OAAS35C,KAAK45C,MACnDnvC,GAAgByvC,EAAM7zC,GACtB+zC,EAAMp6C,OAGP05C,EAAkBr5C,UAAUq3B,MAAQ,WACnC13B,KAAK25C,OAAOxnB,OAAOnyB,KAAK45C,QAAQl3C,QAAQ,SAAUsI,GACjD,MAAOA,GAAE0sB,UAEV13B,KAAKw6C,OAAQ,EACbJ,EAAMp6C,OAGA05C,KAyCJe,GAAa,GAAInkC,IAAK,UAEtBokC,GAAQ,OAER11C,IACH0yB,MAAO,SAAenb,EAAUo+B,GAC/B,GAAI3iB,GAAS4iB,CAkBb,OAhBID,KACH3iB,EAAU,GAAIxc,IAAU,SAAU1R,GACjC,MAAO8wC,GAAgB9wC,KAIzB4wC,IACCG,cAAeH,GACfI,kBAAmB,GAAIpB,IAAkBkB,EAAeF,IAASA,GAAMI,mBACvEC,aACAC,SACAC,sBACAC,qBACA3+B,SAAUA,GAGJyb,GAERlb,IAAK,WACJq+B,IACAT,GAAQA,GAAMG,eAEf9lC,YAAa,SAAqBxT,GACjC65C,EAAWV,GAAMK,UAAWx5C,IAE7Bq7B,YAAa,SAAqBye,EAAU7e,GAC3C4e,EAAW5e,EAAQke,GAAMQ,kBAAoBR,GAAMO,mBAAoBI,IAExEvK,mBAAoB,SAA4BzqC,GAC/CA,EAAW0xB,SAAW2iB,GAAMI,kBAC5BJ,GAAMI,kBAAkBn5C,IAAI0E,IAK7BE,gBAAiB,SAAyB+0C,GACzCZ,GAAMI,kBAAkBf,YAAYj4C,KAAKw5C,IAE1Cr2C,aAAc,SAAsBs2C,EAAMC,GACzC,GAAIC,EAEJ,IAAKf,GAEE,CAEN,IADAe,EAASf,GACFc,GAAcC,EAAOZ,eAI3BY,EAASA,EAAOZ,aAGjBY,GAAOT,MAAMl5C,KAAKy5C,OAVlBA,OA8DCG,GAAclgC,GAAUjT,SAC5B1E,IAAe63C,GAAa,QAAU53C,MAAOwtB,GAE7C,IA0nBIqqB,IA1nBAvnB,GAASnY,GAAOmY,OAsDhBwnB,GAAa,GAAItlC,IAAK,UA2GtBulC,GAAQ,WACX,QAASA,GAAMl7C,EAASU,EAAUO,EAAMk6C,GACvC10C,GAAaC,eAAerH,KAAM67C,GAElC77C,KAAKW,QAAUA,EACfX,KAAKqB,SAAWA,EAChBrB,KAAK4B,KAAOA,EACZ5B,KAAK87C,iBAAmBA,EAExB97C,KAAK+6B,UAEL/6B,KAAK8G,OAAQ,EAoDd,MAjDA+0C,GAAMx7C,UAAUsB,IAAM,SAAasT,GAClCjV,KAAK+6B,OAAOj5B,KAAKmT,GACjBjV,KAAK+c,aAGN8+B,EAAMx7C,UAAUsd,OAAS,WACxB,GAAI9b,GAAc7B,KAAK+7C,MAAM/7C,KAAK87C,iBAAmB,uBAAyB,eAC1Ez6C,EAAWrB,KAAKqB,SAEhB2G,EAAQnG,EAAYuI,QAAQ/I,EAElB,MAAV2G,IACHnG,EAAYwI,OAAOrC,EAAO,GAC1BnG,EAAYR,GAAY,OAI1Bw6C,EAAMx7C,UAAUq8B,KAAO,WACtB18B,KAAK8G,OAAQ,GAGd+0C,EAAMx7C,UAAU0c,UAAY,WAC3B,GAAIzV,GAAQtH,IAEPA,MAAK8G,QACT9G,KAAK8G,OAAQ,EAIb9B,GAAQC,aAAa,WACpB,MAAOqC,GAAMT,aAKhBg1C,EAAMx7C,UAAU6d,OAAS,SAAgB89B,GACxC,GAAIh0C,GAAQhI,KAAK+6B,OAAO3wB,QAAQpK,KAAK87C,iBAAmBE,EAAgBz/B,SAAWy/B,EACrE,MAAVh0C,GAAchI,KAAK+6B,OAAO1wB,OAAOrC,EAAO,IAG7C6zC,EAAMx7C,UAAUwG,OAAS,WACxB7G,KAAK+6B,OAAO3kB,KAAKpW,KAAK87C,iBAAmBG,EAAqBC,GAC9Dl8C,KAAK8G,OAAQ,GAGd+0C,EAAMx7C,UAAUqB,KAAO,SAAcuT,GACpC,MAAOjV,MAAK87C,kBAAoB97C,KAAKqB,UAAY4T,EAAKjT,OAAShC,KAAKqB,SAAW4T,EAAO3T,GAAQ2T,EAAMjV,KAAKqB,UAAY,MAG/Gw6C,KAwGJM,MAmFAC,MAoKA1T,MACA2T,GAAe,MA6Dd9hC,MAIJ,SAAWgZ,EAAS+oB,EAAU/hC,GAE7B,GAAInW,GAAG4wB,CAEP,KAAIza,EAAIohC,sBAAR,CAIA,IAAKv3C,EAAI,EAAGA,EAAImvB,EAAQ1uB,SAAW0V,EAAIohC,wBAAyBv3C,EAC/DmW,EAAIohC,sBAAwBphC,EAAIgZ,EAAQnvB,GAAK,wBAGzCmW,GAAIohC,wBACR3mB,EAAaza,EAAIya,WAEjBza,EAAIohC,sBAAwB,SAAU/nC,GACrC,GAAI2oC,GAAUC,EAAY91C,CAS1B,OAPA61C,GAAWtiC,KAAKC,MAChBsiC,EAAajH,KAAK9X,IAAI,EAAG,IAAM8e,EAAWD,IAC1C51C,EAAKsuB,EAAW,WACfphB,EAAS2oC,EAAWC,IAClBA,GAEHF,EAAWC,EAAWC,EACf91C,MAGP6sB,GAAS,EAAGhZ,IAEfohC,GAAwBphC,GAAIohC,uBAjC5BA,GAAwB,IAoCzB,IAAIc,IAAMd,GAENe,GAAUniC,IAAOA,GAAIoiC,aAA8C,kBAAxBpiC,IAAIoiC,YAAYziC,IAAqB,WACnF,MAAOK,IAAIoiC,YAAYziC,OACpB,WACH,MAAOD,MAAKC,OAKT0iC,MACAC,IAAU,EA4BVxmB,GAAS,WACZ,QAASA,GAAOlvB,GACfC,GAAaC,eAAerH,KAAMq2B,GAElCr2B,KAAKy1B,SAAWtuB,EAAQsuB,SACxBz1B,KAAKs2B,KAAOnvB,EAAQmvB,KACpBt2B,KAAKsG,SAAWa,EAAQb,SACxBtG,KAAKic,OAAS9U,EAAQ8U,OAEtBjc,KAAK03B,MAAQglB,KACb18C,KAAK8c,IAAM9c,KAAK03B,MAAQ13B,KAAKy1B,SAE7Bz1B,KAAK68C,SAAU,EAEfD,GAAQ96C,KAAK9B,MACR68C,IAASJ,GAAIK,IA0BnB,MAvBAzmB,GAAOh2B,UAAUy8C,KAAO,SAAc5iC,GACrC,IAAKla,KAAK68C,QAAS,OAAO,CAE1B,IAAI3iC,EAAMla,KAAK8c,IAId,MAHI9c,MAAKs2B,MAAMt2B,KAAKs2B,KAAK,GACrBt2B,KAAKsG,UAAUtG,KAAKsG,SAAS,IAE1B,CAGR,IAAIy2C,GAAU7iC,EAAMla,KAAK03B,MACrBslB,EAAQh9C,KAAKic,OAAO8gC,EAAU/8C,KAAKy1B,SAIvC,OAFIz1B,MAAKs2B,MAAMt2B,KAAKs2B,KAAK0mB,IAElB,GAGR3mB,EAAOh2B,UAAU48C,KAAO,WACnBj9C,KAAKk9C,OAAOl9C,KAAKk9C,QACrBl9C,KAAK68C,SAAU,GAGTxmB,KAGJ8mB,MA+CAC,GAAW,WACd,QAASA,GAAS9wC,GACjBlF,GAAaC,eAAerH,KAAMo9C,GAElCp9C,KAAK8D,MAAQwI,EACbtM,KAAKq4B,YAAa,EAClBr4B,KAAKwnC,cAwBN,MArBA4V,GAAS/8C,UAAU+H,IAAM,WACxB,MAAOiT,GAAYrb,KAAK8D,QAGzBs5C,EAAS/8C,UAAUwwB,WAAa,WAC/B,MAAOxV,GAAYrb,KAAK8D,QAGzBs5C,EAAS/8C,UAAUoC,OAAS,SAAgB6J,GAC3CtM,KAAK8D,MAAQwI,EACbtM,KAAKwnC,WAAW9kC,QAAQ8gC,KAGzB4Z,EAAS/8C,UAAUgI,SAAW,SAAkBg1C,GAC/Cr9C,KAAKwnC,WAAW1lC,KAAKu7C,IAGtBD,EAAS/8C,UAAUsI,WAAa,SAAoB00C,GACnD5yC,EAAgBzK,KAAKwnC,WAAY6V,IAG3BD,KAGJE,GAAe,WAClB,QAASA,GAAarzC,EAAQtJ,GAC7ByG,GAAaC,eAAerH,KAAMs9C,GAElCt9C,KAAKiK,OAASA,EACdjK,KAAKW,QAAUA,EACfX,KAAK8D,MAAQnD,EAAUsJ,EAAO4mB,WAAWlwB,GAAWsJ,EAAO4mB,aAC3D7wB,KAAKwnC,cACLxnC,KAAKuE,YA0CN,MAvCA+4C,GAAaj9C,UAAU45C,SAAW,SAAkBn5C,GACnDd,KAAKuE,SAASzC,KAAKhB,GACnBA,EAAMqK,MAAQnL,MAGfs9C,EAAaj9C,UAAU+H,IAAM,WAC5B,MAAOpI,MAAK8D,OAGbw5C,EAAaj9C,UAAUwwB,WAAa,WACnC,MAAO7wB,MAAK8D,OAGbw5C,EAAaj9C,UAAUoI,aAAe,WACrCzI,KAAK8D,MAAQ9D,KAAKW,QAAUX,KAAKiK,OAAO4mB,WAAW7wB,KAAKW,SAAWX,KAAKiK,OAAO4mB,aAC3E7wB,KAAKW,SAAWX,KAAKmL,QACxBnL,KAAKW,QAAQ0b,UAAUkhC,cAAcv9C,KAAKmL,MAAMrH,OAAS9D,MAE1DA,KAAKuE,SAAS7B,QAAQ8gC,IACtBxjC,KAAKwnC,WAAW9kC,QAAQ8gC,KAGzB8Z,EAAaj9C,UAAUgI,SAAW,SAAkBg1C,GACnDr9C,KAAKwnC,WAAW1lC,KAAKu7C,IAGtBC,EAAaj9C,UAAUm9C,YAAc,SAAqB18C,GACzD2J,EAAgBzK,KAAKuE,SAAUzD,IAGhCw8C,EAAaj9C,UAAU4Y,SAAW,WAC7BjZ,KAAKmL,OAAOnL,KAAKmL,MAAMqyC,YAAYx9C,MACvCA,KAAKuE,SAAS7B,QAAQuW,KAGvBqkC,EAAaj9C,UAAUsI,WAAa,SAAoB00C,GACvD5yC,EAAgBzK,KAAKwnC,WAAY6V,IAG3BC,KAGJG,GAAUrxC,OAAO/L,UAAUo3B,eAU3BimB,GAAmB,KAEnB9Z,GAAQ,WACX,QAASA,GAAM35B,EAAQqC,GACtBlF,GAAaC,eAAerH,KAAM4jC,GAElC5jC,KAAKujC,QAELvjC,KAAKuE,YACLvE,KAAK0jC,cAEL1jC,KAAK29C,eAEL39C,KAAKuU,cACLvU,KAAK49C,mBAEL59C,KAAKq5B,YAELr5B,KAAK8D,MAAQtB,OAEbxC,KAAK69C,OAAS,KAEV5zC,IACHjK,KAAKiK,OAASA,EACdjK,KAAK44B,KAAO3uB,EAAO2uB,KACnB54B,KAAKsM,IAAM+O,EAAY/O,GACvBtM,KAAKq4B,WAAapuB,EAAOouB,WAErBpuB,EAAOnG,QACV9D,KAAK8D,MAAQmG,EAAOnG,MAAM9D,KAAKsM,KAC/BtM,KAAKi/B,UAucR,MAlcA2E,GAAMvjC,UAAU4+B,MAAQ,WACvB,GAAInjB,GAAW9b,KAAK44B,KAAK9c,SACrBjP,EAAMiP,EAASjX,MAGnB,IAAY,IAARgI,EAAJ,CAEA,GAAI/I,GAAQ9D,KAAK8D,MAGbnD,EAAUX,KAAK44B,KAAKj4B,QACpB23B,EAAUt4B,KAAK6wB,YAGf7wB,MAAKkqC,UACRlqC,KAAKkqC,QAAQjxB,WACbjZ,KAAKkqC,QAAU,KAGhB,IAAItlC,GAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIk5C,GAAUhiC,EAASlX,EACvB,IAAIk5C,EAAQxjC,OAAOxW,EAAOw0B,EAAS33B,GAAU,CAC5CX,KAAKkqC,QAAU4T,EAAQxX,KAAK3lC,EAASmD,EAAOw0B,EAASylB,GAAYzlB,IACjEt4B,KAAKkqC,QAAQpmC,MAAQ9D,KAAK8D,MAC1B9D,KAAKkqC,QAAQ1D,QAAUxmC,KAEvBA,KAAK8D,MAAQ9D,KAAKkqC,QAAQ9hC,KAE1B,WAKHw7B,EAAMvjC,UAAU2T,cAAgB,SAAuB1H,EAAKhE,GACtDtI,KAAK49C,gBAAgBtxC,KACzBtM,KAAKuU,WAAWzS,KAAKwK,GACrBtM,KAAK49C,gBAAgBtxC,OAGtBtM,KAAK49C,gBAAgBtxC,GAAKxK,KAAKwG,IAGhCs7B,EAAMvjC,UAAUuW,QAAU,SAAiB69B,EAAM3f,EAAI3tB,EAASkpB,GAC7D,GAAI/oB,GAAQtH,IAERA,MAAK69C,QAAQ79C,KAAK69C,OAAOZ,MAE7B,IAAIrC,GAAgB,OAChB5iB,EAAU,GAAIxc,IAAU,SAAU0b,GACrC,MAAO0jB,GAAgB1jB,GAqBxB,OAlBAl3B,MAAK69C,OAAS,GAAIxnB,KACjBZ,SAAUtuB,EAAQsuB,SAClBxZ,OAAQ9U,EAAQ8U,OAChBqa,KAAM,SAActrB,GACnB,GAAIlH,GAAQusB,EAAarlB,EACzB1D,GAAMq9B,WAAW7gC,GACbqD,EAAQmvB,MAAMnvB,EAAQmvB,KAAKtrB,EAAGlH,IAEnCwC,SAAU,WACTgB,EAAMq9B,WAAW7P,GACb3tB,EAAQb,UAAUa,EAAQb,SAASwuB,GAEvCxtB,EAAMu2C,OAAS,KACfjD,OAIF5iB,EAAQilB,KAAOj9C,KAAK69C,OAAOZ,KACpBjlB,GAGR4L,EAAMvjC,UAAUskC,WAAa,SAAoB7gC,GAChD,IAAIw5B,EAAQx5B,EAAO9D,KAAK8D,OAAxB,CAKA,GAFA9D,KAAK44B,KAAKwQ,QAAQppC,KAAK6wB,cAAgB/sB,EAEnC9D,KAAKiK,OAAOigC,SAAWlqC,KAAKiK,OAAOigC,QAAQrxB,IAC9C7Y,KAAKiK,OAAOigC,QAAQrxB,IAAI7Y,KAAKsM,IAAKxI,GAClC9D,KAAKiK,OAAOnG,MAAQ9D,KAAKiK,OAAOigC,QAAQ9hC,MAExCpI,KAAK8D,MAAQ9D,KAAKiK,OAAOnG,MAAM9D,KAAKsM,SAE9B,IAAItM,KAAKkqC,QAAS,CACvB,GAAIC,IAAkBnqC,KAAKkqC,QAAQn8B,OAAS/N,KAAKkqC,QAAQn8B,MAAMjK,MAAW,CAE1E,IAAIqmC,EAAgB,CACnBnqC,KAAKkqC,QAAQjxB,WACbjZ,KAAKkqC,QAAU,IACf,IAAI5G,GAActjC,KAAKiK,OAAOnG,OAAS9D,KAAKiK,OAAO+zC,aAAah+C,KAAKsM,IACrEg3B,GAAYtjC,KAAKsM,KAAOtM,KAAK8D,MAAQA,EACrC9D,KAAKi/B,YAELj/B,MAAK8D,MAAQ9D,KAAKkqC,QAAQ9hC,UAErB,CACN,GAAI61C,GAAej+C,KAAKiK,OAAOnG,OAAS9D,KAAKiK,OAAO+zC,aAAah+C,KAAKsM,IACtE2xC,GAAaj+C,KAAKsM,KAAOxI,EAEzB9D,KAAK8D,MAAQA,EACb9D,KAAKi/B,QAGPj/B,KAAKiK,OAAOw5B,mBACZzjC,KAAKyjC,kBAGL,IAAIya,GAA2BR,EAC/BA,IAAmB19C,KAEnBA,KAAKuE,SAAS7B,QAAQ6hC,IACtBvkC,KAAKujC,KAAK7gC,QAAQ8gC,GAGlB,KADA,GAAIv5B,GAASjK,KAAKiK,OACXA,GACNA,EAAOs5B,KAAK7gC,QAAQ8gC,IACpBv5B,EAASA,EAAOA,MAGjByzC,IAAmBQ,IAGpBta,EAAMvjC,UAAUojC,iBAAmB,SAA0B0a,GAG5D,IAFA,GAAIv5C,GAAI5E,KAAKuU,WAAW1P,OAEjBD,KAAK,CACX,GAAI0H,GAAMtM,KAAKuU,WAAW3P,EAE1B,KAAIu5C,GAAe7xC,IAAQ6xC,EAA3B,CAMA,IAJA,GAAI3pC,GAAYxU,KAAK49C,gBAAgBtxC,GACjC8xC,EAASp+C,KAAK8pC,IAAIx9B,GAElBuF,EAAI2C,EAAU3P,OACXgN,KACFusC,GAAQ5pC,EAAU3C,GAAGqC,oBACrBM,EAAU3C,GAAGkC,UAAUS,EAAUnK,OAAOwH,EAAG,EAG3C2C,GAAU3P,SACd7E,KAAKuU,WAAWlK,OAAOzF,EAAG,GAC1B5E,KAAK49C,gBAAgBtxC,GAAO,SAK/Bs3B,EAAMvjC,UAAU29C,aAAe,SAAsB1xC,GACpD,GAAI+xC,GAAS7jB,EAAUluB,QAGvB,OAFAtM,MAAK6Y,IAAIwlC,GAEFA,GAGRza,EAAMvjC,UAAU+8B,YAAc,SAAqB/wB,GAClD,GAAIQ,GAAMR,EAAKxH,OAEXy5C,GAAmBt+C,MACnBsB,EAAU,OACVsD,EAAI,OAEJ25C,EAAQ,WACX,GAAIjyC,GAAMD,EAAKzH,EAEH,OAAR0H,GACHhL,KACAg9C,EAAgB57C,QAAQ,SAAU5B,GACjCQ,EAAQQ,KAAKgH,MAAMxH,EAASR,EAAM+oC,iBAAiB/oC,EAAMsH,WAG1D9G,EAAUg9C,EAAgBn6C,IAAI,SAAUrD,GACvC,MAAOA,GAAM0L,QAAQF,KAIvBgyC,EAAkBh9C,EAGnB,KAAKsD,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EACzB25C,GAGD,OAAOj9C,IAGRsiC,EAAMvjC,UAAU+H,IAAM,SAAag7B,GAElC,MADIA,IAAeC,GAAQrjC,MACpBA,KAAK8D,OAGb8/B,EAAMvjC,UAAUm+C,cAAgB,SAAuBC,GACtD,GAAId,GAAc39C,KAAKiK,OAAO0zC,WAG9B,OAAwB,gBAAb39C,MAAKsM,KAAsC9J,SAAlBi8C,EAC5B,GAAIrB,IAASqB,IACTd,EAAY39C,KAAKsM,OAC5BqxC,EAAY39C,KAAKsM,KAAO,GAAI8wC,IAASp9C,KAAKsM,MAGpCqxC,EAAY39C,KAAKsM,OAGzBs3B,EAAMvjC,UAAUq+C,YAAc,WAE7B,MAAO,IAAItB,IAASniC,EAAUjb,KAAKsM,OAGpCs3B,EAAMvjC,UAAUs7B,gBAAkB,SAAyBh7B,GAC1D,GAAI23B,GAAUt4B,KAAK6wB,aACf/vB,EAAQd,KAAKglC,eAAiBhlC,KAAKglC,aAAe,GAAIsY,IAAat9C,MAEvE,IAAIW,GAAWA,EAAQwR,UAAW,CACjC,GAAIwsC,GAAS3+C,KAAK6wB,WAAWlwB,EAC7B,IAAIg+C,IAAWrmB,EAAS,CACvB,GAAIn0B,GAAMxD,EAAQ0b,UAAUkhC,gBAAkB58C,EAAQ0b,UAAUkhC,kBAC5D5Z,EAAQx/B,EAAIm0B,KAAan0B,EAAIm0B,GAAW,GAAIglB,IAAat9C,KAAMW,GAEnE,OADAG,GAAMm5C,SAAStW,GACRA,GAIT,MAAO7iC,IAGR8iC,EAAMvjC,UAAUwwB,WAAa,SAAoBlwB,GAChD,GAAIi4B,GAAO54B,KAAKiK,OAAOgF,OAASgM,EAAUjb,KAAKsM,KAAOtM,KAAKiK,OAAO4mB,aAAe,IAAM5V,EAAUjb,KAAKsM,IAEtG,IAAI3L,GAAWA,EAAQwR,UAAW,CACjC,GAAIhO,GAAMxD,EAAQ0b,UAAUW,QAC5B,KAAK,GAAIe,KAAK5Z,GACb,GAAIy0B,EAAKxuB,QAAQjG,EAAI4Z,GAAG8S,eAAiB,EAAG,CAC3C+H,EAAOA,EAAK9H,QAAQ3sB,EAAI4Z,GAAG8S,aAAc9S,EACzC,QAKH,MAAO6a,IAGRgL,EAAMvjC,UAAUwpC,iBAAmB,SAA0B/lC,GAC5D,GAAIZ,GAASlD,KAETuE,EAAW,MACf,IAAIiG,EAAQ1G,GACXS,KAGIm5C,IAAoBA,GAAiBzzC,SAAWjK,MAAiC,WAAzB09C,GAAiBpxC,KAC5E/H,EAASzC,KAAK47C,IAEf55C,EAAMpB,QAAQ,SAAUq5B,EAAGn3B,GAC1BL,EAASzC,KAAKoB,EAAOsJ,QAAQ5H,UAExB,IAAIqH,EAASnI,IAA2B,kBAAVA,GACpCS,EAAW6H,OAAOC,KAAKvI,GAAOK,IAAI,SAAUmI,GAC3C,MAAOpJ,GAAOsJ,QAAQF,SAEjB,IAAa,MAATxI,EAEV,KAAM,IAAIsR,OAAM,wBAA0BpV,KAAK6wB,aAAe,SAAW7wB,KAAK6wB,aAAe,uCAG9F,OAAOtsB,IAGRq/B,EAAMvjC,UAAUypC,IAAM,SAAax9B,GAClC,GAAIxI,GAAQ9D,KAAKoI,KACjB,KAAKtE,EAAO,OAAO,CAGnB,IADAwI,EAAM+O,EAAY/O,GACdmxC,GAAQj2C,KAAK1D,EAAOwI,GAAM,OAAO,CAIrC,KADA,GAAIqO,GAAc7W,EAAM6W,YACjBA,IAAgBovB,UAAYpvB,IAAgBN,OAASM,IAAgBvO,QAAQ,CACnF,GAAIqxC,GAAQj2C,KAAKmT,EAAYta,UAAWiM,GAAM,OAAO,CACrDqO,GAAcA,EAAYA,YAG3B,OAAO,GAGRipB,EAAMvjC,UAAUmM,QAAU,SAAiBF,GAC1C,GAAY9J,SAAR8J,GAA6B,KAARA,EAAY,MAAOtM,KAE5C,KAAKA,KAAK0jC,WAAWjM,eAAenrB,GAAM,CACzC,GAAIq3B,GAAQ,GAAIC,GAAM5jC,KAAMsM,EAC5BtM,MAAKuE,SAASzC,KAAK6hC,GACnB3jC,KAAK0jC,WAAWp3B,GAAOq3B,EAGxB,MAAO3jC,MAAK0jC,WAAWp3B,IAGxBs3B,EAAMvjC,UAAUiU,QAAU,SAAiBjI,GAE1C,IAAK,GADDvL,GAAQd,KACH4E,EAAI,EAAGA,EAAIyH,EAAKxH,OAAQD,GAAK,EACrC9D,EAAQA,EAAM0L,QAAQH,EAAKzH,GAG5B,OAAO9D,IAGR8iC,EAAMvjC,UAAUkkC,KAAO,WACtB,GAAIzgC,GAAQ9D,KAAKwkC,UAEjB,KAAKlH,EAAQx5B,EAAO9D,KAAK8D,OAAQ,CAChC,GAAI86C,GAAM5+C,KAAK8D,KACf9D,MAAK8D,MAAQA,EAGT86C,IAAQ96C,GAAO9D,KAAKi/B,QAExBj/B,KAAKuE,SAAS7B,QAAQ6hC,IAEtBvkC,KAAKujC,KAAK7gC,QAAQ8gC,IAClBxjC,KAAKyjC,qBAIPG,EAAMvjC,UAAUwX,MAAQ,SAAekuB,EAAO8Y,GAC7C,GAAIC,GAAWD,EAAa7+C,KAAK8D,MAAMK,IAAI06C,GAAc7+C,KAAK8D,MAC1Di7C,EAAWF,EAAa9Y,EAAM5hC,IAAI06C,GAAc9Y,EAEhDiZ,EAAYF,EAASj6C,OAErBo6C,KACAC,EAAmB,EAEnBjyC,EAAa6xC,EAAS36C,IAAI,SAAU8Q,GACvC,GAAIjN,GAAQ,OACR0vB,EAAQwnB,CAEZ,GAAG,CAGF,GAFAl3C,EAAQ+2C,EAAS30C,QAAQ6K,EAAMyiB,GAEjB,KAAV1vB,EACH,MAAO,EAGR0vB,GAAQ1vB,EAAQ,QACRi3C,EAAYj3C,MAAW,GAAgBg3C,EAARtnB,EASxC,OALI1vB,KAAUk3C,IACbA,GAAoB,GAGrBD,EAAYj3C,IAAS,EACdA,GAGRhI,MAAKiK,OAAOnG,MAAM9D,KAAKsM,KAAOy5B,EAC9B/lC,KAAKm/C,SAAU,EACfn/C,KAAKgN,QAAQC,IAGd22B,EAAMvjC,UAAUgI,SAAW,SAAkBo8B,GAC5CzkC,KAAKujC,KAAKzhC,KAAK2iC,IAGhBb,EAAMvjC,UAAUs4B,sBAAwB,SAA+B14B,GACtED,KAAKq5B,SAASv3B,KAAK7B,IAGpB2jC,EAAMvjC,UAAUmkC,SAAW,WAC1B,MAAOxkC,MAAKiK,OAAOnG,MAAQ9D,KAAKiK,OAAOnG,MAAM9D,KAAKsM,KAAO9J,QAG1DohC,EAAMvjC,UAAUwY,IAAM,SAAa/U,GAC9B9D,KAAK69C,QAAQ79C,KAAK69C,OAAOZ,OAC7Bj9C,KAAK2kC,WAAW7gC,IAGjB8/B,EAAMvjC,UAAU2M,QAAU,SAAiBC,GAC1C,GAAIC,GAASlN,KAET29C,IAEJ1wC,GAAWvK,QAAQ,SAAU0K,EAAUC,GACtC,IAAOD,EAAP,CAEA,GAAItM,GAAQoM,EAAOywC,YAAYtwC,EAE1BvM,KAEL68C,EAAYvwC,GAAYtM,EAEpBsM,IAAaC,GAChBvM,EAAM2B,OAAO2K,OAIfpN,KAAK29C,YAAcA,EAGnB39C,KAAKujC,KAAK7gC,QAAQ,SAAU+hC,GACvBA,EAAIz3B,SAASy3B,EAAIz3B,QAAQC,KAG9BjN,KAAKo/C,0BACLp/C,KAAKukC,OAGLvkC,KAAKujC,KAAK7gC,QAAQ,SAAU+hC,GACtBA,EAAIz3B,SAASy3B,EAAIh8B,kBAIxBm7B,EAAMvjC,UAAU4Y,SAAW,WAG1B,GAFAjZ,KAAKuE,SAAS7B,QAAQuW,IAClBjZ,KAAKkqC,SAASlqC,KAAKkqC,QAAQjxB,WAC3BjZ,KAAKu9C,cACR,IAAK,GAAIx/B,KAAK/d,MAAKu9C,cAClBv9C,KAAKu9C,cAAcx/B,GAAG9E,YAKzB2qB,EAAMvjC,UAAUsI,WAAa,SAAoB00C,GAChD5yC,EAAgBzK,KAAKujC,KAAM8Z,IAG5BzZ,EAAMvjC,UAAUy4B,wBAA0B,SAAiC74B,GAC1EwK,EAAgBzK,KAAKq5B,SAAUp5B,IAGhC2jC,EAAMvjC,UAAU+pC,mBAAqB,SAA4BC,GAEhE,IADA,GAAIzlC,GAAI5E,KAAKq5B,SAASx0B,OACfD,KAAK,CACX,GAAId,GAAQ9D,KAAKq5B,SAASz0B,GAAGrC,UACzBuB,KAAU9D,KAAK8D,OAAO9D,KAAK6Y,IAAI/U,GAGhCumC,GACHrqC,KAAKuE,SAAS7B,QAAQ28C,KAIxBzb,EAAMvjC,UAAU++C,wBAA0B,WACzCp/C,KAAKuE,SAAS7B,QAAQ48C,IAClBt/C,KAAKglC,cAAchlC,KAAKglC,aAAav8B,gBAGnCm7B,KAGJ2b,GAAc,SAAUpc,GAG3B,QAASoc,KACRn4C,GAAaC,eAAerH,KAAMu/C,EAElC,IAAIj4C,GAAQF,GAAaG,0BAA0BvH,KAAMmjC,EAAO37B,KAAKxH,KAAM,KAAM,WAOjF,OALAsH,GAAMxD,MAA0B,mBAAX07C,QAAyBA,OAAS7J,OACvDruC,EAAM2H,QAAS,EACf3H,EAAMsxB,KAAOtxB,EACbA,EAAMwU,YACNxU,EAAM8hC,WACC9hC,EAOR,MAnBAF,IAAaM,SAAS63C,EAAapc,GAenCoc,EAAYl/C,UAAUwwB,WAAa,WAClC,MAAO,WAGD0uB,GACN3b,IAEEoG,GAAgB,GAAIuV,IAuEpBE,GAAa,GAAInpC,IAAK,UAwEtB0lB,GAAO,WACV,QAASA,GAAKxmB,EAAQ0mB,EAAMv7B,GAC3ByG,GAAaC,eAAerH,KAAMg8B,GAElCh8B,KAAKwV,OAAS,GAAI2mB,IAAS3mB,EAAQxV,MACnCA,KAAKk8B,KAAO,GAAIC,IAASD,EAAMl8B,MAC/BA,KAAKW,QAAUA,EACfX,KAAK64B,QAAS,EACd74B,KAAKi7B,aAAeiB,EAAK9zB;CAsB1B,MAnBA4zB,GAAK37B,UAAUuP,KAAO,SAAcqsB,GAC9Bj8B,KAAK64B,SACT74B,KAAK64B,QAAS,EAEVoD,IAASj8B,KAAKk8B,KACjBl8B,KAAKwV,OAAO1U,MAAM+X,IAAI7Y,KAAKk8B,KAAKp7B,MAAMsH,OAEtCpI,KAAKk8B,KAAKp7B,MAAM+X,IAAI7Y,KAAKwV,OAAO1U,MAAMsH,OAGvCpI,KAAK64B,QAAS,IAIhBmD,EAAK37B,UAAUsZ,OAAS,WACvB3Z,KAAKwV,OAAO1U,MAAM6H,WAAW3I,KAAKwV,QAClCxV,KAAKk8B,KAAKp7B,MAAM6H,WAAW3I,KAAKk8B,OAG1BF,KAGJG,GAAW,WACd,QAASA,GAASr7B,EAAOqK,GACxB/D,GAAaC,eAAerH,KAAMm8B,GAElCn8B,KAAKc,MAAQA,EACbd,KAAKmL,MAAQA,EACbrK,EAAMuH,SAASrI,MAOhB,MAJAm8B,GAAS97B,UAAUoI,aAAe,WACjCzI,KAAKmL,MAAMyE,KAAK5P,OAGVm8B,KAGJC,MA8GAC,GAAW,WACd,QAASA,GAAS17B,EAASG,EAAO8S,EAAUzM,GAC3CC,GAAaC,eAAerH,KAAMq8B,GAElCr8B,KAAK0L,QAAUvE,EAAQuE,SAAW/K,EAClCX,KAAKc,MAAQA,EACbd,KAAKs4B,QAAUx3B,EAAM+vB,WAAWlwB,GAChCX,KAAK4T,SAAWA,EAEhB5T,KAAKs8B,SAAW95B,OAChBxC,KAAKu8B,SAAWz7B,EAAMsH,MAEtBpI,KAAKw8B,MAAQr1B,EAAQq1B,MACrBx8B,KAAKsY,KAAOnR,EAAQmR,KACpBtY,KAAKy8B,OAASt1B,EAAQs1B,OAEtBz8B,KAAK8G,OAAQ,EAETK,EAAQu1B,QAAS,EACpB18B,KAAK28B,WAEL38B,KAAKs8B,SAAWt8B,KAAKu8B,SAGtBz7B,EAAMuH,SAASrI,MA0BhB,MAvBAq8B,GAASh8B,UAAUsd,OAAS,WAC3B3d,KAAKc,MAAM6H,WAAW3I,OAGvBq8B,EAASh8B,UAAUs8B,SAAW,WAC7B38B,KAAK4T,SAASpM,KAAKxH,KAAK0L,QAAS1L,KAAKu8B,SAAUv8B,KAAKs8B,SAAUt8B,KAAKs4B,SACpEt4B,KAAKs8B,SAAWt8B,KAAKu8B,SACrBv8B,KAAK8G,OAAQ,GAGdu1B,EAASh8B,UAAUoI,aAAe,WACjC,IAAKzI,KAAK8G,MAAO,CAGhB,GAFA9G,KAAKu8B,SAAWv8B,KAAKc,MAAMsH,MAEvBpI,KAAKy8B,QAAUz8B,KAAKu8B,WAAav8B,KAAKs8B,SAAU,MAEpDt3B,IAAQ43B,YAAY58B,KAAMA,KAAKw8B,OAC/Bx8B,KAAK8G,OAAQ,EAET9G,KAAKsY,MAAMtY,KAAK2d,WAIf0e,KAGJQ,GAAkB,WACrB,QAASA,GAAgBl8B,EAASm8B,EAAWzwB,EAAMuH,EAAUzM,GAC5D,GAAIjE,GAASlD,IAEboH,IAAaC,eAAerH,KAAM68B,GAElC78B,KAAK0L,QAAUvE,EAAQuE,SAAW/K,EAClCX,KAAKW,QAAUA,EACfX,KAAK88B,UAAYA,EACjB98B,KAAKqM,KAAOA,EACZrM,KAAK4T,SAAWA,CAEhB,IAAImpB,GAAU1wB,EAAKhI,KAAK,OAAOysB,QAAQ,MAAO,QAC1CkM,EAAcF,EAAUjM,WAAWlwB,EACvCX,MAAK+8B,QAAU,GAAIrN,QAAO,KAAOsN,EAAcA,EAAc,MAAQ,IAAMD,EAAU,KAErF/8B,KAAKi9B,aACLj9B,KAAKk9B,aAELl9B,KAAKw8B,MAAQr1B,EAAQq1B,MACrBx8B,KAAKsY,KAAOnR,EAAQmR,KACpBtY,KAAKy8B,OAASt1B,EAAQs1B,OAEtBz8B,KAAK8G,OAAQ,CAEb,IAAIq2B,GAASL,EAAUM,YAAYp9B,KAAKqM,KAExC8wB,GAAOz6B,QAAQ,SAAU5B,GACxBoC,EAAOg6B,UAAUp8B,EAAM+vB,WAAW3tB,EAAOvC,UAAYG,EAAMsH,QAGxDjB,EAAQu1B,QAAS,EACpB18B,KAAK28B,WAEL38B,KAAKi9B,UAAYj9B,KAAKk9B,UAGvBJ,EAAUz0B,SAASrI,MA4EpB,MAzEA68B,GAAgBx8B,UAAUsd,OAAS,WAClC3d,KAAK88B,UAAUn0B,WAAW3I,OAG3B68B,EAAgBx8B,UAAUs8B,SAAW,WACpC,GAAIzvB,GAASlN,IAEboM,QAAOC,KAAKrM,KAAKk9B,WAAWx6B,QAAQ,SAAU41B,GAC7C,IAAIprB,EAAOmwB,SAAYnwB,EAAOmwB,QAAQ/E,GAAtC,CAEA,GAAIiE,GAAWrvB,EAAOgwB,UAAU5E,GAC5BgE,EAAWpvB,EAAO+vB,UAAU3E,EAEhC,MAAIprB,EAAOuvB,QAAUF,IAAaD,GAC9BgB,EAAQf,EAAUD,IAAtB,CAEA,GAAIzK,IAAQ0K,EAAUD,EAAUhE,EAChC,IAAIA,EAAS,CACZ,GAAIiF,GAAYrwB,EAAO6vB,QAAQ7G,KAAKoC,GAASnrB,MAAM,EACnD0kB,GAAOA,EAAKM,OAAOoL,GAGpBrwB,EAAO0G,SAAS9K,MAAMoE,EAAOxB,QAASmmB,OAGvC7xB,KAAKi9B,UAAYj9B,KAAKk9B,UACtBl9B,KAAKq9B,QAAU,KACfr9B,KAAK8G,OAAQ,GAGd+1B,EAAgBx8B,UAAU2M,QAAU,SAAiBC,GACpD,GAAKzC,EAAQxK,KAAK88B,UAAUh5B,OAA5B,CAEA,GAAI05B,GAAOx9B,KAAK88B,UAAUjM,WAAW7wB,KAAKW,SACtC88B,EAAMz9B,KAAK88B,UAAUh5B,MAAMe,OAC3BmxB,EAASh2B,KAAKqM,KAAKxH,OAAS,EAAI,IAAM7E,KAAKqM,KAAKc,MAAM,GAAG9I,KAAK,KAAO,EAEzErE,MAAKq9B,UACL,KAAK,GAAIz4B,GAAI,EAAGA,EAAIqI,EAAWpI,OAAQD,IAChB,KAAlBqI,EAAWrI,IAAaqI,EAAWrI,KAAOA,IAC9C5E,KAAKq9B,QAAQG,EAAO,IAAM54B,EAAIoxB,IAAU,EAGzC,KAAK,GAAI0H,GAAKzwB,EAAW0wB,YAAkBF,EAALC,EAAUA,IAC/C19B,KAAKq9B,QAAQG,EAAO,IAAME,EAAK1H,IAAU,IAI3C6G,EAAgBx8B,UAAUoI,aAAe,WACxC,GAAIgF,GAASzN,IAERA,MAAK8G,QACT9G,KAAKk9B,aASLl9B,KAAK88B,UAAUM,YAAYp9B,KAAKqM,MAAM3J,QAAQ,SAAU5B,GACvD,GAAIw3B,GAAUx3B,EAAM+vB,WAAWpjB,EAAO9M,QACtC8M,GAAOyvB,UAAU5E,GAAWx3B,EAAMsH,QAGnCpD,GAAQ43B,YAAY58B,KAAMA,KAAKw8B,OAC/Bx8B,KAAK8G,OAAQ,EAET9G,KAAKsY,MAAMtY,KAAK2d,WAIfkf,KA0BJe,GAAe,WAClB,QAASA,GAAalyB,EAAS5K,EAAO8S,EAAUzM,GAC/CC,GAAaC,eAAerH,KAAM49B,GAElC59B,KAAK0L,QAAUA,EACf1L,KAAKc,MAAQA,EACbd,KAAKs4B,QAAUx3B,EAAM+vB,aACrB7wB,KAAK4T,SAAWA,EAEhB5T,KAAK69B,QAAU,KAEf/8B,EAAMuH,SAASrI,MAEXmH,EAAQu1B,QAAS,GACpB18B,KAAK89B,UACL99B,KAAKgN,YACLhN,KAAKyI,gBAELzI,KAAK89B,OAAS99B,KAAKmN,QAuDrB,MAnDAywB,GAAav9B,UAAUoI,aAAe,WACjCzI,KAAK69B,SAER79B,KAAK4T,SAAS5T,KAAK69B,SACnB79B,KAAK69B,QAAU,OAGf79B,KAAKgN,QAAQhN,KAAK89B,OAAO35B,IAAI45B,KAC7B/9B,KAAKyI,iBAIPm1B,EAAav9B,UAAU2M,QAAU,SAAiBC,GACjD,GAAI3F,GAAQtH,KAERu8B,EAAWv8B,KAAKmN,QAEhB6wB,KACAC,KACAvG,EAAQ,OAERwG,IAEJjxB,GAAWvK,QAAQ,SAAU0K,EAAUC,GACtC6wB,EAAS9wB,IAAY,EAEjBA,IAAaC,GAAsB7K,SAAVk1B,IAC5BA,EAAQrqB,GAGQ,KAAbD,GACH6wB,EAAQn8B,KAAKwF,EAAMw2B,OAAOzwB,MAId7K,SAAVk1B,IAAqBA,EAAQzqB,EAAWpI,OAG5C,KAAK,GADDgI,GAAM0vB,EAAS13B,OACVD,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EACxBs5B,EAASt5B,IAAIo5B,EAASl8B,KAAKy6B,EAAS33B,GAG1C5E,MAAK69B,SAAYG,SAAUA,EAAUC,QAASA,EAASvG,MAAOA,GAC9D13B,KAAK89B,OAASvB,GAGfqB,EAAav9B,UAAU8M,MAAQ,WAC9B,GAAIrJ,GAAQ9D,KAAKc,MAAMsH,KACvB,OAAOoC,GAAQ1G,GAASA,EAAMqJ,YAGxBywB,KAGJO,IAAgBzB,MAAM,EAAOpkB,MAAM,GAYnC8B,GAAO,SAAWrU,GACpB,MAAOA,GAAIqU,QAGTgkB,GAAiB,SAAWr4B,GAC9B,MAAe,KAARA,GA0MLs4B,GAAahkB,MAAMha,UAkCnBmY,GAAMrC,GAAgB,OAEtBrU,GAAOqU,GAAgB,QAEvBmoB,GAAS,oCAGTC,MAGAC,IAAU,EAGVC,GAAe,KACfC,GAAa,MAkCbt1B,IAASq1B,IAAiBA,GAAavwB,aAE1CuwB,GAAer1B,GAAIxF,cAAc,SACjC66B,GAAa9tB,KAAO,WAEpBvH,GAAIu1B,qBAAqB,QAAQ,GAAGp5B,YAAYk5B,IAEhDC,KAAeD,GAAaG,WAG7B,IAAIC,IAAa,GAAIvoB,IAAK,UACtBwoB,GAAe,GAAIxoB,IAAK,YAuExByoB,IACH/jB,OAAQ,SAAgBgkB,EAAQtoB,EAAOvP,GACtCuP,EAAMuoB,MAAQC,GAAQxoB,EAAMuoB,MAAOE,EAAYh4B,EAAQ83B,SAGxDvC,KAAM,cAgBH0C,GAAmB,+BACnBC,GAAkB,eAClBC,GAAsB,kGACtBC,GAAiB,cACjBC,GAAqB,yCA6ErBC,IACHz9B,KAAM,MAGNgZ,OAAQ,SAAgBgkB,EAAQtoB,EAAOvP,GACtC,GAAKA,EAAQu4B,IAAb,CAEA,GAAIh5B,GAAKi5B,KACLrI,EAASnwB,EAAQy4B,eAAiBz4B,EAAQu4B,IAAMG,GAAa14B,EAAQu4B,IAAKh5B,EAE9EgQ,GAAMopB,MAAQp5B,EAEdq5B,IAASr5B,GAAIA,EAAI4wB,OAAQA,MAI1BoF,KAAM,SAAcsC,EAAQh8B,EAAQmE,GAC9BA,EAAQu4B,KAEbltB,EAAY,2TA2BVwtB,IACHh+B,KAAM,OAENgZ,OAAQ,SAAgBgkB,EAAQtoB,EAAOvP,GACtC,GAAImF,GAAM,OACNxI,EAAQ,MAGZ,IAAIqD,EAAQsC,MAAQwC,EAAS9E,EAAQsC,MACpC,IAAK6C,IAAOnF,GAAQsC,KACnB3F,EAAQqD,EAAQsC,KAAK6C,GAEjBxI,GAAuF,YAA5D,mBAAVA,GAAwB,YAAcsD,GAAAA,UAAoBtD,MAC1EmI,EAASnI,IAAU0G,EAAQ1G,KAC9B0O,EAAY,mUAMhBkE,GAAMjN,KAAOw2B,GAAUvpB,EAAMjN,KAAMtC,EAAQsC,OAG5CizB,KAAM,SAAcsC,EAAQr+B,EAASwG,GACpC,GAAI4zB,GAASkF,GAAUjB,EAAO3+B,UAAUoJ,KAAMtC,EAAQsC,KAMtD,IAJsB,kBAAXsxB,KAAuBA,EAASA,EAAOvzB,KAAK7G,IAInDo6B,GAAUA,EAAOpgB,cAAgBvO,OACpC,IAAK,GAAIghB,KAAQ2N,GACY,kBAAjBA,GAAO3N,KAAsB2N,EAAO3N,GAAQjtB,GAAK46B,EAAO3N,GAAOzsB,GAI5E,OAAOo6B,QAGRhtB,MAAO,SAAepN,GACrB,GAAIo6B,GAAS/6B,KAAK08B,KAAK/7B,EAAQga,YAAaha,EAASA,EAAQ0b,UAE7D,OADA1b,GAAQ0b,UAAUuc,KAAK/f,IAAIkiB,IACpB,IA6DLmF,GAAmB,EAEnBnD,GAAU,kBAgCVoD,GAAYC,GAAO,MAoBnB7tB,GAAQ,KAER8tB,IAAgB,aAAc,mBAAoB,mBAAoB,yBAA0B,MAAO,cAAe,qBAAsB,WAAY,iBAExJC,GAAwB,6EAExBC,GAA2B,4LAkB3BC,IACHC,OAAQ,SAAgB/5B,EAAIS,GAC3B,IAAKiC,GAAK,CACT,GAAIjC,GAAWA,EAAQu5B,QACtB,MAED,MAAM,IAAItrB,OAAM,6BAA+B1O,EAAK,4CAGjDA,IAAIA,EAAKA,EAAGoqB,QAAQ,KAAM,IAE9B,IAAIvwB,GAAW,MAEf,MAAMA,EAAW6I,GAAIu3B,eAAej6B,IAAM,CACzC,GAAIS,GAAWA,EAAQu5B,QACtB,MAED,MAAM,IAAItrB,OAAM,4CAA8C1O,GAG/D,GAAuC,WAAnCnG,EAASmF,QAAQhC,cAA4B,CAChD,GAAIyD,GAAWA,EAAQu5B,QACtB,MAED,MAAM,IAAItrB,OAAM,6BAA+B1O,EAAK,gCAGrD,MAAO,eAAiBnG,GAAWA,EAASqgC,YAAcrgC,EAASyQ,WAEpE6vB,SAAU,SAAkBtgC,GAC3B,QAA6B,gBAAbA,KAEjBugC,gBAAiB,SAAyBngC,GAMzC,MAJIA,GAAQ+Z,WACX/Z,EAAUA,EAAQ+Z,UAGZ2lB,GAAaU,OAAO,SAAUC,EAAK10B,GAEzC,MADA00B,GAAI10B,GAAO3L,EAAQ2L,GACZ00B,QAGTzuB,MAAO,SAAiBhS,EAAU4G,GACjC85B,GAAa1uB,GAAO,WAAY+tB,GAChC,IAAI3qB,GAASpD,GAAMhS,EAAU4G,EAE7B,OADA+5B,IAAavrB,GACNA,GAERwrB,SAAU,SAAkB5gC,EAAUI,GACrC,MAAOX,MAAKuS,MAAMhS,EAAUP,KAAK8gC,gBAAgBngC,MAI/CygC,IACHp/B,KAAM,WAENgZ,OAAQ,SAAgBgkB,EAAQtoB,EAAOvP,GAEtC,GAAI,YAAcA,GAAS,CAC1B,GAAI5G,GAAW4G,EAAQ5G,QAEC,mBAAbA,GACVmW,EAAMnW,SAAWA,EAEjBmW,EAAMnW,SAAW8gC,GAAc9gC,EAAUmW,KAI5CgmB,KAAM,SAAcsC,EAAQr+B,EAASwG,GAIpC,GAAI5G,GAAW,YAAc4G,GAAUA,EAAQ5G,SAAWy+B,EAAO3+B,UAAUE,QAG3E,IAFAA,EAAWA,IAAc6c,EAAG8iB,GAAkBl1B,MAEtB,kBAAbzK,GAAyB,CACnC,GAAIwxB,GAAKxxB,CACTA,GAAW+gC,GAAmB3gC,EAASoxB,GAEvCpxB,EAAQ4gC,QAAQhhC,UACfwxB,GAAIA,EACJgJ,OAAQx6B,GAIVA,EAAW8gC,GAAc9gC,EAAUI,GAMnCA,EAAQJ,SAAWA,EAASyK,EAExBzK,EAASihC,GACZC,GAAe9gC,EAAQ8R,SAAUlS,EAASihC,IAG5CzzB,MAAO,SAAepN,GACrB,GAAIo6B,GAASrC,GAAW/3B,EAExB,IAAIo6B,EAAQ,CACX,GAAIplB,GAAS0rB,GAActG,EAAQp6B,EAKnC,OAHAA,GAAQJ,SAAWoV,EAAO3K,EAC1By2B,GAAe9gC,EAAQ8R,SAAUkD,EAAO6rB,GAAG,IAEpC,KAwFNE,IAAiB,WAAY,aAAc,WAAY,aAAc,SAAU,SAAU,gBAAiB,WAAY,eAEtHC,GAAW,WACd,QAASA,GAAS3/B,EAAM4/B,GACvBx6B,GAAaC,eAAerH,KAAM2hC,GAElC3hC,KAAKgC,KAAOA,EACZhC,KAAK4hC,YAAcA,EA4CpB,MAzCAD,GAASthC,UAAU2a,OAAS,SAAgBgkB,EAAQtoB,EAAOvP,GAC1DnH,KAAK6hC,UAAU7hC,KAAK4hC,YAAc5C,EAAOtkB,SAAWskB,EAAQh/B,KAAK4hC,YAAclrB,EAAQA,EAAMiE,YAAaxT,IAG3Gw6B,EAASthC,UAAUq8B,KAAO,aAI1BiF,EAASthC,UAAUwhC,UAAY,SAAmB7C,EAAQh8B,EAAQmE,GACjE,GAAInF,GAAOhC,KAAKgC,KACZwR,EAASrM,EAAQnF,GAEjB8/B,EAAW1B,GAAOpB,EAAOh9B,GAE7B,KAAK,GAAIsK,KAAOkH,GACfsuB,EAASx1B,GAAOkH,EAAOlH,EAGxBtJ,GAAOhB,GAAQ8/B,GAGhBH,EAASthC,UAAU0N,MAAQ,SAAepN,GACzC,GAAImhC,GAAWnhC,EAAQX,KAAKgC,MACxBg4B,GAAU,CAed,OAbA5tB,QAAOC,KAAKy1B,GAAUp/B,QAAQ,SAAU4J,GACvC,GAAI2I,GAAO6sB,EAASx1B,EAEhB2I,GAAK8hB,MACJ9hB,EAAK8hB,IAAIgL,QACZD,EAASx1B,GAAO2I,EAAK8hB,UAEd+K,GAASx1B,GAEjB0tB,GAAU,KAILA,GAGD2H,KAGJK,GAAaN,GAAcv9B,IAAI,SAAUnC,GAC5C,MAAO,IAAI2/B,IAAS3/B,EAAe,aAATA,KA6EvBigC,IACHhD,MAAOF,GACPW,IAAKD,GACLh2B,KAAMu2B,GACNz/B,SAAU6gC,IAGPc,GAAc91B,OAAOC,KAAKqO,IAE1BynB,GAAgBC,GAAQF,GAAY5nB,OAAO,SAAUhO,GACxD,OAAQ21B,GAAO31B,MAIZ+1B,GAAgBD,GAAQF,GAAY/P,OAAO6P,GAAW79B,IAAI,SAAUqE,GACvE,MAAOA,GAAExG,SAGNsgC,MAAWnQ,OAAO+P,GAAY5nB,OAAO,SAAUhO,GAClD,OAAQ01B,GAAW11B,KAAS21B,GAAO31B,KAChC01B,GAEJC,GAAO1hC,SAAU0hC,GAAOvC,KAEpB6C,IACHvnB,OAAQ,SAAgBgkB,EAAQtoB,EAAOvP,GACtC,MAAO06B,IAAU,SAAU7C,EAAQtoB,EAAOvP,IAG3Cu1B,KAAM,SAAcsC,EAAQr+B,EAASwG,GACpC,MAAO06B,IAAU,OAAQ7C,EAAQr+B,EAASwG,IAG3C4G,MAAO,SAAepN,GACrB,MAAO2hC,IAAMhoB,OAAO,SAAUkoB,GAC7B,MAAOA,GAAEz0B,OAASy0B,EAAEz0B,MAAMpN,KACxBwD,IAAI,SAAUq+B,GAChB,MAAOA,GAAExgC,QAMXsgC,MAAOA,IA8DJG,IAAkB,WAAY,WAAY,aAAc,aAAc,UAEtEC,GAAiB,GAAIpsB,IAAK,YAC1BqsB,GAAY,GAAIrsB,IAAK,SACrBssB,GAAe,GAAItsB,IAAK,UACxBusB,GAAe,GAAIvsB,IAAK,YAmDxB1F,GAAO,EACPmC,GAAe,EACfG,GAAS,EACTD,GAAU,EACViC,GAAU,EACVlC,GAAU,EACV8vB,GAAY,GACZ3vB,GAAU,GACVN,GAAU,GACVF,GAAQ,GAERowB,GAAiB,GACjBC,GAAiB,GACjBC,GAAY,GACZl0B,GAAa,GACbD,GAAiB,GACjBE,GAAe,GACfK,GAAe,GACfC,GAAkB,GA0DlBtI,GAAO,WACV,QAASA,GAAKG,GACbC,GAAaC,eAAerH,KAAMgH,GAElChH,KAAKgE,eAAiBmD,EAAQnD,eAC9BhE,KAAKW,QAAUwG,EAAQnD,eAAerD,QAEtCX,KAAKO,SAAW4G,EAAQ5G,SACxBP,KAAKgI,MAAQb,EAAQa,MACrBhI,KAAK2Q,KAAOxJ,EAAQ5G,SAASyK,EAE7BhL,KAAK8G,OAAQ,EAkCd,MA/BAE,GAAK3G,UAAUqI,OAAS,WAClB1I,KAAK8G,QACT9G,KAAK8G,OAAQ,EACb9G,KAAKgE,eAAe0E,WAItB1B,EAAK3G,UAAUe,KAAO,WACrB,MAAO,OAGR4F,EAAK3G,UAAUmB,QAAU,aAIzBwF,EAAK3G,UAAU0B,cAAgB,WAC9B,MAAO,OAGRiF,EAAK3G,UAAU4B,kBAAoB,aAInC+E,EAAK3G,UAAU6B,aAAe,WAC7B,MAAOlC,MAAKgE,eAAe9B,aAAalC,OAGzCgH,EAAK3G,UAAUqJ,QAAU,WACxB,MAAO1J,MAAKyF,YAGNuB,KAGJk8B,GAAmB,SAAUC,GAGhC,QAASD,KAER,MADA97B,IAAaC,eAAerH,KAAMkjC,GAC3B97B,GAAaG,0BAA0BvH,KAAMmjC,EAAOr6B,MAAM9I,KAAM+I,YAoCxE,MAxCA3B,IAAaM,SAASw7B,EAAkBC,GAOxCD,EAAiB7iC,UAAU+H,IAAM,SAAag7B,GACzCA,GAAeC,GAAQrjC,KAE3B,IAAIsjC,GAActjC,KAAKiK,OAAO7B,KAC9B,OAAOk7B,GAAcA,EAAYtjC,KAAKsM,KAAO9J,QAG9C0gC,EAAiB7iC,UAAUoI,aAAe,WACzCzI,KAAK8G,OAAQ,EAEb9G,KAAKujC,KAAK7gC,QAAQ8gC,IAClBxjC,KAAKuE,SAAS7B,QAAQ8gC,IACtBxjC,KAAKyjC,oBAGNP,EAAiB7iC,UAAUmM,QAAU,SAAiBF,GACrD,GAAY9J,SAAR8J,GAA6B,KAARA,EAAY,MAAOtM,KAE5C,KAAKA,KAAK0jC,WAAWjM,eAAenrB,GAAM,CACzC,GAAIq3B,GAAQ,GAAIT,GAAiBljC,KAAMsM,EACvCtM,MAAKuE,SAASzC,KAAK6hC,GACnB3jC,KAAK0jC,WAAWp3B,GAAOq3B,EAGxB,MAAO3jC,MAAK0jC,WAAWp3B,IASjB42B,GACNU,IAMEC,GAAkB,SAAUV,GAG/B,QAASU,GAAgBtiC,EAAUhB,GAClC6G,GAAaC,eAAerH,KAAM6jC,EAElC,IAAIv8B,GAAQF,GAAaG,0BAA0BvH,KAAMmjC,EAAO37B,KAAKxH,KAAMuB,EAASZ,QAAQ0b,UAAW,MA6BvG,OA3BA/U,GAAM/F,SAAWA,EACjB+F,EAAM/G,SAAWA,EAEjB+G,EAAM+wB,YAAa,EAEnB/wB,EAAMyqB,GAAK+R,GAAYvjC,EAAS2H,EAAG3H,EAASiI,EAAE3D,QAC9CyC,EAAMy8B,YAAc,KAEpBz8B,EAAMkN,aACNlN,EAAM61B,OAAS71B,EAAM/G,SAASiI,EAAErE,IAAI,SAAU6/B,EAAKh8B,GAClD,GAAIlH,GAAQmjC,GAAiB38B,EAAM/F,SAAUyiC,GACzC17B,EAAW,MAYf,OAVKxH,KACJwH,EAAWhB,EAAM/F,SAASgH,QAAQy7B,EAAK,SAAUljC,GAChD2J,EAAgBnD,EAAMkN,UAAWlM,GACjChB,EAAM61B,OAAOn1B,GAASlH,EACtBwG,EAAMoB,WAGPpB,EAAMkN,UAAU1S,KAAKwG,IAGfxH,IAGRwG,EAAMoB,SACCpB,EAqGR,MAvIAF,IAAaM,SAASm8B,EAAiBV,GAqCvCU,EAAgBxjC,UAAUqI,OAAS,WAClC,GAAIxF,GAASlD,KAETW,EAAUX,KAAKuB,SAASZ,QAKxB2L,EAAM,IAAMtM,KAAKO,SAAS2H,EAAE4oB,QAAQ,UAAW,SAAUoT,EAAOt/B,GACnE,GAAIA,GAAK1B,EAAOi6B,OAAOt4B,OAAQ,MAAOq/B,EAEtC,IAAIpjC,GAAQoC,EAAOi6B,OAAOv4B,EAC1B,OAAO9D,GAAQA,EAAM+vB,aAAe,eAIjCsT,GACHC,OAAQ,WACP,GAAI7uB,GAASrS,EAAOi6B,OAAOh5B,IAAI5B,GAC/B,OAAOW,GAAO6uB,GAAGjpB,MAAMnI,EAAS4U,IAEjC8uB,aAAc/3B,GAGXy3B,EAAcpjC,EAAQ0b,UAAUioB,QAAQh4B,EAAK63B,EAEjDnkC,MAAK8D,MAAQigC,EAAY37B,MAErBpI,KAAK+jC,aACR/jC,KAAK+jC,YAAYp7B,WAAW3I,MAI7BA,KAAK+jC,YAAcA,EACnBA,EAAY17B,SAASrI,MAErBA,KAAKyI,gBAGNo7B,EAAgBxjC,UAAU+H,IAAM,SAAag7B,GAC5C,MAAOpjC,MAAK+jC,YAAY37B,IAAIg7B,IAG7BS,EAAgBxjC,UAAUwwB,WAAa,WACtC,MAAO7wB,MAAK+jC,YAAc/jC,KAAK+jC,YAAYlT,aAAe,cAG3DgT,EAAgBxjC,UAAUoI,aAAe,WACxCzI,KAAKujC,KAAK7gC,QAAQ8gC,IAClBxjC,KAAKuE,SAAS7B,QAAQ8gC,IAEtBxjC,KAAKyjC,oBAGNI,EAAgBxjC,UAAUmM,QAAU,SAAiBF,GACpD,GAAY9J,SAAR8J,GAA6B,KAARA,EAAY,MAAOtM,KAE5C,KAAKA,KAAK0jC,WAAWjM,eAAenrB,GAAM,CACzC,GAAIq3B,GAAQ,GAAIT,IAAiBljC,KAAMsM,EACvCtM,MAAKuE,SAASzC,KAAK6hC,GACnB3jC,KAAK0jC,WAAWp3B,GAAOq3B,EAGxB,MAAO3jC,MAAK0jC,WAAWp3B,IAGxBu3B,EAAgBxjC,UAAUkkC,KAAO,WAChCvkC,KAAKyI,gBAGNo7B,EAAgBxjC,UAAUmkC,SAAW,WACpC,MAAOxkC,MAAKoI,OAGby7B,EAAgBxjC,UAAU4Y,SAAW,WACpCjZ,KAAKkG,SACLlG,KAAKuB,SAAWiB,OACZxC,KAAK+jC,aACR/jC,KAAK+jC,YAAY9qB,WAElBjZ,KAAK+jC,YAAcvhC,OACnB2gC,EAAO9iC,UAAU4Y,SAASzR,KAAKxH,OAGhC6jC,EAAgBxjC,UAAUsI,WAAa,SAAoB87B,GAC1DtB,EAAO9iC,UAAUsI,WAAWnB,KAAKxH,KAAMykC,GAClCzkC,KAAKujC,KAAK1+B,QAAQ7E,KAAKiZ,YAG7B4qB,EAAgBxjC,UAAU6F,OAAS,WAClClG,KAAKwU,UAAU9R,QAAQyD,GAGvB,KADA,GAAIvB,GAAI5E,KAAKm9B,OAAOt4B,OACbD,KACF5E,KAAKm9B,OAAOv4B,IAAI5E,KAAKm9B,OAAOv4B,GAAG+D,WAAW3I,OAIzC6jC,GACND,IAEEc,GAA2B,SAAUvB,GAGxC,QAASuB,GAAyBz6B,EAAQqC,GAEzC,MADAlF,IAAaC,eAAerH,KAAM0kC,GAC3Bt9B,GAAaG,0BAA0BvH,KAAMmjC,EAAO37B,KAAKxH,KAAMiK,EAAQqC,IAiC/E,MArCAlF,IAAaM,SAASg9B,EAA0BvB,GAOhDuB,EAAyBrkC,UAAUskC,WAAa,SAAoB7gC,GACnE,IAAIw5B,EAAQx5B,EAAO9D,KAAK8D,OAIxB,IAFA,GAAImG,GAASjK,KAAKiK,OACdoC,GAAQrM,KAAKsM,KACVrC,GAAQ,CACd,GAAIA,EAAOuzB,KAAM,CAChB,GAAIx6B,GAASiH,EAAOnJ,MAAMwT,QAAQjI,EAClCrJ,GAAO2hC,WAAW7gC,EAClB,OAGDuI,EAAKmK,QAAQvM,EAAOqC,KAEpBrC,EAASA,EAAOA,SAIlBy6B,EAAyBrkC,UAAUmM,QAAU,SAAiBF,GAC7D,GAAY9J,SAAR8J,GAA6B,KAARA,EAAY,MAAOtM,KAE5C,KAAKA,KAAK0jC,WAAWjM,eAAenrB,GAAM,CACzC,GAAIq3B,GAAQ,GAAIe,GAAyB1kC,KAAMsM,EAC/CtM,MAAKuE,SAASzC,KAAK6hC,GACnB3jC,KAAK0jC,WAAWp3B,GAAOq3B,EAGxB,MAAO3jC,MAAK0jC,WAAWp3B,IAGjBo4B,GACNd,IAEEgB,GAA2B,SAAUC,GAGxC,QAASD,GAAyBrjC,EAAUhB,GAC3C6G,GAAaC,eAAerH,KAAM4kC,EAElC,IAAI1hC,GAASkE,GAAaG,0BAA0BvH,KAAM6kC,EAAQr9B,KAAKxH,KAAM,KAAM,MAEnFkD,GAAO01B,KAAOr3B,EAASZ,QAAQ0b,UAE/BnZ,EAAOsR,aAEPtR,EAAOs6B,KAAOr1B,GAAU5G,EAAUhB,EAClC,IAAIukC,GAAe,MAEd5hC,GAAOs6B,OACXsH,EAAevjC,EAASgH,QAAQhI,EAASiI,EAAG,SAAU1H,GACrDoC,EAAOs6B,KAAO18B,EACdoC,EAAOwF,SAEP+B,EAAgBvH,EAAOsR,UAAWswB,KAGnC5hC,EAAOsR,UAAU1S,KAAKgjC,GAGvB,IAAIhT,IACHrpB,aAAc,WACb,MAAOvF,GAAOwF,UA0ChB,OAtCAxF,GAAO6hC,QAAUxkC,EAASw7B,EAAE53B,IAAI,SAAU5D,EAAUqE,GACnD,GAAwB,gBAAbrE,GACV,OAAS6H,IAAK,WACZ,MAAO7H,IAIV,IAAIO,GAAQ,OACRwH,EAAW,MAEf,OAAI/H,GAASyK,IAAMi4B,IAClBniC,EAAQmjC,GAAiB1iC,EAAUhB,EAAS+C,GAExCxC,EACHA,EAAMuH,SAASypB,IAEfxpB,EAAW/G,EAASgH,QAAQhI,EAAS+C,EAAG,SAAUxC,GACjDoC,EAAO6hC,QAAQngC,GAAK9D,EAEpBA,EAAMuH,SAASypB,GACf5uB,EAAOwF,SAEP+B,EAAgBvH,EAAOsR,UAAWlM,KAGnCpF,EAAOsR,UAAU1S,KAAKwG,IAGhBxH,IAGRA,EAAQ,GAAI+iC,IAAgBtiC,EAAUhB,GACtCO,EAAMuH,SAASypB,GACRhxB,KAGRoC,EAAOi1B,cAAe,EACtBj1B,EAAOwF,SACAxF,EA4FR,MAjKAkE,IAAaM,SAASk9B,EAA0BC,GAwEhDD,EAAyBvkC,UAAUqI,OAAS,WAC3C,GAAK1I,KAAKw9B,KAAV,CAIA,IADA,GAAI54B,GAAI5E,KAAK+kC,QAAQlgC,OACdD,KACN,IAAK5E,KAAK+kC,QAAQngC,GAAI,MAGvB5E,MAAKm4B,cAAe,CAEpB,IAAI9rB,GAAOrM,KAAK+kC,QAAQ5gC,IAAI,SAAUrD,GACrC,MAAOma,GAAUd,OAAOrZ,EAAMsH,UAE3BtH,EAAQd,KAAKw9B,KAAKlpB,QAAQjI,EAE1BrM,MAAKc,QACRd,KAAKc,MAAM6H,WAAW3I,MACtBA,KAAKc,MAAMg4B,wBAAwB94B,OAGpCA,KAAKc,MAAQA,EACbd,KAAKiK,OAASnJ,EAAMmJ,OAEpBnJ,EAAMuH,SAASrI,MACfc,EAAM63B,sBAAsB34B,MAExBA,KAAKglC,cAAchlC,KAAKglC,aAAav8B,eAEzCzI,KAAKukC,SAGNK,EAAyBvkC,UAAU+T,gBAAkB,WACpDpU,KAAKwU,UAAU9R,QAAQ,SAAU4F,GAChC,MAAOA,GAAS8L,oBAEjBpU,KAAK0I,UAGNk8B,EAAyBvkC,UAAU+H,IAAM,WACxC,MAAOpI,MAAKc,MAAQd,KAAKc,MAAMsH,MAAQ5F,QAMxCoiC,EAAyBvkC,UAAUkC,SAAW,WAE7C,IADA,GAAIqC,GAAI5E,KAAKq5B,SAASx0B,OACfD,KAAK,CACX,GAAId,GAAQ9D,KAAKq5B,SAASz0B,GAAGrC,UAC7B,IAAIuB,IAAU9D,KAAK8D,MAAO,MAAOA,GAGlC,MAAO9D,MAAK8D,OAGb8gC,EAAyBvkC,UAAUwwB,WAAa,WAC/C,MAAO7wB,MAAKc,MAAQd,KAAKc,MAAM+vB,aAAe,cAG/C+T,EAAyBvkC,UAAUoI,aAAe,WACjDzI,KAAKukC,QAGNK,EAAyBvkC,UAAUmM,QAAU,SAAiBF,GAC7D,GAAY9J,SAAR8J,GAA6B,KAARA,EAAY,MAAOtM,KAE5C,KAAKA,KAAK0jC,WAAWjM,eAAenrB,GAAM,CACzC,GAAIq3B,GAAQ,GAAIe,IAAyB1kC,KAAMsM,EAC/CtM,MAAKuE,SAASzC,KAAK6hC,GACnB3jC,KAAK0jC,WAAWp3B,GAAOq3B,EAGxB,MAAO3jC,MAAK0jC,WAAWp3B,IAGxBs4B,EAAyBvkC,UAAUmkC,SAAW,WAC7C,MAAOxkC,MAAKoI,OAGbw8B,EAAyBvkC,UAAUwY,IAAM,SAAa/U,GACrD,IAAK9D,KAAKc,MAAO,KAAM,IAAIsU,OAAM,2DACjCpV,MAAKc,MAAM+X,IAAI/U,IAGhB8gC,EAAyBvkC,UAAU6F,OAAS,WAC3ClG,KAAKwU,UAAU9R,QAAQyD,KAGjBy+B,GACNhB,IAuBEhxB,GAAQ,SAAU7K,GAGrB,QAAS6K,GAAMzL,GACdC,GAAaC,eAAerH,KAAM4S,EAElC,IAAItL,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAG1E,OADAG,GAAM/F,SAAW,KACV+F,EA2ER,MAnFAF,IAAaM,SAASkL,EAAO7K,GAW7B6K,EAAMvS,UAAUF,KAAO,WACtB8kC,GAAejlC,MAEfA,KAAKuB,SAAW,GAAI2J,KACnBC,MAAOnL,KACPO,SAAUP,KAAKO,SAASuJ,IACtB3J,QAGJyS,EAAMvS,UAAUU,OAAS,WACxB,MAAOf,MAAKuB,SAAWvB,KAAKuB,SAASR,SAAW6L,KAGjDgG,EAAMvS,UAAUe,KAAO,SAAcC,GACpC,MAAIrB,MAAKuB,SACDvB,KAAKuB,SAASH,KAAKC,GAD3B,QAKDuR,EAAMvS,UAAUmB,QAAU,SAAiBH,EAAUI,GAChDzB,KAAKuB,UACRvB,KAAKuB,SAASC,QAAQH,EAAUI,IAIlCmR,EAAMvS,UAAU0B,cAAgB,SAAuBC,GACtD,MAAIhC,MAAKuB,SACDvB,KAAKuB,SAASQ,cAAcC,GADpC,QAKD4Q,EAAMvS,UAAU4B,kBAAoB,SAA2BD,EAAMP,GAChEzB,KAAKuB,UACRvB,KAAKuB,SAASU,kBAAkBD,EAAMP,IAIxCmR,EAAMvS,UAAU8B,UAAY,SAAmBkJ,GAC9C,MAAOrL,MAAKuB,UAAYvB,KAAKuB,SAASY,UAAUkJ,IAGjDuH,EAAMvS,UAAUoC,OAAS,WACxBwiC,GAAejlC,MACXA,KAAKuB,UAAUvB,KAAKuB,SAASkB,UAGlCmQ,EAAMvS,UAAU0C,OAAS,SAAgBC,GACxChD,KAAKwF,UAAW,EACZxF,KAAKuB,UAAUvB,KAAKuB,SAASwB,OAAOC,IAGzC4P,EAAMvS,UAAUoF,SAAW,SAAkB8D,GAC5C,MAAOvJ,MAAKuB,SAAWvB,KAAKuB,SAASkE,SAAS8D,GAAU,IAGzDqJ,EAAMvS,UAAU6F,OAAS,WACxBlG,KAAK0M,WACD1M,KAAKuB,UAAUvB,KAAKuB,SAAS2E,UAGlC0M,EAAMvS,UAAUY,SAAW,SAAkBmF,GACxCpG,KAAKwF,UAAYxF,KAAKuB,UAAUvB,KAAKuB,SAASN,SAASmF,GAC3DpG,KAAKwF,UAAW,GAGjBoN,EAAMvS,UAAUwG,OAAS,WACpB7G,KAAK8G,QACR9G,KAAK8G,OAAQ,EACb9G,KAAKuB,SAASsF,WAIT+L,GACN5L,IAeEk+B,IAAkB,MAAO,OAAQ,UAAW,QAAS,OAAQ,SAAU,WACvEC,KAEJD,IAAexiC,QAAQ,SAAU0iC,GAChC,GAAIC,GAAS,WACZ,IAAK,GAAIC,GAAOv8B,UAAUlE,OAAQgtB,EAAOxX,MAAMirB,GAAOC,EAAO,EAAUD,EAAPC,EAAaA,IAC5E1T,EAAK0T,GAAQx8B,UAAUw8B,EAGxB,IAAIt4B,GAAau4B,GAAcxlC,KAAK6E,OAAQugC,EAAYvT,GAGpDkJ,EAAS1gB,MAAMha,UAAU+kC,GAAYt8B,MAAM9I,KAAM+I,UAGrD/D,IAAQ0yB,QAER13B,KAAKkQ,SAASu1B,SAAU,CAExB,KADA,GAAI7gC,GAAI5E,KAAKkQ,SAASw1B,SAAS7gC,OACxBD,KACN+gC,GAAe3lC,KAAKkQ,SAASw1B,SAAS9gC,GAAI5E,KAAMolC,EAAYn4B,EAM7D,OAHAjI,IAAQ8X,MAER9c,KAAKkQ,SAASu1B,SAAU,EACjB1K,EAGRl3B,IAAeshC,GAAmBC,GACjCthC,MAAOuhC,KAIT,IAAIO,IAAoB,OACpBC,GAAsB,YAInBC,WAENF,GAAoB,SAA2BG,GAC9C,MAAOA,GAAMD,UAAYX,IAE1BU,GAAsB,SAA6BE,GAClD,MAAOA,GAAMD,UAAYzrB,MAAMha,aAIhCulC,GAAoB,SAA2BG,GAE9C,IADA,GAAInhC,GAAIsgC,GAAergC,OAChBD,KAAK,CACX,GAAIwgC,GAAaF,GAAetgC,EAChCf,IAAekiC,EAAOX,GACrBthC,MAAOqhC,GAAkBC,GACzBY,cAAc,MAKjBH,GAAsB,SAA6BE,GAElD,IADA,GAAInhC,GAAIsgC,GAAergC,OAChBD,WACCmhC,GAAMb,GAAetgC,MAK/BghC,GAAkBK,QAAUJ,EAC5B,IAAIK,IAAQN,GAERO,GAAiB,mDAEjBC,IACH9rB,OAAQ,SAAgB+rB,GAGvB,MAAO77B,GAAQ67B,MAAaA,EAAOn2B,WAAam2B,EAAOn2B,SAASu1B,UAEjEa,KAAM,SAAc3lC,EAASolC,EAAOzN,GACnC,MAAO,IAAIiO,IAAa5lC,EAASolC,EAAOzN,KAItCiO,GAAe,WAClB,QAASA,GAAa5lC,EAASolC,GAC9B3+B,GAAaC,eAAerH,KAAMumC,GAElCvmC,KAAK44B,KAAOj4B,EACZX,KAAK8D,MAAQiiC,EACb/lC,KAAKwmC,QAAU,KAGVT,EAAM71B,WAEVrM,GAAekiC,EAAO,YACrBjiC,OACC4hC,YACAe,aACAhB,SAAS,GAEVO,cAAc,IAGfE,GAAMH,IAIFA,EAAM71B,SAASu2B,UAAU9lC,EAAQ+U,SACrCqwB,EAAM71B,SAASu2B,UAAU9lC,EAAQ+U,OAAS,EAC1CqwB,EAAM71B,SAASu2B,UAAU3kC,KAAKnB,IAG/BolC,EAAM71B,SAASu2B,UAAU9lC,EAAQ+U,QAAU,EAC3CqwB,EAAM71B,SAASw1B,SAAS5jC,KAAK9B,MAiD9B,MA9CAumC,GAAalmC,UAAU+H,IAAM,WAC5B,MAAOpI,MAAK8D,OAGbyiC,EAAalmC,UAAU4Y,SAAW,WACjC,GAAI8sB,GAAOW,EAAShB,EAAUe,EAAWz+B,CAUzC,IARA+9B,EAAQ/lC,KAAK8D,MACb4iC,EAAUX,EAAM71B,SAChBw1B,EAAWgB,EAAQhB,SACnBe,EAAYC,EAAQD,UAKhBC,EAAQjB,QACX,OAAO,CAIR,IADAz9B,EAAQ09B,EAASt7B,QAAQpK,MACX,KAAVgI,EACH,KAAM,IAAIoN,OAAM+wB,GAOjB,IAJAT,EAASr7B,OAAOrC,EAAO,GAIlB09B,EAAS7gC,QAMb,GADA4hC,EAAUzmC,KAAK44B,KAAKljB,QAAU,GACzB+wB,EAAUzmC,KAAK44B,KAAKljB,OAAQ,CAGhC,GAFA1N,EAAQy+B,EAAUr8B,QAAQpK,KAAK44B,MAEjB,KAAV5wB,EACH,KAAM,IAAIoN,OAAM+wB,GAGjBM,GAAUp8B,OAAOrC,EAAO,eAZlB+9B,GAAM71B,SACbg2B,GAAMD,QAAQjmC,KAAK8D,QAgBdyiC,KAGJI,GAAe,MAEnB,KACCv6B,OAAOvI,kBAAmB,QACzBuE,IAAK,aACLyQ,IAAK,eAGN8tB,IACCrsB,OAAQ,SAAgBxW,GACvB,MAAOA,IAAuF,YAA5D,mBAAVA,GAAwB,YAAcsD,GAAAA,UAAoBtD,KAEnFwiC,KAAM,SAAc3lC,EAASmD,EAAOw0B,GACnC,MAAO,IAAIsO,IAAajmC,EAASmD,EAAOw0B,KAGzC,MAAOrnB,IACR01B,IAAe,EAGhB,GAszBIE,IACAC,GAvzBAC,GAAiBJ,GAwDjBC,GAAe,WAClB,QAASA,GAAajmC,EAASmD,EAAOw0B,GACrC,GAAIhxB,GAAQtH,IAEZoH,IAAaC,eAAerH,KAAM4mC,GAElC5mC,KAAKW,QAAUA,EACfX,KAAK8D,MAAQA,EACb9D,KAAKs4B,QAAUA,EAEft4B,KAAKgnC,uBAGL56B,OAAOC,KAAKvI,GAAOpB,QAAQ,SAAU4J,GACpC,GAAI26B,GAAqB76B,OAAO86B,yBAAyB5/B,EAAMxD,MAAOwI,EACtEhF,GAAM0/B,oBAAoB16B,GAAO26B,CAEjC,IAAIE,GAAe7O,EAAUA,EAAU,IAAMrd,EAAU3O,GAAO2O,EAAU3O,GAEpE86B,EAAaC,GAAuBJ,EAAoBtmC,EAASwmC,EAErE/6B,QAAOvI,eAAeyD,EAAMxD,MAAOwI,EAAK86B,KA+B1C,MA3BAR,GAAavmC,UAAU+H,IAAM,WAC5B,MAAOpI,MAAK8D,OAGb8iC,EAAavmC,UAAU0N,MAAQ,WAC9B,KAAM,IAAIqH,OAAM,6BAGjBwxB,EAAavmC,UAAUwY,IAAM,SAAavM,EAAKxI,GAC9C9D,KAAK8D,MAAMwI,GAAOxI,GAGnB8iC,EAAavmC,UAAU4Y,SAAW,WACjC,GAAI/V,GAASlD,IAEboM,QAAOC,KAAKrM,KAAK8D,OAAOpB,QAAQ,SAAU4J,GACzC,GAAI86B,GAAah7B,OAAO86B,yBAAyBhkC,EAAOY,MAAOwI,EAC1D86B,GAAWvuB,KAAQuuB,EAAWvuB,IAAIyuB,UAEvCC,GAAOH,GAE0C,IAA7CA,EAAWvuB,IAAIyuB,QAAQE,WAAW3iC,QACrCuH,OAAOvI,eAAeX,EAAOY,MAAOwI,EAAK86B,EAAWvuB,IAAIyuB,QAAQL,wBAK5DL,KAGJa,GAAoB,WACvB,QAASA,GAAkB9mC,EAASolC,EAAOzN,GAC1ClxB,GAAaC,eAAerH,KAAMynC,GAElCznC,KAAK8D,MAAQiiC,EAEb/lC,KAAK2b,OAAQ,EAEb3b,KAAK0nC,aAAeX,GAAeT,KAAK3lC,EAASolC,EAAOzN,GACxDt4B,KAAK2nC,aAAevB,GAAaE,KAAK3lC,EAASolC,EAAOzN,GAGtDlsB,OAAOvI,eAAe7D,KAAM,WAC3BoI,IAAK,WACJ,MAAOpI,MAAK2nC,aAAanB,SAE1B3tB,IAAK,SAAa/X,GACjBd,KAAK2nC,aAAanB,QAAU1lC,KAkB/B,MAbA2mC,GAAkBpnC,UAAU+H,IAAM,WACjC,MAAOpI,MAAK8D,OAGb2jC,EAAkBpnC,UAAU4Y,SAAW,WACtCjZ,KAAK2nC,aAAa1uB,WAClBjZ,KAAK0nC,aAAazuB,YAGnBwuB,EAAkBpnC,UAAU0N,MAAQ,SAAejK,GAClD,MAAO9D,MAAK0nC,aAAa35B,MAAMjK,IAGzB2jC,KAGJG,IACHttB,OAAQ,SAAgB+rB,EAAQ/N,EAAS33B,GACxC,MAAOomC,IAAezsB,OAAO+rB,EAAQ/N,EAAS33B,IAAYylC,GAAa9rB,OAAO+rB,IAE/EC,KAAM,SAAc3lC,EAASolC,EAAOzN,GACnC,MAAO,IAAImP,IAAkB9mC,EAASolC,EAAOzN,KAwC3CuP,GAAc,SAAU1E,GAG3B,QAAS0E,GAAYxrB,EAAW8nB,EAAW73B,GAC1ClF,GAAaC,eAAerH,KAAM6nC,EAElC,IAAIvgC,GAAQF,GAAaG,0BAA0BvH,KAAMmjC,EAAO37B,KAAKxH,KAAM,KAAM,MAwBjF,OAtBAsH,GAAMsxB,KAAOtxB,EAAM2C,OAASoS,EAC5B/U,EAAM68B,UAAYA,EAElB78B,EAAMgF,IAAMA,EACZhF,EAAMwgC,aAAex7B,GAAkB,MAAXA,EAAI,GAEhChF,EAAM+wB,YAAc/wB,EAAM68B,UAAU4D,OAEpCzgC,EAAMoE,QAAU2Q,EAAU2rB,mBAE1B1gC,EAAM2gC,gBAEN3gC,EAAM/C,YACN+C,EAAMo8B,cAENp8B,EAAMi8B,QAENj8B,EAAM4gC,iBAAkB,EACxB5gC,EAAMR,OAAQ,EAGdQ,EAAM0F,QAAUxK,OACT8E,EAqGR,MAlIAF,IAAaM,SAASmgC,EAAa1E,GAgCnC0E,EAAYxnC,UAAU+H,IAAM,SAAag7B,GASxC,MARIA,IAAeC,GAAQrjC,MAEvBA,KAAK8G,QACR9G,KAAK8G,OAAQ,EACb9G,KAAK8D,MAAQ9D,KAAKuC,WAClBvC,KAAKi/B,SAGCj/B,KAAK8D,OAGb+jC,EAAYxnC,UAAUkC,SAAW,WAChC4lC,IACA,IAAIpN,GAAS,MAEb,KACCA,EAAS/6B,KAAKmkC,UAAUC,OAAO58B,KAAKxH,KAAK0L,SACxC,MAAOuF,GAMR,GALAuB,EAAY,qBAAuBxS,KAAK6wB,aAAe,MAAQ5f,EAAIm3B,SAAWn3B,IAK1Eo3B,GAAY,CACXC,QAAQC,gBAAgBD,QAAQC,eAAe,iBAAkB,6EACrE,IAAIC,GAAeC,GAASzoC,KAAKmkC,UAAUE,cACvCqE,EAAQ1oC,KAAKmkC,UAAUwE,eAAiB,OAASC,GAAc33B,EAAIy3B,OAAS,EAChFJ,SAAQO,MAAM53B,EAAIjP,KAAO,KAAOiP,EAAIm3B,QAAU,OAASI,EAAeE,GAClEJ,QAAQC,gBAAgBD,QAAQQ,YAItC,GAAIb,GAAec,IAGnB,OAFA/oC,MAAKgpC,gBAAgBf,GAEdlN,GAGR8M,EAAYxnC,UAAUoI,aAAe,WACpCzI,KAAK8G,OAAQ,EAEb9G,KAAKujC,KAAK7gC,QAAQ8gC,IAClBxjC,KAAKuE,SAAS7B,QAAQ8gC,IACtBxjC,KAAKyjC,oBAGNoE,EAAYxnC,UAAUmM,QAAU,SAAiBF,GAChD,GAAY9J,SAAR8J,GAA6B,KAARA,EAAY,MAAOtM,KAE5C,KAAKA,KAAK0jC,WAAWjM,eAAenrB,GAAM,CACzC,GAAIq3B,GAAQ,GAAIT,IAAiBljC,KAAMsM,EACvCtM,MAAKuE,SAASzC,KAAK6hC,GACnB3jC,KAAK0jC,WAAWp3B,GAAOq3B,EAGxB,MAAO3jC,MAAK0jC,WAAWp3B,IAGxBu7B,EAAYxnC,UAAUkkC,KAAO,WAC5BvkC,KAAKyI,gBAGNo/B,EAAYxnC,UAAUwY,IAAM,SAAa/U,GACxC,IAAK9D,KAAKmkC,UAAU4D,OACnB,KAAM,IAAI3yB,OAAM,wCAA2CpV,KAAKsM,IAAM,IAGvEtM,MAAKmkC,UAAU4D,OAAOjkC,IAGvB+jC,EAAYxnC,UAAU2oC,gBAAkB,SAAyBf,GAGhE,IADA,GAAIrjC,GAAI5E,KAAKioC,aAAapjC,OACnBD,KAAK,CACX,GAAI9D,GAAQd,KAAKioC,aAAarjC,IACvBqjC,EAAa79B,QAAQtJ,IAAQA,EAAM6H,WAAW3I,MAKtD,IADA4E,EAAIqjC,EAAapjC,OACVD,KAAK,CACX,GAAIqkC,GAAShB,EAAarjC,IACnB5E,KAAKioC,aAAa79B,QAAQ6+B,IAASA,EAAO5gC,SAASrI,MAG3DA,KAAKioC,aAAeA,GAGrBJ,EAAYxnC,UAAU4Y,SAAW,WAEhC,IADA,GAAIrU,GAAI5E,KAAKioC,aAAapjC,OACnBD,KACF5E,KAAKioC,aAAarjC,IAAI5E,KAAKioC,aAAarjC,GAAG+D,WAAW3I,KAEvDA,MAAK44B,KAAKsQ,aAAalpC,KAAKsM,OAAStM,YAAaA,MAAK44B,KAAKsQ,aAAalpC,KAAKsM,KAClF62B,EAAO9iC,UAAU4Y,SAASzR,KAAKxH,OAGzB6nC,GACNjE,IAEEuF,GAAe,SAAUhG,GAG5B,QAASgG,GAAaxoC,GACrByG,GAAaC,eAAerH,KAAMmpC,EAElC,IAAI7hC,GAAQF,GAAaG,0BAA0BvH,KAAMmjC,EAAO37B,KAAKxH,KAAM,KAAM,IAQjF,OANAsH,GAAMxD,MAAQnD,EACd2G,EAAM2H,QAAS,EACf3H,EAAMsxB,KAAOtxB,EACbA,EAAMwU,YACNxU,EAAM3G,QAAUA,EAChB2G,EAAM8hC,WACC9hC,EAOR,MApBAF,IAAaM,SAASyhC,EAAchG,GAgBpCgG,EAAa9oC,UAAUwwB,WAAa,WACnC,MAAO,YAGDsY,GACNvF,IAEEyF,GAAYj9B,OAAO/L,UAAUo3B,eAE7B6R,GAAY,SAAUnG,GAGzB,QAASmG,GAAUniC,GAClBC,GAAaC,eAAerH,KAAMspC,EAKlC,IAAIhiC,GAAQF,GAAaG,0BAA0BvH,KAAMmjC,EAAO37B,KAAKxH,KAAM,KAAM,MAgBjF,OAdAsH,GAAM8hC,WAEN9hC,EAAM2H,QAAS,EACf3H,EAAMsxB,KAAOtxB,EACbA,EAAM3G,QAAUwG,EAAQxG,QAExB2G,EAAMxD,MAAQqD,EAAQsC,KACtBnC,EAAMwU,SAAW3U,EAAQ83B,MACzB33B,EAAM23B,QAEN33B,EAAM0V,YAEN1V,EAAM0gC,mBAAqB7gC,EAAQxG,QACnC2G,EAAM4hC,gBACC5hC,EAuJR,MA/KAF,IAAaM,SAAS4hC,EAAWnG,GA2BjCmG,EAAUjpC,UAAUkpC,aAAe,WAIlC,MAHAvpC,MAAKwpC,eACLxpC,KAAKypC,QAEEzpC,KAAKwpC,aAGbF,EAAUjpC,UAAUikC,QAAU,SAAiBh4B,EAAK63B,GACnD,GAAIJ,GAAc,GAAI8D,IAAY7nC,KAAMmkC,EAAW73B,EAGnD,OAFAtM,MAAKkpC,aAAa58B,GAAOy3B,EAElBA,GAGRuF,EAAUjpC,UAAUqpC,eAAiB,SAAwB3X,GAC5D,GAAI/U,GAAWhd,KAAKgd,QACpB5Q,QAAOC,KAAK2Q,GAAUta,QAAQ,SAAU4J,GACvCylB,EAAGzlB,EAAK0Q,EAAS1Q,KAGlB,IAAI48B,GAAelpC,KAAKkpC,YACxB98B,QAAOC,KAAK68B,GAAcxmC,QAAQ,SAAU4J,GAC3C,GAAIy3B,GAAcmF,EAAa58B,EAE1By3B,GAAY+D,cAChB/V,EAAGzlB,EAAKy3B,MAKXuF,EAAUjpC,UAAU+H,IAAM,SAAag7B,GAClCA,GAAeC,GAAQrjC,KAC3B,IAAI+6B,GAASvgB,KAAcxa,KAAK8D,MAMhC,OAJA9D,MAAK0pC,eAAe,SAAUp9B,EAAKxL,GAClCi6B,EAAOzuB,GAAOxL,EAAMgD,QAGdi3B,GAGRuO,EAAUjpC,UAAUwwB,WAAa,WAChC,MAAO,IAGRyY,EAAUjpC,UAAUspC,gBAAkB,WACrC,MAAO3pC,MAAK4pC,eAAiB5pC,KAAK4pC,aAAe,GAAIT,IAAanpC,KAAKW,WAGxE2oC,EAAUjpC,UAAUwpC,iBAAmB,WACtC,GAAItlC,GAAW4+B,EAAO9iC,UAAUwpC,iBAAiBriC,KAAKxH,KAAMA,KAAK8D,MAMjE,OAJA9D,MAAK0pC,eAAe,SAAUp9B,EAAKxL,GAClCyD,EAASzC,KAAKhB,KAGRyD,GAGR+kC,EAAUjpC,UAAUoI,aAAe,WAClCzI,KAAKujC,KAAK7gC,QAAQ8gC,KAGnB8F,EAAUjpC,UAAUypC,IAAM,SAAax9B,GACtC,GAAIA,IAAOtM,MAAKgd,UAAY1Q,IAAOtM,MAAKkpC,aAAc,OAAO,CAE7D,IAAIplC,GAAQ9D,KAAK8D,KAGjB,IADAwI,EAAM+O,EAAY/O,GACd+8B,GAAU7hC,KAAK1D,EAAOwI,GAAM,OAAO,CAIvC,KADA,GAAIqO,GAAc7W,EAAM6W,YACjBA,IAAgBovB,UAAYpvB,IAAgBN,OAASM,IAAgBvO,QAAQ,CACnF,GAAIi9B,GAAU7hC,KAAKmT,EAAYta,UAAWiM,GAAM,OAAO,CACvDqO,GAAcA,EAAYA,YAG3B,OAAO,GAGR2uB,EAAUjpC,UAAUmM,QAAU,SAAiBF,GAC9C,MAAY,YAARA,EAA0B09B,GAClB,aAAR19B,EAA2BtM,KAAK2pC,kBAE7B3pC,KAAKgd,SAASya,eAAenrB,GAAOtM,KAAKgd,SAAS1Q,GAAOtM,KAAKkpC,aAAazR,eAAenrB,GAAOtM,KAAKkpC,aAAa58B,GAAO62B,EAAO9iC,UAAUmM,QAAQhF,KAAKxH,KAAMsM,IAGtKg9B,EAAUjpC,UAAU8D,IAAM,SAAamY,EAAU2tB,GAEhDjqC,KAAKgd,SAASV,GAAY2tB,EAC1BA,EAAO5hC,SAASrI,OAGjBspC,EAAUjpC,UAAUwY,IAAM,SAAa/U,GAEtC,GAAIomC,GAAUlqC,KAAKkqC,OACnB,IAAIA,EAAS,CACZ,GAAIC,IAAkBD,EAAQn8B,OAASm8B,EAAQn8B,MAAMjK,MAAW,CAE5DqmC,KACHD,EAAQjxB,WACRjZ,KAAKkqC,QAAU,KACflqC,KAAK8D,MAAQA,EACb9D,KAAKi/B,aAGNj/B,MAAK8D,MAAQA,EACb9D,KAAKi/B,OAGNj/B,MAAKujC,KAAK7gC,QAAQ8gC,IAClBxjC,KAAKuE,SAAS7B,QAAQ6hC,IACtBvkC,KAAKyjC,oBAGN6F,EAAUjpC,UAAUmkC,SAAW,WAC9B,MAAOxkC,MAAK8D,OAGbwlC,EAAUjpC,UAAU4Y,SAAW,WAG9B,IAFA,GAAI5M,GAAOD,OAAOC,KAAKrM,KAAKgd,UACxBpY,EAAIyH,EAAKxH,OACND,KACF5E,KAAKgd,SAAS3Q,EAAKzH,KAAK5E,KAAKgd,SAAS3Q,EAAKzH,IAAI+D,WAAW3I,KAG/DmjC,GAAO9iC,UAAU4Y,SAASzR,KAAKxH,OAGhCspC,EAAUjpC,UAAUwG,OAAS,aAI7ByiC,EAAUjpC,UAAU+pC,mBAAqB,SAA4BC,GACpE,GAAInnC,GAASlD,IAEbmjC,GAAO9iC,UAAU+pC,mBAAmB5iC,KAAKxH,KAAMqqC,GAE3CA,GAEHj+B,OAAOC,KAAKrM,KAAKgd,UAAUta,QAAQ,SAAU4J,GAC5C,GAAIxL,GAAQoC,EAAO8Z,SAAS1Q,EAC5BxL,GAAMspC,mBAAmBC,MAKrBf,GACN1F,IAiDE0G,GAAgB,GAAIh0B,IAAK,aAEzBi0B,IAAmB,WAAY,aAAc,aAAc,SAAU,SAAU,gBAAiB,WAAY,eAE5GC,GAAM,EAkJNC,GAAY,WACf,QAASA,GAAUltB,GAClBnW,GAAaC,eAAerH,KAAMyqC,GAElCzqC,KAAK0qC,KAAO,GAAIp0B,IAAKiH,GACrBvd,KAAK2qC,aACL3qC,KAAK4qC,SAuBN,MApBAH,GAAUpqC,UAAUwqC,MAAQ,SAAelqC,GAC1CX,KAAK2qC,UAAUhqC,EAAQ+U,QAAS,GAGjC+0B,EAAUpqC,UAAUyc,IAAM,SAAanc,GACtC,GAAIsJ,GAAStJ,EAAQsJ,MAIhBA,IAAWjK,KAAK2qC,UAAU1gC,EAAOyL,OAKpCo1B,GAAc9qC,KAAK4qC,MAAO3gC,GAAQnI,KAAKnB,GAJxC4W,GAAKvX,KAAMW,SAOLX,MAAK2qC,UAAUhqC,EAAQ+U,QAGxB+0B,KAGJM,GAAa,GAAIz0B,IAAK,UACtB00B,GAAW,GAAIP,IAAU,QA6DzBQ,GAAoB,MACxBnE,IAAa,SAAoBsB,GAChCpoC,KAAKgC,KAAO,aACZhC,KAAKooC,QAAUA,CACf,KACC,KAAM,IAAIhzB,OAAMgzB,GACf,MAAO3kC,GACRzD,KAAK0oC,MAAQjlC,EAAEilC,QAIjB5B,GAAWzmC,UAAY+U,MAAM/U,UAE7BwmC,GAAS,SAAgB9gC,EAAKoB,GAC7B,GAAIyN,GACAK,EACAi2B,EAAY,CAmBhB,KAjBAlrC,KAAK+F,IAAMA,EACX/F,KAAKmH,QAAUA,MACfnH,KAAKu2B,IAAM,EAEXv2B,KAAKmrC,MAAQnrC,KAAK+F,IAAIoG,MAAM,MAC5BnM,KAAKorC,SAAWprC,KAAKmrC,MAAMhnC,IAAI,SAAUknC,GACxC,GAAIC,GAAUJ,EAAYG,EAAKxmC,OAAS,CAGxC,OADAqmC,GAAYI,EACLA,GACL,GAGCtrC,KAAK08B,MAAM18B,KAAK08B,KAAK32B,EAAKoB,GAE9ByN,KAEO5U,KAAKu2B,IAAMv2B,KAAK+F,IAAIlB,SAAWoQ,EAAOjV,KAAKurC,SACjD32B,EAAM9S,KAAKmT,EAGZjV,MAAKwrC,SAAWxrC,KAAKyrC,YACrBzrC,KAAK+6B,OAAS/6B,KAAK0rC,YAAc1rC,KAAK0rC,YAAY92B,EAAOzN,GAAWyN,GAGrEiyB,GAAOxmC,WACNkrC,KAAM,SAAcI,GACnB,GAAIpV,GAAK3xB,EAAGiI,EAAKoI,CAOjB,KALK02B,IAAYA,EAAa3rC,KAAK2rC,YAEnCpV,EAAMv2B,KAAKu2B,IAEX1pB,EAAM8+B,EAAW9mC,OACZD,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAGzB,GAFA5E,KAAKu2B,IAAMA,EAEPthB,EAAO02B,EAAW/mC,GAAG5E,MACxB,MAAOiV,EAIT,OAAO,OAGR22B,WAAY,SAAoBC,GAK/B,IAJA,GAEIC,GAFAC,EAAU,EACVb,EAAY,EAGTW,GAAQ7rC,KAAKorC,SAASW,IAC5Bb,EAAYlrC,KAAKorC,SAASW,GAC1BA,GAAW,CAIZ,OADAD,GAAYD,EAAOX,GACXa,EAAU,EAAGD,EAAY,EAAGD,IAGrChD,MAAO,QAASA,IAAMT,GACrB,GAAI7R,GAAMv2B,KAAK4rC,WAAW5rC,KAAKu2B,KAC3BwV,EAAUxV,EAAI,GACduV,EAAYvV,EAAI,GAEhB8U,EAAOrrC,KAAKmrC,MAAM5U,EAAI,GAAK,GAC3ByV,EAAU,EACVC,EAAaZ,EAAKva,QAAQ,MAAO,SAAUoT,EAAO2H,GAKrD,MAJIA,GAAOtV,EAAI,KACdyV,GAAW,GAGL,OACH,KAAO,GAAI3xB,OAAMkc,EAAI,GAAKyV,GAAS3nC,KAAK,KAAO,QAEhDwkC,GAAQ,GAAI/B,IAAWsB,EAAU,YAAc2D,EAAU,cAAgBD,EAAY,MAAQG,EAMjG,MAJApD,IAAMwC,KAAO9U,EAAI,GACjBsS,GAAMqD,UAAY3V,EAAI,GACtBsS,GAAMsD,aAAe/D,EAEfS,IAGPuD,YAAa,SAAqB5iC,GACjC,MAAIxJ,MAAK+F,IAAIsmC,OAAOrsC,KAAKu2B,IAAK/sB,EAAO3E,UAAY2E,GAChDxJ,KAAKu2B,KAAO/sB,EAAO3E,OACZ2E,GAFR,QAMD8iC,aAAc,SAAsBvP,GACnC,GAAImH,EAEJ,QAAIA,EAAQnH,EAAQ7G,KAAKl2B,KAAKyrC,eAC7BzrC,KAAKu2B,KAAO2N,EAAM,GAAGr/B,OACdq/B,EAAM,IAAMA,EAAM,IAF1B,QAMDqI,gBAAiB,WAChBvsC,KAAKssC,aAAarB,KAGnBQ,UAAW,WACV,MAAOzrC,MAAK+F,IAAIutB,UAAUtzB,KAAKu2B,MAGhCiW,SAAU,WACT,MAAOxsC,MAAK+F,IAAIstB,OAAOrzB,KAAKu2B,OAI9BsQ,GAAO7rB,OAAS,SAAUtE,GACzB,GACI+1B,GACAngC,EAFA0yB,EAASh/B,IAIbysC,GAAQ,SAAe1mC,EAAKoB,GAC3B0/B,GAAOr/B,KAAKxH,KAAM+F,EAAKoB,IAGxBslC,EAAMpsC,UAAY+/B,GAAOpB,EAAO3+B,UAEhC,KAAKiM,IAAOoK,GACPg2B,GAAOllC,KAAKkP,EAAOpK,KACtBmgC,EAAMpsC,UAAUiM,GAAOoK,EAAMpK,GAK/B,OADAmgC,GAAMzxB,OAAS6rB,GAAO7rB,OACfyxB,EAGR,IAEIE,IACAC,GACAC,GAJAC,GAAWjG,EAOf8F,IAAsB,sCAGtBC,GAAwB,8EAGxBC,GAA0B,wCAqC1B,IAAIE,IAAwBC,GAAwB,KAChDC,GAAwBD,GAAwB,KAuChDE,GAAkB,8FAelBlrC,GAAO,4BAEPmrC,GAAa,6BA4BbC,IACHC,QAAM,EACNC,SAAO,EACPC,OAAM,KACN/qC,UAAWA,QAGRgrC,GAAkB,GAAI9d,QAAO,OAAStjB,OAAOC,KAAK+gC,IAAU/oC,KAAK,KAAO,KACxEopC,GAAgB,8FAChBC,GAAqB,kBACrBC,GAA4B,kBAC5BC,GAAiB,QAEjBC,GAAaf,GAAS9xB,QACzB0hB,KAAM,SAAc32B,EAAKoB,GACxBnH,KAAKuV,OAASpO,EAAQoO,OACtBvV,KAAKusC,mBAENb,YAAa,SAAqB3Q,GACjC,MAAsB,KAAlBA,EAAOl2B,QAAiB+oC,GAAelsC,KAAK1B,KAAKwrC,WAI5C1nC,MAAOi3B,EAAO,GAAG3d,GAHlB,MAOTuuB,YAAa,SAAwBnL,GACpC,IAAKA,EAAOjrB,OAAQ,MAAO,KAE3B,IAAIu4B,GAActN,EAAO8L,aAAaqB,GAEtC,OAAIG,IAAetN,EAAOjrB,OAAOkiB,eAAeqW,IACtC1wB,EAAGojB,EAAOjrB,OAAOu4B,IAD3B,QAGE,SAAoBtN,GACtB,GAAIuN,GAAUvN,EAAO8L,aAAakB,GAClC,OAAIO,IAAkB3wB,EAAGgwB,GAASW,IAAlC,QACE,SAAmBvN,GACrB,GAAIwN,GAASxN,EAAO8L,aAAamB,GACjC,OAAIO,IAAiB5wB,GAAI4wB,GAAzB,QACE,SAAmBxN,GACrB,GAAIyN,GAAgBC,GAAkB1N,GAClCjrB,EAASirB,EAAOjrB,MAEpB,OAAI04B,IAAiB14B,GAEnB6H,EAAG6wB,EAAc7wB,EAAE0T,QAAQ4c,GAAoB,SAAUxJ,EAAOiK,GAC/D,MAAOA,KAAM54B,GAASA,EAAO44B,GAAMA,KAK/BF,GACL,SAAmBzN,GACrB,IAAKA,EAAO4L,YAAY,KAAM,MAAO,KAErC,IAAIrR,KAIJ,IAFAyF,EAAO+L,kBAEH/L,EAAO4L,YAAY,KACtB,OAAShvB,EAAG2d,EAIb,KADA,GAAIqT,GAAO,OACJA,EAAOC,GAAgB7N,IAAS,CAKtC,GAJAzF,EAAOqT,EAAK9hC,KAAO8hC,EAAKtqC,MAExB08B,EAAO+L,kBAEH/L,EAAO4L,YAAY,KACtB,OAAShvB,EAAG2d,EAGb,KAAKyF,EAAO4L,YAAY,KACvB,MAAO,MAIT,MAAO,OACL,SAAkB5L,GACpB,IAAKA,EAAO4L,YAAY,KAAM,MAAO,KAErC,IAAIrR,KAIJ,IAFAyF,EAAO+L,kBAEH/L,EAAO4L,YAAY,KACtB,OAAShvB,EAAG2d,EAIb,KADA,GAAIuT,GAAa,OACVA,EAAa9N,EAAO+K,QAAQ,CAKlC,GAJAxQ,EAAOj5B,KAAKwsC,EAAWlxB,GAEvBojB,EAAO+L,kBAEH/L,EAAO4L,YAAY,KACtB,OAAShvB,EAAG2d,EAGb,KAAKyF,EAAO4L,YAAY,KACvB,MAAO,KAGR5L,GAAO+L,kBAGR,MAAO,UAuDLgC,GAAe,qBACfC,GAAmB,qBACnBC,GAAoB,YAEpBhxB,GAAiB,WACpB,QAASA,GAAetS,EAAOoS,EAAOhd,GACrC6G,GAAaC,eAAerH,KAAMyd,GAElCzd,KAAKmL,MAAQA,EACbnL,KAAKud,MAAQA,EACbvd,KAAKO,SAAWA,EAEhBP,KAAKW,QAAUwK,EAAMnH,eAAerD,QACpCX,KAAKgE,eAAiBmH,EAAMnH,eAE5BhE,KAAK0L,QAAU,KACf1L,KAAK0uC,UAAW,EAGhB1uC,KAAKqlC,OAAS,KACdrlC,KAAKwU,UAAY,KACjBxU,KAAKm9B,OAAS,KACdn9B,KAAK2uC,OAAS,KAGd3uC,KAAK4uC,OAAS,KACd5uC,KAAK6xB,KAAO,KAsNb,MAnNApU,GAAepd,UAAUF,KAAO,WAC/B,GAAImH,GAAQtH,IAEZA,MAAK0L,QAAU1L,KAAKgE,eAAeqQ,aAEnC,IAAI9T,GAAWP,KAAKO,QAEhBA,GAASw7B,GACZ/7B,KAAKqlC,OAAS9kC,EAASw7B,EAGvB/7B,KAAK0uC,WAAanuC,EAASsuC,EAEvBtuC,EAASC,IACZR,KAAKwU,aACLxU,KAAKm9B,OAAS58B,EAASC,EAAEgI,EAAErE,IAAI,SAAU6/B,EAAKp/B,GAE7C,GAAI2pC,GAAa7sC,KAAKsiC,GAErB,OACCzmB,OAAO,EACPlR,KAAM23B,EAAIn/B,OAAS,EAAIiP,EAAckwB,EAAI72B,MAAM,OAC/CjH,OAAQorB,EAIV,IAAIwd,GAAWN,GAAiBtY,KAAK8N,EACrC,IAAI8K,EAEH,OACCC,UAAU,EACV/mC,MAAO8mC,EAAS,GAIlB,IAAIE,GAAcP,GAAkBvY,KAAK8N,EACzC,IAAIgL,EAEH,OACCD,UAAU,EACV/mC,MAAOgnC,EAAY,GAAK,EAI1B,IAAI1mC,GAAW,OAEXxH,EAAQmjC,GAAiB38B,EAAMtD,eAAgBggC,EAUnD,OATKljC,KACJwH,EAAWhB,EAAMtD,eAAeuE,QAAQy7B,EAAK,SAAUljC,GACtDwG,EAAM61B,OAAOv4B,GAAK9D,EAClB2J,EAAgBnD,EAAMkN,UAAWlM,KAGlChB,EAAMkN,UAAU1S,KAAKwG,IAGfxH,IAGRd,KAAK2uC,OAAS7K,GAAYvjC,EAASC,EAAE0H,EAAG3H,EAASC,EAAEgI,EAAE3D,WAItD7E,KAAK4uC,OAA6B,gBAAbruC,GACrBA,EAAiC,gBAAfA,GAAS+C,EAC3B/C,EAAS+C,EAAI,GAAI4H,KAChBC,MAAOnL,KACPO,SAAUA,EAAS+C,IAGpBtD,KAAK6xB,KAAOtxB,EAASC,EACC,gBAAfD,GAASC,GAAkBD,EAASC,GAAKD,EAASC,EAAID,EAASmxB,EACtE,GAAIxmB,KACHC,MAAOnL,KACPO,SAAUA,EAASmxB,QAIjB1xB,KAAKO,SAAS+C,GAAgC,gBAApBtD,MAAKO,SAAS+C,GAAgBtD,KAAK4uC,OAAOzuC,OACpEH,KAAKO,SAASmxB,GAAG1xB,KAAK6xB,KAAK1xB,QAGhCsd,EAAepd,UAAUqI,OAAS,WAC5B1I,KAAK8G,QACT9G,KAAK8G,OAAQ,EACb9G,KAAKmL,MAAMzC,WAIb+U,EAAepd,UAAUkX,KAAO,SAAcgG,GAC7C,GAAI0xB,GAAalmC,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,MAAwBA,UAAU,EAItF,IAAIwU,EAAO,CACV,GAAIrR,GAAOgjC,GAAWlvC,KAAKgE,eAC3BuZ,GAAM+a,QAAUt4B,KAAK0L,QAAQmlB,WAAW7wB,KAAKW,SAC7C4c,EAAM4xB,SAAWnvC,KAAK0L,QAAQmlB,aAC9BtT,EAAM7R,QAAU1L,KAAK0L,QAAQtD,MAC7BmV,EAAMvV,MAAQkE,EAAKlE,MACnBuV,EAAMjR,IAAMJ,EAAKI,IAGlB,GAAItM,KAAKqlC,OAAQ,CAChB,GAAyC,kBAA9BrlC,MAAKW,QAAQX,KAAKqlC,QAC5B,KAAM,IAAIjwB,OAAM,6CAA+CpV,KAAKqlC,OAAS,KAG9E,IAAIxT,GAAO,MAIX,IAFItU,GAAO0xB,EAAWz4B,QAAQ+G,GAE1Bvd,KAAKm9B,OAAQ,CAChB,GAAI5nB,GAASvV,KAAKm9B,OAAOh5B,IAAI,SAAUrD,GACtC,GAAKA,EAAL,CAEA,GAAIA,EAAMyc,MAAO,CAIhB,IAHA,GAAI6xB,GAAM7xB,EACNlR,EAAOvL,EAAMuL,KAAKc,QAEfd,EAAKxH,QACXuqC,EAAMA,EAAI/iC,EAAK9I,QACf,OAAO6rC,GAGT,MAAItuC,GAAMiuC,SACFE,EAAaA,EAAWnuC,EAAMkH,OAAS,OAG3ClH,EAAMopC,QACFppC,EAAMopC,QAAQpmC,MAGfhD,EAAMsH,QAGdypB,GAAO7xB,KAAK2uC,OAAO7lC,MAAM,KAAMyM,GAG5BvV,KAAK0uC,WACR7c,EAAOA,EAAOA,EAAKM,OAAO8c,GAAcA,EAIzC,IAAItuC,GAAUX,KAAKW,QACf0uC,EAAW1uC,EAAQ4c,KAEvB5c,GAAQ4c,MAAQA,CAChB,IAAIwd,GAASp6B,EAAQX,KAAKqlC,QAAQv8B,MAAMnI,EAASkxB,GAG7Ca,EAAW,MACXqI,MAAW,IAAUrI,EAAWnV,EAAMmV,YACzCA,EAAS4c,gBAAkB5c,EAAS4c,iBACpC5c,EAAS6c,iBAAmB7c,EAAS6c,mBAGtC5uC,EAAQ4c,MAAQ8xB,MACV,CACN,GAAIT,GAAS5uC,KAAK4uC,OAAOnpC,WACrB+pC,EAAQxvC,KAAKO,SAASmxB,EAAI1xB,KAAK6xB,KAAKvc,cAAgBtV,KAAK6xB,IAEzDod,GAAWpqC,SAAQ2qC,EAAQA,EAAMrd,OAAO8c,IAExC1xB,IAAOA,EAAMvb,KAAO4sC,GAExBa,GAAUzvC,KAAKW,QAASiuC,GACvBrxB,MAAOA,EACPsU,KAAM2d,MAKT/xB,EAAepd,UAAUoC,OAAS,WACjCzC,KAAKkG,SACLlG,KAAKG,QAGNsd,EAAepd,UAAU0C,OAAS,WACjC/C,KAAKud,MAAMiV,OAAOxyB,OAGnByd,EAAepd,UAAU6F,OAAS,WACjC,GAAI3F,GAAWP,KAAKO,QAEhBA,GAASw7B,GACR/7B,KAAKwU,WAAWxU,KAAKwU,UAAU9R,QAAQyD,IAC3CnG,KAAKwU,aAELxU,KAAKm9B,OAAS,OAGVn9B,KAAK4uC,OAAO1oC,QAAQlG,KAAK4uC,OAAO1oC,SAChClG,KAAK6xB,KAAK3rB,QAAQlG,KAAK6xB,KAAK3rB,WAIlCuX,EAAepd,UAAUY,SAAW,WACnCjB,KAAKud,MAAMoV,YAGZlV,EAAepd,UAAUwG,OAAS,YAC7B7G,KAAKqlC,QAAWrlC,KAAK8G,QAEzB9G,KAAK8G,OAAQ,EAGT9G,KAAK4uC,OAAO/nC,QAAQ7G,KAAK4uC,OAAO/nC,SAChC7G,KAAKO,SAASmxB,GAAG1xB,KAAK6xB,KAAKhrB,WAGzB4W,KAGJD,GAAe,WAClB,QAASA,GAAa7c,EAASqB,GAC9BoF,GAAaC,eAAerH,KAAMwd,GAElCxd,KAAKW,QAAUA,EACfX,KAAKgC,KAAOA,EACZhC,KAAKuyB,QAAU,KA2BhB,MAxBA/U,GAAand,UAAUmyB,OAAS,SAAgBC,GAC/C,GAAI9xB,GAAUX,KAAKW,OAEnBX,MAAKuyB,QAAU5xB,EAAQyX,GAAGpY,KAAKgC,KAAM,WACpC,GAAIub,GAAQ,MAGRxU,WAAUlE,QAAUkE,UAAU,IAAMA,UAAU,GAAG5H,OACpDoc,EAAQlD,MAAMha,UAAUkD,MAAMiE,KAAKuB,WACnCwU,EAAMpL,UAAYxR,EAGnB,IAAIkxB,GAAOxX,MAAMha,UAAU8M,MAAM3F,KAAKuB,UAItC,OAHA0pB,GAAUlb,KAAKgG,EAAOsU,IAGf,KAITrU,EAAand,UAAUsyB,SAAW,WACjC3yB,KAAKuyB,QAAQ5U,UAGPH,KAyCJQ,GAAe,GAAI1H,IAAK,YAExBsG,GAAY,SAAU7U,GAGzB,QAAS6U,GAAUzV,EAASuoC,GAC3BtoC,GAAaC,eAAerH,KAAM4c,EAElC,IAAItV,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAE1EG,GAAMqJ,KAAOmyB,EAEb,IAAIvmB,GAAW6jB,GAAOsP,EAAqBrvC,UAE3CiH,GAAMiV,SAAWA,EACjBjV,EAAMtF,KAAOmF,EAAQ5G,SAASkD,EAC9B6D,EAAMtD,eAAiBmD,EAAQnD,eAC/BsD,EAAMmV,mBAENnV,EAAMzF,eAEF0a,EAASpH,IACZ3C,EAAY,QAAUlL,EAAMtF,KAAO,mEAGpC,IAAIyQ,GAAWtL,EAAQ5G,SAASihC,KAC1B,YAAa/uB,KAAWA,EAASk9B,QAAUxoC,EAAQ5G,SAASuJ,OAClExC,EAAMqV,UAAYlK,EAElBnL,EAAM+K,WAKN,KAFA,GAAI9Q,GAAW4F,EAAQnD,eACnBkO,EAAY,OACT3Q,GAAU,CAChB,GAAIA,EAAS4J,MAAMwF,OAASwC,GAAS,CACpCjB,EAAY3Q,EAAS4J,MAAM+G,SAC3B,OAGD3Q,EAAWA,EAAS0I,OAkBrB,MAdAsS,GAAStS,OAAS3C,EAAMtD,eAAerD,QACvC4b,EAASrK,UAAYA,GAAa,KAClCqK,EAASqc,KAAOrc,EAAStS,OAAO2uB,KAChCrc,EAASpK,UAAY7K,EAErBsoC,GAAUtoC,EAAMiV,UAAY9J,SAAUA,IAKtC8J,EAASjK,gBAAkBG,EAE3BnL,EAAMzE,iBACFyE,EAAM/G,SAAS6c,GAAG9V,EAAM4V,cACrB5V,EAkOR,MAzRAF,IAAaM,SAASkV,EAAW7U,GA0DjC6U,EAAUvc,UAAUF,KAAO,WAC1B,GAAI+C,GAASlD,KAETqc,EAAYrc,KAAKuc,SAASF,UAC1BG,EAAYH,EAAUvY,KAGtB9D,MAAKO,SAASC,GACjB4L,OAAOC,KAAKrM,KAAKO,SAASC,GAAGkC,QAAQ,SAAU4Z,GAC9C,GAAI/b,GAAW2C,EAAO3C,SAASC,EAAE8b,GAC7Bxb,EAAQ,OACRS,EAAW,MAEf,IAAiB,IAAbhB,EAEH8b,EAAU7P,QAAQ8P,GAAUzD,KAAI,OAC1B,IAAwB,gBAAbtY,GAAuB;AACxC,GAAIoV,GAASC,GAAUrV,EACvB8b,GAAU7P,QAAQ8P,GAAUzD,IAAIlD,EAASA,EAAO7R,MAAQvD,OAC9CiK,GAAQjK,KACM,IAApBA,EAASsE,QAAgBtE,EAAS,GAAGyK,IAAM+H,IAC9CjS,EAAQqH,GAAUjF,EAAOc,eAAgBzD,EAAS,IAE7CO,IACJyK,EAAgB,OAAS+Q,EAAW,OAAU/b,EAAS,GAAGiI,EAAI,0HAA6H7H,QAASuC,EAAOqZ,WAC3MrZ,EAAOc,eAAerD,QAAQyH,IAAIkU,GAClCxb,EAAQoC,EAAOc,eAAeqQ,cAAc7H,QAAQ8P,IAGrDD,EAAUlY,IAAImY,EAAUxb,GAEJ0B,SAAhB1B,EAAMsH,OAAuBkU,IAAYE,IAC5C1b,EAAM+X,IAAI2D,EAAUF,MAGrB/a,EAAW,GAAI2J,KACdC,MAAOjI,EACP3C,SAAUA,IACRJ,OAEHW,EAAQub,EAAU7P,QAAQ8P,GAC1Bxb,EAAM+X,IAAItX,EAASmI,WAGnBnI,EAASmH,OAAS,WACjBwC,GAAS7K,UAAUqI,OAAOlB,KAAKjG,GAC/BA,EAASsF,SACT/F,EAAM+X,IAAItX,EAASmI,YAGpBxG,EAAOuZ,gBAAgB3a,KAAKP,OAMhCmb,GAAW1c,KAAKuc,UACf9J,SAAUzS,KAAK2c,YAEf1Y,OAAQjE,KAAKgE,eAAeC,SAG7BjE,KAAK6C,cAAcH,QAAQmS,KAG5B+H,EAAUvc,UAAUqI,OAAS,WACvB1I,KAAK8G,QACT9G,KAAK8G,OAAQ,EACb9G,KAAKgE,eAAe0E,WAItBkU,EAAUvc,UAAUwc,cAAgB,WACnC,GAAI3P,GAASlN,IAEboM,QAAOC,KAAKrM,KAAKqS,UAAU3P,QAAQ,SAAUV,GAC5C,GAAIkL,EAAOmF,SAASrQ,GAAM6C,OAAS,EAElC,KADAG,IAAQ8X,MACF,GAAI1H,OAAM,kDAAoDpT,EAAO,IAAMA,EAAO,IAAM,+BAKjG4a,EAAUvc,UAAUU,OAAS,WAC5B,MAAOf,MAAKuc,SAAShb,SAASR,UAG/B6b,EAAUvc,UAAUe,KAAO,SAAcC,GACxC,MAAOrB,MAAKuc,SAAShb,SAASH,KAAKC,IAGpCub,EAAUvc,UAAUmB,QAAU,SAAiBH,EAAUI,GACxDzB,KAAKuc,SAAShb,SAASC,QAAQH,EAAUI,IAG1Cmb,EAAUvc,UAAU0B,cAAgB,SAAuBC,GAC1D,MAAKA,IAAQhC,KAAKgC,OAASA,EAEvBhC,KAAKuc,SAAShb,SACVvB,KAAKuc,SAAShb,SAASQ,cAAcC,GAD7C,OAFwChC,KAAKuc,UAO9CK,EAAUvc,UAAU4B,kBAAoB,SAA2BD,EAAMP,GACpEA,EAAMC,KAAK1B,QACdyB,EAAME,IAAI3B,KAAKuc,UAEX9a,EAAMG,MACT5B,KAAK6B,YAAYC,KAAKL,IAIxBzB,KAAKuc,SAAShb,SAASU,kBAAkBD,EAAMP,IAGhDmb,EAAUvc,UAAU8B,UAAY,SAAmBkJ,GAClD,MAAOrL,MAAKuc,SAAShb,SAASY,UAAUkJ,IAGzCuR,EAAUvc,UAAUoC,OAAS,WAC5B,GAAIgL,GAASzN,IAEbA,MAAKyc,gBAAgB/Z,QAAQC,IAE7B3C,KAAK6B,YAAYa,QAAQqa,GAGzB,IAAIV,GAAYrc,KAAKuc,SAASF,SAC9BA,GAAUW,YAENhd,KAAKO,SAASC,GACjB4L,OAAOC,KAAKrM,KAAKO,SAASC,GAAGkC,QAAQ,SAAU4Z,GAC9C,GAAI/b,GAAWkN,EAAOlN,SAASC,EAAE8b,GAC7Bxb,EAAQ,MAER0J,GAAQjK,IAAiC,IAApBA,EAASsE,QAAgBtE,EAAS,GAAGyK,IAAM+H,KACnEjS,EAAQqH,GAAUsF,EAAOzJ,eAAgBzD,EAAS,IAE7CO,IAEJyK,EAAgB,OAAS+Q,EAAW,OAAU/b,EAAS,GAAGiI,EAAI,0HAA6H7H,QAAS8M,EAAO8O,WAC3M9O,EAAOzJ,eAAerD,QAAQyH,IAAIkU,GAClCxb,EAAQ2M,EAAOzJ,eAAeqQ,cAAc7H,QAAQ8P,IAGrDD,EAAUlY,IAAImY,EAAUxb,MAK3Bd,KAAKuc,SAAShb,SAASkB,OAAO4Z,IAG/BO,EAAUvc,UAAU0C,OAAS,SAAkBC,EAAQC,GACtDF,GAAO/C,KAAKuc,SAAUvZ,EAAQ,KAAMC,GAEpCjD,KAAK6c,gBACL7c,KAAK6C,cAAcH,QAAQqC,IAC3BkY,GAAkBjd,MAElBA,KAAKwF,UAAW,GAGjBoX,EAAUvc,UAAU6c,YAAc,WACjC,GAAI7O,GAASrO,KAETmd,EAAWnd,KAAK6C,aAEpBuJ,QAAOC,KAAKrM,KAAKO,SAAS6c,GAAG1a,QAAQ,SAAU4J,GAC9C,GAAI+Q,GAAa/Q,EAAIH,MAAM,KACvB5L,EAAW8N,EAAO9N,SAAS6c,EAAE9Q,EAEjC+Q,GAAW3a,QAAQ,SAAU4a,GAC5B,GAAIC,GAAQ,GAAIC,IAAanP,EAAOkO,SAAUe,EAC9CH,GAASrb,KAAK,GAAI2b,IAAepP,EAAQkP,EAAOhd,SAKnDqc,EAAUvc,UAAUoF,SAAW,WAC9B,MAAOzF,MAAKuc,SAAS/C,UAGtBoD,EAAUvc,UAAU6F,OAAS,WAC5BlG,KAAKyc,gBAAgB/Z,QAAQyD,GAE7B,IAAIoW,GAAWvc,KAAKuc,QACpBA,GAASF,UAAUpD,WACnBsD,EAAShb,SAAS2E,SAClBqW,EAASmB,WAAWhb,QAAQib,IAE5BC,GAA+B5d,MAE3Buc,EAAShb,SAASiE,UAAY+W,EAASpH,GAAG0I,uBAC7CpT,EAAgB8R,EAASpH,GAAG0I,sBAAuBtB,GAGpDnQ,OAAOC,KAAKkQ,EAASuB,QAAQpb,QAAQ,SAAUqb,GAC9C,MAAOxB,GAASuB,OAAOC,GAAGpE,WAG3BqE,GAAazG,KAAKgF,IAGnBK,EAAUvc,UAAUY,SAAW,SAAkBmF,GAChD,GAAI6X,GAASje,IAEbA,MAAKoG,cAAgBA,EACrBpG,KAAKuc,SAAStb,WACdjB,KAAK6C,cAAcH,QAAQ8D,IAC3BxG,KAAK6B,YAAYa,QAAQ,SAAUjB,GAClC,MAAOA,GAAMyc,OAAOD,EAAO1B,aAI7BK,EAAUvc,UAAUwG,OAAS,WAC5B7G,KAAK8G,OAAQ,EACb9G,KAAKuc,SAAShb,SAASsF,SACvB7G,KAAK6c,gBACL7c,KAAK6C,cAAcH,QAAQqE,IAC3B/G,KAAKyc,gBAAgB/Z,QAAQqE,KAGvB6V,GACN5V,IAEE8L,GAAU,SAAU/K,GAGvB,QAAS+K,KAER,MADA1L,IAAaC,eAAerH,KAAM8S,GAC3B1L,GAAaG,0BAA0BvH,KAAM+H,EAAMe,MAAM9I,KAAM+I,YA2BvE,MA/BA3B,IAAaM,SAASoL,EAAS/K,GAO/B+K,EAAQzS,UAAUF,KAAO,aAIzB2S,EAAQzS,UAAU0C,OAAS,aAI3B+P,EAAQzS,UAAU4Y,SAAW,aAI7BnG,EAAQzS,UAAUoF,SAAW,WAC5B,MAAO,YAAczF,KAAKO,SAASC,EAAI,KAGxCsS,EAAQzS,UAAU6F,OAAS,aAI3B4M,EAAQzS,UAAUY,SAAW,aAItB6R,GACN9L,IAEEmX,IAAa3b,OAAW,OAAQ,SAAU,MAAO,QAAS,SAAU,WAAY,SAAU,QAAS,UAuNnG4b,IACHC,iBAAkB,gBAClBC,UAAW,YACXC,QAAS,UACTC,QAAO,YACPC,SAAU,WACVC,QAAS,UACTC,gBAAiB,kBACjBC,SAAU,WACVC,QAAS,UACTC,MAAK,UACLC,aAAc,YACdC,MAAO,QACPC,UAAW,YACXC,WAAY,aACZC,QAAS,UACTC,SAAU,WACVC,QAAS,UACTC,SAAU,WACVC,OAAQ,UAILC,GAAoB,4YACpBC,GAAmB,qGAEnBC,IAAiBC,KAAM,GAAIC,IAAK,GAAIC,KAAM,GAAIC,GAAI,GAAIC,GAAI,GAAIC,KAAM,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,IAAK,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,SAAU,IAAKC,MAAO,IAAKC,IAAK,IAAKC,KAAM,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,MAAO,KAAMC,KAAM,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,MAAO,KAAMC,QAAS,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,MAAO,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,KAAM,KAAMC,MAAO,KAAMC,GAAI,KAAMC,KAAM,KAAMC,IAAK,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,KAAM,KAAMC,MAAO,KAAMC,IAAK,KAAMC,IAAK,KAAMC,GAAI,KAAMC,IAAK,KAAMC,IAAK,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,IAAK,KAAMC,KAAM,KAAMC,MAAO,KAAMC,GAAI,KAAMC,MAAO,KAAMC,GAAI,KAAMC,GAAI,KAAMC,IAAK,KAAMC,IAAK,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,KAAM,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,KAAM,KAAMC,IAAK,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,MAAO,MAC/9FC,IAAqB,KAAM,IAAK,KAAM,IAAK,KAAM,KAAM,KAAM,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,IAAK,KACjMC,GAAgB,GAAIC,QAAO,0BAA4BtjB,OAAOC,KAAKqT,IAAcrb,KAAK,KAAO,OAAQ,KACrGsrB,GAAmD,kBAAzBxV,QAAOyV,cACjCC,GAAaF,GAAmBxV,OAAOyV,cAAgBzV,OAAO2V,aAuB9DC,GAAW,KACXC,GAAc,KACdpQ,GAAM,KACNqQ,GAAU,MAyEVC,GAAY,SAAUnoB,GAGzB,QAASmoB,GAAU/oB,GAClBC,GAAaC,eAAerH,KAAMkwB,EAElC,IAAI5oB,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GA0B1E,OAxBAG,GAAMtF,KAAOmF,EAAQnF,KACrBsF,EAAMnE,UAAY,KAClBmE,EAAM6oB,QAAUhpB,EAAQgpB,QACxB7oB,EAAMtD,eAAiBmD,EAAQgpB,QAAQnsB,eACvCsD,EAAM3G,QAAU2G,EAAMtD,eAAerD,QAErC2G,EAAM9B,UAAW,EACjB8B,EAAM8oB,eAAiB,KACvB9oB,EAAM/F,SAAW,KACjB+F,EAAMxD,MAAQ,KAET0G,EAAQrD,EAAQ5G,UAMpB+G,EAAM/F,SAAW,GAAI2J,KACpBC,MAAO7D,EACP/G,SAAU4G,EAAQ5G,YAPnB+G,EAAMxD,MAAQqD,EAAQ5G,SACF,IAAhB+G,EAAMxD,QACTwD,EAAMxD,MAAQ,KAShBwD,EAAM+oB,aAAe/oB,EAAM/F,UAA4C,IAAhC+F,EAAM/F,SAASqT,MAAM/P,QAAgByC,EAAM/F,SAASqT,MAAM,GAAGjE,OAASoC,IAAgBzL,EAAM/F,SAASqT,MAAM,GAC3ItN,EAsGR,MArIAF,IAAaM,SAASwoB,EAAWnoB,GAkCjCmoB,EAAU7vB,UAAUF,KAAO,WACtBH,KAAKuB,UACRvB,KAAKuB,SAASpB,QAIhB+vB,EAAU7vB,UAAUqI,OAAS,WACvB1I,KAAK8G,QACT9G,KAAKmwB,QAAQznB,SACb1I,KAAK8G,OAAQ,IAIfopB,EAAU7vB,UAAU2I,UAAY,WAC/B,MAAOhJ,MAAKuB,SAAWvB,KAAKuB,SAASkE,WAA2B,MAAdzF,KAAK8D,MAAgB,GAAK9D,KAAK8D,MAAQ,IAO1FosB,EAAU7vB,UAAUkC,SAAW,WAC9B,MAAOvC,MAAKuB,SAAWvB,KAAKuB,SAASmI,UAAY8V,GAAkB9d,KAAK1B,KAAKgC,OAAQ,EAAOhC,KAAK8D,OAGlGosB,EAAU7vB,UAAUoC,OAAS,WACxBzC,KAAKuB,UAAUvB,KAAKuB,SAASkB,UAGlCytB,EAAU7vB,UAAU0C,OAAS,WAC5B,GAAI5B,GAAOnB,KAAKmwB,QAAQhvB,IAsBxB,IArBAnB,KAAKmB,KAAOA,EAGPA,EAAKwC,cAAgBxC,EAAKwC,eAAiB2sB,GAAWxe,OAC1D9R,KAAKuwB,aAAenS,GAAcpe,KAAKgC,OAAShC,KAAKgC,KAErBQ,SAA5BrB,EAAKnB,KAAKuwB,gBACbvwB,KAAKwwB,aAAc,IAKhBhR,GAAkB9d,KAAK1B,KAAKgC,OAAShC,KAAKywB,YAC7CzwB,KAAK0wB,WAAY,GAGQ,UAAtB1wB,KAAKuwB,eACRpvB,EAAK+O,SAASpM,MAAQ9D,KAAK8D,QAIzB3C,EAAKwC,aAAc,CACtB,GAAIqE,GAAQhI,KAAKgC,KAAKoI,QAAQ,IAChB,MAAVpC,EACHhI,KAAKmD,UAAYwtB,GAAgBxvB,EAAMnB,KAAKgC,KAAKmL,MAAM,EAAGnF,IAE1DhI,KAAKmD,UAAYhC,EAAKwC,aAIxB3D,KAAKwF,UAAW,EAChBxF,KAAKowB,eAAiBQ,GAAkB5wB,MACxCA,KAAKowB,kBAGNF,EAAU7vB,UAAUoF,SAAW,WAC9B,GAAI3B,GAAQ9D,KAAKuC,UAGjB,IAAkB,UAAdvC,KAAKgC,MAAsEQ,SAAjDxC,KAAKmwB,QAAQ/tB,aAAa,oBAA0D,WAAtBpC,KAAKmwB,QAAQnuB,MAA2C,aAAtBhC,KAAKmwB,QAAQnuB,KAA3I,CAKA,GAAkB,SAAdhC,KAAKgC,MAAyC,UAAtBhC,KAAKmwB,QAAQnuB,MAAoBhC,KAAKqwB,cAAsD,UAAtCrwB,KAAKmwB,QAAQ/tB,aAAa,QAC3G,MAAO,WAAapC,KAAKqwB,aAAavvB,MAAM+vB,aAAe,KAG5D,IAAIrR,GAAkB9d,KAAK1B,KAAKgC,MAAO,MAAO8B,GAAQ9D,KAAKgC,KAAO,EAClE,IAAa,MAAT8B,EAAe,MAAO,EAE1B,IAAIiC,GAAMkD,EAAkBjJ,KAAKgJ,aAAa8nB,QAAQ,KAAM,SAASA,QAAQ,KAAM,UAAUA,QAAQ,KAAM,QAE3G,OAAO/qB,GAAM/F,KAAKgC,KAAO,KAAO+D,EAAM,IAAM/F,KAAKgC,OAGlDkuB,EAAU7vB,UAAU6F,OAAS,WACxBlG,KAAKuB,UAAUvB,KAAKuB,SAAS2E,UAGlCgqB,EAAU7vB,UAAUwG,OAAS,WACxB7G,KAAK8G,QACR9G,KAAK8G,OAAQ,EACT9G,KAAKuB,UAAUvB,KAAKuB,SAASsF,SAC7B7G,KAAKwF,UAAUxF,KAAKowB,mBAInBF,GACNlpB,IAEE+pB,GAAQ3nB,GAAMxF,GAAc,OAAS,KAErCotB,GAAuB,SAAUjpB,GAGpC,QAASipB,GAAqB7pB,GAC7BC,GAAaC,eAAerH,KAAMgxB,EAElC,IAAI1pB,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAa1E,OAXAG,GAAMhH,cAENgH,EAAM6D,MAAQhE,EAAQgE,MAEtB7D,EAAM/F,SAAW,GAAI2J,KACpBvK,QAAS2G,EAAM3G,QACfwK,MAAO7D,EACP/G,UAAW+G,EAAM/G,YAGlB+G,EAAMR,OAAQ,EACPQ,EAuER,MAzFAF,IAAaM,SAASspB,EAAsBjpB,GAqB5CipB,EAAqB3wB,UAAUF,KAAO,WACrCH,KAAKuB,SAASpB,QAGf6wB,EAAqB3wB,UAAUqI,OAAS,WAClC1I,KAAK8G,QACT9G,KAAK8G,OAAQ,EACb9G,KAAKmL,MAAMzC,WAIbsoB,EAAqB3wB,UAAUoC,OAAS,WACvCzC,KAAKuB,SAASkB,UAGfuuB,EAAqB3wB,UAAU0C,OAAS,WACvC/C,KAAKmB,KAAOnB,KAAKmL,MAAMhK,KACvBnB,KAAKixB,MAAQjxB,KAAKmB,KAAKwC,eAAiButB,GAExClxB,KAAKwF,UAAW,EAChBxF,KAAK8G,OAAQ,EACb9G,KAAK6G,UAGNmqB,EAAqB3wB,UAAUoF,SAAW,WACzC,MAAOzF,MAAKuB,SAASkE,YAGtBurB,EAAqB3wB,UAAU6F,OAAS,WACvClG,KAAKuB,SAAS2E,UAGf8qB,EAAqB3wB,UAAUY,SAAW,WACzCjB,KAAKwF,UAAW,GAGjBwrB,EAAqB3wB,UAAUwG,OAAS,WACvC,GAAI3D,GAASlD,KAET+F,EAAM,OACNJ,EAAQ,MAER3F,MAAK8G,QACR9G,KAAK8G,OAAQ,EAEb9G,KAAKuB,SAASsF,SAEV7G,KAAKwF,WACRO,EAAM/F,KAAKuB,SAASkE,WACpBE,EAAQwrB,GAAgBprB,EAAK/F,KAAKixB,OAIlCjxB,KAAKM,WAAWga,OAAO,SAAU9Z,GAChC,MAAO4wB,IAAMzrB,EAAOnF,KAClBkC,QAAQ,SAAUlC,GACpB0C,EAAO/B,KAAK2D,gBAAgBtE,EAAEwB,QAG/B2D,EAAMjD,QAAQ,SAAUlC,GACvB0C,EAAO/B,KAAK+C,aAAa1D,EAAEwB,KAAMxB,EAAEsD,SAGpC9D,KAAKM,WAAaqF,KAKdqrB,GACNhqB,IAmBEqqB,IACHxqB,OAAQyqB,EACRrY,SAAUqY,GAGPC,GAAY,WACf,QAASA,GAAUpmB,EAAO5K,GACzB6G,GAAaC,eAAerH,KAAMuxB,GAElCvxB,KAAKmL,MAAQA,EACbnL,KAAKO,SAAWA,EAEhBP,KAAKgE,eAAiBmH,EAAMnH,eAC5BhE,KAAKW,QAAUwK,EAAMxK,QAErBX,KAAKwxB,YAAkD,WAApCpqB,GAAAA,UAAoB7G,EAAS+C,GAChDtD,KAAKyxB,cAAgBlxB,EAASmxB,EAE1B1xB,KAAKwxB,YACRxxB,KAAK2xB,aAAe,GAAIzmB,KACvBC,MAAOnL,KACPO,SAAUA,EAAS+C,IAGpBtD,KAAKgC,KAAOzB,EAAS+C,GAAK/C,EAGvBP,KAAKyxB,YACRzxB,KAAK4xB,aAAe,GAAI1mB,KACvBC,MAAOnL,KACPO,SAAUA,EAASmxB,IAGpB1xB,KAAK6xB,KAAOtxB,EAASC,MAGtBR,KAAKmB,KAAO,KACZnB,KAAK8xB,aAAe,KA6FrB,MA1FAP,GAAUlxB,UAAUF,KAAO,WACtBH,KAAKwxB,cACRxxB,KAAK2xB,aAAaxxB,OAClBH,KAAKgC,KAAOhC,KAAK2xB,aAAalsB,YAG3BzF,KAAKyxB,aAAazxB,KAAK4xB,aAAazxB,QAGzCoxB,EAAUlxB,UAAUqI,OAAS,WACvB1I,KAAK8G,QACT9G,KAAK8G,OAAQ,EACb9G,KAAKmL,MAAMzC,WAIb6oB,EAAUlxB,UAAUoC,OAAS,WACxBzC,KAAKwxB,aAAaxxB,KAAK2xB,aAAalvB,SACpCzC,KAAKyxB,aAAazxB,KAAK4xB,aAAanvB,UAGzC8uB,EAAUlxB,UAAU0C,OAAS,WAC5B,GAAIgvB,GAAKC,EAAoB,aAAchyB,KAAKW,QAASX,KAAKgC,KAE9D,KAAK+vB,EAGJ,MAFAE,GAASC,GAAclyB,KAAKgC,KAAM,mBAClChC,KAAK8xB,aAAeT,GAIrBrxB,MAAKmB,KAAOnB,KAAKmL,MAAMhK,IAEvB,IAAI0wB,GAAO7xB,KAAKyxB,YAAczxB,KAAK4xB,aAAatc,cAAgBtV,KAAK6xB,IAGrE,IAFA7xB,KAAK8xB,aAAeC,EAAGjpB,MAAM9I,KAAKW,SAAUX,KAAKmB,MAAMgxB,OAAON,KAEzD7xB,KAAK8xB,eAAiB9xB,KAAK8xB,aAAa7Y,SAC5C,KAAM,IAAI7D,OAAM,QAAWpV,KAAKgC,KAAO,6DAIzCuvB,EAAUlxB,UAAU6F,OAAS,WACxBlG,KAAKwxB,aAAaxxB,KAAK2xB,aAAazrB,SACpClG,KAAKyxB,aAAazxB,KAAK4xB,aAAa1rB,UAGzCqrB,EAAUlxB,UAAUY,SAAW,WAC1BjB,KAAK8xB,cAAc9xB,KAAK8xB,aAAa7Y,YAG1CsY,EAAUlxB,UAAUwG,OAAS,WAC5B,GAAK7G,KAAK8G,MAAV,CAEA9G,KAAK8G,OAAQ,CAEb,IAAIsrB,IAAc,CAElB,IAAIpyB,KAAKwxB,aAAexxB,KAAK2xB,aAAa7qB,MAAO,CAChD,GAAI9E,GAAOhC,KAAK2xB,aAAalsB,UAC7B2sB,GAAcpwB,IAAShC,KAAKgC,KAC5BhC,KAAKgC,KAAOA,EAGb,GAAIhC,KAAK8xB,aACR,GAAIM,IAAgBpyB,KAAK8xB,aAAajrB,OACrC7G,KAAKiB,WACLjB,KAAK+C,aAEL,IAAI/C,KAAKyxB,aACR,GAAIzxB,KAAK4xB,aAAa9qB,MAAO,CAC5B,GAAI+qB,GAAO7xB,KAAK4xB,aAAatc,aAC7BtV,MAAK8xB,aAAajrB,OAAOiC,MAAM9I,KAAKW,QAASkxB,QAG9C7xB,MAAK8xB,aAAajrB,OAAOiC,MAAM9I,KAAKW,QAASX,KAAK6xB,KAQjD7xB,MAAKwxB,aAAexxB,KAAK2xB,aAAa7qB,OACzC9G,KAAK2xB,aAAa9qB,SAGf7G,KAAKyxB,aAAezxB,KAAK4xB,aAAa9qB,OACzC9G,KAAK4xB,aAAa/qB,WAIb0qB,KAGJc,GAAW,WACd,QAASA,GAASrwB,EAAMmJ,GACvB/D,GAAaC,eAAerH,KAAMqyB,GAER,KAAtBrwB,EAAKoI,QAAQ,MAChBkoB,EAAM,2DAA6DnnB,EAAMnJ,KAAO,OAASA,EAAO,yBAGjGhC,KAAKgC,KAAOA,EACZhC,KAAKmL,MAAQA,EACbnL,KAAKmB,KAAO,KACZnB,KAAKuyB,QAAU,KAuBhB,MApBAF,GAAShyB,UAAUmyB,OAAS,SAAgBC,GAC3C,GAAItxB,GAAOnB,KAAKmB,KAAOnB,KAAKmL,MAAMhK,KAC9Ba,EAAOhC,KAAKgC,IAEV,MAAOA,IAAQb,IACpB8wB,EAASC,GAAclwB,EAAM,WAG9Bb,EAAKwG,iBAAiB3F,EAAMhC,KAAKuyB,QAAU,SAAUhV,GACpDkV,EAAUlb,MACTpW,KAAMA,EACNuxB,SAAUnV,MAET,IAGJ8U,EAAShyB,UAAUsyB,SAAW,WAC7B3yB,KAAKmB,KAAK0G,oBAAoB7H,KAAKgC,KAAMhC,KAAKuyB,SAAS,IAGjDF,KAGJO,GAAc,WACjB,QAASA,GAAYC,EAAa1nB,GACjC/D,GAAaC,eAAerH,KAAM4yB,GAElC5yB,KAAK6yB,YAAcA,EACnB7yB,KAAKmL,MAAQA,EACbnL,KAAKuyB,QAAU,KAkBhB,MAfAK,GAAYvyB,UAAUmyB,OAAS,SAAgBC,GAC9C,GAAItxB,GAAOnB,KAAKmL,MAAMhK,IAEtBnB,MAAKuyB,QAAUvyB,KAAK6yB,YAAY1xB,EAAM,WACrC,GAAIoc,GAAQxU,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,MAAwBA,UAAU,EAEjFwU,GAAMpc,KAAOoc,EAAMpc,MAAQA,EAC3BsxB,EAAUlb,KAAKgG,MAIjBqV,EAAYvyB,UAAUsyB,SAAW,WAChC3yB,KAAKuyB,QAAQtZ,YAGP2Z,KASJE,GAAS,MAERC,KAGJ,WACC,GAAIC,MACAC,EAAYrvB,GAAc,OAAOsvB,KAErCJ,IAAS,SAAgB1F,GAGxB,GAFAA,EAAO+F,GAAU/F,IAEZ4F,EAAY5F,GAChB,GAAwB5qB,SAApBywB,EAAU7F,GACb4F,EAAY5F,GAAQA,MAMpB,KAHA,GAAIgG,GAAShG,EAAKiG,OAAO,GAAG3vB,cAAgB0pB,EAAKkG,UAAU,GAEvD1uB,EAAI2uB,GAAQ1uB,OACTD,KAAK,CACX,GAAI4uB,GAASD,GAAQ3uB,EACrB,IAAmCpC,SAA/BywB,EAAUO,EAASJ,GAAuB,CAC7CJ,EAAY5F,GAAQoG,EAASJ,CAC7B,QAMJ,MAAOJ,GAAY5F,OA3BrB0F,GAAS,IAgCV,IAAIW,IAAWX,GAEXY,GAAU,OACVC,GAAS,QAEb,IAAIvqB,GAAK,CACR,GAAIwqB,IAAW,MAEf,IAAID,KAAUvqB,IACbwqB,GAAW,OAGX,KADA,GAAIC,IAAMN,GAAQ1uB,OACXgvB,MAAO,CACb,GAAIL,IAASD,GAAQM,GAGrB,IAFAF,GAASH,GAAS,SAEdG,KAAUvqB,IAAK,CAClBwqB,GAAWJ,EACX,QAKchxB,SAAboxB,IACHxqB,GAAIzB,iBAAiBisB,GAAW,mBAAoBE,IACpDA,OAGI,cAAgB1qB,KACnBA,GAAIzB,iBAAiB,WAAYosB,IACjC3qB,GAAIzB,iBAAiB,UAAWqsB,MAEhCzZ,GAAI5S,iBAAiB,WAAYosB,IACjCxZ,GAAI5S,iBAAiB,OAAQosB,IAE7BxZ,GAAI5S,iBAAiB,WAAYqsB,IACjCzZ,GAAI5S,iBAAiB,QAASqsB,KAG/BN,IAAU,GAgBZ,GAAIO,IAAkB,GAAIvE,QAAO,QAAU6D,GAAQlvB,KAAK,KAAO,MAM3D6vB,GAAgB,GAAIxE,QAAO,OAAS6D,GAAQlvB,KAAK,KAAO,YAYxD8vB,GAAoB,MAEnBpB,KAGJ,WACC,GAAIE,GAAYrvB,GAAc,OAAOsvB,MACjCkB,EAAS,SAAgBhwB,GAC5B,MAAOA,IAGJiwB,KACAC,KAGAC,EAAa,OACbC,EAAgB,OAChBC,EAA0B,OAC1BC,EAAsB,OACtBC,EAAsB,OACtBC,EAA6B,MAEJpyB,UAAzBywB,EAAU5sB,YACbkuB,EAAa,aACbC,EAAgB,gBAChBC,GAA0B,GACejyB,SAA/BywB,EAAU4B,kBACpBN,EAAa,mBACbC,EAAgB,sBAChBC,GAA0B,GAE1BA,GAA0B,EAGvBF,IACHG,EAAsBH,EAAa,WACnCI,EAAsBJ,EAAa,WACnCK,EAA6BL,EAAa,kBAG3CJ,GAAoB,SAA2BnpB,EAAG8pB,EAAI3tB,EAAS4tB,EAAmBxsB,GAIjFysB,WAAW,WAIV,QAASC,KACJC,GAAyBC,IAE5BnqB,EAAErK,QAAQ4W,KAAKvM,EAAEhJ,KAAO,OAAQgJ,EAAE7J,KAAM6J,EAAEoqB,SAC1C7sB,KAoBF,QAAS8sB,GAAqB9X,GAC7B,GAAIvV,GAAQ+sB,EAAkB3qB,QAAQ+oB,GAAUmC,GAAS/X,EAAMgT,eAEjD,MAAVvoB,GACH+sB,EAAkB1qB,OAAOrC,EAAO,GAG7B+sB,EAAkBlwB,SAKtBquB,EAAMyB,GAAuBY,EAASC,SACtCtC,EAAM0B,GAA8BW,EAASE,SAC7CvC,EAAMwB,GAAuBa,EAASG,OAEtC1qB,EAAE7J,KAAK0G,oBAAoB2sB,EAAea,GAAsB,GAEhEF,GAAyB,EACzBF,KA9CD,GAAIC,GAAwB,OACxBC,EAAyB,OAYzBQ,GAAc3qB,EAAE7J,KAAKwC,cAAgB,IAAMqH,EAAE7J,KAAKuE,QAGlDwtB,EAAQloB,EAAE7J,KAAK+xB,MACfqC,GACHC,SAAUtC,EAAMyB,GAChBe,OAAQxC,EAAM0B,GACda,SAAUvC,EAAMwB,GAGjBxB,GAAMyB,GAAuBI,EAAkB5wB,IAAIsvB,IAAUtvB,IAAIyxB,IAAWvxB,KAAK,KACjF6uB,EAAM0B,GAA8BgB,GAAUzuB,EAAQ8U,QAAU,UAChEiX,EAAMwB,GAAuBvtB,EAAQsuB,SAAW,IAAO,IAwBvDzqB,EAAE7J,KAAKwG,iBAAiB6sB,EAAea,GAAsB,GAE7DL,WAAW,WAUV,IATA,GAAIpwB,GAAImwB,EAAkBlwB,OACtBgxB,EAAO,OACPC,EAAgB,OAChB9tB,EAAQ,OACR+tB,KACA3I,EAAO,OACP4I,EAAS,OACT3F,EAAe,OAEZzrB,KACNwoB,EAAO2H,EAAkBnwB,GACzBixB,EAAOF,EAAavI,EAEhBqH,IAA4BH,EAAwBuB,KACvD3C,EAAMO,GAASrG,IAAS0H,EAAG1H,GAItBiH,EAAqBwB,KACzBC,EAAgB9qB,EAAEirB,SAAS7I,GAI3BiH,EAAqBwB,GAAQ7qB,EAAEirB,SAAS7I,IAAS0H,EAAG1H,GACpDkH,EAAwBuB,IAASxB,EAAqBwB,GAGlDvB,EAAwBuB,KAC3B3C,EAAMO,GAASrG,IAAS0I,KAKtBrB,IAA2BH,EAAwBuB,KAEjCrzB,SAAlBszB,IACHA,EAAgB9qB,EAAEirB,SAAS7I,IAK5BplB,EAAQ+sB,EAAkB3qB,QAAQgjB,GACpB,KAAVplB,EACHwK,EAAY,oIAAsIrR,KAAM6J,EAAE7J,OAE1J4zB,EAAkB1qB,OAAOrC,EAAO,GAKjCguB,EAAS,UAAUE,KAAKpB,EAAG1H,IAAO,GAClCiD,EAAe8F,EAAYC,WAAWN,GAAgBM,WAAWtB,EAAG1H,MAAW,WAC9E,MAAO0H,GAAG1H,IAIX2I,EAA2Bj0B,MAC1BE,KAAMyxB,GAASrG,GACfiD,aAAcA,EACd2F,OAAQA,IAMX,IAAID,EAA2BlxB,OAAQ,CACtC,GAAIoX,GAAS,MAEiB,iBAAnB9U,GAAQ8U,QAClBA,EAASjR,EAAErK,QAAQsb,OAAO9U,EAAQ8U,QAE7BA,IACJ1Q,EAAgB2mB,GAAc/qB,EAAQ8U,OAAQ,WAC9CA,EAASmY,IAGVnY,EADoC,kBAAnB9U,GAAQ8U,OAChB9U,EAAQ8U,OAERmY,EAGV,GAAIiC,KACHZ,SAAUtuB,EAAQsuB,SAClBxZ,OAAQA,EACRqa,KAAM,SAAcC,GAEnB,IADA,GAAI3xB,GAAImxB,EAA2BlxB,OAC5BD,KAAK,CACX,GAAI4xB,GAAQT,EAA2BnxB,EACvCoG,GAAE7J,KAAK+xB,MAAMsD,EAAMx0B,MAAQw0B,EAAMnG,aAAakG,GAAOC,EAAMR,SAG7D1vB,SAAU,WACT4uB,GAAwB,EACxBD,WAIFC,IAAwB,CAGpBH,GAAkBlwB,SAGtBmG,EAAE7J,KAAK0G,oBAAoB2sB,EAAea,GAAsB,GAChEF,GAAyB,EACzBF,MAEC,IACD9tB,EAAQsvB,OAAS,OA1MtBtC,GAAoB,IA+MrB,IAAIuC,IAAsBvC,GAatBwC,GAAmBpc,KAAQA,GAAIoc,kBAAoBC,GAAOD,kBAC1D5iB,GAAWyH,GAAUjT,UAErBsuB,GAAa,WAChB,QAASA,GAAWl2B,EAASQ,EAAMa,EAAM80B,EAAQxZ,GAChDlW,GAAaC,eAAerH,KAAM62B,GAElC72B,KAAKW,QAAUA,EACfX,KAAKmB,KAAOA,EACZnB,KAAKgC,KAAOA,EACZhC,KAAK82B,OAASA,EAGd92B,KAAKsd,UAAYA,EACjBtd,KAAKo1B,QAAwB,UAAd9X,EAEK,kBAATtb,GACVhC,KAAK+2B,IAAM/0B,GAEXhC,KAAK+2B,IAAM/E,EAAoB,cAAerxB,EAASqB,GAElDhC,KAAK+2B,KACTxrB,EAAgB2mB,GAAclwB,EAAM,eAAiBrB,QAASA,KAmLjE,MA9KAk2B,GAAWx2B,UAAU22B,aAAe,SAAsB9D,EAAOpvB,EAAOqD,GACvE,GAAIG,GAAQtH,IAEZ,IAAyB,IAArB+I,UAAUlE,OACb,KAAM,IAAIuQ,OAAM,iFAKjB,KAAKse,GAEJ,MADA1zB,MAAKi3B,SAAS/D,EAAOpvB,GACdiQ,EAGR,IAAI+gB,GAAK,MAsBT,OApBqB,gBAAV5B,IACV4B,KACAA,EAAG5B,GAASpvB,IAEZgxB,EAAK5B,EAGL/rB,EAAUrD,GAQNqD,IACJoE,EAAgB,iMAAkMvL,KAAKgC,MACvNmF,EAAUnH,MAGJ,GAAIwb,IAAU,SAAU0b,GAE9B,IAAK/vB,EAAQsuB,SAGZ,MAFAnuB,GAAM2vB,SAASnC,OACfoC,IAYD,KAPA,GAAI9Y,GAAgBhS,OAAOC,KAAKyoB,GAC5BC,KAGAoC,EAAgBR,GAAiBrvB,EAAMnG,MAEvCyD,EAAIwZ,EAAcvZ,OACfD,KAAK,CACX,GAAIwoB,GAAOhP,EAAcxZ,GACrBwyB,EAAUD,EAAc1D,GAASrG,GAErB,SAAZgK,IAAmBA,EAAU,GAG7BA,GAAWtC,EAAG1H,KAEjB2H,EAAkBjzB,KAAKsrB,GAIvB9lB,EAAMnG,KAAK+xB,MAAMO,GAASrG,IAASgK,GAMrC,MAAKrC,GAAkBlwB,WAKvB6xB,IAAoBpvB,EAAOwtB,EAAI3tB,EAAS4tB,EAAmBmC,OAJ1DA,QAQHL,EAAWx2B,UAAU41B,SAAW,SAAkBoB,GACjD,GAAIF,GAAgBR,GAAiB32B,KAAKmB,KAE1C,IAAqB,gBAAVk2B,GAAoB,CAC9B,GAAIvzB,GAAQqzB,EAAc1D,GAAS4D,GACnC,OAAiB,QAAVvzB,EAAkB,EAAIA,EAG9B,IAAK0G,EAAQ6sB,GACZ,KAAM,IAAIjiB,OAAM,kGAMjB,KAHA,GAAIkiB,MAEA1yB,EAAIyyB,EAAMxyB,OACPD,KAAK,CACX,GAAIwoB,GAAOiK,EAAMzyB,GACb2yB,EAASJ,EAAc1D,GAASrG,GAErB,SAAXmK,IAAkBA,EAAS,GAC/BD,EAAOlK,GAAQmK,EAGhB,MAAOD,IAGRT,EAAWx2B,UAAUm3B,cAAgB,SAAuBV,EAAQpc,GAenE,MAdsB,gBAAXoc,GACVA,GAAWrB,SAAUqB,GACO,gBAAXA,GAEhBA,EADc,SAAXA,GACQrB,SAAU,KACA,SAAXqB,GACCrB,SAAU,MAEVA,SAAU,KAEXqB,IACXA,MAGMtc,KAAcE,EAAUoc,IAGhCD,EAAWx2B,UAAU42B,SAAW,SAAkB/D,EAAOpvB,GACxD,GAAqB,gBAAVovB,GACVlzB,KAAKmB,KAAK+xB,MAAMO,GAASP,IAAUpvB,MAC7B,CACN,GAAIspB,GAAO,MACX,KAAKA,IAAQ8F,GACRA,EAAMuE,eAAerK,KACxBptB,KAAKmB,KAAK+xB,MAAMO,GAASrG,IAAS8F,EAAM9F,IAK3C,MAAOptB,OAGR62B,EAAWx2B,UAAUq3B,MAAQ,WAC5B,GAAIx0B,GAASlD,KAETmB,EAAOnB,KAAKmB,KACZw2B,EAAgBx2B,EAAKiB,aAAa,SAElCw1B,EAAY,MAoBhB,IAfA53B,KAAKsG,SAAW,SAAUuxB,GACrBD,IAICC,GAAgC,UAArB30B,EAAOoa,WACtBwa,GAAW32B,EAAMw2B,GAGlBz0B,EAAO60B,SAAS7Z,OAAOhb,GAEvB00B,GAAY,KAIR53B,KAAK+2B,IAET,WADA/2B,MAAKsG,UAIN,IAAI0xB,GAAUh4B,KAAK+2B,IAAIjuB,MAAM9I,KAAKW,SAAUX,MAAMmyB,OAAOnyB,KAAK82B,QAC1DkB,IAASA,EAAQC,KAAKj4B,KAAKsG,WAGzBuwB,KAsCJj2B,GAAU,WACb,QAASA,GAAQuvB,GAChB,GAAInuB,GAAO+G,UAAUlE,QAAU,GAAsBrC,SAAjBuG,UAAU,GAAmB,QAAUA,UAAU,EACrF3B,IAAaC,eAAerH,KAAMY,GAElCZ,KAAKmwB,QAAUA,EACfnwB,KAAKW,QAAUwvB,EAAQxvB,QACvBX,KAAKqC,UAAY8tB,EAAQ7tB,gBAAgBN,EAEzC,IAAIquB,GAAerwB,KAAKqC,UAAUguB,YAClCA,GAAa6H,cAAgBl4B,IAE7B,IAAIc,GAAQuvB,EAAavvB,KAGzB,IAAKA,GAME,GAAIA,EAAMq3B,aAEhBr3B,EAAMsT,kBACNgkB,GAAmB,aAAcp4B,KAAKW,aAIlC,IAAIG,EAAMu3B,WAAY,CACzB,GAAIC,GAAUx3B,EAAM+vB,aAAaC,QAAQ,KAAM,GAE/C,OADAvlB,GAAgB,kCAAoC4kB,EAAQnuB,KAAO,cAAgBs2B,EAAU,gDAAkDnI,EAAQnuB,KAAO,uBAA2BrB,QAASX,KAAKW,WAChM,OAdR0vB,GAAa/nB,SAAS8L,kBACtBtT,EAAQuvB,EAAavvB,MAErBs3B,GAAmB,IAAO/H,EAAa9vB,SAASiI,EAAI,cAAgBxI,KAAKW,QAc1EX,MAAKqC,UAAUouB,UAAW,EAC1BzwB,KAAKc,MAAQA,CAGb,IAAIgD,GAAQhD,EAAMsH,KAClBpI,MAAK0E,aAAyBlC,SAAVsB,EAENtB,SAAVsB,GAAuB9D,KAAKu4B,kBAC/Bz0B,EAAQ9D,KAAKu4B,kBACbz3B,EAAM+X,IAAI/U,GAGX,IAAI00B,GAAaC,GAAetI,EAC5BqI,KACHx4B,KAAK04B,WAAa50B,EAClB00B,EAAW/wB,aAAa3F,KAAK9B,OA6C/B,MAzCAY,GAAQP,UAAUF,KAAO,WACxBH,KAAKc,MAAM63B,sBAAsB34B,OAGlCY,EAAQP,UAAUoI,aAAe,WAChC,GAAInB,GAAQtH,IAEZgF,IAAQ0yB,MAAM13B,KAAK44B,MACnB54B,KAAKqC,UAAUw2B,QAAS,EACxB74B,KAAKc,MAAM+X,IAAI7Y,KAAKuC,YACpByC,GAAQC,aAAa,WACpB,MAAOqC,GAAMjF,UAAUw2B,QAAS,IAEjC7zB,GAAQ8X,OAGTlc,EAAQP,UAAUoC,OAAS,WAE1BzC,KAAKkG,SACLlG,KAAKc,MAAQd,KAAKqC,UAAUguB,aAAavvB,MACzCd,KAAKG,QAGNS,EAAQP,UAAU0C,OAAS,WAC1B/C,KAAKmB,KAAOnB,KAAKmwB,QAAQhvB,KACzBnB,KAAKmB,KAAK+O,SAASjQ,QAAUD,KAC7BA,KAAKwF,UAAW,GAGjB5E,EAAQP,UAAUsE,YAAc,SAAqBxD,GACpDnB,KAAKc,MAAM+X,IAAI1X,EAAK2C,QAGrBlD,EAAQP,UAAU6F,OAAS,WAC1BlG,KAAKc,MAAMg4B,wBAAwB94B,OAGpCY,EAAQP,UAAUY,SAAW,aAItBL,KASJm4B,GAAkB,SAAUC,GAG/B,QAASD,GAAgB5I,GAExB,MADA/oB,IAAaC,eAAerH,KAAM+4B,GAC3B3xB,GAAaG,0BAA0BvH,KAAMg5B,EAASxxB,KAAKxH,KAAMmwB,EAAS,YA8BlF,MAlCA/oB,IAAaM,SAASqxB,EAAiBC,GAOvCD,EAAgB14B,UAAU0C,OAAS,WAClCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,MAE/BA,KAAKmB,KAAKwG,iBAAiB,SAAUsxB,IAAgB,GAEjDj5B,KAAKmB,KAAK+3B,aACbl5B,KAAKmB,KAAKwG,iBAAiB,QAASsxB,IAAgB,IAItDF,EAAgB14B,UAAUY,SAAW,WACpCjB,KAAKmB,KAAK0G,oBAAoB,SAAUoxB,IAAgB,GACxDj5B,KAAKmB,KAAK0G,oBAAoB,QAASoxB,IAAgB,IAGxDF,EAAgB14B,UAAUk4B,gBAAkB,WAC3C,QAASv4B,KAAKmwB,QAAQ/tB,aAAa,YAGpC22B,EAAgB14B,UAAUkC,SAAW,WACpC,MAAOvC,MAAKmB,KAAKg4B,SAGlBJ,EAAgB14B,UAAUsE,YAAc,SAAqBxD,GAC5DnB,KAAKc,MAAM+X,IAAI1X,EAAKg4B,UAGdJ,GACNn4B,IAOEw4B,GAAe,WAClB,QAASA,GAAavD,EAAM/0B,EAAOyB,GAClC,GAAI+E,GAAQtH,IAEZoH,IAAaC,eAAerH,KAAMo5B,GAElCp5B,KAAKc,MAAQA,EACbd,KAAK61B,KAAOA,EACZ71B,KAAKuC,SAAW,WAEf,MADA+E,GAAMxD,MAAQvB,EAASiF,KAAKF,GACrBA,EAAMxD,OAGd9D,KAAKq5B,YA0BN,MAvBAD,GAAa/4B,UAAUsB,IAAM,SAAa1B,GACzCD,KAAKq5B,SAASv3B,KAAK7B,IAGpBm5B,EAAa/4B,UAAUF,KAAO,WAC7BH,KAAK8D,MAAQ9D,KAAKc,MAAMsH,MACxBpI,KAAKc,MAAM63B,sBAAsB34B,MACjCA,KAAK8U,OAAQ,GAGdskB,EAAa/4B,UAAU6d,OAAS,SAAgBje,GAC/CwK,EAAgBzK,KAAKq5B,SAAUp5B,GAC1BD,KAAKq5B,SAASx0B,QAClB7E,KAAKkG,UAIPkzB,EAAa/4B,UAAU6F,OAAS,WAC/BlG,KAAKc,MAAMg4B,wBAAwB94B,MACnCA,KAAK8U,OAAQ,QACN9U,MAAKc,MAAMd,KAAK61B,OAGjBuD,KAGJE,MAAYx3B,KAeZy3B,GAAsB,SAAUP,GAGnC,QAASO,GAAoBpJ,GAC5B/oB,GAAaC,eAAerH,KAAMu5B,EAElC,IAAIjyB,GAAQF,GAAaG,0BAA0BvH,KAAMg5B,EAASxxB,KAAKxH,KAAMmwB,EAAS,QAgBtF,IAdA7oB,EAAMkyB,cAAe,EAKrBlyB,EAAMmyB,MAAQC,GAAgB,aAAcpyB,EAAMxG,MAAO64B,IACzDryB,EAAMmyB,MAAM93B,IAAI2F,GAEZA,EAAMsyB,iBACTtyB,EAAMmyB,MAAMG,gBAAiB,GAK1BtyB,EAAMmyB,MAAMG,gBAAkBtyB,EAAM6oB,QAAQ/tB,aAAa,WAAY,CACxE,GAAIy3B,GAAgBvyB,EAAMxG,MAAMsH,MAC5B0xB,EAAexyB,EAAM6oB,QAAQ/tB,aAAa,QAEzC23B,GAAcF,EAAeC,IACjCR,GAAO9xB,KAAKqyB,EAAeC,GAG7B,MAAOxyB,GA4FR,MAzHAF,IAAaM,SAAS6xB,EAAqBP,GAgC3CO,EAAoBl5B,UAAUF,KAAO,WAC/BH,KAAKy5B,MAAM3kB,OACf9U,KAAKy5B,MAAMt5B,QAIbo5B,EAAoBl5B,UAAU25B,QAAU,WACvC,GAAIC,KAAej6B,KAAKk6B,SAExB,OADAl6B,MAAKk6B,UAAYl6B,KAAKmB,KAAKg4B,QACpBn5B,KAAKk6B,YAAcD,GAG3BV,EAAoBl5B,UAAUk4B,gBAAkB,WAS/C,MADAv4B,MAAK45B,gBAAiB,MAIvBL,EAAoBl5B,UAAUkC,SAAW,WACxC,MAAOvC,MAAKy5B,MAAM31B,OAGnBy1B,EAAoBl5B,UAAUoI,aAAe,WAC5CzI,KAAKk6B,UAAYl6B,KAAKmwB,QAAQhvB,KAAKg4B,QACnCn5B,KAAKy5B,MAAM31B,MAAQ9D,KAAKc,MAAMsH,KAC9B,IAAItE,GAAQ9D,KAAKmwB,QAAQ/tB,aAAa,QAClCpC,MAAKk6B,YAAcH,EAAc/5B,KAAKy5B,MAAM31B,MAAOA,GACtD9D,KAAKy5B,MAAM31B,MAAMhC,KAAKgC,IACX9D,KAAKk6B,WAAaH,EAAc/5B,KAAKy5B,MAAM31B,MAAOA,IAC7D2G,EAAgBzK,KAAKy5B,MAAM31B,MAAOA,GAEnCk1B,EAAS34B,UAAUoI,aAAajB,KAAKxH,OAGtCu5B,EAAoBl5B,UAAU0C,OAAS,WACtCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,KAE/B,IAAImB,GAAOnB,KAAKmB,KAEZ04B,EAAgB75B,KAAKc,MAAMsH,MAC3B0xB,EAAe95B,KAAKmwB,QAAQ/tB,aAAa,QAEzCoI,GAAQqvB,GACX75B,KAAKk6B,UAAYH,EAAcF,EAAeC,GAE9C95B,KAAKk6B,UAAYL,GAAiBC,EAGnC34B,EAAKa,KAAO,KAAOhC,KAAKc,MAAM+vB,aAAe,KAC7C1vB,EAAKg4B,QAAUn5B,KAAKk6B,UAEpB/4B,EAAKwG,iBAAiB,SAAUsxB,IAAgB,GAG5C93B,EAAK+3B,aACR/3B,EAAKwG,iBAAiB,QAASsxB,IAAgB,IAIjDM,EAAoBl5B,UAAUsE,YAAc,SAAqBxD,GAKhE,GAJAnB,KAAKy5B,MAAMJ,SAAS32B,QAAQ,SAAUzC,GACrC,MAAOA,GAAQyE,cAAe,IAG3BvD,EAAKg4B,QAAS,CACjB,GAAIgB,GAAan6B,KAAKy5B,MAAMl3B,UAC5B43B,GAAWr4B,KAAK9B,KAAKmwB,QAAQ/tB,aAAa,UAE1CpC,KAAKy5B,MAAM34B,MAAM+X,IAAIshB,KAIvBZ,EAAoBl5B,UAAU6F,OAAS,WACtClG,KAAKy5B,MAAMvb,OAAOle,OAGnBu5B,EAAoBl5B,UAAUY,SAAW,WACxC,GAAIE,GAAOnB,KAAKmwB,QAAQhvB,IAExBA,GAAK0G,oBAAoB,SAAUoxB,IAAgB,GACnD93B,EAAK0G,oBAAoB,QAASoxB,IAAgB,IAG5CM,GACN34B,IAEEw5B,GAAyB,SAAUpB,GAGtC,QAASoB,KAER,MADAhzB,IAAaC,eAAerH,KAAMo6B,GAC3BhzB,GAAaG,0BAA0BvH,KAAMg5B,EAASlwB,MAAM9I,KAAM+I,YAyC1E,MA7CA3B,IAAaM,SAAS0yB,EAAwBpB,GAO9CoB,EAAuB/5B,UAAUk4B,gBAAkB,WAClD,MAAOv4B,MAAKmwB,QAAQ5uB,SAAWvB,KAAKmwB,QAAQ5uB,SAASkE,WAAa,IAGnE20B,EAAuB/5B,UAAUkC,SAAW,WAC3C,MAAOvC,MAAKmwB,QAAQhvB,KAAK6P,WAG1BopB,EAAuB/5B,UAAU0C,OAAS,WACzCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,KAE/B,IAAImB,GAAOnB,KAAKmB,IAEhBA,GAAKwG,iBAAiB,SAAUsxB,IAAgB,GAChD93B,EAAKwG,iBAAiB,OAAQsxB,IAAgB,GAEzCj5B,KAAKW,QAAQ05B,OACjBl5B,EAAKwG,iBAAiB,QAASsxB,IAAgB,GAE3C93B,EAAK+3B,aACR/3B,EAAKwG,iBAAiB,QAASsxB,IAAgB,KAKlDmB,EAAuB/5B,UAAUsE,YAAc,SAAqBxD,GACnEnB,KAAKc,MAAM+X,IAAI1X,EAAK6P,YAGrBopB,EAAuB/5B,UAAUY,SAAW,WAC3C,GAAIE,GAAOnB,KAAKmB,IAEhBA,GAAK0G,oBAAoB,OAAQoxB,IAAgB,GACjD93B,EAAK0G,oBAAoB,SAAUoxB,IAAgB,GACnD93B,EAAK0G,oBAAoB,QAASoxB,IAAgB,GAClD93B,EAAK0G,oBAAoB,QAASoxB,IAAgB,IAG5CmB,GACNx5B,IAyBE05B,GAAiB,SAAUtB,GAG9B,QAASsB,KAER,MADAlzB,IAAaC,eAAerH,KAAMs6B,GAC3BlzB,GAAaG,0BAA0BvH,KAAMg5B,EAASlwB,MAAM9I,KAAM+I,YA4D1E,MAhEA3B,IAAaM,SAAS4yB,EAAgBtB,GAOtCsB,EAAej6B,UAAUk4B,gBAAkB,WAC1C,MAAO,IAGR+B,EAAej6B,UAAUkC,SAAW,WACnC,MAAOvC,MAAKmB,KAAK2C,OAGlBw2B,EAAej6B,UAAU0C,OAAS,WACjCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,KAI/B,IAAIq6B,GAAOr6B,KAAKW,QAAQ05B,KACpBE,GAAU,CAGVv6B,MAAKmwB,QAAQ5vB,SAASC,GAAK,QAAUR,MAAKmwB,QAAQ5vB,SAASC,IAC9D65B,EAAOr6B,KAAKmwB,QAAQ5vB,SAASC,EAAE65B,KAClB,IAATA,IAAYA,GAAO,IAIX,UAATA,IAAkBA,GAAO,GAEzBG,EAAUH,KACbE,GAAWF,EACXA,GAAO,GAGRr6B,KAAKuyB,QAAUgI,EAAUE,GAAYF,GAAWtB,EAEhD,IAAI93B,GAAOnB,KAAKmB,IAEhBA,GAAKwG,iBAAiB,SAAUsxB,IAAgB,GAE3CoB,IACJl5B,EAAKwG,iBAAiB,QAAS3H,KAAKuyB,SAAS,GAEzCpxB,EAAK+3B,aACR/3B,EAAKwG,iBAAiB,QAAS3H,KAAKuyB,SAAS,IAI/CpxB,EAAKwG,iBAAiB,OAAQ+yB,IAAY,IAG3CJ,EAAej6B,UAAUY,SAAW,WACnC,GAAIE,GAAOnB,KAAKmwB,QAAQhvB,IACxBnB,MAAKwF,UAAW,EAEhBrE,EAAK0G,oBAAoB,SAAUoxB,IAAgB,GACnD93B,EAAK0G,oBAAoB,QAAS7H,KAAKuyB,SAAS,GAChDpxB,EAAK0G,oBAAoB,QAAS7H,KAAKuyB,SAAS,GAChDpxB,EAAK0G,oBAAoB,OAAQ6yB,IAAY,IAGvCJ,GACN15B,IAQE+5B,GAAwB,SAAU3B,GAGrC,QAAS2B,KAER,MADAvzB,IAAaC,eAAerH,KAAM26B,GAC3BvzB,GAAaG,0BAA0BvH,KAAMg5B,EAASlwB,MAAM9I,KAAM+I,YA8F1E,MAlGA3B,IAAaM,SAASizB,EAAuB3B,GAO7C2B,EAAsBt6B,UAAUgQ,YAAc,WAC7C,GAAInN,GAASlD,KAET8D,EAAQ9D,KAAKuC,UAEHC,UAAVsB,IACH9D,KAAKqC,UAAUw2B,QAAS,EACxB7zB,GAAQC,aAAa,WACpB,MAAO/B,GAAOb,UAAUw2B,QAAS,IAElC74B,KAAKc,MAAM+X,IAAI/U,KAIjB62B,EAAsBt6B,UAAUk4B,gBAAkB,WACjD,MAAOv4B,MAAKmwB,QAAQhpB,QAAQmT,OAAO,SAAU9G,GAC5C,MAAOA,GAAOpR,aAAa,cACzB+B,IAAI,SAAUqP,GAChB,MAAOA,GAAOpR,aAAa,YAI7Bu4B,EAAsBt6B,UAAUkC,SAAW,WAM1C,IAAK,GALD4E,GAAUnH,KAAKmwB,QAAQhvB,KAAKgG,QAC5B0F,EAAM1F,EAAQtC,OAEd+1B,KAEKh2B,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAChC,GAAI4O,GAASrM,EAAQvC,EAErB,IAAI4O,EAAOrJ,SAAU,CACpB,GAAIG,GAAckJ,EAAOtD,SAAWsD,EAAOtD,SAASpM,MAAQ0P,EAAO1P,KACnE82B,GAAe94B,KAAKwI,IAItB,MAAOswB,IAGRD,EAAsBt6B,UAAUoI,aAAe,WAC9C,GAAIpG,GAAYrC,KAAKqC,UACjBw4B,EAAgBx4B,EAAUE,WAE1BuB,EAAQ9D,KAAKuC,UAMjB,OAJsBC,UAAlBq4B,GAAgCC,EAAmBh3B,EAAO+2B,IAC7D7B,EAAS34B,UAAUoI,aAAajB,KAAKxH,MAG/BA,MAGR26B,EAAsBt6B,UAAU0C,OAAS,WACxCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,MAE/BA,KAAKmB,KAAKwG,iBAAiB,SAAUsxB,IAAgB,GAE5Bz2B,SAArBxC,KAAKc,MAAMsH,OAEdpI,KAAKyI,gBAIPkyB,EAAsBt6B,UAAUsE,YAAc,SAAqBxD,GAKlE,IAJA,GAAIuO,GAAkBC,GAAmBxO,GACrCyD,EAAI8K,EAAgB7K,OACpBk2B,EAAS,GAAI1gB,OAAMzV,GAEhBA,KAAK,CACX,GAAI4O,GAAS9D,EAAgB9K,EAC7Bm2B,GAAOn2B,GAAK4O,EAAOtD,SAAWsD,EAAOtD,SAASpM,MAAQ0P,EAAO1P,MAG9D9D,KAAKc,MAAM+X,IAAIkiB,IAGhBJ,EAAsBt6B,UAAU26B,SAAW,WAC1C,KAAM,IAAI5lB,OAAM,6BAGjBulB,EAAsBt6B,UAAUY,SAAW,WAC1CjB,KAAKmB,KAAK0G,oBAAoB,SAAUoxB,IAAgB,IAGzD0B,EAAsBt6B,UAAUyZ,YAAc,WAChBtX,SAAzBxC,KAAKqC,UAAUyB,OAAwB9D,KAAKqC,UAAUyB,MAAMe,QAC/D7E,KAAKs4B,QAAQzf,IAAI7Y,KAAKi7B,eAIjBN,GACN/5B,IAEEs6B,GAAiB,SAAUC,GAG9B,QAASD,KAER,MADA9zB,IAAaC,eAAerH,KAAMk7B,GAC3B9zB,GAAaG,0BAA0BvH,KAAMm7B,EAAgBryB,MAAM9I,KAAM+I,YAiBjF,MArBA3B,IAAaM,SAASwzB,EAAgBC,GAOtCD,EAAe76B,UAAUk4B,gBAAkB,aAI3C2C,EAAe76B,UAAUkC,SAAW,WACnC,GAAIuB,GAAQsyB,WAAWp2B,KAAKmB,KAAK2C,MACjC,OAAOs3B,OAAMt3B,GAAStB,OAAYsB,GAGnCo3B,EAAe76B,UAAUsE,YAAc,SAAqBxD,GAC3D,GAAI2C,GAAQsyB,WAAWj1B,EAAK2C,MACvBs3B,OAAMt3B,IAAQ9D,KAAKc,MAAM+X,IAAI/U,IAG5Bo3B,GACNZ,IAEEe,MAMAC,GAAe,SAAUtC,GAG5B,QAASsC,GAAanL,GACrB/oB,GAAaC,eAAerH,KAAMs7B,EAElC,IAAIh0B,GAAQF,GAAaG,0BAA0BvH,KAAMg5B,EAASxxB,KAAKxH,KAAMmwB,EAAS,WAItF,OAFA7oB,GAAM+zB,SAAWE,GAAYj0B,EAAM3G,QAAQ+U,MAAQpO,EAAM6oB,QAAQ/tB,aAAa,SAC9EkF,EAAM+zB,SAASv5B,KAAKwF,GACbA,EAwCR,MAjDAF,IAAaM,SAAS4zB,EAActC,GAYpCsC,EAAaj7B,UAAUkC,SAAW,WACjC,MAAOvC,MAAKmB,KAAKg4B,SAGlBmC,EAAaj7B,UAAUoI,aAAe,WACrCzD,GAAQ0yB,MAAM13B,KAAK44B,MAEnB54B,KAAKq7B,SAAS34B,QAAQ,SAAUzC,GAC/BA,EAAQa,MAAM+X,IAAI5Y,EAAQsC,cAG3ByC,GAAQ8X,OAGTwe,EAAaj7B,UAAU0C,OAAS,WAC/Bi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,MAE/BA,KAAKmB,KAAKwG,iBAAiB,SAAUsxB,IAAgB,GAEjDj5B,KAAKmB,KAAK+3B,aACbl5B,KAAKmB,KAAKwG,iBAAiB,QAASsxB,IAAgB,IAItDqC,EAAaj7B,UAAUsE,YAAc,SAAqBxD,GACzDnB,KAAKc,MAAM+X,IAAI1X,EAAKg4B,UAGrBmC,EAAaj7B,UAAU6F,OAAS,WAC/BuE,EAAgBzK,KAAKq7B,SAAUr7B,OAGhCs7B,EAAaj7B,UAAUY,SAAW,WACjCjB,KAAKmB,KAAK0G,oBAAoB,SAAUoxB,IAAgB,GACxDj5B,KAAKmB,KAAK0G,oBAAoB,QAASoxB,IAAgB,IAGjDqC,GACN16B,IAWE46B,GAAmB,SAAUxC,GAGhC,QAASwC,GAAiBrL,GACzB/oB,GAAaC,eAAerH,KAAMw7B,EAElC,IAAIl0B,GAAQF,GAAaG,0BAA0BvH,KAAMg5B,EAASxxB,KAAKxH,KAAMmwB,EAAS,QAQtF,OANA7oB,GAAMmyB,MAAQC,GAAgB,YAAapyB,EAAMxG,MAAO26B,IACxDn0B,EAAMmyB,MAAM93B,IAAI2F,GAEZ6oB,EAAQgJ,UACX7xB,EAAMmyB,MAAM31B,MAAQwD,EAAM/E,YAEpB+E,EAyER,MAtFAF,IAAaM,SAAS8zB,EAAkBxC,GAgBxCwC,EAAiBn7B,UAAUF,KAAO,WACjC,GAAI+C,GAASlD,IAERA,MAAKy5B,MAAM3kB,OACf9U,KAAKy5B,MAAMt5B,OAIZH,KAAK07B,sBACJjzB,aAAc,WACb,MAAOvF,GAAO/B,KAAKa,KAAO,KAAOkB,EAAOpC,MAAM+vB,aAAe,OAI/D7wB,KAAKc,MAAM66B,kBAAkBtzB,SAASrI,KAAK07B,uBAG5CF,EAAiBn7B,UAAUk4B,gBAAkB,WAC5C,MAAIv4B,MAAKmwB,QAAQ/tB,aAAa,WACtBpC,KAAKmwB,QAAQ/tB,aAAa,SADlC,QAKDo5B,EAAiBn7B,UAAUkC,SAAW,WACrC,MAAOvC,MAAKmwB,QAAQ/tB,aAAa,UAGlCo5B,EAAiBn7B,UAAUoI,aAAe,WAGrCzI,KAAKmB,KAAKg4B,UACbn5B,KAAKy5B,MAAM31B,MAAQ9D,KAAKuC,WACxBy2B,EAAS34B,UAAUoI,aAAajB,KAAKxH,QAIvCw7B,EAAiBn7B,UAAU0C,OAAS,WACnCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,KAE/B,IAAImB,GAAOnB,KAAKmB,IAEhBA,GAAKa,KAAO,KAAOhC,KAAKc,MAAM+vB,aAAe,KAC7C1vB,EAAKg4B,QAAUn5B,KAAKc,MAAMsH,OAASpI,KAAKmwB,QAAQ/tB,aAAa,SAE7DjB,EAAKwG,iBAAiB,SAAUsxB,IAAgB,GAE5C93B,EAAK+3B,aACR/3B,EAAKwG,iBAAiB,QAASsxB,IAAgB,IAIjDuC,EAAiBn7B,UAAUsE,YAAc,SAAqBxD,GACzDA,EAAKg4B,SACRn5B,KAAKy5B,MAAM34B,MAAM+X,IAAI7Y,KAAKmwB,QAAQ/tB,aAAa,WAIjDo5B,EAAiBn7B,UAAU6F,OAAS,WACnClG,KAAKy5B,MAAMvb,OAAOle,MAElBA,KAAKc,MAAM66B,kBAAkBhzB,WAAW3I,KAAK07B,uBAG9CF,EAAiBn7B,UAAUY,SAAW,WACrC,GAAIE,GAAOnB,KAAKmB,IAEhBA,GAAK0G,oBAAoB,SAAUoxB,IAAgB,GACnD93B,EAAK0G,oBAAoB,QAASoxB,IAAgB,IAG5CuC,GACN56B,IAEEg7B,GAAsB,SAAU5C,GAGnC,QAAS4C,KAER,MADAx0B,IAAaC,eAAerH,KAAM47B,GAC3Bx0B,GAAaG,0BAA0BvH,KAAMg5B,EAASlwB,MAAM9I,KAAM+I,YAoG1E,MAxGA3B,IAAaM,SAASk0B,EAAqB5C,GAO3C4C,EAAoBv7B,UAAUgQ,YAAc,WAC3C,GAAInN,GAASlD,KAET8D,EAAQ9D,KAAKuC,UAEHC,UAAVsB,IACH9D,KAAKqC,UAAUw2B,QAAS,EACxB7zB,GAAQC,aAAa,WACpB,MAAO/B,GAAOb,UAAUw2B,QAAS,IAElC74B,KAAKc,MAAM+X,IAAI/U,KAIjB83B,EAAoBv7B,UAAUk4B,gBAAkB,WAC/C,GAA2C/1B,SAAvCxC,KAAKmwB,QAAQ/tB,aAAa,SAA9B,CAIA,GAAI+E,GAAUnH,KAAKmwB,QAAQhpB,QACvB0F,EAAM1F,EAAQtC,MAElB,IAAKgI,EAAL,CAOA,IALA,GAAI/I,GAAQ,OACRmM,EAAoB,OACpBrL,EAAIiI,EAGDjI,KAAK,CACX,GAAI4O,GAASrM,EAAQvC,EAErB,IAAI4O,EAAOpR,aAAa,YAAa,CAC/BoR,EAAOpR,aAAa,cACxB0B,EAAQ0P,EAAOpR,aAAa,UAG7B6N,GAAoB,CACpB,QAKF,IAAKA,EACJ,OAASrL,EAAIiI,GACZ,IAAK1F,EAAQvC,GAAGxC,aAAa,YAAa,CACzC0B,EAAQqD,EAAQvC,GAAGxC,aAAa,QAChC,OAYH,MAJcI,UAAVsB,IACH9D,KAAKmwB,QAAQ7tB,gBAAgBwB,MAAMA,MAAQA,GAGrCA,KAGR83B,EAAoBv7B,UAAUkC,SAAW,WACxC,GAAI4E,GAAUnH,KAAKmB,KAAKgG,QACpB0F,EAAM1F,EAAQtC,OAEdD,EAAI,MACR,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAI4O,GAASrM,EAAQvC,EAErB,IAAIuC,EAAQvC,GAAGuF,WAAahD,EAAQvC,GAAGi3B,SACtC,MAAOroB,GAAOtD,SAAWsD,EAAOtD,SAASpM,MAAQ0P,EAAO1P,QAK3D83B,EAAoBv7B,UAAU0C,OAAS,WACtCi2B,EAAS34B,UAAU0C,OAAOyE,KAAKxH,MAC/BA,KAAKmB,KAAKwG,iBAAiB,SAAUsxB,IAAgB,IAGtD2C,EAAoBv7B,UAAUsE,YAAc,SAAqBxD,GAChE,GAAIqS,GAAS7D,GAAmBxO,GAAM,EACtCnB,MAAKc,MAAM+X,IAAIrF,EAAOtD,SAAWsD,EAAOtD,SAASpM,MAAQ0P,EAAO1P,QAMjE83B,EAAoBv7B,UAAU26B,SAAW,SAAkBl3B,GAC1D9D,KAAKc,MAAM+X,IAAI/U,IAGhB83B,EAAoBv7B,UAAUY,SAAW,WACxCjB,KAAKmB,KAAK0G,oBAAoB,SAAUoxB,IAAgB,IAGlD2C,GACNh7B,IAqEER,GAAU,SAAU2H,GAGvB,QAAS3H,GAAQ+G,GAChBC,GAAaC,eAAerH,KAAMI,EAElC,IAAIkH,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAE1EG,GAAMzF,eAENyF,EAAMtF,KAAOmF,EAAQ5G,SAASkD,EAAEq4B,cAChCx0B,EAAMtB,OAASyZ,GAAiB/d,KAAK4F,EAAMtF,KAI3C,KADA,GAAIT,GAAW+F,EAAMtD,eACdzC,GAAU,CAChB,GAAIA,EAAS4J,MAAMwF,OAASuE,GAAS,CACpC5N,EAAM2C,OAAS1I,EAAS4J,KACxB,OAED5J,EAAWA,EAAS0I,OAGrB,GAAI3C,EAAM2C,QAAgC,WAAtB3C,EAAM2C,OAAOjI,KAChC,KAAM,IAAIoT,OAAM,mEAAqE9N,EAAMtF,KAAO,KAqEnG,OAjEAsF,GAAMhF,mBACNgF,EAAMhH,cAEFgH,EAAM/G,SAASC,IAClB4L,OAAOC,KAAK/E,EAAM/G,SAASC,GAAGkC,QAAQ,SAAUV,GAE/C,GAAa,WAATA,GAA8B,SAATA,EAAzB,CAEA,GAAIK,GAAY,GAAI6tB,KACnBluB,KAAMA,EACNmuB,QAAS7oB,EACTtD,eAAgBsD,EAAMtD,eACtBzD,SAAU+G,EAAM/G,SAASC,EAAEwB,IAG5BsF,GAAMhF,gBAAgBN,GAAQK,EAEjB,UAATL,GAA6B,SAATA,GAAiBsF,EAAMhH,WAAWwB,KAAKO,MAG5DiF,EAAMhF,gBAAgBqO,MAAMrJ,EAAMhH,WAAWkW,QAAQlP,EAAMhF,gBAAgBqO,MAC3ErJ,EAAMhF,gBAAgBwB,OAAOwD,EAAMhH,WAAWwB,KAAKwF,EAAMhF,gBAAgBwB,QAI9EwD,EAAM1E,uBAAyB0E,EAAM/G,SAASw7B,OAAS53B,IAAI,SAAU5D,GACpE,MAAO,IAAIywB,KACV7lB,MAAO7D,EACPtD,eAAgBsD,EAAMtD,eACtBzD,SAAUA,MAKR+G,EAAM/G,SAASwP,IAClBzI,EAAMtG,UAAY,GAAIuwB,IAAUjqB,EAAOA,EAAM/G,SAASwP,IAIvDzI,EAAMzE,iBACFyE,EAAM/G,SAAS6c,GAClBhR,OAAOC,KAAK/E,EAAM/G,SAAS6c,GAAG1a,QAAQ,SAAU4J,GAC/C,GAAI+Q,GAAa/Q,EAAIH,MAAM,KACvB5L,EAAW+G,EAAM/G,SAAS6c,EAAE9Q,EAEhC+Q,GAAW3a,QAAQ,SAAU4a,GAC5B,GAAIyU,GAAKC,EAAoB,SAAU1qB,EAAM3G,QAAS2c,GAGlDC,EAAQwU,EAAK,GAAIa,IAAYb,EAAIzqB,GAAS,GAAI+qB,IAAS/U,EAAWhW,EACtEA,GAAMzE,cAAcf,KAAK,GAAI2b,IAAenW,EAAOiW,EAAOhd,QAMzD4G,EAAQ5G,SAASuJ,IAAM3C,EAAQsJ,YAClCnJ,EAAM/F,SAAW,GAAI2J,KACpB3K,SAAU4G,EAAQ5G,SAASuJ,EAC3BqB,MAAO7D,EACPrD,OAAQ,QAIVqD,EAAMrH,QAAU,KACTqH,EAyRR,MArXAF,IAAaM,SAAStH,EAAS2H,GA+F/B3H,EAAQC,UAAUF,KAAO,WACxBH,KAAKM,WAAWoC,QAAQmS,IACxB7U,KAAK4C,sBAAsBF,QAAQmS,IACnC7U,KAAK6C,cAAcH,QAAQmS,IAEvB7U,KAAKgB,WAAWhB,KAAKgB,UAAUb,OAC/BH,KAAKuB,UAAUvB,KAAKuB,SAASpB;CAG7BH,KAAKC,QAAUD,KAAKE,wBAAuBF,KAAKC,QAAQE,QAG7DC,EAAQC,UAAUH,oBAAsB,WACvC,GAAII,GAAaN,KAAKO,SAASC,CAE/B,KAAKF,EAAY,MAAO,KAExB,IAAIG,GAAa,UAAYH,GAAmC,IAAtBA,EAAWI,QAAsC,SAAtBJ,EAAWI,OAChFV,KAAKW,QAAQD,MAEb,KAAKD,EAAY,MAAO,KAExB,IAAIG,GAAUC,GAAcb,KAE5B,KAAKY,EAAS,MAAO,KAErB,IAAIX,GAAU,GAAIW,GAAQZ,KAE1B,OAAOC,IAAWA,EAAQa,MAAQb,EAAU,MAG7CG,EAAQC,UAAUU,OAAS,WAE1B,MADIf,MAAKgB,WAAWhB,KAAKgB,UAAUC,WAC5BC,EAAWlB,KAAKmB,OAGxBf,EAAQC,UAAUe,KAAO,SAAcC,GACtC,MAAIC,IAAQtB,KAAKmB,KAAME,GAAkBrB,KAAKmB,KAC1CnB,KAAKuB,SACDvB,KAAKuB,SAASH,KAAKC,GAD3B,QAKDjB,EAAQC,UAAUmB,QAAU,SAAiBH,EAAUI,GAGtD,GAAIH,GAAUG,EAAMC,KAAK1B,KAAKmB,KAC1BG,KACHG,EAAME,IAAI3B,KAAKmB,MACXM,EAAMG,MAAM5B,KAAK6B,YAAYC,KAAKL,IAGnCzB,KAAKuB,UACRvB,KAAKuB,SAASC,QAAQH,EAAUI,IAIlCrB,EAAQC,UAAU0B,cAAgB,SAAuBC,GACxD,MAAIhC,MAAKuB,SACDvB,KAAKuB,SAASQ,cAAcC,GADpC,QAKD5B,EAAQC,UAAU4B,kBAAoB,SAA2BD,EAAMP,GAClEzB,KAAKuB,UACRvB,KAAKuB,SAASU,kBAAkBD,EAAMP,IAIxCrB,EAAQC,UAAU6B,aAAe,WAChC,MAAO,OAGR9B,EAAQC,UAAU8B,UAAY,WAC7B,MAAOnC,MAAKmB,MAGbf,EAAQC,UAAU+B,aAAe,SAAsBJ,GACtD,GAAIK,GAAYrC,KAAKsC,gBAAgBN,EACrC,OAAOK,GAAYA,EAAUE,WAAaC,QAG3CpC,EAAQC,UAAUoC,OAAS,WAC1BzC,KAAKM,WAAWoC,QAAQC,IACxB3C,KAAK4C,sBAAsBF,QAAQC,IACnC3C,KAAK6C,cAAcH,QAAQC,IACvB3C,KAAKgB,WAAWhB,KAAKgB,UAAUyB,SAC/BzC,KAAKuB,UAAUvB,KAAKuB,SAASkB,SAC7BzC,KAAKC,SAASD,KAAKC,QAAQwC,SAE/BzC,KAAK6B,YAAYa,QAAQI,KAG1B1C,EAAQC,UAAU0C,OAAS,SAAgBC,EAAQC,GAClD,GAAIC,GAASlD,IAGbA,MAAKmD,UAAYC,GAAapD,KAE9B,IAAImB,GAAO,OACPkC,GAAW,CAEf,IAAIJ,EAEH,IADA,GAAIK,GAAI,OACDA,EAAIL,EAAUM,SAAS,CAC7B,GAAID,EAAEE,WAAaxD,KAAKO,SAASkD,EAAEC,eAAiBJ,EAAEK,eAAiB3D,KAAKmD,UAAW,CACtFnD,KAAKmB,KAAOA,EAAOmC,EACnBD,GAAW,CACX,OAEAnC,EAAWoC,GA2Bd,GAtBKnC,IACJA,EAAOyC,GAAc5D,KAAKO,SAASkD,EAAGzD,KAAKmD,UAAWnD,KAAKoC,aAAa,OACxEpC,KAAKmB,KAAOA,GAGb0C,GAAe1C,EAAM,YACpB2C,OACCC,MAAO/D,KACPuB,SAAUvB,KAAKgE,kBAMbhE,KAAKgE,eAAeC,QACvB9C,EAAK+C,aAAa,mBAAoBlE,KAAKgE,eAAeC,OAAOE,IAAI,SAAUC,GAC9E,MAAO,IAAMA,EAAI,MACfC,KAAK,MAGLhB,GAAYrD,KAAKsE,WAAWtE,KAAKsE,UAAUnD,GAE3CnB,KAAKuB,SAAU,CAClB,GAAIgD,GAAWlB,EAAWmB,EAAQrD,EAAKsD,YAAcjC,MACrDxC,MAAKuB,SAASwB,OAAO5B,EAAMoD,GAGvBA,GACHA,EAAS7B,QAAQxB,GAInB,GAAImC,EAAU,CAETrD,KAAKC,SAAWD,KAAKC,QAAQyE,cAAc1E,KAAKC,QAAQ0E,YAAYxD,EAIxE,KADA,GAAIyD,GAAIzD,EAAKb,WAAWuE,OACjBD,KAAK,CACX,GAAI5C,GAAOb,EAAKb,WAAWsE,GAAG5C,IACzBhC,MAAKO,SAASC,GAAOwB,IAAQhC,MAAKO,SAASC,GAAIW,EAAK2D,gBAAgB9C,IAI3EhC,KAAKM,WAAWoC,QAAQqC,IACxB/E,KAAK4C,sBAAsBF,QAAQqC,IAE/B/E,KAAKgB,WAAWgE,GAAQC,aAAa,WACxC,MAAO/B,GAAOlC,UAAU+B,WACtB,GACC/C,KAAKC,SAASD,KAAKC,QAAQ8C,SAE/B/C,KAAK6C,cAAcH,QAAQqC,IAE3BG,GAAoBlF,MAGpBA,KAAKmF,iBAAmBC,GAAcpF,KAAMA,KAAKO,SAAS8E,IAAMrF,KAAKO,SAAS+E,GAAI,SAE7EjC,GACJL,EAAOuC,YAAYpE,GAGpBnB,KAAKwF,UAAW,GAGjBpF,EAAQC,UAAUoF,SAAW,WAC5B,GAAIC,GAAU1F,KAAKO,SAASkD,EAExBkC,EAAQ3F,KAAKM,WAAW6D,IAAIyB,IAAoBvB,KAAK,IAAMrE,KAAK4C,sBAAsBuB,IAAIyB,IAAoBvB,KAAK,GAGrG,YAAdrE,KAAKgC,MAAqBhC,KAAK6F,eAClCF,GAAS,aAIQ,UAAd3F,KAAKgC,MAAoB8D,GAAoB9F,QAChD2F,GAAS,WAGV,IAAII,GAAM,IAAML,EAAUC,EAAQ,GAElC,OAAI3F,MAAKgG,OAAeD,GAGN,aAAd/F,KAAKgC,MAAsDQ,SAA/BxC,KAAKoC,aAAa,SACjD2D,GAAOE,GAAWjG,KAAKoC,aAAa,UAIaI,SAAzCxC,KAAKoC,aAAa,qBACzB2D,GAAO/F,KAAKoC,aAAa,UAAY,IAGnCpC,KAAKuB,WACRwE,GAAO/F,KAAKuB,SAASkE,UAAU,sBAAsB/D,KAAK1B,KAAKO,SAASkD,KAGzEsC,GAAO,KAAOL,EAAU,MAIzBtF,EAAQC,UAAU6F,OAAS,WAC1BlG,KAAKM,WAAWoC,QAAQyD,IACxBnG,KAAK4C,sBAAsBF,QAAQyD,IAE/BnG,KAAKgB,WAAWhB,KAAKgB,UAAUkF,SAC/BlG,KAAKuB,UAAUvB,KAAKuB,SAAS2E,UAGlC9F,EAAQC,UAAUY,SAAW,SAAkBmF,GAC9C,GAAKpG,KAAKwF,SAAV,CACAxF,KAAKwF,UAAW,CAIhB,IAAIa,GAAarG,KAAKmF,gBAClBkB,IAAYA,EAAWC,WAGT,WAAdtG,KAAKgC,KAIRhC,KAAKe,SACKqF,GACVpB,GAAQuB,gBAAgBvG,MAGrBA,KAAKuB,UAAUvB,KAAKuB,SAASN,WAEjCjB,KAAK6C,cAAcH,QAAQ8D,IAEvBxG,KAAKC,SAASD,KAAKC,QAAQgB,YAC1BmF,GAAiBpG,KAAKgB,WAAWhB,KAAKgB,UAAUC,WAGrDmE,GAAcpF,KAAMA,KAAKO,SAAS8E,IAAMrF,KAAKO,SAASkG,GAAI,QAG1D,IAAIC,GAAK1G,KAAKsC,gBAAgBoE,EAC1BA,UACI1G,MAAKW,QAAQgG,MAAMD,EAAGnE,YAG9BqE,GAAsB5G,QAIvBI,EAAQC,UAAUwG,OAAS,WACtB7G,KAAK8G,QACR9G,KAAK8G,OAAQ,EAEb9G,KAAKM,WAAWoC,QAAQqE,IACxB/G,KAAK4C,sBAAsBF,QAAQqE,IACnC/G,KAAK6C,cAAcH,QAAQqE,IAEvB/G,KAAKgB,WAAWhB,KAAKgB,UAAU6F,SAC/B7G,KAAKuB,UAAUvB,KAAKuB,SAASsF,WAI5BzG,GACN4G,IAiGEC,GAAO,SAAUC,GAGpB,QAASD,GAAKE,GACbC,GAAaC,eAAerH,KAAMiH,EAElC,IAAIK,GAAQF,GAAaG,0BAA0BvH,KAAMkH,EAASM,KAAKxH,KAAMmH,GAG7E,OADAG,GAAMG,gBACCH,EAaR,MArBAF,IAAaM,SAAST,EAAMC,GAW5BD,EAAK5G,UAAU0C,OAAS,SAAgBC,EAAQC,GAC/CiE,EAAS7G,UAAU0C,OAAOyE,KAAKxH,KAAMgD,EAAQC,GAC7CjD,KAAKmB,KAAKwG,iBAAiB,QAASC,IAAa,IAGlDX,EAAK5G,UAAUY,SAAW,SAAkBmF,GAC3CpG,KAAKmB,KAAK0G,oBAAoB,QAASD,IAAa,GACpDV,EAAS7G,UAAUY,SAASuG,KAAKxH,KAAMoG,IAGjCa,GACN7G,IAcE0H,GAAW,SAAUC,GAGxB,QAASD,GAASX,GACjBC,GAAaC,eAAerH,KAAM8H,EAElC,IAAIR,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAU1E,OARAG,GAAMtD,eAAiBmD,EAAQnD,eAC/BsD,EAAM/G,SAAW4G,EAAQ5G,SACzB+G,EAAMU,MAAQb,EAAQa,MAEtBV,EAAMW,WAAad,EAAQ5G,SAAS2H,EAEpCZ,EAAMxG,MAAQ,KACdwG,EAAMR,OAAQ,EACPQ,EA4DR,MA3EAF,IAAaM,SAASI,EAAUC,GAkBhCD,EAASzH,UAAUF,KAAO,WACzB,GAAI+C,GAASlD,KAGTc,EAAQqH,GAAUnI,KAAKgE,eAAgBhE,KAAKO,UAC5CuD,EAAQhD,EAAQA,EAAMsH,MAAQ5F,MAElC,OAAIxC,MAAKiI,cACRjI,KAAKc,OAAUsH,IAAK,WAClB,MAAOtE,WAKNhD,GACHA,EAAMuH,SAASrI,MACfA,KAAKc,MAAQA,GAEbd,KAAKsI,SAAWtI,KAAKgE,eAAeuE,QAAQvI,KAAKO,SAASiI,EAAG,SAAU1H,GACtEoC,EAAOpC,MAAQA,EACfA,EAAMuH,SAASnF,GAEfA,EAAOuF,eACPvF,EAAOoF,SAAW,SAKrBR,EAASzH,UAAUoI,aAAe,WACjCzI,KAAK0I,UAGNZ,EAASzH,UAAUoC,OAAS,WAC3B,IAAIzC,KAAKiI,UAAajI,KAAKc,MAA3B,CAEA,GAAIA,GAAQqH,GAAUnI,KAAKgE,eAAgBhE,KAAKO,SAE5CO,KAAUd,KAAKc,QAEnBd,KAAKc,MAAM6H,WAAW3I,MAEtBA,KAAKc,MAAQA,EAETA,IACHA,EAAMuH,SAASrI,MACfA,KAAKyI,mBAIPX,EAASzH,UAAU6F,OAAS,WACtBlG,KAAKiI,WACTjI,KAAKc,OAASd,KAAKc,MAAM6H,WAAW3I,MACpCA,KAAKc,MAAQ0B,OACbxC,KAAKsI,UAAYtI,KAAKsI,SAASpC,WAI1B4B,GACNd,IAEE4B,GAAe,SAAUC,GAG5B,QAASD,KAER,MADAxB,IAAaC,eAAerH,KAAM4I,GAC3BxB,GAAaG,0BAA0BvH,KAAM6I,EAAUC,MAAM9I,KAAM+I,YAkE3E,MAtEA3B,IAAaM,SAASkB,EAAcC,GAOpCD,EAAavI,UAAUU,OAAS,WAC/B,MAAOG,GAAWlB,KAAKmB,OAGxByH,EAAavI,UAAU8B,UAAY,WAClC,MAAOnC,MAAKmB,MAGbyH,EAAavI,UAAU2I,UAAY,WAClC,MAAOhJ,MAAKc,MAAQmI,EAAkBjJ,KAAKc,MAAMsH,OAAS,IAG3DQ,EAAavI,UAAU0C,OAAS,SAAgBC,EAAQC,GACvD,GAAIa,GAAQ9D,KAAKgJ,WAIjB,IAFAhJ,KAAKwF,UAAW,EAEZvC,EAAW,CACd,GAAIK,GAAIL,EAAU,EACdK,IAAoB,IAAfA,EAAE4F,UACVjG,EAAUM,QACND,EAAE6F,YAAcrF,IACnBR,EAAE6F,UAAYrF,KAGfR,EAAItD,KAAKmB,KAAOiI,GAAIC,eAAevF,GAC/Bb,EAAU,GACbD,EAAOsG,aAAahG,EAAGL,EAAU,IAEjCD,EAAOuC,YAAYjC,IAIrBtD,KAAKmB,KAAOmC,MAEZtD,MAAKmB,KAAOiI,GAAIC,eAAevF,GAC/Bd,EAAOuC,YAAYvF,KAAKmB,OAI1ByH,EAAavI,UAAUoF,SAAW,SAAkB8D,GACnD,GAAIC,GAASxJ,KAAKgJ,WAClB,OAAOO,GAAStD,GAAWuD,GAAUA,GAGtCZ,EAAavI,UAAUY,SAAW,SAAkBmF,GAC/CA,GAAepG,KAAKe,SACxBf,KAAKwF,UAAW,GAGjBoD,EAAavI,UAAUwG,OAAS,WAC3B7G,KAAK8G,QACR9G,KAAK8G,OAAQ,EACT9G,KAAKwF,WACRxF,KAAKmB,KAAKsI,KAAOzJ,KAAKgJ,eAKzBJ,EAAavI,UAAUqJ,QAAU,WAChC,MAAO1J,MAAKc,MAAQd,KAAKc,MAAMsH,MAAQ5F,QAGjCoG,GACNd,IAEE6B,GAAQ,SAAUzC,GAGrB,QAASyC,KAER,MADAvC,IAAaC,eAAerH,KAAM2J,GAC3BvC,GAAaG,0BAA0BvH,KAAMkH,EAAS4B,MAAM9I,KAAM+I,YAQ1E,MAZA3B,IAAaM,SAASiC,EAAOzC,GAO7ByC,EAAMtJ,UAAU0C,OAAS,SAAgBC,EAAQC,GAChDiE,EAAS7G,UAAU0C,OAAOyE,KAAKxH,KAAMgD,EAAQC,GAC7CjD,KAAKmB,KAAKyI,aAAe5J,KAAKmB,KAAK2C,OAG7B6F,GACNvJ,IASEyJ,GAAS,SAAU3C,GAGtB,QAAS2C,GAAO1C,GACfC,GAAaC,eAAerH,KAAM6J,EAElC,IAAItJ,GAAW4G,EAAQ5G,QAClBA,GAASC,IAAGD,EAASC,MAIDgC,SAArBjC,EAASC,EAAEsD,OAAyB,YAAcvD,GAASC,IAC9DD,EAASC,EAAEsD,MAAQvD,EAASuJ,GAAK,GAGlC,IAAIxC,GAAQF,GAAaG,0BAA0BvH,KAAMkH,EAASM,KAAKxH,KAAMmH,GAG7E,OADAG,GAAMyC,OAASC,GAAiB1C,EAAM2C,QAC/B3C,EAqDR,MAtEAF,IAAaM,SAASmC,EAAQ3C,GAoB9B2C,EAAOxJ,UAAUF,KAAO,WACvB,IAAKH,KAAK+J,OAET,WADA7C,GAAS7G,UAAUF,KAAKqH,KAAKxH,KAM9B,IAAIkK,GAAoBlK,KAAKsC,gBAAgB6H,QAC7C,IAAID,GAA2D1H,SAAtCxC,KAAK+J,OAAO3H,aAAa,SAAwB,CACzE,GAAI4F,GAAQhI,KAAKM,WAAW8J,QAAQF,EACpClK,MAAKM,WAAW+J,OAAOrC,EAAO,SACvBhI,MAAKsC,gBAAgB6H,SAG7BjD,EAAS7G,UAAUF,KAAKqH,KAAKxH,MAC7BA,KAAK+J,OAAO5C,QAAQrF,KAAK9B,OAG1B6J,EAAOxJ,UAAUwF,WAAa,WAC7B,GAAIyE,GAActK,KAAKoC,aAAa,QAEpC,IAAoBI,SAAhB8H,IAA8BtK,KAAK+J,OACtC,OAAO,CAGR,IAAIQ,GAAcvK,KAAK+J,OAAO3H,aAAa,QAE3C,IAAImI,GAAeD,EAClB,OAAO,CAGR,IAAItK,KAAK+J,OAAO3H,aAAa,aAAeoI,EAAQD,GAEnD,IADA,GAAI3F,GAAI2F,EAAY1F,OACbD,KACN,GAAI2F,EAAY3F,IAAM0F,EACrB,OAAO,GAMXT,EAAOxJ,UAAU6F,OAAS,WACzBgB,EAAS7G,UAAU6F,OAAOsB,KAAKxH,MAE3BA,KAAK+J,QACRU,EAAgBzK,KAAK+J,OAAO5C,QAASnH,OAIhC6J,GACNzJ,IA+FEsK,GAAU,SAAU7B,GAGvB,QAAS6B,KAER,MADAtD,IAAaC,eAAerH,KAAM0K,GAC3BtD,GAAaG,0BAA0BvH,KAAM6I,EAAUC,MAAM9I,KAAM+I,YAgJ3E,MApJA3B,IAAaM,SAASgD,EAAS7B,GAO/B6B,EAAQrK,UAAUF,KAAO,WAExBH,KAAK2K,QAAU3K,KAAKO,SAASiI,CAG7B,IAAIjI,GAAWP,KAAK2K,QAAUC,GAAmB5K,KAAKW,QAASX,KAAK2K,QAAS3K,KAAKgE,iBAAmB,KAAO,KACxG6G,EAAc,MAEdtK,KACHP,KAAK8K,OAAQ,EACb9K,KAAK+K,YAAY/K,KAAKO,SAASiI,EAAGjI,IAG9BA,IACJsI,EAAUxI,UAAUF,KAAKqH,KAAKxH,MAC1BA,KAAKc,QAAU+J,EAAc7K,KAAKc,MAAMsH,QAAoG,YAAlE,mBAAhByC,GAA8B,YAAczD,GAAAA,UAAoByD,MAA+D,gBAAzBA,GAAYtK,UAAyBiK,EAAQK,EAAYG,KACxNH,EAAYtK,WACfsK,EAAcI,GAAajL,KAAKO,SAASiI,EAAGqC,EAAYtK,SAAUP,KAAKW,UAExEX,KAAK+K,YAAY/K,KAAKO,SAASiI,EAAGqC,EAAYG,IAClChL,KAAKc,OAAqC,gBAArBd,MAAKc,MAAMsH,QAAuBpI,KAAK2K,QAGxE3K,KAAK+K,YAAY/K,KAAKc,MAAMsH,OAF5BpI,KAAK+K,YAAY/K,KAAK2K,QAASpK,IAMjCP,KAAKuB,SAAW,GAAI2J,KACnBC,MAAOnL,KACPO,SAAUP,KAAKoL,kBACbjL,QAGJuK,EAAQrK,UAAUU,OAAS,WAC1B,MAAOf,MAAKuB,SAASR,UAGtB2J,EAAQrK,UAAUe,KAAO,SAAcC,GACtC,MAAOrB,MAAKuB,SAASH,KAAKC,IAG3BqJ,EAAQrK,UAAUmB,QAAU,SAAiBH,EAAUI,GACtDzB,KAAKuB,SAASC,QAAQH,EAAUI,IAGjCiJ,EAAQrK,UAAU0B,cAAgB,SAAuBC,GACxD,MAAOhC,MAAKuB,SAASQ,cAAcC,IAGpC0I,EAAQrK,UAAU4B,kBAAoB,SAA2BD,EAAMP,GACtEzB,KAAKuB,SAASU,kBAAkBD,EAAMP,IAGvCiJ,EAAQrK,UAAU8B,UAAY,SAAmBkJ,GAChD,MAAOrL,MAAKuB,SAASY,UAAUkJ,IAGhCX,EAAQrK,UAAUiL,mBAAqB,WACtCtL,KAAKoL,gBAAkB5I,OAGnBxC,KAAK2K,UACR3K,KAAKoL,gBAAkBR,GAAmB5K,KAAKW,QAASX,KAAK2K,QAAS3K,KAAKgE,iBAIvEhE,KAAKoL,kBACTpL,KAAKoL,gBAAkBR,GAAmB5K,KAAKW,QAASX,KAAKgC,KAAMhC,KAAKgE,iBAGpEhE,KAAKoL,kBACTG,EAAgB,wCAA2CvL,KAAKgC,KAAO,KACvEhC,KAAKoL,oBAGNpL,KAAKuB,SAASiK,cAAcxL,KAAKoL,iBACjCpL,KAAK0I,UAGNgC,EAAQrK,UAAUoC,OAAS,WAC1BoG,EAAUxI,UAAU6F,OAAOsB,KAAKxH,MAChC6I,EAAUxI,UAAUF,KAAKqH,KAAKxH,MAC9BA,KAAKuB,SAASkB,UAGfiI,EAAQrK,UAAU0C,OAAS,SAAgBC,EAAQC,GAClDjD,KAAKuB,SAASwB,OAAOC,EAAQC,IAG9ByH,EAAQrK,UAAU0K,YAAc,SAAqB/I,EAAMzB,GAC1DP,KAAKgC,KAAOA,EAEPzB,GAAyB,OAAbA,IAAmBA,EAAWqK,GAAmB5K,KAAKW,QAASqB,EAAMhC,KAAKgE,iBAEtFzD,GACJgL,EAAgB,wCAA2CvJ,EAAO,KAGnEhC,KAAKoL,gBAAkB7K,OAGxBmK,EAAQrK,UAAUoF,SAAW,SAAkB8D,GAC9C,MAAOvJ,MAAKuB,SAASkE,SAAS8D,IAG/BmB,EAAQrK,UAAU6F,OAAS,WAC1B2C,EAAUxI,UAAU6F,OAAOsB,KAAKxH,MAChCA,KAAKuB,SAAS2E,UAGfwE,EAAQrK,UAAUY,SAAW,SAAkBmF,GAC9CpG,KAAKuB,SAASN,SAASmF,IAGxBsE,EAAQrK,UAAUwG,OAAS,WAC1B,GAAItG,GAAW,MAEXP,MAAK8G,QACR9G,KAAK8G,OAAQ,EAER9G,KAAK8K,QACL9K,KAAKc,QACRP,EAAWP,KAAKc,MAAMsH,OAGnB7H,GAAgC,gBAAbA,IAAyBA,IAAaP,KAAKgC,MACjEhC,KAAK+K,YAAYxK,GACjBP,KAAKuB,SAASiK,cAAcxL,KAAKoL,kBACvB7K,GAAgG,YAA/D,mBAAbA,GAA2B,YAAc6G,GAAAA,UAAoB7G,MAAyD,gBAAtBA,GAASA,UAAyBiK,EAAQjK,EAASyK,MAC7KzK,EAASA,WACZA,EAAW0K,GAAajL,KAAKgC,KAAMzB,EAASA,SAAUP,KAAKW,UAE5DX,KAAK+K,YAAY/K,KAAKgC,KAAMzB,EAASyK,GACrChL,KAAKuB,SAASiK,cAAcxL,KAAKoL,mBAInCpL,KAAKuB,SAASsF,WAIT6D,GACN5C,IAcE2D,GAAmB,WACtB,QAASA,GAAiBtE,GACzBC,GAAaC,eAAerH,KAAMyL,GAElCzL,KAAKiK,OAAS9C,EAAQgE,MAAMnH,eAI5BhE,KAAKgE,eAAiBhE,KACtBA,KAAKmL,MAAQhE,EAAQgE,MACrBnL,KAAKW,QAAUX,KAAKiK,OAAOtJ,QAG3BX,KAAKiE,OAAS,UAAYkD,GAAUA,EAAQlD,OAASjE,KAAKiK,OAASjK,KAAKiK,OAAOhG,OAAS,KAExFjE,KAAK0L,QAAU,KACf1L,KAAKwF,UAAW,EAChBxF,KAAK2L,cAEL3L,KAAKO,SAAW4G,EAAQ5G,SAExBP,KAAK4L,SAAWzE,EAAQyE,SACxB5L,KAAK6L,OAAS1E,EAAQ0E,OAEtB7L,KAAK8L,kBAAoB,KACzB9L,KAAK+L,mBAAqB,KAG1B/L,KAAKwK,SAAU,EAiZhB,MA9YAiB,GAAiBpL,UAAUF,KAAO,SAAcuL,GAC/C,GAAIpE,GAAQtH,IAEZA,MAAK0L,QAAUA,CACf,IAAI5H,GAAQ4H,EAAQtD,KAGpB,IAAIpI,KAAKwK,QAAUA,EAAQ1G,GAAQ,CAElC9D,KAAK2L,aACL,KAAK,GAAI/G,GAAI,EAAGA,EAAId,EAAMe,OAAQD,GAAK,EACtC5E,KAAK2L,WAAW/G,GAAK5E,KAAKgM,gBAAgBpH,EAAGA,OAK1C,IAAIqH,EAASnI,GAAQ,CAIxB,GAHA9D,KAAKwK,SAAU,EAGXxK,KAAK4L,SAAU,CAClB,GAAIM,GAAOlM,KAAK4L,SAASO,MAAM,IAC/BnM,MAAK6L,OAASK,EAAK,GACnBlM,KAAK4L,SAAWM,EAAK,GAGtBlM,KAAK2L,WAAaS,OAAOC,KAAKvI,GAAOK,IAAI,SAAUmI,EAAKtE,GACvD,MAAOV,GAAM0E,gBAAgBM,EAAKtE,KAIrC,MAAOhI,OAGRyL,EAAiBpL,UAAUqI,OAAS,WACnC1I,KAAKmL,MAAMzC,UAGZ+C,EAAiBpL,UAAU2L,gBAAkB,SAAyBM,EAAKtE,GAC1E,GAAIzG,GAAW,GAAI2J,KAClBC,MAAOnL,KACPO,SAAUP,KAAKO,UAIhBgB,GAAS+K,IAAMA,EACf/K,EAASyG,MAAQA,EACjBzG,EAASgL,aAAc,CAEvB,IAAIzL,GAAQd,KAAK0L,QAAQc,QAAQF,EAQjC,OALItM,MAAKmL,MAAM5K,SAASkM,IACvBlL,EAASmL,WACTnL,EAASmL,QAAQ1M,KAAKmL,MAAM5K,SAASkM,EAAE,GAAGnJ,GAAKxC,GAGzCS,EAASpB,KAAKW,IAGtB2K,EAAiBpL,UAAUU,OAAS,WACnC,GAAI4L,GAAUC,GAId,OAHA5M,MAAK2L,WAAWjJ,QAAQ,SAAUnB,GACjC,MAAOoL,GAAQpH,YAAYhE,EAASR,YAE9B4L,GAGRlB,EAAiBpL,UAAUe,KAAO,SAAcC,GAC/C,GAAIwL,GAAM7M,KAAK2L,WAAW9G,OACtBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIkI,GAAQ9M,KAAK2L,WAAW/G,GAAGxD,KAAKC,EACpC,IAAIyL,EAAO,MAAOA,KAIpBrB,EAAiBpL,UAAUmB,QAAU,SAAiBH,EAAUI,GAC/D,GAAIoL,GAAM7M,KAAK2L,WAAW9G,OACtBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EACzB5E,KAAK2L,WAAW/G,GAAGpD,QAAQH,EAAUI,IAIvCgK,EAAiBpL,UAAU0B,cAAgB,SAAuBC,GACjE,GAAI6K,GAAM7M,KAAK2L,WAAW9G,OACtBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIkI,GAAQ9M,KAAK2L,WAAW/G,GAAG7C,cAAcC,EAC7C,IAAI8K,EAAO,MAAOA,KAIpBrB,EAAiBpL,UAAU4B,kBAAoB,SAA2BD,EAAMP,GAC/E,GAAIoL,GAAM7M,KAAK2L,WAAW9G,OACtBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EACzB5E,KAAK2L,WAAW/G,GAAG3C,kBAAkBD,EAAMP,IAI7CgK,EAAiBpL,UAAU6B,aAAe,SAAsB6K,GAC/D,GAAIA,EAAU/E,MAAQhI,KAAK2L,WAAW9G,OAAS,EAC9C,IAAK,GAAID,GAAImI,EAAU/E,MAAQ,EAAGpD,EAAI5E,KAAK2L,WAAW9G,OAAQD,IAAK,CAClE,GAAIzD,GAAOnB,KAAK2L,WAAW/G,GAAGzC,WAAU,EACxC,IAAIhB,EAAM,MAAOA,GAInB,MAAOnB,MAAKmL,MAAMjJ,gBAGnBuJ,EAAiBpL,UAAU8B,UAAY,SAAmBkJ,GACzD,MAAOrL,MAAK2L,WAAW,GAAK3L,KAAK2L,WAAW,GAAGxJ,UAAUkJ,GAAc,MAGxEI,EAAiBpL,UAAUoC,OAAS,SAAgBiJ,GACnD,GAAIxI,GAASlD,IAEbA,MAAK0L,QAAUA,EAEf1L,KAAK2L,WAAWjJ,QAAQ,SAAUnB,GACjC,GAAIT,GAAQ4K,EAAQc,QAAQjL,EAAS+K,KAAO/K,EAASyG,MACjD9E,GAAOiI,MAAM5K,SAASkM,IACzBlL,EAASmL,WACTnL,EAASmL,QAAQxJ,EAAOiI,MAAM5K,SAASkM,EAAE,GAAGnJ,GAAKxC,GAElDS,EAASkB,OAAO3B,MAIlB2K,EAAiBpL,UAAU0C,OAAS,SAAgBC,EAAQC,GAGvDjD,KAAK2L,YACR3L,KAAK2L,WAAWjJ,QAAQ,SAAUnB,GACjC,MAAOA,GAASwB,OAAOC,EAAQC,KAIjCjD,KAAKwF,UAAW,GAGjBiG,EAAiBpL,UAAU2M,QAAU,SAAiBC,GACrD,GAAIC,GAASlN,IAERA,MAAK8L,oBAAmB9L,KAAK+L,mBAAqB/L,KAAK2L,WAAWwB,SAElEnN,KAAK8L,oBAAmB9L,KAAK8L,sBAElC9L,KAAK8L,kBAAkBhK,KAAKmL,EAE5B,IAAItB,KAEJsB,GAAWvK,QAAQ,SAAU0K,EAAUC,GACtC,GAAiB,KAAbD,EAAJ,CAEA,GAAI7L,GAAW2L,EAAOvB,WAAW0B,EACjC1B,GAAWyB,GAAY7L,EAEnB6L,IAAaC,GAAY9L,IAAUA,EAASuF,OAAQ,MAGzD9G,KAAK2L,WAAaA,EAElB3L,KAAK0I,UAGN+C,EAAiBpL,UAAUoF,SAAW,SAAkB8D,GACvD,MAAOvJ,MAAK2L,WAAa3L,KAAK2L,WAAWxH,IAAIoF,EAAS+D,GAAkBC,IAAWlJ,KAAK,IAAM,IAG/FoH,EAAiBpL,UAAU6F,OAAS,WAEnC,MADAlG,MAAK2L,WAAWjJ,QAAQyD,IACjBnG,MAGRyL,EAAiBpL,UAAUY,SAAW,SAAkBmF,GACvDpG,KAAK2L,WAAWjJ,QAAQ0D,EAAgBoH,GAAqBhH,IACzDxG,KAAK8L,mBAAqB9L,KAAK+L,oBAClC/L,KAAK+L,mBAAmBrJ,QAAQ,SAAUnB,GACrCA,EAASiE,WAAUY,EAAgBoH,GAAmBjM,GAAYiF,GAAUjF,MAGlFvB,KAAKwF,UAAW,GAMjBiG,EAAiBpL,UAAUwG,OAAS,WACnC,GAAI4G,GAASzN,IAIb,IAAIA,KAAK8L,kBAER,WADA9L,MAAK0N,mBAIN,KAAI1N,KAAK2N,SAAT,CACA3N,KAAK2N,UAAW,CAEhB,IAAI7J,GAAQ9D,KAAK0L,QAAQtD,MACrBwF,EAAW5N,KAAKwK,QAEhBqD,EAAW,OACXC,EAAU,OACVC,GAAQ,EACRnJ,EAAI,MAER,IAAI5E,KAAKwK,QAAUA,EAAQ1G,GACtB8J,IACHG,GAAQ,EACJ/N,KAAK2L,WAAW9G,OAASf,EAAMe,SAClCgJ,EAAW7N,KAAK2L,WAAWtB,OAAOvG,EAAMe,cAGpC,IAAIoH,EAASnI,KAAW8J,EAM9B,IALAG,GAAQ,EACRF,KACAC,KACAlJ,EAAI5E,KAAK2L,WAAW9G,OAEbD,KAAK,CACX,GAAIoJ,GAAYhO,KAAK2L,WAAW/G,EAC5BoJ,GAAU1B,MAAOxI,GACpBgK,EAAQE,EAAU1B,MAAO,GAEzBtM,KAAK2L,WAAWtB,OAAOzF,EAAG,GAC1BiJ,EAAS/L,KAAKkM,IAKbD,IACHF,EAAW7N,KAAK2L,WAChB3L,KAAK2L,eAGFkC,GACHA,EAASnL,QAAQ,SAAUnB,GAC1BA,EAAS2E,SACT3E,EAASN,UAAS,KAKpBjB,KAAK2L,WAAWjJ,QAAQqE,GAGxB,IAAIkH,GAAYzD,EAAQ1G,GAASA,EAAMe,OAASoH,EAASnI,GAASsI,OAAOC,KAAKvI,GAAOe,OAAS,EAE1F8H,EAAU,OACVpL,EAAW,MAEf,IAAI0M,EAAYjO,KAAK2L,WAAW9G,OAAQ,CAIvC,GAHA8H,EAAU3M,KAAKwF,SAAWoH,IAA2B,KACrDhI,EAAI5E,KAAK2L,WAAW9G,OAEhB2F,EAAQ1G,GACX,KAAOc,EAAId,EAAMe,QAChBtD,EAAWvB,KAAKgM,gBAAgBpH,EAAGA,GAEnC5E,KAAK2L,WAAW7J,KAAKP,GACjBvB,KAAKwF,UAAUjE,EAASwB,OAAO4J,GAEnC/H,GAAK,MAEA,IAAIqH,EAASnI,GAAQ,CAE3B,GAAI9D,KAAK4L,WAAa5L,KAAK6L,OAAQ,CAClC,GAAIK,GAAOlM,KAAK4L,SAASO,MAAM,IAC/BnM,MAAK6L,OAASK,EAAK,GACnBlM,KAAK4L,SAAWM,EAAK,GAGtBE,OAAOC,KAAKvI,GAAOpB,QAAQ,SAAU4J,GAC/BwB,GAAaxB,IAAOwB,KACxBvM,EAAWkM,EAAOzB,gBAAgBM,EAAK1H,GAEvC6I,EAAO9B,WAAW7J,KAAKP,GACnBkM,EAAOjI,UAAUjE,EAASwB,OAAO4J,GAErC/H,GAAK,KAKR,GAAI5E,KAAKwF,SAAU,CAClB,GAAI0I,GAAalO,KAAKiK,OAAOkE,iBACzBC,EAASpO,KAAKiK,OAAO/H,aAAalC,KAAKmL,MAE3C+C,GAAW5E,aAAaqD,EAASyB,IAInCpO,KAAK2N,UAAW,IAGjBlC,EAAiBpL,UAAUqN,kBAAoB,WAC9C,GAAIW,GAASrO,KAETiN,EAAajN,KAAK8L,kBAAkB,EAGxC9L,MAAK8L,kBAAkBqB,MAAM,GAAGzK,QAAQ,SAAU4L,GACjDrB,EAAWvK,QAAQ,SAAU0K,EAAUC,GACtCJ,EAAWI,GAAYiB,EAAQlB,MAOjC,IAAIP,GAAM7M,KAAK0L,QAAQtD,MAAMvD,OACzBD,EAAI,OACJ2J,EAAS,EACTC,GAAS,CAEbvB,GAAWvK,QAAQ,SAAU0K,EAAUC,GACtC,GAAI9L,GAAW8M,EAAOtC,mBAAmBsB,EAQzC,IALKmB,GAAuB,KAAbpB,IACCmB,EAAXnB,IAAmBoB,GAAS,GAC5BpB,EAAWmB,IAAQA,EAASnB,IAGhB,KAAbA,EACH7L,EAAS2E,SAASjF,UAAS,OACrB,CACNM,EAASyG,MAAQoF,CACjB,IAAItM,GAAQuN,EAAO3C,QAAQc,QAAQY,EAC/BiB,GAAOlD,MAAM5K,SAASkM,IACzBlL,EAASmL,WACTnL,EAASmL,QAAQ2B,EAAOlD,MAAM5K,SAASkM,EAAE,GAAGnJ,GAAKxC,GAElDS,EAASkB,OAAO3B,KAKlB,IAAI6L,GAAU3M,KAAKwF,SAAWoH,IAA2B,KACrDsB,EAAalO,KAAKwF,SAAWxF,KAAKiK,OAAOkE,iBAAmB,IAEhE,IAAIK,EACH,IAAK5J,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAI6J,GAAOzO,KAAK2L,WAAW/G,EAEvB5E,MAAKwF,WACJiJ,EACH9B,EAAQpH,YAAYkJ,EAAK1N,WAEzBf,KAAK2L,WAAW/G,GAAK5E,KAAKgM,gBAAgBpH,EAAGA,GAC7C5E,KAAK2L,WAAW/G,GAAG7B,OAAO4J,KAIvB3M,KAAKwF,UACJiJ,IACJzO,KAAK2L,WAAW/G,GAAK5E,KAAKgM,gBAAgBpH,EAAGA,QAKhD,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,IAAK,CACzB,GAAI8J,GAAQ1O,KAAK2L,WAAW/G,EAExB5E,MAAKwF,UACJkJ,GAAS/B,EAAQlI,WAAWI,QAC/BqJ,EAAW5E,aAAaqD,EAAS+B,EAAMvM,aAGnCuM,IACJA,EAAQ1O,KAAK2L,WAAW/G,GAAK5E,KAAKgM,gBAAgBpH,EAAGA,GACrD8J,EAAM3L,OAAO4J,KAEH+B,IACX1O,KAAK2L,WAAW/G,GAAK5E,KAAKgM,gBAAgBpH,EAAGA,IAK5C5E,KAAKwF,UAAYmH,EAAQlI,WAAWI,QACvCqJ,EAAW5E,aAAaqD,EAAS3M,KAAKmL,MAAMjJ,gBAG7ClC,KAAK2L,WAAWjJ,QAAQqE,IAExB/G,KAAK8L,kBAAoB,MAGnBL,KAcJkD,GAAU,SAAU9F,GAGvB,QAAS8F,GAAQxH,GAChBC,GAAaC,eAAerH,KAAM2O,EAElC,IAAIrH,GAAQF,GAAaG,0BAA0BvH,KAAM6I,EAAUrB,KAAKxH,KAAMmH,GAK9E,OAHAG,GAAMsH,YAAczH,EAAQ5G,SAAS+C,GAAK,KAC1CgE,EAAMuH,oBAAsBvH,EAAMsH,YAClCtH,EAAM/F,SAAW,KACV+F,EA0LR,MApMAF,IAAaM,SAASiH,EAAS9F,GAa/B8F,EAAQtO,UAAUF,KAAO,WACxB0I,EAAUxI,UAAUF,KAAKqH,KAAKxH,MAG1BA,KAAKc,OACRd,KAAK8G,OAAQ,EACb9G,KAAK6G,UACK7G,KAAK4O,aAAe5O,KAAK4O,cAAgBE,KACnD9O,KAAKuB,SAAW,GAAI2J,KACnBC,MAAOnL,KACPO,SAAUP,KAAKO,SAASuJ,IACtB3J,SAILwO,EAAQtO,UAAUU,OAAS,WAC1B,MAAOf,MAAKuB,SAAWvB,KAAKuB,SAASR,SAAW6L,KAGjD+B,EAAQtO,UAAUe,KAAO,SAAcC,GACtC,MAAIrB,MAAKuB,SACDvB,KAAKuB,SAASH,KAAKC,GAD3B,QAKDsN,EAAQtO,UAAUmB,QAAU,SAAiBH,EAAUI,GAClDzB,KAAKuB,UACRvB,KAAKuB,SAASC,QAAQH,EAAUI,IAIlCkN,EAAQtO,UAAU0B,cAAgB,SAAuBC,GACxD,MAAIhC,MAAKuB,SACDvB,KAAKuB,SAASQ,cAAcC,GADpC,QAKD2M,EAAQtO,UAAU4B,kBAAoB,SAA2BD,EAAMP,GAClEzB,KAAKuB,UACRvB,KAAKuB,SAASU,kBAAkBD,EAAMP,IAIxCkN,EAAQtO,UAAU8B,UAAY,SAAmBkJ,GAChD,MAAOrL,MAAKuB,UAAYvB,KAAKuB,SAASY,UAAUkJ,IAGjDsD,EAAQtO,UAAUoC,OAAS,WAC1BoG,EAAUxI,UAAUoC,OAAO+E,KAAKxH,MAE5BA,KAAKuB,UACRvB,KAAKuB,SAASkB,OAAOzC,KAAK4O,cAAgBG,IAAc/O,KAAK4O,cAAgBE,GAAiB,KAAO9O,KAAKc,QAI5G6N,EAAQtO,UAAU0C,OAAS,SAAgBC,EAAQC,GAClDjD,KAAKwF,UAAW,EACZxF,KAAKuB,UAAUvB,KAAKuB,SAASwB,OAAOC,EAAQC,IAGjD0L,EAAQtO,UAAU2M,QAAU,SAAiBC,GACxCjN,KAAKuB,UAAYvB,KAAK4O,cAAgBI,IACzChP,KAAKuB,SAASyL,QAAQC,IAIxB0B,EAAQtO,UAAUoF,SAAW,SAAkB8D,GAC9C,MAAOvJ,MAAKuB,SAAWvB,KAAKuB,SAASkE,SAAS8D,GAAU,IAGzDoF,EAAQtO,UAAU6F,OAAS,WAC1B2C,EAAUxI,UAAU6F,OAAOsB,KAAKxH,MAC5BA,KAAKuB,UAAUvB,KAAKuB,SAAS2E,UAGlCyI,EAAQtO,UAAUY,SAAW,SAAkBmF,GAC1CpG,KAAKwF,UAAYxF,KAAKuB,UAAUvB,KAAKuB,SAASN,SAASmF,GAC3DpG,KAAKwF,UAAW,GAGjBmJ,EAAQtO,UAAUwG,OAAS,WAC1B,GAAK7G,KAAK8G,QACL9G,KAAKc,OAASd,KAAK4O,cAAgBE,IAAxC,CAEA9O,KAAK8G,OAAQ,CAEb,IAAIhD,GAAS9D,KAAKc,MAAoBd,KAAKc,MAAMmO,OAASjP,KAAKc,MAAMgD,MAAQ9D,KAAKc,MAAMsH,MAA9D5F,OACtB0M,EAAWlP,KAAK4O,WAGK,QAArB5O,KAAK4O,aAAqD,OAA7B5O,KAAK6O,sBAA8B7O,KAAK4O,YAAcO,GAAQrL,EAAO9D,KAAKO,SAASqE,IAChHsK,GAAYA,IAAalP,KAAK4O,aAAe5O,KAAKuB,WACjDvB,KAAKwF,UACRxF,KAAKuB,SAAS2E,SAASjF,UAAS,GAGjCjB,KAAKuB,SAAW,KAGjB,IAAI6N,GAAc,MAElB,IAAIpP,KAAK4O,cAAgBI,GACpBhP,KAAKuB,SACRvB,KAAKuB,SAASsF,SAGduI,EAAc,GAAI3D,KACjBN,MAAOnL,KACPO,SAAUP,KAAKO,SAASuJ,EACxB8B,SAAU5L,KAAKO,SAASqE,IACtBzE,KAAKH,KAAKc,WAKV,IAAId,KAAK4O,cAAgBS,GACxBrP,KAAKuB,SACRvB,KAAKuB,SAASsF,SAEduI,EAAc,GAAIlE,KACjBC,MAAOnL,KACPO,SAAUP,KAAKO,SAASuJ,IACtB3J,KAAKH,KAAKc,WAER,IAAId,KAAK4O,cAAgBU,GAC3BtP,KAAKuB,SACJgO,GAAQzL,IACP9D,KAAKwF,UACRxF,KAAKuB,SAAS2E,SAASjF,UAAS,GAGjCjB,KAAKuB,SAAW,MAEhBvB,KAAKuB,SAASsF,SAEJ0I,GAAQzL,KACnBsL,EAAc,GAAIlE,KACjBC,MAAOnL,KACPO,SAAUP,KAAKO,SAASuJ,IACtB3J,KAAKH,KAAKc,YAER,CACN,GAAI0O,GAAsBxP,KAAK4O,cAAgBE,GAAiBS,GAAQzL,KAAWA,IAAUyL,GAAQzL,EAEjG9D,MAAKuB,SACJiO,EACHxP,KAAKuB,SAASsF,UAEV7G,KAAKwF,UACRxF,KAAKuB,SAAS2E,SAASjF,UAAS,GAGjCjB,KAAKuB,SAAW,MAEPiO,IACVJ,EAAc,GAAIlE,KACjBC,MAAOnL,KACPO,SAAUP,KAAKO,SAASuJ,IACtB3J,KAAK,OAIX,GAAIiP,EAAa,CAChB,GAAIpP,KAAKwF,SAAU,CAClB,GAAI0I,GAAalO,KAAKgE,eAAemK,iBACjCC,EAASpO,KAAKgE,eAAe9B,aAAalC,KAE9C,IAAIoO,EAAQ,CACX,GAAIzB,GAAUC,GACdwC,GAAYrM,OAAO4J,GAInByB,EAAOF,WAAW5E,aAAaqD,EAASyB,OAExCgB,GAAYrM,OAAOmL,GAIrBlO,KAAKuB,SAAW6N,KAIXT,GACN7G,IASE2H,GAAS,SAAUvI,GAGtB,QAASuI,GAAOtI,GACfC,GAAaC,eAAerH,KAAMyP,EAElC,IAAInI,GAAQF,GAAaG,0BAA0BvH,KAAMkH,EAASM,KAAKxH,KAAMmH,GAG7E,OADAG,GAAMH,WACCG,EAmFR,MA3FAF,IAAaM,SAAS+H,EAAQvI,GAW9BuI,EAAOpP,UAAUiE,UAAY,SAAmBnD,GAC/C,GAAInB,KAAKC,QAAS,CACjB,GAAIyP,GAAkBC,GAAmBxO,EAErCuO,GAAgB7K,OAAS,IAC5B7E,KAAK0P,gBAAkBA,KAK1BD,EAAOpP,UAAU0C,OAAS,SAAgBC,EAAQC,GACjDiE,EAAS7G,UAAU0C,OAAOyE,KAAKxH,KAAMgD,EAAQC,GAC7CjD,KAAK4P,MAKL,KAHA,GAAIzO,GAAOnB,KAAKmB,KAEZyD,EAAIzD,EAAKgG,QAAQtC,OACdD,KACNzD,EAAKgG,QAAQvC,GAAGiL,gBAAkB1O,EAAKgG,QAAQvC,GAAGuF,QAGnDnK,MAAKwF,UAAW,GAGjBiK,EAAOpP,UAAUuP,KAAO,WACvB,GAAI1M,GAASlD,KAET8P,EAAa9P,KAAKmB,IAEtB,IAAK2O,EAAL,CAEA,GAAI3I,GAAU3C,EAAQsL,EAAW3I,QAEjC,IAAInH,KAAK0P,gBAMR,MALAvI,GAAQzE,QAAQ,SAAUqN,GACrB7M,EAAOwM,gBAAgBtF,QAAQ2F,IAAM,EAAGA,EAAE5F,UAAW,EAAU4F,EAAE5F,UAAW,IAEjFnK,KAAKC,QAAQ0E,YAAYmL,cAClB9P,MAAK0P,eAIb,IAAInF,GAAcvK,KAAKoC,aAAa,SAChC4N,EAAahQ,KAAKoC,aAAa,WAInC,IAAoBI,SAAhB+H,EAA2B,CAC9B,GAAI0F,GAAoB,MAExB9I,GAAQzE,QAAQ,SAAUqN,GACzB,GAAIzF,GAAcyF,EAAEG,SAAWH,EAAEG,SAASpM,MAAQiM,EAAEjM,MAChDqM,EAAeH,EAAaI,GAAc7F,EAAaD,GAAeC,GAAeD,CAErF6F,KACHF,GAAoB,GAGrBF,EAAE5F,SAAWgG,IAGTF,GAAsBD,GACtBhQ,KAAKC,SACRD,KAAKC,QAAQoQ,kBAOPrQ,MAAKC,SACZD,KAAKC,QAAQoQ,gBAIhBZ,EAAOpP,UAAUwG,OAAS,WACzBK,EAAS7G,UAAUwG,OAAOW,KAAKxH,MAC/BA,KAAK4P,QAGCH,GACNrP,IAEEkQ,GAAW,SAAUC,GAGxB,QAASD,GAASnJ,GACjBC,GAAaC,eAAerH,KAAMsQ,EAElC,IAAI/P,GAAW4G,EAAQ5G,QAcvB,OAXIA,GAASC,GAAKD,EAASC,EAAEsD,OAAS0M,IAAajQ,SAAUA,EAASC,EAAEsD,QACvEqD,EAAQsJ,WAAY,GAIZlQ,EAASuJ,GAAOvJ,EAASC,GAAMD,EAASC,EAAEsD,QAAU0M,IAAajQ,SAAUA,EAASuJ,MACtFvJ,EAASC,IAAGD,EAASC,MAC1BD,EAASC,EAAEsD,MAAQvD,EAASuJ,EAC5B3C,EAAQsJ,WAAY,GAGfrJ,GAAaG,0BAA0BvH,KAAMuQ,EAAO/I,KAAKxH,KAAMmH,IAoBvE,MAvCAC,IAAaM,SAAS4I,EAAUC,GAsBhCD,EAASjQ,UAAUqI,OAAS,WAC3B,GAAIxF,GAASlD,IAERA,MAAK8G,QACT9G,KAAK8G,OAAQ,EAET9G,KAAKwF,WAAaxF,KAAKC,SAAWD,KAAKuB,UAC1CyD,GAAQC,aAAa,WACpB/B,EAAO4D,OAAQ,EACf5D,EAAO/B,KAAK2C,MAAQZ,EAAO3B,SAASkE,aAItCzF,KAAKgE,eAAe0E,WAIf4H,GACN3G,IAEE+G,GAAO,SAAU3I,GAGpB,QAAS2I,GAAKvJ,GACbC,GAAaC,eAAerH,KAAM0Q,EAElC,IAAIpJ,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAG1E,OADAG,GAAMqJ,KAAOC,GACNtJ,EAkER,MA1EAF,IAAaM,SAASgJ,EAAM3I,GAW5B2I,EAAKrQ,UAAUF,KAAO,aAItBuQ,EAAKrQ,UAAUU,OAAS,WACvB,MAAOG,GAAWlB,KAAKmB,OAGxBuP,EAAKrQ,UAAU8B,UAAY,WAC1B,MAAOnC,MAAKmB,MAGbuP,EAAKrQ,UAAUoC,OAAS,aAIxBiO,EAAKrQ,UAAU0C,OAAS,SAAgBC,EAAQC,GAG/C,GAFAjD,KAAKwF,UAAW,EAEZvC,EAAW,CACd,GAAIK,GAAIL,EAAU,EACdK,IAAoB,IAAfA,EAAE4F,UACVjG,EAAUM,QACND,EAAE6F,YAAcnJ,KAAKO,WACxB+C,EAAE6F,UAAYnJ,KAAKO,YAGpB+C,EAAItD,KAAKmB,KAAOiI,GAAIC,eAAerJ,KAAKO,UACpC0C,EAAU,GACbD,EAAOsG,aAAahG,EAAGL,EAAU,IAEjCD,EAAOuC,YAAYjC,IAIrBtD,KAAKmB,KAAOmC,MAEZtD,MAAKmB,KAAOiI,GAAIC,eAAerJ,KAAKO,UACpCyC,EAAOuC,YAAYvF,KAAKmB,OAI1BuP,EAAKrQ,UAAUoF,SAAW,SAAkB8D,GAC3C,MAAOA,GAAStD,GAAWjG,KAAKO,UAAYP,KAAKO,UAGlDmQ,EAAKrQ,UAAU6F,OAAS,aAIxBwK,EAAKrQ,UAAUY,SAAW,SAAkBmF,GACvCpG,KAAKwF,UAAYY,GAAepG,KAAKe,SACzCf,KAAKwF,UAAW,GAGjBkL,EAAKrQ,UAAUwG,OAAS,aAIxB6J,EAAKrQ,UAAUqJ,QAAU,WACxB,MAAO1J,MAAKO,UAGNmQ,GACN1J,IAEE6J,MAEAC,GAAQ,OACRC,GAAc,MAElB,KACCnN,GAAc,SAASoN,UAAY,MAClC,MAAOC,IACRH,IAAQ,EAERC,IACCG,OAAQ,oBAAqB,YAC7BC,OAAQ,2BAA4B,oBACpCC,OAAQ,2BAA4B,oBACpCC,IAAK,wBAAyB,iBAC9BC,QAAS,qBAAsB,cAuEjC,GAAIC,IAAS,SAAU1I,GAGtB,QAAS0I,GAAOpK,GAEf,MADAC,IAAaC,eAAerH,KAAMuR,GAC3BnK,GAAaG,0BAA0BvH,KAAM6I,EAAUrB,KAAKxH,KAAMmH,IA4F1E,MAhGAC,IAAaM,SAAS6J,EAAQ1I,GAO9B0I,EAAOlR,UAAUU,OAAS,WACzB,GAAI4L,GAAUC,GAId,OAHA5M,MAAK2G,MAAMjE,QAAQ,SAAUvB,GAC5B,MAAOwL,GAAQpH,YAAYpE,KAErBwL,GAGR4E,EAAOlR,UAAUe,KAAO,SAAcC,GACrC,GAAIwL,GAAM7M,KAAK2G,MAAM9B,OACjBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIzD,GAAOnB,KAAK2G,MAAM/B,EAEtB,IAAsB,IAAlBzD,EAAK+H,SAAT,CAEA,GAAI5H,GAAQH,EAAME,GAAW,MAAOF,EAEpC,IAAIqQ,GAAcrQ,EAAKsQ,cAAcpQ,EACrC,IAAImQ,EAAa,MAAOA,IAGzB,MAAO,OAGRD,EAAOlR,UAAUmB,QAAU,SAAiBH,EAAUI,GACrD,GAAIoL,GAAM7M,KAAK2G,MAAM9B,OACjBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIzD,GAAOnB,KAAK2G,MAAM/B,EAEtB,IAAsB,IAAlBzD,EAAK+H,SAAT,CAEIzH,EAAMC,KAAKP,IAAOM,EAAME,IAAIR,EAEhC,IAAIuQ,GAAiBvQ,EAAKwQ,iBAAiBtQ,EAC3C,IAAIqQ,EAAgB,CACnB,GAAIE,GAAWF,EAAe7M,OAC1BgN,EAAI,MAER,KAAKA,EAAI,EAAOD,EAAJC,EAAcA,GAAK,EAC9BpQ,EAAME,IAAI+P,EAAeG,QAM7BN,EAAOlR,UAAU0B,cAAgB,WAChC,MAAO,OAGRwP,EAAOlR,UAAU8B,UAAY,WAC5B,MAAOnC,MAAK2G,MAAM,IAGnB4K,EAAOlR,UAAU0C,OAAS,SAAgBC,GACzC,GAAI8O,GAAO9R,KAAKc,MAAQd,KAAKc,MAAMsH,MAAQ,EAC3CpI,MAAK2G,MAAQoL,GAAWD,EAAM9R,KAAKgE,eAAemK,iBAAkBnL,GACpEhD,KAAKwF,UAAW,GAGjB+L,EAAOlR,UAAUoF,SAAW,WAC3B,MAAOzF,MAAKc,OAA6B,MAApBd,KAAKc,MAAMsH,MAAgB4J,GAA0B,GAAKhS,KAAKc,MAAMsH,OAAS,IAGpGmJ,EAAOlR,UAAUY,SAAW,WACvBjB,KAAK2G,OAAO3G,KAAK2G,MAAMjE,QAAQ,SAAUvB,GAC5C,MAAOD,GAAWC,KAEnBnB,KAAKwF,UAAW,GAGjB+L,EAAOlR,UAAUwG,OAAS,WACzB,GAAI7G,KAAKwF,UAAYxF,KAAK8G,MAAO,CAChC9G,KAAK8G,OAAQ,EAEb9G,KAAKiB,UACL,IAAI0L,GAAUC,GACd5M,MAAK+C,OAAO4J,EAEZ,IAAIuB,GAAalO,KAAKgE,eAAemK,iBACjCC,EAASpO,KAAKgE,eAAe9B,aAAalC,KAE9CkO,GAAW5E,aAAaqD,EAASyB,KAI5BmD,GACNzJ,IAEEmK,GAAU,SAAUlK,GAGvB,QAASkK,GAAQ9K,GAChBC,GAAaC,eAAerH,KAAMiS,EAElC,IAAI3K,GAAQF,GAAaG,0BAA0BvH,KAAM+H,EAAMP,KAAKxH,KAAMmH,GAU1E,OARAG,GAAM4K,UAAY/K,EAAQnD,eAAerD,QACzC2G,EAAM6K,UAAY7K,EAAM4K,UAAUC,UAElC7K,EAAM8K,kBAAoBjL,EAAQnD,eAClCsD,EAAMtD,eAAiBsD,EAAM6K,UAAUnO,eAGvCsD,EAAMtF,KAAOmF,EAAQ5G,SAAS+C,GAAK,GAC5BgE,EAkGR,MAjHAF,IAAaM,SAASuK,EAASlK,GAkB/BkK,EAAQ5R,UAAUF,KAAO,WACxB,GAAI6B,GAAOhC,KAAKgC,MAEfhC,KAAKmS,UAAUE,SAASrQ,KAAUhC,KAAKmS,UAAUE,SAASrQ,QAAaF,KAAK9B,KAG7E,IAAIO,GAAWP,KAAKkS,UAAUI,gBAAgBtQ,GAAQ,UAE9B,iBAAbzB,KACVA,EAAWgS,GAAMhS,GAAUyK,GAGvBzK,IACJiS,EAAY,wCAA0CxQ,EAAO,KAAOrB,QAASX,KAAKW,UAClFJ,MAGDP,KAAKuB,SAAW,GAAI2J,KACnBC,MAAOnL,KACPW,QAASX,KAAKkS,UAAUjI,OACxB1J,SAAUA,IACRJ,QAGJ8R,EAAQ5R,UAAUqI,OAAS,WACrB1I,KAAK8G,QACT9G,KAAKoS,kBAAkB1J,SACvB1I,KAAK8G,OAAQ,IAIfmL,EAAQ5R,UAAUU,OAAS,WAC1B,MAAOf,MAAKuB,SAASR,UAGtBkR,EAAQ5R,UAAUe,KAAO,SAAcC,GACtC,MAAOrB,MAAKuB,SAASH,KAAKC,IAG3B4Q,EAAQ5R,UAAUmB,QAAU,SAAiBH,EAAUmQ,GACtDxR,KAAKuB,SAASH,KAAKC,EAAUmQ,IAG9BS,EAAQ5R,UAAU0B,cAAgB,SAAuBC,GACxD,MAAOhC,MAAKuB,SAASQ,cAAcC,IAGpCiQ,EAAQ5R,UAAU4B,kBAAoB,SAA2BD,EAAMwP,GACtExR,KAAKuB,SAASU,kBAAkBD,EAAMwP,IAGvCS,EAAQ5R,UAAU6B,aAAe,WAChC,MAAOlC,MAAKoS,kBAAkBlQ,aAAalC,OAG5CiS,EAAQ5R,UAAU8B,UAAY,SAAmBkJ,GAChD,MAAOrL,MAAKuB,SAASY,UAAUkJ,IAGhC4G,EAAQ5R,UAAUoC,OAAS,WAC1BzC,KAAKuB,SAASkB,UAGfwP,EAAQ5R,UAAU0C,OAAS,SAAgBC,EAAQC,GAClD,MAAOjD,MAAKuB,SAASwB,OAAOC,EAAQC,IAGrCgP,EAAQ5R,UAAU0K,YAAc,SAAqB/I,GACpD,GAAIzB,GAAWP,KAAKgE,eAAerD,QAAQ8R,SAASzQ,EAE5B,iBAAbzB,KACVA,EAAWgS,GAAMhS,GAAUyK,GAG5BhL,KAAKoL,gBAAkB7K,OAGxB0R,EAAQ5R,UAAUoF,SAAW,SAAkB8D,GAC9C,MAAOvJ,MAAKuB,SAASkE,SAAS8D,IAG/B0I,EAAQ5R,UAAU6F,OAAS,WAC1BlG,KAAKuB,SAAS2E,SACduE,EAAgBzK,KAAKmS,UAAUE,SAASrS,KAAKgC,MAAOhC,OAGrDiS,EAAQ5R,UAAUY,SAAW,SAAkBmF,GAC9CpG,KAAKuB,SAASN,SAASmF,IAGxB6L,EAAQ5R,UAAUwG,OAAS,WAC1B7G,KAAK8G,OAAQ,EACb9G,KAAKuB,SAASsF,UAGRoL,GACNjL,IAmCE0L,KACJA,IAAaC,IAASC,GACtBF,GAAaG,IAAWC,GACxBJ,GAAaK,IAAgBnK,GAC7B8J,GAAaM,IAAWtI,GACxBgI,GAAaO,IAAWtE,GACxB+D,GAAaQ,IAAU3B,GACvBmB,GAAaS,IAAWlB,EAExB,IAAImB,KACHC,QAASP,GACTQ,KAAMrM,GACNsM,MAAO5J,GACP6J,OAAQ3J,GACRE,OAAQ0F,GACRgE,SAAUnD,IA4BPoD,GAAoB,WACvB,QAASA,GAAkBnS,EAAUoS,EAAWC,GAc/C,IAbAxM,GAAaC,eAAerH,KAAM0T,GAElC1T,KAAKuB,SAAWA,EAChBvB,KAAK2T,UAAYE,EAAUF,GAC3B3T,KAAK4T,SAAWA,EAEhB5T,KAAKqM,KAAOyH,EAAcH,GAC1B3T,KAAK+T,UAAW,EAMTxS,GACFA,EAASmK,SACZnK,EAASmK,QAAQsI,cAAchU,KAAKqM,KAAK,GAAIrM,MAG9CuB,EAAWA,EAAS0S,iBAAmB1S,EAAS0I,OA2BlD,MAvBAyJ,GAAkBrT,UAAU6T,kBAAoB,WAC/C,IAAIlU,KAAK+T,SAAT,CAEA,GAAIjT,GAAQqT,GAA0BnU,KAAKuB,SAAUvB,KAAK2T,UAEtD7S,KACHd,KAAK+T,UAAW,EAChB/T,KAAK4T,SAAS9S,MAIhB4S,EAAkBrT,UAAU+T,gBAAkB,WAC7C,IAAIpU,KAAK+T,SAAT,CAEA,GAAIjT,GAAQd,KAAKuB,SAAS8S,cAAcC,QAAQtU,KAAKqM,KACrDrM,MAAK4T,SAAS9S,GACdd,KAAK+T,UAAW,IAGjBL,EAAkBrT,UAAU6F,OAAS,WACpCuE,EAAgBzK,KAAKuB,SAASgT,WAAYvU,OAGpC0T,KAkCJxI,GAAW,WACd,QAASA,GAAS/D,GACjBC,GAAaC,eAAerH,KAAMkL,GAElClL,KAAKmL,MAAQhE,EAAQgE,MAErBnL,KAAKiP,QAAU9H,EAAQgE,MAAMnH,eAC7BhE,KAAKiK,OAASjK,KAAKiP,OAAS,KAAOjP,KAAKmL,MAAMnH,eAC9ChE,KAAKW,QAAUwG,EAAQxG,UAAYX,KAAKiP,OAAS9H,EAAQgE,MAAQnL,KAAKiK,OAAOtJ,SAE7EX,KAAKiU,gBAAkBjU,KAAKiP,QAAUjP,KAAKW,QAAQwR,UAAYnS,KAAKW,QAAQwR,UAAUnO,eAAiB,KAEvGhE,KAAK0L,QAAU,KACf1L,KAAKwF,UAAW,EAGhBxF,KAAKiE,OAAS,UAAYkD,GAAUA,EAAQlD,OAASjE,KAAKiK,OAASjK,KAAKiK,OAAOhG,OAAS,KAExFjE,KAAKwU,aAELxU,KAAK8G,OAAQ,EACb9G,KAAKyU,UAAYzU,KAAK0U,YAAa,EAEnC1U,KAAKO,SAAW4G,EAAQ5G,aACxBP,KAAK2U,cAmTN,MAhTAzJ,GAAS7K,UAAUF,KAAO,SAAcuL,GAUvC,MATA1L,MAAK0L,QAAUA,EACf1L,KAAK4U,MAAMlS,QAAQmS,IACnB7U,KAAK8U,OAAQ,EAKT9U,KAAK8G,OAAO9G,KAAK6G,SAEd7G,MAGRkL,EAAS7K,UAAUqI,OAAS,WAC3B1I,KAAKyU,UAAYzU,KAAK0U,YAAa,EAE9B1U,KAAK8G,QACT9G,KAAK8G,OAAQ,EAET9G,KAAKiP,OAEJjP,KAAKW,QAAQwR,UAChBnS,KAAKW,QAAQwR,UAAUzJ,SACb1I,KAAK8U,OACf9P,GAAQ+P,YAAY/U,MAGrBA,KAAKmL,MAAMzC,WAKdwC,EAAS7K,UAAUsU,YAAc,WAChC,GAAIrN,GAAQtH,IAEZA,MAAK4U,MAAQ5U,KAAKO,SAAS4D,IAAI,SAAU5D,EAAUyH,GAClD,MAAOgN,KAAahR,eAAgBsD,EAAO/G,SAAUA,EAAUyH,MAAOA,OAIxEkD,EAAS7K,UAAUU,OAAS,WAC3B,GAAI4L,GAAUC,GAId,OAHA5M,MAAK4U,MAAMlS,QAAQ,SAAUuS,GAC5B,MAAOtI,GAAQpH,YAAY0P,EAAKlU,YAE1B4L,GAGRzB,EAAS7K,UAAUe,KAAO,SAAcC,GACvC,GAAIwL,GAAM7M,KAAK4U,MAAM/P,OACjBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIkI,GAAQ9M,KAAK4U,MAAMhQ,GAAGxD,KAAKC,EAC/B,IAAIyL,EAAO,MAAOA,KAIpB5B,EAAS7K,UAAUmB,QAAU,SAAiBH,EAAUI,GACvD,GAAIzB,KAAK4U,MAAO,CACf,GAAI/H,GAAM7M,KAAK4U,MAAM/P,OACjBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIqQ,GAAOjV,KAAK4U,MAAMhQ,EAElBqQ,GAAKzT,SACRyT,EAAKzT,QAAQH,EAAUI,IAK1B,MAAOA,IAGRyJ,EAAS7K,UAAU0B,cAAgB,SAAuBC,GACzD,GAAI6K,GAAM7M,KAAK4U,MAAM/P,OACjBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIkI,GAAQ9M,KAAK4U,MAAMhQ,GAAG7C,cAAcC,EACxC,IAAI8K,EAAO,MAAOA,KAIpB5B,EAAS7K,UAAU4B,kBAAoB,SAA2BD,EAAMP,GACvE,GAAIzB,KAAK4U,MAAO,CACf,GAAI/H,GAAM7M,KAAK4U,MAAM/P,OACjBD,EAAI,MAER,KAAKA,EAAI,EAAOiI,EAAJjI,EAASA,GAAK,EAAG,CAC5B,GAAIqQ,GAAOjV,KAAK4U,MAAMhQ,EAElBqQ,GAAKhT,mBACRgT,EAAKhT,kBAAkBD,EAAMP,IAKhC,MAAOA,IAGRyJ,EAAS7K,UAAUgU,YAAc,WAEhC,IADA,GAAI9S,GAAWvB,MACPuB,EAASmK,SAChBnK,EAAWA,EAAS0I,MACpB,OAAO1I,GAASmK,SAGlBR,EAAS7K,UAAU6B,aAAe,SAAsB+S,GAEvD,IAAK,GAAIrQ,GAAIqQ,EAAKjN,MAAQ,EAAGpD,EAAI5E,KAAK4U,MAAM/P,OAAQD,IACnD,GAAK5E,KAAK4U,MAAMhQ,GAAhB,CAEA,GAAIzD,GAAOnB,KAAK4U,MAAMhQ,GAAGzC,WAAU,EACnC,IAAIhB,EAAM,MAAOA,GAKlB,MAAInB,MAAKiP,OACJjP,KAAKW,QAAQwR,UACTnS,KAAKW,QAAQwR,UAAUnO,eAAe9B,aAAalC,KAAKW,QAAQwR,WAKjE,KAGDnS,KAAKmL,MAAMjJ,aAAalC,OAGhCkL,EAAS7K,UAAU8N,eAAiB,WACnC,GAAI5M,GAAWvB,IAEf,GAAG,CACF,GAAIuB,EAAS4J,MAAMwF,OAASuE,GAC3B,MAAO3T,GAAS4J,MAAMhK,IAGvB,IAAII,EAAS0N,SAAW1N,EAASZ,QAAQwR,UAExC,MAAO5Q,GAASZ,QAAQwU,EAIxB5T,GADGA,EAAS4J,MAAMwF,OAASwC,GAChB5R,EAAS4J,MAAMiH,kBAEf7Q,EAAS0S,iBAAmB1S,EAAS0I,aAEzC1I,EAET,MAAM,IAAI6T,OAAM,+BAGjBlK,EAAS7K,UAAUgV,sBAAwB,WAG1C,IAFA,GAAI9T,GAAWvB,KAERuB,EAAS0I,SAAW1I,EAASgL,aACnChL,EAAWA,EAAS0I,QAAU1I,EAAS0S,eAGxC,OAAO1S,IAGR2J,EAAS7K,UAAU8B,UAAY,SAAmBkJ,GAEjD,IAAK,GADDlK,GAAO,OACFyD,EAAI,EAAGA,EAAI5E,KAAK4U,MAAM/P,OAAQD,IAGtC,GAFAzD,EAAOnB,KAAK4U,MAAMhQ,GAAGzC,WAAU,GAG9B,MAAOhB,EAIT,OAAIkK,GAAmB,KAEhBrL,KAAKiK,OAAO/H,aAAalC,KAAKmL,QAOtCD,EAAS7K,UAAUiV,YAAc,WAChC,GAAItV,KAAKyU,UAAW,CACnB,GAAIc,MACAC,EAASC,GAAazV,KAAK4U,MAAOW,EAAQvV,KAAKW,QAAQ+U,OACvDC,EAASC,GAAU,IAAMJ,EAAS,IAAKD,EAE3CvV,MAAK6V,SAAWF,EAASA,EAAO7R,OAAS9D,KAAKyF,YAE9CzF,KAAKyU,WAAY,EAGlB,MAAOzU,MAAK6V,UAGb3K,EAAS7K,UAAUoC,OAAS,SAAgBiJ,GAC3C1L,KAAK0L,QAAUA,EAEf1L,KAAK4U,MAAMlS,QAAQC,KAGpBuI,EAAS7K,UAAU0C,OAAS,SAAgBC,EAAQC,GACnD,GAAIjD,KAAKwF,SAAU,KAAM,IAAI4P,OAAM,gCACnCpV,MAAKwF,UAAW,EAEhBxF,KAAK4U,MAAMlS,QAAQ,SAAUuS,GAC5B,MAAOA,GAAKlS,OAAOC,EAAQC,MAI7BiI,EAAS7K,UAAUmL,cAAgB,SAAuBjL,GACzD,GAAIuV,GAAW9V,KAAK8U,MAChBiB,EAAc/V,KAAKwF,QAYvB,IARIsQ,IACCC,GAAa/V,KAAKiB,UAAS,GAC/BjB,KAAKkG,UAGNlG,KAAKO,SAAWA,EAChBP,KAAK2U,cAEDmB,IACH9V,KAAKG,KAAKH,KAAK0L,SAEXqK,GAAa,CAChB,GAAI7H,GAAalO,KAAKmO,iBAClBC,EAASpO,KAAKiK,OAASjK,KAAKiK,OAAO/H,aAAalC,KAAKmL,OAAS,IAElE,IAAIiD,EAAQ,CACX,GAAIzB,GAAUC,GACd5M,MAAK+C,OAAO4J,GACZuB,EAAW5E,aAAaqD,EAASyB,OAEjCpO,MAAK+C,OAAOmL,KAMhBhD,EAAS7K,UAAUkI,QAAU,SAAiBhI,EAAUqT,GACvD,IAAK5T,KAAK0L,QACT,MAAO1L,MAAKiK,OAAO1B,QAAQhI,EAAUqT,EAGtC,IAAItL,GAAW,GAAIoL,IAAkB1T,KAAMO,EAAUqT,EAGrD,OAFA5T,MAAKwU,UAAU1S,KAAKwG,GAEbA,GAGR4C,EAAS7K,UAAU2V,OAAS,WAC3B,MAAOhW,MAAKyF,YAGbyF,EAAS7K,UAAUoF,SAAW,SAAkB8D,GAC/C,MAAOvJ,MAAK4U,MAAMzQ,IAAIoF,EAAS+D,GAAkBC,IAAWlJ,KAAK,KAGlE6G,EAAS7K,UAAU6F,OAAS,WAI3B,MAHAlG,MAAK4U,MAAMlS,QAAQyD,IACnBnG,KAAK8U,OAAQ,EAEN9U,MAGRkL,EAAS7K,UAAUY,SAAW,SAAkBmF,GAC/CpG,KAAK4U,MAAMlS,QAAQ0D,EAAgB6P,GAAuBzP,IAC1DxG,KAAKwF,UAAW,GAGjB0F,EAAS7K,UAAUwG,OAAS,WACvB7G,KAAK8G,QAAU9G,KAAK2N,WACvB3N,KAAK8G,OAAQ,EACb9G,KAAK2N,UAAW,EAChB3N,KAAK4U,MAAMlS,QAAQqE,IACnB/G,KAAK2N,UAAW,IAIlBzC,EAAS7K,UAAUqJ,QAAU,WAC5B,GAA0B,IAAtB1J,KAAK4U,MAAM/P,OACd,MAAO7E,MAAK4U,MAAM,GAAGlL,SAGtB,IAAI1J,KAAK0U,WAAY,CACpB,GAAIa,MACAC,EAASC,GAAazV,KAAK4U,MAAOW,EAAQvV,KAAKW,QAAQ+U,OACvDC,EAASC,GAAUJ,EAAQD,EAE/BvV,MAAK8D,MAAQ6R,EAASA,EAAO7R,MAAQ9D,KAAKyF,WAE1CzF,KAAK0U,YAAa,EAGnB,MAAO1U,MAAK8D,OAGNoH,KAuCJgL,GAAUC,GAAgB,WAsC1B5S,GAAQ4S,GAAgB,SAExBC,GAAOD,GAAgB,QAEvB9L,GAAS8L,GAAgB,UAMzBE,GAAiB,GAAIC,IAAK,YAyG1BC,GAAiB,GAAID,IAAK,YAuB1BE,GAAUL,GAAgB,WAE1BM,GAAa,GAAIH,IAAK,UAkDtBI,IACH/U,IAAKgV,EACLC,QAASC,EACT9V,OAAQ+V,EACR1V,KAAM2V,EACNvV,QAASwV,EACT/U,kBAAmBgV,EACnBlV,cAAemV,EACfC,cAAeC,GACfC,WAAYC,GACZC,KAAMC,GACNpP,IAAKqP,GACLC,OAAQC,GACRC,KAAMA,GACNC,MAAOC,GACPC,QAASA,GACTC,YAAaA,GACbC,YAAaA,GAGbC,IAAKC,GACLC,GAAIC,GACJC,KAAMC,GACNC,IAAKA,GACL1W,KAAMA,GACNiB,OAAQ0V,GACR1K,MAAO2K,GACPC,aAAcA,GACdnN,cAAeoN,GACf1C,QAASA,GACT2C,IAAKC,GACLvV,MAAOA,GACP6S,KAAMA,GACN/L,OAAQA,GACR0O,SAAUC,GACVC,SAAUC,GACVC,OAAQC,GACRC,MAAOC,GACPC,MAAOD,GACPE,OAAQC,GACRzD,OAAQyD,GACRpT,WAAYqT,GACZC,OAAQA,GACR1Y,SAAU2Y,GACVpD,QAASA,GACT3P,OAAQgT,GACRC,YAAaC,IAiNVC,GAAW,UAEf,IAAI5S,GAAAA,UAAoB6S,KAAKC,OAASF,IAAY5S,GAAAA,UAAoB+S,OAAO9Z,UAAU+Z,QAAUJ,IAAY5S,GAAAA,UAAoBgF,OAAOC,QAAU2N,IAAY5S,GAAAA,UAAoBiT,MAAMha,UAAU+J,WAAa4P,IAAY5S,GAAAA,UAAoBiT,MAAMha,UAAUqC,WAAasX,IAAY5S,GAAAA,UAAoBiT,MAAMha,UAAU8D,OAAS6V,IAAY5S,GAAAA,UAAoBiT,MAAMha,UAAUia,UAAYN,IAAYO,IAAOnT,GAAAA,UAAoBmT,GAAI5S,oBAAsBqS,GACjc,KAAM,IAAI5E,OAAM,uNAuDjB,OA7CAoF,GAAUC,GAAQpa,UAAWqW,GAAOgE,IACpCD,GAAQpa,UAAUsa,YAAcF,GAGhCA,GAAQC,SAAWD,GAAQpa,UAG3Bua,GAAiBH,IAGhBI,OAASC,UAAU,EAAMhX,OAAO,GAChCiX,gBAAkBD,UAAU,EAAMhX,OAAO,GAGzCkX,QAAUlX,MAAOkX,IACjBC,WAAanX,MAAOmX,GACpBC,aAAepX,MAAOoX,IACtBC,UAAYrX,MAAOqX,IACnB5I,OAASzO,MAAOyO,IAChB6I,cAAgBtX,MAAOsX,IACvBC,aAAevX,MAAOuX,GACtBC,QAAUxX,MAAOwX,IAGjBC,SAAWzX,MAAO0X,IAGlBC,SAAWX,UAAU,EAAMhX,OAAO,GAClC4X,KAAO5X,MAAO4X,IACdC,OAAS7X,MAAO8X,IAGhBC,SAAW/X,MAAO,cAGlBgY,UAAYhB,UAAU,EAAMhX,UAC5BiY,YAAcjB,UAAU,EAAMhX,UAC9BkY,YAAclB,UAAU,EAAMhX,UAC9BmY,QAAUnB,UAAU,EAAMhX,MAAOmY,IACjCC,QAAUpB,UAAU,EAAMhX,UAC1BqY,eAAiBrB,UAAU,EAAMhX,MAAOqY,IACxC1J,UAAYqI,UAAU,EAAMhX,UAC5BsY,aAAetB,UAAU,EAAMhX,YAGzB2W"}