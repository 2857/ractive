{"version":3,"file":"ractive.runtime.min.js","sources":["ractive.runtime.js"],"sourcesContent":["/*\n\tRactive.js v0.8.0-edge\n\tSun Apr 10 2016 01:56:51 GMT+0000 (UTC) - commit a979c240cfc5d64f2a8b929cffef84c2ed92dbf8\n\n\thttp://ractivejs.org\n\thttp://twitter.com/RactiveJS\n\n\tReleased under the MIT License.\n*/\n\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.Ractive = factory());\n}(this, function () { 'use strict';\n\n  var babelHelpers = {};\n  babelHelpers.typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n  };\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers.toConsumableArray = function (arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    } else {\n      return Array.from(arr);\n    }\n  };\n\n  babelHelpers;\n\n  var defaults = {\n  \t// render placement:\n  \tel: void 0,\n  \tappend: false,\n\n  \t// template:\n  \ttemplate: null,\n\n  \t// parse:\n  \tdelimiters: ['{{', '}}'],\n  \ttripleDelimiters: ['{{{', '}}}'],\n  \tstaticDelimiters: ['[[', ']]'],\n  \tstaticTripleDelimiters: ['[[[', ']]]'],\n  \tcsp: true,\n  \tinterpolate: false,\n  \tpreserveWhitespace: false,\n  \tsanitize: false,\n  \tstripComments: true,\n\n  \t// data & binding:\n  \tdata: {},\n  \tcomputed: {},\n  \tmagic: false,\n  \tmodifyArrays: true,\n  \tadapt: [],\n  \tisolated: false,\n  \ttwoway: true,\n  \tlazy: false,\n\n  \t// transitions:\n  \tnoIntro: false,\n  \ttransitionsEnabled: true,\n  \tcomplete: void 0,\n\n  \t// css:\n  \tcss: null,\n  \tnoCssTransform: false\n  };\n\n  // These are a subset of the easing equations found at\n  // https://raw.github.com/danro/easing-js - license info\n  // follows:\n\n  // --------------------------------------------------\n  // easing.js v0.5.4\n  // Generic set of easing functions with AMD support\n  // https://github.com/danro/easing-js\n  // This code may be freely distributed under the MIT license\n  // http://danro.mit-license.org/\n  // --------------------------------------------------\n  // All functions adapted from Thomas Fuchs & Jeremy Kahn\n  // Easing Equations (c) 2003 Robert Penner, BSD license\n  // https://raw.github.com/danro/easing-js/master/LICENSE\n  // --------------------------------------------------\n\n  // In that library, the functions named easeIn, easeOut, and\n  // easeInOut below are named easeInCubic, easeOutCubic, and\n  // (you guessed it) easeInOutCubic.\n  //\n  // You can add additional easing functions to this list, and they\n  // will be globally available.\n\n  var easing = {\n  \tlinear: function linear(pos) {\n  \t\treturn pos;\n  \t},\n  \teaseIn: function easeIn(pos) {\n  \t\treturn Math.pow(pos, 3);\n  \t},\n  \teaseOut: function easeOut(pos) {\n  \t\treturn Math.pow(pos - 1, 3) + 1;\n  \t},\n  \teaseInOut: function easeInOut(pos) {\n  \t\tif ((pos /= 0.5) < 1) {\n  \t\t\treturn 0.5 * Math.pow(pos, 3);\n  \t\t}\n  \t\treturn 0.5 * (Math.pow(pos - 2, 3) + 2);\n  \t}\n  };\n\n  var legacy = null;\n\n  /*global console, navigator */\n\n  var win = typeof window !== 'undefined' ? window : null;\n  var doc = win ? document : null;\n\n  var isClient = !!doc;\n  var isJsdom = typeof navigator !== 'undefined' && /jsDom/.test(navigator.appName);\n  var hasConsole = typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function';\n\n  var magicSupported = void 0;\n  try {\n  \tObject.defineProperty({}, 'test', { value: 0 });\n  \tmagicSupported = true;\n  } catch (e) {\n  \tmagicSupported = false;\n  }\n\n  var svg = doc ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1') : false;\n\n  var vendors = ['o', 'ms', 'moz', 'webkit'];\n\n  var html = 'http://www.w3.org/1999/xhtml';\n  var mathml = 'http://www.w3.org/1998/Math/MathML';\n  var svg$1 = 'http://www.w3.org/2000/svg';\n  var xlink = 'http://www.w3.org/1999/xlink';\n  var xml = 'http://www.w3.org/XML/1998/namespace';\n  var xmlns = 'http://www.w3.org/2000/xmlns';\n\n  var namespaces = { html: html, mathml: mathml, svg: svg$1, xlink: xlink, xml: xml, xmlns: xmlns };\n\n  var createElement;\n  var matches;\n  var div;\n  var methodNames;\n  var unprefixed;\n  var prefixed;\n  var i;\n  var j;\n  var makeFunction;\n  // Test for SVG support\n  if (!svg) {\n  \tcreateElement = function createElement(type, ns, extend) {\n  \t\tif (ns && ns !== html) {\n  \t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n  \t\t}\n\n  \t\treturn extend ? doc.createElement(type, extend) : doc.createElement(type);\n  \t};\n  } else {\n  \tcreateElement = function createElement(type, ns, extend) {\n  \t\tif (!ns || ns === html) {\n  \t\t\treturn extend ? doc.createElement(type, extend) : doc.createElement(type);\n  \t\t}\n\n  \t\treturn extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  \t};\n  }\n\n  function createDocumentFragment() {\n  \treturn doc.createDocumentFragment();\n  }\n\n  function getElement(input) {\n  \tvar output;\n\n  \tif (!input || typeof input === 'boolean') {\n  \t\treturn;\n  \t}\n\n  \tif (!win || !doc || !input) {\n  \t\treturn null;\n  \t}\n\n  \t// We already have a DOM node - no work to do. (Duck typing alert!)\n  \tif (input.nodeType) {\n  \t\treturn input;\n  \t}\n\n  \t// Get node from string\n  \tif (typeof input === 'string') {\n  \t\t// try ID first\n  \t\toutput = doc.getElementById(input);\n\n  \t\t// then as selector, if possible\n  \t\tif (!output && doc.querySelector) {\n  \t\t\toutput = doc.querySelector(input);\n  \t\t}\n\n  \t\t// did it work?\n  \t\tif (output && output.nodeType) {\n  \t\t\treturn output;\n  \t\t}\n  \t}\n\n  \t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n  \tif (input[0] && input[0].nodeType) {\n  \t\treturn input[0];\n  \t}\n\n  \treturn null;\n  }\n\n  if (!isClient) {\n  \tmatches = null;\n  } else {\n  \tdiv = createElement('div');\n  \tmethodNames = ['matches', 'matchesSelector'];\n\n  \tmakeFunction = function makeFunction(methodName) {\n  \t\treturn function (node, selector) {\n  \t\t\treturn node[methodName](selector);\n  \t\t};\n  \t};\n\n  \ti = methodNames.length;\n\n  \twhile (i-- && !matches) {\n  \t\tunprefixed = methodNames[i];\n\n  \t\tif (div[unprefixed]) {\n  \t\t\tmatches = makeFunction(unprefixed);\n  \t\t} else {\n  \t\t\tj = vendors.length;\n  \t\t\twhile (j--) {\n  \t\t\t\tprefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n  \t\t\t\tif (div[prefixed]) {\n  \t\t\t\t\tmatches = makeFunction(prefixed);\n  \t\t\t\t\tbreak;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \t// IE8...\n  \tif (!matches) {\n  \t\tmatches = function matches(node, selector) {\n  \t\t\tvar nodes, parentNode, i;\n\n  \t\t\tparentNode = node.parentNode;\n\n  \t\t\tif (!parentNode) {\n  \t\t\t\t// empty dummy <div>\n  \t\t\t\tdiv.innerHTML = '';\n\n  \t\t\t\tparentNode = div;\n  \t\t\t\tnode = node.cloneNode();\n\n  \t\t\t\tdiv.appendChild(node);\n  \t\t\t}\n\n  \t\t\tnodes = parentNode.querySelectorAll(selector);\n\n  \t\t\ti = nodes.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tif (nodes[i] === node) {\n  \t\t\t\t\treturn true;\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\treturn false;\n  \t\t};\n  \t}\n  }\n\n  function detachNode(node) {\n  \tif (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n  \t\tnode.parentNode.removeChild(node);\n  \t}\n\n  \treturn node;\n  }\n\n  function safeToStringValue(value) {\n  \treturn value == null || !value.toString ? '' : '' + value;\n  }\n\n  var create;\n  var defineProperty;\n  var defineProperties;\n  try {\n  \tObject.defineProperty({}, 'test', {\n  \t\tget: function get() {},\n  \t\tset: function set() {}\n  \t});\n\n  \tif (doc) {\n  \t\tObject.defineProperty(createElement('div'), 'test', { value: 0 });\n  \t}\n\n  \tdefineProperty = Object.defineProperty;\n  } catch (err) {\n  \t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n  \t// only use it with DOM objects (what were you smoking, MSFT?)\n  \tdefineProperty = function defineProperty(obj, prop, desc) {\n  \t\tobj[prop] = desc.value;\n  \t};\n  }\n\n  try {\n  \ttry {\n  \t\tObject.defineProperties({}, { test: { value: 0 } });\n  \t} catch (err) {\n  \t\t// TODO how do we account for this? noMagic = true;\n  \t\tthrow err;\n  \t}\n\n  \tif (doc) {\n  \t\tObject.defineProperties(createElement('div'), { test: { value: 0 } });\n  \t}\n\n  \tdefineProperties = Object.defineProperties;\n  } catch (err) {\n  \tdefineProperties = function defineProperties(obj, props) {\n  \t\tvar prop;\n\n  \t\tfor (prop in props) {\n  \t\t\tif (props.hasOwnProperty(prop)) {\n  \t\t\t\tdefineProperty(obj, prop, props[prop]);\n  \t\t\t}\n  \t\t}\n  \t};\n  }\n\n  try {\n  \tObject.create(null);\n\n  \tcreate = Object.create;\n  } catch (err) {\n  \t// sigh\n  \tcreate = function () {\n  \t\tvar F = function F() {};\n\n  \t\treturn function (proto, props) {\n  \t\t\tvar obj;\n\n  \t\t\tif (proto === null) {\n  \t\t\t\treturn {};\n  \t\t\t}\n\n  \t\t\tF.prototype = proto;\n  \t\t\tobj = new F();\n\n  \t\t\tif (props) {\n  \t\t\t\tObject.defineProperties(obj, props);\n  \t\t\t}\n\n  \t\t\treturn obj;\n  \t\t};\n  \t}();\n  }\n\n  function extendObj(target) {\n  \tvar prop;\n\n  \tfor (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\tsources[_key - 1] = arguments[_key];\n  \t}\n\n  \tsources.forEach(function (source) {\n  \t\tfor (prop in source) {\n  \t\t\tif (hasOwn.call(source, prop)) {\n  \t\t\t\ttarget[prop] = source[prop];\n  \t\t\t}\n  \t\t}\n  \t});\n\n  \treturn target;\n  }\n\n  function fillGaps(target) {\n  \tfor (var _len2 = arguments.length, sources = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n  \t\tsources[_key2 - 1] = arguments[_key2];\n  \t}\n\n  \tsources.forEach(function (s) {\n  \t\tfor (var key in s) {\n  \t\t\tif (hasOwn.call(s, key) && !(key in target)) {\n  \t\t\t\ttarget[key] = s[key];\n  \t\t\t}\n  \t\t}\n  \t});\n\n  \treturn target;\n  }\n\n  var hasOwn = Object.prototype.hasOwnProperty;\n\n  var toString = Object.prototype.toString;\n  // thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\n  function isArray(thing) {\n  \treturn toString.call(thing) === '[object Array]';\n  }\n\n  function isEqual(a, b) {\n  \tif (a === null && b === null) {\n  \t\treturn true;\n  \t}\n\n  \tif ((typeof a === 'undefined' ? 'undefined' : babelHelpers.typeof(a)) === 'object' || (typeof b === 'undefined' ? 'undefined' : babelHelpers.typeof(b)) === 'object') {\n  \t\treturn false;\n  \t}\n\n  \treturn a === b;\n  }\n\n  // http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\n  function isNumeric(thing) {\n  \treturn !isNaN(parseFloat(thing)) && isFinite(thing);\n  }\n\n  function isObject(thing) {\n  \treturn thing && toString.call(thing) === '[object Object]';\n  }\n\n  function noop () {}\n\n  var alreadyWarned = {};\n  var log;\n  var printWarning;\n  var welcome;\n  if (hasConsole) {\n  \t(function () {\n  \t\tvar welcomeIntro = ['%cRactive.js %c0.8.0-edge %cin debug mode, %cmore...', 'color: rgb(114, 157, 52); font-weight: normal;', 'color: rgb(85, 85, 85); font-weight: normal;', 'color: rgb(85, 85, 85); font-weight: normal;', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'];\n  \t\tvar welcomeMessage = 'You\\'re running Ractive 0.8.0-edge in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\\n\\nTo disable debug mode, add this line at the start of your app:\\n  Ractive.DEBUG = false;\\n\\nTo disable debug mode when your app is minified, add this snippet:\\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\\n\\nGet help and support:\\n  http://docs.ractivejs.org\\n  http://stackoverflow.com/questions/tagged/ractivejs\\n  http://groups.google.com/forum/#!forum/ractive-js\\n  http://twitter.com/ractivejs\\n\\nFound a bug? Raise an issue:\\n  https://github.com/ractivejs/ractive/issues\\n\\n';\n\n  \t\twelcome = function welcome$$() {\n  \t\t\tvar hasGroup = !!console.groupCollapsed;\n  \t\t\tconsole[hasGroup ? 'groupCollapsed' : 'log'].apply(console, welcomeIntro);\n  \t\t\tconsole.log(welcomeMessage);\n  \t\t\tif (hasGroup) {\n  \t\t\t\tconsole.groupEnd(welcomeIntro);\n  \t\t\t}\n\n  \t\t\twelcome = noop;\n  \t\t};\n\n  \t\tprintWarning = function printWarning(message, args) {\n  \t\t\twelcome();\n\n  \t\t\t// extract information about the instance this message pertains to, if applicable\n  \t\t\tif (babelHelpers.typeof(args[args.length - 1]) === 'object') {\n  \t\t\t\tvar options = args.pop();\n  \t\t\t\tvar ractive = options ? options.ractive : null;\n\n  \t\t\t\tif (ractive) {\n  \t\t\t\t\t// if this is an instance of a component that we know the name of, add\n  \t\t\t\t\t// it to the message\n  \t\t\t\t\tvar name = void 0;\n  \t\t\t\t\tif (ractive.component && (name = ractive.component.name)) {\n  \t\t\t\t\t\tmessage = '<' + name + '> ' + message;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar node = void 0;\n  \t\t\t\t\tif (node = options.node || ractive.fragment && ractive.fragment.rendered && ractive.find('*')) {\n  \t\t\t\t\t\targs.push(node);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tconsole.warn.apply(console, ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(args));\n  \t\t};\n\n  \t\tlog = function log() {\n  \t\t\tconsole.log.apply(console, arguments);\n  \t\t};\n  \t})();\n  } else {\n  \tprintWarning = log = welcome = noop;\n  }\n\n  function format(message, args) {\n  \treturn message.replace(/%s/g, function () {\n  \t\treturn args.shift();\n  \t});\n  }\n\n  function fatal(message) {\n  \tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\targs[_key - 1] = arguments[_key];\n  \t}\n\n  \tmessage = format(message, args);\n  \tthrow new Error(message);\n  }\n\n  function logIfDebug() {\n  \tif (Ractive.DEBUG) {\n  \t\tlog.apply(null, arguments);\n  \t}\n  }\n\n  function warn(message) {\n  \tfor (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n  \t\targs[_key2 - 1] = arguments[_key2];\n  \t}\n\n  \tmessage = format(message, args);\n  \tprintWarning(message, args);\n  }\n\n  function warnOnce(message) {\n  \tfor (var _len3 = arguments.length, args = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n  \t\targs[_key3 - 1] = arguments[_key3];\n  \t}\n\n  \tmessage = format(message, args);\n\n  \tif (alreadyWarned[message]) {\n  \t\treturn;\n  \t}\n\n  \talreadyWarned[message] = true;\n  \tprintWarning(message, args);\n  }\n\n  function warnIfDebug() {\n  \tif (Ractive.DEBUG) {\n  \t\twarn.apply(null, arguments);\n  \t}\n  }\n\n  function warnOnceIfDebug() {\n  \tif (Ractive.DEBUG) {\n  \t\twarnOnce.apply(null, arguments);\n  \t}\n  }\n\n  // Error messages that are used (or could be) in multiple places\n  var badArguments = 'Bad arguments';\n  var noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\n  var missingPlugin = function missingPlugin(name, type) {\n    return 'Missing \"' + name + '\" ' + type + ' plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#' + type + 's';\n  };\n\n  function findInViewHierarchy(registryName, ractive, name) {\n  \tvar instance = findInstance(registryName, ractive, name);\n  \treturn instance ? instance[registryName][name] : null;\n  }\n\n  function findInstance(registryName, ractive, name) {\n  \twhile (ractive) {\n  \t\tif (name in ractive[registryName]) {\n  \t\t\treturn ractive;\n  \t\t}\n\n  \t\tif (ractive.isolated) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tractive = ractive.parent;\n  \t}\n  }\n\n  function interpolate(from, to, ractive, type) {\n  \tif (from === to) return null;\n\n  \tif (type) {\n  \t\tvar interpol = findInViewHierarchy('interpolators', ractive, type);\n  \t\tif (interpol) return interpol(from, to) || null;\n\n  \t\tfatal(missingPlugin(type, 'interpolator'));\n  \t}\n\n  \treturn interpolators.number(from, to) || interpolators.array(from, to) || interpolators.object(from, to) || null;\n  }\n\n  function snap(to) {\n  \treturn function () {\n  \t\treturn to;\n  \t};\n  }\n\n  var interpolators = {\n  \tnumber: function number(from, to) {\n  \t\tvar delta;\n\n  \t\tif (!isNumeric(from) || !isNumeric(to)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tfrom = +from;\n  \t\tto = +to;\n\n  \t\tdelta = to - from;\n\n  \t\tif (!delta) {\n  \t\t\treturn function () {\n  \t\t\t\treturn from;\n  \t\t\t};\n  \t\t}\n\n  \t\treturn function (t) {\n  \t\t\treturn from + t * delta;\n  \t\t};\n  \t},\n\n  \tarray: function array(from, to) {\n  \t\tvar intermediate, interpolators, len, i;\n\n  \t\tif (!isArray(from) || !isArray(to)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tintermediate = [];\n  \t\tinterpolators = [];\n\n  \t\ti = len = Math.min(from.length, to.length);\n  \t\twhile (i--) {\n  \t\t\tinterpolators[i] = interpolate(from[i], to[i]);\n  \t\t}\n\n  \t\t// surplus values - don't interpolate, but don't exclude them either\n  \t\tfor (i = len; i < from.length; i += 1) {\n  \t\t\tintermediate[i] = from[i];\n  \t\t}\n\n  \t\tfor (i = len; i < to.length; i += 1) {\n  \t\t\tintermediate[i] = to[i];\n  \t\t}\n\n  \t\treturn function (t) {\n  \t\t\tvar i = len;\n\n  \t\t\twhile (i--) {\n  \t\t\t\tintermediate[i] = interpolators[i](t);\n  \t\t\t}\n\n  \t\t\treturn intermediate;\n  \t\t};\n  \t},\n\n  \tobject: function object(from, to) {\n  \t\tvar properties, len, interpolators, intermediate, prop;\n\n  \t\tif (!isObject(from) || !isObject(to)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\tproperties = [];\n  \t\tintermediate = {};\n  \t\tinterpolators = {};\n\n  \t\tfor (prop in from) {\n  \t\t\tif (hasOwn.call(from, prop)) {\n  \t\t\t\tif (hasOwn.call(to, prop)) {\n  \t\t\t\t\tproperties.push(prop);\n  \t\t\t\t\tinterpolators[prop] = interpolate(from[prop], to[prop]) || snap(to[prop]);\n  \t\t\t\t} else {\n  \t\t\t\t\tintermediate[prop] = from[prop];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tfor (prop in to) {\n  \t\t\tif (hasOwn.call(to, prop) && !hasOwn.call(from, prop)) {\n  \t\t\t\tintermediate[prop] = to[prop];\n  \t\t\t}\n  \t\t}\n\n  \t\tlen = properties.length;\n\n  \t\treturn function (t) {\n  \t\t\tvar i = len,\n  \t\t\t    prop;\n\n  \t\t\twhile (i--) {\n  \t\t\t\tprop = properties[i];\n\n  \t\t\t\tintermediate[prop] = interpolators[prop](t);\n  \t\t\t}\n\n  \t\t\treturn intermediate;\n  \t\t};\n  \t}\n  };\n\n  var refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\n  var splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\n  var escapeKeyPattern = /\\\\|\\./g;\n  var unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\n  function escapeKey(key) {\n  \tif (typeof key === 'string') {\n  \t\treturn key.replace(escapeKeyPattern, '\\\\$&');\n  \t}\n\n  \treturn key;\n  }\n\n  function normalise(ref) {\n  \treturn ref ? ref.replace(refPattern, '.$1') : '';\n  }\n\n  function splitKeypathI(keypath) {\n  \tvar result = [],\n  \t    match = void 0;\n\n  \tkeypath = normalise(keypath);\n\n  \twhile (match = splitPattern.exec(keypath)) {\n  \t\tvar index = match.index + match[1].length;\n  \t\tresult.push(keypath.substr(0, index));\n  \t\tkeypath = keypath.substr(index + 1);\n  \t}\n\n  \tresult.push(keypath);\n\n  \treturn result;\n  }\n\n  function unescapeKey(key) {\n  \tif (typeof key === 'string') {\n  \t\treturn key.replace(unescapeKeyPattern, '$1$2');\n  \t}\n\n  \treturn key;\n  }\n\n  var errorMessage = 'Cannot add to a non-numeric value';\n\n  function add(ractive, keypath, d) {\n  \tif (typeof keypath !== 'string' || !isNumeric(d)) {\n  \t\tthrow new Error('Bad arguments');\n  \t}\n\n  \tvar changes = void 0;\n\n  \tif (/\\*/.test(keypath)) {\n  \t\tchanges = {};\n\n  \t\tractive.viewmodel.findMatches(splitKeypathI(keypath)).forEach(function (model) {\n  \t\t\tvar value = model.get();\n\n  \t\t\tif (!isNumeric(value)) throw new Error(errorMessage);\n\n  \t\t\tchanges[model.getKeypath()] = value + d;\n  \t\t});\n\n  \t\treturn ractive.set(changes);\n  \t}\n\n  \tvar value = ractive.get(keypath);\n\n  \tif (!isNumeric(value)) {\n  \t\tthrow new Error(errorMessage);\n  \t}\n\n  \treturn ractive.set(keypath, +value + d);\n  }\n\n  function Ractive$add(keypath, d) {\n  \treturn add(this, keypath, d === undefined ? 1 : +d);\n  }\n\n  // TODO: deprecate in future release\n  var deprecations = {\n  \tconstruct: {\n  \t\tdeprecated: 'beforeInit',\n  \t\treplacement: 'onconstruct'\n  \t},\n  \trender: {\n  \t\tdeprecated: 'init',\n  \t\tmessage: 'The \"init\" method has been deprecated ' + 'and will likely be removed in a future release. ' + 'You can either use the \"oninit\" method which will fire ' + 'only once prior to, and regardless of, any eventual ractive ' + 'instance being rendered, or if you need to access the ' + 'rendered DOM, use \"onrender\" instead. ' + 'See http://docs.ractivejs.org/latest/migrating for more information.'\n  \t},\n  \tcomplete: {\n  \t\tdeprecated: 'complete',\n  \t\treplacement: 'oncomplete'\n  \t}\n  };\n\n  var Hook = function () {\n  \tfunction Hook(event) {\n  \t\tbabelHelpers.classCallCheck(this, Hook);\n\n  \t\tthis.event = event;\n  \t\tthis.method = 'on' + event;\n  \t\tthis.deprecate = deprecations[event];\n  \t}\n\n  \tHook.prototype.call = function call(method, ractive, arg) {\n  \t\tif (ractive[method]) {\n  \t\t\targ ? ractive[method](arg) : ractive[method]();\n  \t\t\treturn true;\n  \t\t}\n  \t};\n\n  \tHook.prototype.fire = function fire(ractive, arg) {\n  \t\tthis.call(this.method, ractive, arg);\n\n  \t\t// handle deprecations\n  \t\tif (!ractive[this.method] && this.deprecate && this.call(this.deprecate.deprecated, ractive, arg)) {\n  \t\t\tif (this.deprecate.message) {\n  \t\t\t\twarnIfDebug(this.deprecate.message);\n  \t\t\t} else {\n  \t\t\t\twarnIfDebug('The method \"%s\" has been deprecated in favor of \"%s\" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.', this.deprecate.deprecated, this.deprecate.replacement);\n  \t\t\t}\n  \t\t}\n\n  \t\t// TODO should probably use internal method, in case ractive.fire was overwritten\n  \t\targ ? ractive.fire(this.event, arg) : ractive.fire(this.event);\n  \t};\n\n  \treturn Hook;\n  }();\n\n  function addToArray(array, value) {\n  \tvar index = array.indexOf(value);\n\n  \tif (index === -1) {\n  \t\tarray.push(value);\n  \t}\n  }\n\n  function arrayContains(array, value) {\n  \tfor (var i = 0, c = array.length; i < c; i++) {\n  \t\tif (array[i] == value) {\n  \t\t\treturn true;\n  \t\t}\n  \t}\n\n  \treturn false;\n  }\n\n  function arrayContentsMatch(a, b) {\n  \tvar i;\n\n  \tif (!isArray(a) || !isArray(b)) {\n  \t\treturn false;\n  \t}\n\n  \tif (a.length !== b.length) {\n  \t\treturn false;\n  \t}\n\n  \ti = a.length;\n  \twhile (i--) {\n  \t\tif (a[i] !== b[i]) {\n  \t\t\treturn false;\n  \t\t}\n  \t}\n\n  \treturn true;\n  }\n\n  function ensureArray(x) {\n  \tif (typeof x === 'string') {\n  \t\treturn [x];\n  \t}\n\n  \tif (x === undefined) {\n  \t\treturn [];\n  \t}\n\n  \treturn x;\n  }\n\n  function lastItem(array) {\n  \treturn array[array.length - 1];\n  }\n\n  function removeFromArray(array, member) {\n  \tif (!array) {\n  \t\treturn;\n  \t}\n\n  \tvar index = array.indexOf(member);\n\n  \tif (index !== -1) {\n  \t\tarray.splice(index, 1);\n  \t}\n  }\n\n  function toArray(arrayLike) {\n  \tvar array = [],\n  \t    i = arrayLike.length;\n  \twhile (i--) {\n  \t\tarray[i] = arrayLike[i];\n  \t}\n\n  \treturn array;\n  }\n\n  var _Promise2;\n  var PENDING = {};\n  var FULFILLED = {};\n  var REJECTED = {};\n  if (typeof Promise === 'function') {\n  \t// use native Promise\n  \t_Promise2 = Promise;\n  } else {\n  \t_Promise2 = function _Promise(callback) {\n  \t\tvar fulfilledHandlers = [],\n  \t\t    rejectedHandlers = [],\n  \t\t    state = PENDING,\n  \t\t    result,\n  \t\t    dispatchHandlers,\n  \t\t    makeResolver,\n  \t\t    fulfil,\n  \t\t    reject,\n  \t\t    promise;\n\n  \t\tmakeResolver = function makeResolver(newState) {\n  \t\t\treturn function (value) {\n  \t\t\t\tif (state !== PENDING) {\n  \t\t\t\t\treturn;\n  \t\t\t\t}\n\n  \t\t\t\tresult = value;\n  \t\t\t\tstate = newState;\n\n  \t\t\t\tdispatchHandlers = makeDispatcher(state === FULFILLED ? fulfilledHandlers : rejectedHandlers, result);\n\n  \t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n  \t\t\t\twait(dispatchHandlers);\n  \t\t\t};\n  \t\t};\n\n  \t\tfulfil = makeResolver(FULFILLED);\n  \t\treject = makeResolver(REJECTED);\n\n  \t\ttry {\n  \t\t\tcallback(fulfil, reject);\n  \t\t} catch (err) {\n  \t\t\treject(err);\n  \t\t}\n\n  \t\tpromise = {\n  \t\t\t// `then()` returns a Promise - 2.2.7\n  \t\t\tthen: function then(onFulfilled, onRejected) {\n  \t\t\t\tvar promise2 = new _Promise2(function (fulfil, reject) {\n\n  \t\t\t\t\tvar processResolutionHandler = function processResolutionHandler(handler, handlers, forward) {\n\n  \t\t\t\t\t\t// 2.2.1.1\n  \t\t\t\t\t\tif (typeof handler === 'function') {\n  \t\t\t\t\t\t\thandlers.push(function (p1result) {\n  \t\t\t\t\t\t\t\tvar x;\n\n  \t\t\t\t\t\t\t\ttry {\n  \t\t\t\t\t\t\t\t\tx = handler(p1result);\n  \t\t\t\t\t\t\t\t\tresolve(promise2, x, fulfil, reject);\n  \t\t\t\t\t\t\t\t} catch (err) {\n  \t\t\t\t\t\t\t\t\treject(err);\n  \t\t\t\t\t\t\t\t}\n  \t\t\t\t\t\t\t});\n  \t\t\t\t\t\t} else {\n  \t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n  \t\t\t\t\t\t\t// are not given\n  \t\t\t\t\t\t\thandlers.push(forward);\n  \t\t\t\t\t\t}\n  \t\t\t\t\t};\n\n  \t\t\t\t\t// 2.2\n  \t\t\t\t\tprocessResolutionHandler(onFulfilled, fulfilledHandlers, fulfil);\n  \t\t\t\t\tprocessResolutionHandler(onRejected, rejectedHandlers, reject);\n\n  \t\t\t\t\tif (state !== PENDING) {\n  \t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n  \t\t\t\t\t\twait(dispatchHandlers);\n  \t\t\t\t\t}\n  \t\t\t\t});\n\n  \t\t\t\treturn promise2;\n  \t\t\t}\n  \t\t};\n\n  \t\tpromise['catch'] = function (onRejected) {\n  \t\t\treturn this.then(null, onRejected);\n  \t\t};\n\n  \t\treturn promise;\n  \t};\n\n  \t_Promise2.all = function (promises) {\n  \t\treturn new _Promise2(function (fulfil, reject) {\n  \t\t\tvar result = [],\n  \t\t\t    pending,\n  \t\t\t    i,\n  \t\t\t    processPromise;\n\n  \t\t\tif (!promises.length) {\n  \t\t\t\tfulfil(result);\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tprocessPromise = function processPromise(promise, i) {\n  \t\t\t\tif (promise && typeof promise.then === 'function') {\n  \t\t\t\t\tpromise.then(function (value) {\n  \t\t\t\t\t\tresult[i] = value;\n  \t\t\t\t\t\t--pending || fulfil(result);\n  \t\t\t\t\t}, reject);\n  \t\t\t\t} else {\n  \t\t\t\t\tresult[i] = promise;\n  \t\t\t\t\t--pending || fulfil(result);\n  \t\t\t\t}\n  \t\t\t};\n\n  \t\t\tpending = i = promises.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tprocessPromise(promises[i], i);\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \t_Promise2.resolve = function (value) {\n  \t\treturn new _Promise2(function (fulfil) {\n  \t\t\tfulfil(value);\n  \t\t});\n  \t};\n\n  \t_Promise2.reject = function (reason) {\n  \t\treturn new _Promise2(function (fulfil, reject) {\n  \t\t\treject(reason);\n  \t\t});\n  \t};\n  }\n\n  var Promise$1 = _Promise2;\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  function wait(callback) {\n  \tsetTimeout(callback, 0);\n  }\n\n  function makeDispatcher(handlers, result) {\n  \treturn function () {\n  \t\tvar handler;\n\n  \t\twhile (handler = handlers.shift()) {\n  \t\t\thandler(result);\n  \t\t}\n  \t};\n  }\n\n  function resolve(promise, x, fulfil, reject) {\n  \t// Promise Resolution Procedure\n  \tvar then;\n\n  \t// 2.3.1\n  \tif (x === promise) {\n  \t\tthrow new TypeError('A promise\\'s fulfillment handler cannot return the same promise');\n  \t}\n\n  \t// 2.3.2\n  \tif (x instanceof _Promise2) {\n  \t\tx.then(fulfil, reject);\n  \t}\n\n  \t// 2.3.3\n  \telse if (x && ((typeof x === 'undefined' ? 'undefined' : babelHelpers.typeof(x)) === 'object' || typeof x === 'function')) {\n  \t\t\ttry {\n  \t\t\t\tthen = x.then; // 2.3.3.1\n  \t\t\t} catch (e) {\n  \t\t\t\treject(e); // 2.3.3.2\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\t// 2.3.3.3\n  \t\t\tif (typeof then === 'function') {\n  \t\t\t\tvar called, resolvePromise, rejectPromise;\n\n  \t\t\t\tresolvePromise = function resolvePromise(y) {\n  \t\t\t\t\tif (called) {\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n  \t\t\t\t\tcalled = true;\n  \t\t\t\t\tresolve(promise, y, fulfil, reject);\n  \t\t\t\t};\n\n  \t\t\t\trejectPromise = function rejectPromise(r) {\n  \t\t\t\t\tif (called) {\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n  \t\t\t\t\tcalled = true;\n  \t\t\t\t\treject(r);\n  \t\t\t\t};\n\n  \t\t\t\ttry {\n  \t\t\t\t\tthen.call(x, resolvePromise, rejectPromise);\n  \t\t\t\t} catch (e) {\n  \t\t\t\t\tif (!called) {\n  \t\t\t\t\t\t// 2.3.3.3.4.1\n  \t\t\t\t\t\treject(e); // 2.3.3.3.4.2\n  \t\t\t\t\t\tcalled = true;\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tfulfil(x);\n  \t\t\t}\n  \t\t} else {\n  \t\t\tfulfil(x);\n  \t\t}\n  }\n\n  var TransitionManager = function () {\n  \tfunction TransitionManager(callback, parent) {\n  \t\tbabelHelpers.classCallCheck(this, TransitionManager);\n\n  \t\tthis.callback = callback;\n  \t\tthis.parent = parent;\n\n  \t\tthis.intros = [];\n  \t\tthis.outros = [];\n\n  \t\tthis.children = [];\n  \t\tthis.totalChildren = this.outroChildren = 0;\n\n  \t\tthis.detachQueue = [];\n  \t\tthis.outrosComplete = false;\n\n  \t\tif (parent) {\n  \t\t\tparent.addChild(this);\n  \t\t}\n  \t}\n\n  \tTransitionManager.prototype.add = function add(transition) {\n  \t\tvar list = transition.isIntro ? this.intros : this.outros;\n  \t\tlist.push(transition);\n  \t};\n\n  \tTransitionManager.prototype.addChild = function addChild(child) {\n  \t\tthis.children.push(child);\n\n  \t\tthis.totalChildren += 1;\n  \t\tthis.outroChildren += 1;\n  \t};\n\n  \tTransitionManager.prototype.decrementOutros = function decrementOutros() {\n  \t\tthis.outroChildren -= 1;\n  \t\tcheck(this);\n  \t};\n\n  \tTransitionManager.prototype.decrementTotal = function decrementTotal() {\n  \t\tthis.totalChildren -= 1;\n  \t\tcheck(this);\n  \t};\n\n  \tTransitionManager.prototype.detachNodes = function detachNodes() {\n  \t\tthis.detachQueue.forEach(detach);\n  \t\tthis.children.forEach(_detachNodes);\n  \t};\n\n  \tTransitionManager.prototype.remove = function remove(transition) {\n  \t\tvar list = transition.isIntro ? this.intros : this.outros;\n  \t\tremoveFromArray(list, transition);\n  \t\tcheck(this);\n  \t};\n\n  \tTransitionManager.prototype.start = function start() {\n  \t\tthis.intros.concat(this.outros).forEach(function (t) {\n  \t\t\treturn t.start();\n  \t\t});\n  \t\tthis.ready = true;\n  \t\tcheck(this);\n  \t};\n\n  \treturn TransitionManager;\n  }();\n\n  function detach(element) {\n  \telement.detach();\n  }\n\n  function _detachNodes(tm) {\n  \t// _ to avoid transpiler quirk\n  \ttm.detachNodes();\n  }\n\n  function check(tm) {\n  \tif (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  \t// If all outros are complete, and we haven't already done this,\n  \t// we notify the parent if there is one, otherwise\n  \t// start detaching nodes\n  \tif (!tm.outrosComplete) {\n  \t\tif (tm.parent && !tm.parent.outrosComplete) {\n  \t\t\ttm.parent.decrementOutros(tm);\n  \t\t} else {\n  \t\t\ttm.detachNodes();\n  \t\t}\n\n  \t\ttm.outrosComplete = true;\n  \t}\n\n  \t// Once everything is done, we can notify parent transition\n  \t// manager and call the callback\n  \tif (!tm.intros.length && !tm.totalChildren) {\n  \t\tif (typeof tm.callback === 'function') {\n  \t\t\ttm.callback();\n  \t\t}\n\n  \t\tif (tm.parent) {\n  \t\t\ttm.parent.decrementTotal();\n  \t\t}\n  \t}\n  }\n\n  var changeHook = new Hook('change');\n\n  var batch = void 0;\n\n  var runloop = {\n  \tstart: function start(instance, returnPromise) {\n  \t\tvar promise, fulfilPromise;\n\n  \t\tif (returnPromise) {\n  \t\t\tpromise = new Promise$1(function (f) {\n  \t\t\t\treturn fulfilPromise = f;\n  \t\t\t});\n  \t\t}\n\n  \t\tbatch = {\n  \t\t\tpreviousBatch: batch,\n  \t\t\ttransitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n  \t\t\tfragments: [],\n  \t\t\ttasks: [],\n  \t\t\timmediateObservers: [],\n  \t\t\tdeferredObservers: [],\n  \t\t\tinstance: instance\n  \t\t};\n\n  \t\treturn promise;\n  \t},\n  \tend: function end() {\n  \t\tflushChanges();\n  \t\tbatch = batch.previousBatch;\n  \t},\n  \taddFragment: function addFragment(fragment) {\n  \t\taddToArray(batch.fragments, fragment);\n  \t},\n  \taddObserver: function addObserver(observer, defer) {\n  \t\taddToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n  \t},\n  \tregisterTransition: function registerTransition(transition) {\n  \t\ttransition._manager = batch.transitionManager;\n  \t\tbatch.transitionManager.add(transition);\n  \t},\n\n\n  \t// synchronise node detachments with transition ends\n  \tdetachWhenReady: function detachWhenReady(thing) {\n  \t\tbatch.transitionManager.detachQueue.push(thing);\n  \t},\n  \tscheduleTask: function scheduleTask(task, postRender) {\n  \t\tvar _batch;\n\n  \t\tif (!batch) {\n  \t\t\ttask();\n  \t\t} else {\n  \t\t\t_batch = batch;\n  \t\t\twhile (postRender && _batch.previousBatch) {\n  \t\t\t\t// this can't happen until the DOM has been fully updated\n  \t\t\t\t// otherwise in some situations (with components inside elements)\n  \t\t\t\t// transitions and decorators will initialise prematurely\n  \t\t\t\t_batch = _batch.previousBatch;\n  \t\t\t}\n\n  \t\t\t_batch.tasks.push(task);\n  \t\t}\n  \t}\n  };\n\n  function dispatch(observer) {\n  \tobserver.dispatch();\n  }\n\n  function flushChanges() {\n  \tvar which = batch.immediateObservers;\n  \tbatch.immediateObservers = [];\n  \twhich.forEach(dispatch);\n\n  \t// Now that changes have been fully propagated, we can update the DOM\n  \t// and complete other tasks\n  \tvar i = batch.fragments.length;\n  \tvar fragment = void 0;\n\n  \twhich = batch.fragments;\n  \tbatch.fragments = [];\n\n  \twhile (i--) {\n  \t\tfragment = which[i];\n\n  \t\t// TODO deprecate this. It's annoying and serves no useful function\n  \t\tvar ractive = fragment.ractive;\n  \t\tchangeHook.fire(ractive, ractive.viewmodel.changes);\n  \t\tractive.viewmodel.changes = {};\n\n  \t\tfragment.update();\n  \t}\n\n  \tbatch.transitionManager.start();\n\n  \twhich = batch.deferredObservers;\n  \tbatch.deferredObservers = [];\n  \twhich.forEach(dispatch);\n\n  \tvar tasks = batch.tasks;\n  \tbatch.tasks = [];\n\n  \tfor (i = 0; i < tasks.length; i += 1) {\n  \t\ttasks[i]();\n  \t}\n\n  \t// If updating the view caused some model blowback - e.g. a triple\n  \t// containing <option> elements caused the binding on the <select>\n  \t// to update - then we start over\n  \tif (batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length) return flushChanges();\n  }\n\n  var noAnimation = Promise$1.resolve();\n  defineProperty(noAnimation, 'stop', { value: noop });\n\n  var linear = easing.linear;\n\n  function getOptions(options, instance) {\n  \toptions = options || {};\n\n  \tvar easing = void 0;\n  \tif (options.easing) {\n  \t\teasing = typeof options.easing === 'function' ? options.easing : instance.easing[options.easing];\n  \t}\n\n  \treturn {\n  \t\teasing: easing || linear,\n  \t\tduration: 'duration' in options ? options.duration : 400,\n  \t\tcomplete: options.complete || noop,\n  \t\tstep: options.step || noop\n  \t};\n  }\n\n  function Ractive$animate(keypath, to, options) {\n  \tif ((typeof keypath === 'undefined' ? 'undefined' : babelHelpers.typeof(keypath)) === 'object') {\n  \t\tvar keys = Object.keys(keypath);\n\n  \t\tthrow new Error('ractive.animate(...) no longer supports objects. Instead of ractive.animate({\\n  ' + keys.map(function (key) {\n  \t\t\treturn '\\'' + key + '\\': ' + keypath[key];\n  \t\t}).join('\\n  ') + '\\n}, {...}), do\\n\\n' + keys.map(function (key) {\n  \t\t\treturn 'ractive.animate(\\'' + key + '\\', ' + keypath[key] + ', {...});';\n  \t\t}).join('\\n') + '\\n');\n  \t}\n\n  \toptions = getOptions(options, this);\n\n  \tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \tvar from = model.get();\n\n  \t// don't bother animating values that stay the same\n  \tif (isEqual(from, to)) {\n  \t\toptions.complete(options.to);\n  \t\treturn noAnimation; // TODO should this have .then and .catch methods?\n  \t}\n\n  \tvar interpolator = interpolate(from, to, this, options.interpolator);\n\n  \t// if we can't interpolate the value, set it immediately\n  \tif (!interpolator) {\n  \t\trunloop.start();\n  \t\tmodel.set(to);\n  \t\trunloop.end();\n\n  \t\treturn noAnimation;\n  \t}\n\n  \treturn model.animate(from, to, options, interpolator);\n  }\n\n  var detachHook = new Hook('detach');\n\n  function Ractive$detach() {\n  \tif (this.isDetached) {\n  \t\treturn this.el;\n  \t}\n\n  \tif (this.el) {\n  \t\tremoveFromArray(this.el.__ractive_instances__, this);\n  \t}\n\n  \tthis.el = this.fragment.detach();\n  \tthis.isDetached = true;\n\n  \tdetachHook.fire(this);\n  \treturn this.el;\n  }\n\n  function Ractive$find(selector) {\n  \tif (!this.el) throw new Error(\"Cannot call ractive.find('\" + selector + \"') unless instance is rendered to the DOM\");\n\n  \treturn this.fragment.find(selector);\n  }\n\n  function sortByDocumentPosition(node, otherNode) {\n  \tif (node.compareDocumentPosition) {\n  \t\tvar bitmask = node.compareDocumentPosition(otherNode);\n  \t\treturn bitmask & 2 ? 1 : -1;\n  \t}\n\n  \t// In old IE, we can piggy back on the mechanism for\n  \t// comparing component positions\n  \treturn sortByItemPosition(node, otherNode);\n  }\n\n  function sortByItemPosition(a, b) {\n  \tvar ancestryA = getAncestry(a.component || a._ractive.proxy);\n  \tvar ancestryB = getAncestry(b.component || b._ractive.proxy);\n\n  \tvar oldestA = lastItem(ancestryA);\n  \tvar oldestB = lastItem(ancestryB);\n  \tvar mutualAncestor = void 0;\n\n  \t// remove items from the end of both ancestries as long as they are identical\n  \t// - the final one removed is the closest mutual ancestor\n  \twhile (oldestA && oldestA === oldestB) {\n  \t\tancestryA.pop();\n  \t\tancestryB.pop();\n\n  \t\tmutualAncestor = oldestA;\n\n  \t\toldestA = lastItem(ancestryA);\n  \t\toldestB = lastItem(ancestryB);\n  \t}\n\n  \t// now that we have the mutual ancestor, we can find which is earliest\n  \toldestA = oldestA.component || oldestA;\n  \toldestB = oldestB.component || oldestB;\n\n  \tvar fragmentA = oldestA.parentFragment;\n  \tvar fragmentB = oldestB.parentFragment;\n\n  \t// if both items share a parent fragment, our job is easy\n  \tif (fragmentA === fragmentB) {\n  \t\tvar indexA = fragmentA.items.indexOf(oldestA);\n  \t\tvar indexB = fragmentB.items.indexOf(oldestB);\n\n  \t\t// if it's the same index, it means one contains the other,\n  \t\t// so we see which has the longest ancestry\n  \t\treturn indexA - indexB || ancestryA.length - ancestryB.length;\n  \t}\n\n  \t// if mutual ancestor is a section, we first test to see which section\n  \t// fragment comes first\n  \tvar fragments = mutualAncestor.iterations;\n  \tif (fragments) {\n  \t\tvar _indexA = fragments.indexOf(fragmentA);\n  \t\tvar _indexB = fragments.indexOf(fragmentB);\n\n  \t\treturn _indexA - _indexB || ancestryA.length - ancestryB.length;\n  \t}\n\n  \tthrow new Error('An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!');\n  }\n\n  function getParent(item) {\n  \tvar parentFragment = item.parentFragment;\n\n  \tif (parentFragment) return parentFragment.owner;\n\n  \tif (item.component && (parentFragment = item.component.parentFragment)) {\n  \t\treturn parentFragment.owner;\n  \t}\n  }\n\n  function getAncestry(item) {\n  \tvar ancestry = [item];\n  \tvar ancestor = getParent(item);\n\n  \twhile (ancestor) {\n  \t\tancestry.push(ancestor);\n  \t\tancestor = getParent(ancestor);\n  \t}\n\n  \treturn ancestry;\n  }\n\n  var Query = function () {\n  \tfunction Query(ractive, selector, live, isComponentQuery) {\n  \t\tbabelHelpers.classCallCheck(this, Query);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.selector = selector;\n  \t\tthis.live = live;\n  \t\tthis.isComponentQuery = isComponentQuery;\n\n  \t\tthis.result = [];\n\n  \t\tthis.dirty = true;\n  \t}\n\n  \tQuery.prototype.add = function add(item) {\n  \t\tthis.result.push(item);\n  \t\tthis.makeDirty();\n  \t};\n\n  \tQuery.prototype.cancel = function cancel() {\n  \t\tvar liveQueries = this._root[this.isComponentQuery ? 'liveComponentQueries' : 'liveQueries'];\n  \t\tvar selector = this.selector;\n\n  \t\tvar index = liveQueries.indexOf(selector);\n\n  \t\tif (index !== -1) {\n  \t\t\tliveQueries.splice(index, 1);\n  \t\t\tliveQueries[selector] = null;\n  \t\t}\n  \t};\n\n  \tQuery.prototype.init = function init() {\n  \t\tthis.dirty = false;\n  \t};\n\n  \tQuery.prototype.makeDirty = function makeDirty() {\n  \t\tvar _this = this;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n\n  \t\t\t// Once the DOM has been updated, ensure the query\n  \t\t\t// is correctly ordered\n  \t\t\trunloop.scheduleTask(function () {\n  \t\t\t\treturn _this.update();\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tQuery.prototype.remove = function remove(nodeOrComponent) {\n  \t\tvar index = this.result.indexOf(this.isComponentQuery ? nodeOrComponent.instance : nodeOrComponent);\n  \t\tif (index !== -1) this.result.splice(index, 1);\n  \t};\n\n  \tQuery.prototype.update = function update() {\n  \t\tthis.result.sort(this.isComponentQuery ? sortByItemPosition : sortByDocumentPosition);\n  \t\tthis.dirty = false;\n  \t};\n\n  \tQuery.prototype.test = function test(item) {\n  \t\treturn this.isComponentQuery ? !this.selector || item.name === this.selector : item ? matches(item, this.selector) : null;\n  \t};\n\n  \treturn Query;\n  }();\n\n  function Ractive$findAll(selector, options) {\n  \tif (!this.el) throw new Error('Cannot call ractive.findAll(\\'' + selector + '\\', ...) unless instance is rendered to the DOM');\n\n  \toptions = options || {};\n  \tvar liveQueries = this._liveQueries;\n\n  \t// Shortcut: if we're maintaining a live query with this\n  \t// selector, we don't need to traverse the parallel DOM\n  \tvar query = liveQueries[selector];\n  \tif (query) {\n  \t\t// Either return the exact same query, or (if not live) a snapshot\n  \t\treturn options && options.live ? query : query.slice();\n  \t}\n\n  \tquery = new Query(this, selector, !!options.live, false);\n\n  \t// Add this to the list of live queries Ractive needs to maintain,\n  \t// if applicable\n  \tif (query.live) {\n  \t\tliveQueries.push(selector);\n  \t\tliveQueries['_' + selector] = query;\n  \t}\n\n  \tthis.fragment.findAll(selector, query);\n\n  \tquery.init();\n  \treturn query.result;\n  }\n\n  function Ractive$findAllComponents(selector, options) {\n  \toptions = options || {};\n  \tvar liveQueries = this._liveComponentQueries;\n\n  \t// Shortcut: if we're maintaining a live query with this\n  \t// selector, we don't need to traverse the parallel DOM\n  \tvar query = liveQueries[selector];\n  \tif (query) {\n  \t\t// Either return the exact same query, or (if not live) a snapshot\n  \t\treturn options && options.live ? query : query.slice();\n  \t}\n\n  \tquery = new Query(this, selector, !!options.live, true);\n\n  \t// Add this to the list of live queries Ractive needs to maintain,\n  \t// if applicable\n  \tif (query.live) {\n  \t\tliveQueries.push(selector);\n  \t\tliveQueries['_' + selector] = query;\n  \t}\n\n  \tthis.fragment.findAllComponents(selector, query);\n\n  \tquery.init();\n  \treturn query.result;\n  }\n\n  function Ractive$findComponent(selector) {\n  \treturn this.fragment.findComponent(selector);\n  }\n\n  function Ractive$findContainer(selector) {\n  \tif (this.container) {\n  \t\tif (this.container.component && this.container.component.name === selector) {\n  \t\t\treturn this.container;\n  \t\t} else {\n  \t\t\treturn this.container.findContainer(selector);\n  \t\t}\n  \t}\n\n  \treturn null;\n  }\n\n  function Ractive$findParent(selector) {\n\n  \tif (this.parent) {\n  \t\tif (this.parent.component && this.parent.component.name === selector) {\n  \t\t\treturn this.parent;\n  \t\t} else {\n  \t\t\treturn this.parent.findParent(selector);\n  \t\t}\n  \t}\n\n  \treturn null;\n  }\n\n  function enqueue(ractive, event) {\n  \tif (ractive.event) {\n  \t\tractive._eventQueue.push(ractive.event);\n  \t}\n\n  \tractive.event = event;\n  }\n\n  function dequeue(ractive) {\n  \tif (ractive._eventQueue.length) {\n  \t\tractive.event = ractive._eventQueue.pop();\n  \t} else {\n  \t\tractive.event = null;\n  \t}\n  }\n\n  var starMaps = {};\n\n  // This function takes a keypath such as 'foo.bar.baz', and returns\n  // all the variants of that keypath that include a wildcard in place\n  // of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n  // These are then checked against the dependants map (ractive.viewmodel.depsMap)\n  // to see if any pattern observers are downstream of one or more of\n  // these wildcard keypaths (e.g. 'foo.bar.*.status')\n  function getPotentialWildcardMatches(keypath) {\n  \tvar keys, starMap, mapper, i, result, wildcardKeypath;\n\n  \tkeys = splitKeypathI(keypath);\n  \tif (!(starMap = starMaps[keys.length])) {\n  \t\tstarMap = getStarMap(keys.length);\n  \t}\n\n  \tresult = [];\n\n  \tmapper = function mapper(star, i) {\n  \t\treturn star ? '*' : keys[i];\n  \t};\n\n  \ti = starMap.length;\n  \twhile (i--) {\n  \t\twildcardKeypath = starMap[i].map(mapper).join('.');\n\n  \t\tif (!result.hasOwnProperty(wildcardKeypath)) {\n  \t\t\tresult.push(wildcardKeypath);\n  \t\t\tresult[wildcardKeypath] = true;\n  \t\t}\n  \t}\n\n  \treturn result;\n  }\n\n  // This function returns all the possible true/false combinations for\n  // a given number - e.g. for two, the possible combinations are\n  // [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n  // It does so by getting all the binary values between 0 and e.g. 11\n  function getStarMap(num) {\n  \tvar ones = '',\n  \t    max,\n  \t    binary,\n  \t    starMap,\n  \t    mapper,\n  \t    i,\n  \t    j,\n  \t    l,\n  \t    map;\n\n  \tif (!starMaps[num]) {\n  \t\tstarMap = [];\n\n  \t\twhile (ones.length < num) {\n  \t\t\tones += 1;\n  \t\t}\n\n  \t\tmax = parseInt(ones, 2);\n\n  \t\tmapper = function mapper(digit) {\n  \t\t\treturn digit === '1';\n  \t\t};\n\n  \t\tfor (i = 0; i <= max; i += 1) {\n  \t\t\tbinary = i.toString(2);\n  \t\t\twhile (binary.length < num) {\n  \t\t\t\tbinary = '0' + binary;\n  \t\t\t}\n\n  \t\t\tmap = [];\n  \t\t\tl = binary.length;\n  \t\t\tfor (j = 0; j < l; j++) {\n  \t\t\t\tmap.push(mapper(binary[j]));\n  \t\t\t}\n  \t\t\tstarMap[i] = map;\n  \t\t}\n\n  \t\tstarMaps[num] = starMap;\n  \t}\n\n  \treturn starMaps[num];\n  }\n\n  var wildcardCache = {};\n\n  function fireEvent(ractive, eventName) {\n  \tvar options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n  \tif (!eventName) {\n  \t\treturn;\n  \t}\n\n  \tif (!options.event) {\n  \t\toptions.event = {\n  \t\t\tname: eventName,\n  \t\t\t// until event not included as argument default\n  \t\t\t_noArg: true\n  \t\t};\n  \t} else {\n  \t\toptions.event.name = eventName;\n  \t}\n\n  \tvar eventNames = getWildcardNames(eventName);\n\n  \tfireEventAs(ractive, eventNames, options.event, options.args, true);\n  }\n\n  function getWildcardNames(eventName) {\n  \tif (wildcardCache.hasOwnProperty(eventName)) {\n  \t\treturn wildcardCache[eventName];\n  \t} else {\n  \t\treturn wildcardCache[eventName] = getPotentialWildcardMatches(eventName);\n  \t}\n  }\n\n  function fireEventAs(ractive, eventNames, event, args) {\n  \tvar initialFire = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];\n\n\n  \tvar subscribers,\n  \t    i,\n  \t    bubble = true;\n\n  \tenqueue(ractive, event);\n\n  \tfor (i = eventNames.length; i >= 0; i--) {\n  \t\tsubscribers = ractive._subs[eventNames[i]];\n\n  \t\tif (subscribers) {\n  \t\t\tbubble = notifySubscribers(ractive, subscribers, event, args) && bubble;\n  \t\t}\n  \t}\n\n  \tdequeue(ractive);\n\n  \tif (ractive.parent && bubble) {\n\n  \t\tif (initialFire && ractive.component) {\n  \t\t\tvar fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n  \t\t\teventNames = getWildcardNames(fullName);\n\n  \t\t\tif (event && !event.component) {\n  \t\t\t\tevent.component = ractive;\n  \t\t\t}\n  \t\t}\n\n  \t\tfireEventAs(ractive.parent, eventNames, event, args);\n  \t}\n  }\n\n  function notifySubscribers(ractive, subscribers, event, args) {\n  \tvar originalEvent = null,\n  \t    stopEvent = false;\n\n  \tif (event && !event._noArg) {\n  \t\targs = [event].concat(args);\n  \t}\n\n  \t// subscribers can be modified inflight, e.g. \"once\" functionality\n  \t// so we need to copy to make sure everyone gets called\n  \tsubscribers = subscribers.slice();\n\n  \tfor (var i = 0, len = subscribers.length; i < len; i += 1) {\n  \t\tif (subscribers[i].apply(ractive, args) === false) {\n  \t\t\tstopEvent = true;\n  \t\t}\n  \t}\n\n  \tif (event && !event._noArg && stopEvent && (originalEvent = event.original)) {\n  \t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n  \t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n  \t}\n\n  \treturn !stopEvent;\n  }\n\n  function Ractive$fire(eventName) {\n  \tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\targs[_key - 1] = arguments[_key];\n  \t}\n\n  \tfireEvent(this, eventName, { args: args });\n  }\n\n  function badReference(key) {\n  \tthrow new Error('An index or key reference (' + key + ') cannot have child properties');\n  }\n\n  function resolveAmbiguousReference(fragment, ref) {\n  \tvar localViewmodel = fragment.findContext().root;\n  \tvar keys = splitKeypathI(ref);\n  \tvar key = keys[0];\n\n  \tvar hasContextChain = void 0;\n  \tvar crossedComponentBoundary = void 0;\n  \tvar aliases = void 0;\n\n  \twhile (fragment) {\n  \t\t// repeated fragments\n  \t\tif (fragment.isIteration) {\n  \t\t\tif (key === fragment.parent.keyRef) {\n  \t\t\t\tif (keys.length > 1) badReference(key);\n  \t\t\t\treturn fragment.context.getKeyModel();\n  \t\t\t}\n\n  \t\t\tif (key === fragment.parent.indexRef) {\n  \t\t\t\tif (keys.length > 1) badReference(key);\n  \t\t\t\treturn fragment.context.getIndexModel(fragment.index);\n  \t\t\t}\n  \t\t}\n\n  \t\t// alias node or iteration\n  \t\tif (((aliases = fragment.owner.aliases) || (aliases = fragment.aliases)) && aliases.hasOwnProperty(key)) {\n  \t\t\tvar model = aliases[key];\n\n  \t\t\tif (keys.length === 1) return model;else if (typeof model.joinAll === 'function') {\n  \t\t\t\treturn model.joinAll(keys.slice(1));\n  \t\t\t}\n  \t\t}\n\n  \t\tif (fragment.context) {\n  \t\t\t// TODO better encapsulate the component check\n  \t\t\tif (!fragment.isRoot || fragment.ractive.component) hasContextChain = true;\n\n  \t\t\tif (fragment.context.has(key)) {\n  \t\t\t\tif (crossedComponentBoundary) {\n  \t\t\t\t\tlocalViewmodel.map(key, fragment.context.joinKey(key));\n  \t\t\t\t}\n\n  \t\t\t\treturn fragment.context.joinAll(keys);\n  \t\t\t}\n  \t\t}\n\n  \t\tif (fragment.componentParent && !fragment.ractive.isolated) {\n  \t\t\t// ascend through component boundary\n  \t\t\tfragment = fragment.componentParent;\n  \t\t\tcrossedComponentBoundary = true;\n  \t\t} else {\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n  \t}\n\n  \tif (!hasContextChain) {\n  \t\treturn localViewmodel.joinAll(keys);\n  \t}\n  }\n\n  var stack = [];\n  var captureGroup = void 0;\n\n  function startCapturing() {\n  \tstack.push(captureGroup = []);\n  }\n\n  function stopCapturing() {\n  \tvar dependencies = stack.pop();\n  \tcaptureGroup = stack[stack.length - 1];\n  \treturn dependencies;\n  }\n\n  function capture(model) {\n  \tif (captureGroup) {\n  \t\tcaptureGroup.push(model);\n  \t}\n  }\n\n  function _bind(x) {\n    x.bind();\n  }\n  function cancel(x) {\n    x.cancel();\n  }\n  function _handleChange(x) {\n    x.handleChange();\n  }\n  function mark(x) {\n    x.mark();\n  }\n  function _render(x) {\n    x.render();\n  }\n  function _rebind(x) {\n    x.rebind();\n  }\n  function teardown(x) {\n    x.teardown();\n  }\n  function _unbind(x) {\n    x.unbind();\n  }\n  function _unrender(x) {\n    x.unrender();\n  }\n  function unrenderAndDestroy(x) {\n    x.unrender(true);\n  }\n  function _update(x) {\n    x.update();\n  }\n  function _toString(x) {\n    return x.toString();\n  }\n  function toEscapedString(x) {\n    return x.toString(true);\n  }\n\n  var requestAnimationFrame;\n\n  // If window doesn't exist, we don't need requestAnimationFrame\n  if (!win) {\n  \trequestAnimationFrame = null;\n  } else {\n  \t// https://gist.github.com/paulirish/1579671\n  \t(function (vendors, lastTime, win) {\n\n  \t\tvar x, setTimeout;\n\n  \t\tif (win.requestAnimationFrame) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tfor (x = 0; x < vendors.length && !win.requestAnimationFrame; ++x) {\n  \t\t\twin.requestAnimationFrame = win[vendors[x] + 'RequestAnimationFrame'];\n  \t\t}\n\n  \t\tif (!win.requestAnimationFrame) {\n  \t\t\tsetTimeout = win.setTimeout;\n\n  \t\t\twin.requestAnimationFrame = function (callback) {\n  \t\t\t\tvar currTime, timeToCall, id;\n\n  \t\t\t\tcurrTime = Date.now();\n  \t\t\t\ttimeToCall = Math.max(0, 16 - (currTime - lastTime));\n  \t\t\t\tid = setTimeout(function () {\n  \t\t\t\t\tcallback(currTime + timeToCall);\n  \t\t\t\t}, timeToCall);\n\n  \t\t\t\tlastTime = currTime + timeToCall;\n  \t\t\t\treturn id;\n  \t\t\t};\n  \t\t}\n  \t})(vendors, 0, win);\n\n  \trequestAnimationFrame = win.requestAnimationFrame;\n  }\n\n  var rAF = requestAnimationFrame;\n\n  var getTime = win && win.performance && typeof win.performance.now === 'function' ? function () {\n  \treturn win.performance.now();\n  } : function () {\n  \treturn Date.now();\n  };\n\n  // TODO what happens if a transition is aborted?\n\n  var tickers = [];\n  var running = false;\n\n  function tick() {\n  \trunloop.start();\n\n  \tvar now = getTime();\n\n  \tvar i = void 0;\n  \tvar ticker = void 0;\n\n  \tfor (i = 0; i < tickers.length; i += 1) {\n  \t\tticker = tickers[i];\n\n  \t\tif (!ticker.tick(now)) {\n  \t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\n  \t\t\ttickers.splice(i--, 1);\n  \t\t}\n  \t}\n\n  \trunloop.end();\n\n  \tif (tickers.length) {\n  \t\trAF(tick);\n  \t} else {\n  \t\trunning = false;\n  \t}\n  }\n\n  var Ticker = function () {\n  \tfunction Ticker(options) {\n  \t\tbabelHelpers.classCallCheck(this, Ticker);\n\n  \t\tthis.duration = options.duration;\n  \t\tthis.step = options.step;\n  \t\tthis.complete = options.complete;\n  \t\tthis.easing = options.easing;\n\n  \t\tthis.start = getTime();\n  \t\tthis.end = this.start + this.duration;\n\n  \t\tthis.running = true;\n\n  \t\ttickers.push(this);\n  \t\tif (!running) rAF(tick);\n  \t}\n\n  \tTicker.prototype.tick = function tick(now) {\n  \t\tif (!this.running) return false;\n\n  \t\tif (now > this.end) {\n  \t\t\tif (this.step) this.step(1);\n  \t\t\tif (this.complete) this.complete(1);\n\n  \t\t\treturn false;\n  \t\t}\n\n  \t\tvar elapsed = now - this.start;\n  \t\tvar eased = this.easing(elapsed / this.duration);\n\n  \t\tif (this.step) this.step(eased);\n\n  \t\treturn true;\n  \t};\n\n  \tTicker.prototype.stop = function stop() {\n  \t\tif (this.abort) this.abort();\n  \t\tthis.running = false;\n  \t};\n\n  \treturn Ticker;\n  }();\n\n  var prefixers = {};\n\n  // TODO this is legacy. sooner we can replace the old adaptor API the better\n  function prefixKeypath(obj, prefix) {\n  \tvar prefixed = {},\n  \t    key;\n\n  \tif (!prefix) {\n  \t\treturn obj;\n  \t}\n\n  \tprefix += '.';\n\n  \tfor (key in obj) {\n  \t\tif (obj.hasOwnProperty(key)) {\n  \t\t\tprefixed[prefix + key] = obj[key];\n  \t\t}\n  \t}\n\n  \treturn prefixed;\n  }\n\n  function getPrefixer(rootKeypath) {\n  \tvar rootDot;\n\n  \tif (!prefixers[rootKeypath]) {\n  \t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n  \t\tprefixers[rootKeypath] = function (relativeKeypath, value) {\n  \t\t\tvar obj;\n\n  \t\t\tif (typeof relativeKeypath === 'string') {\n  \t\t\t\tobj = {};\n  \t\t\t\tobj[rootDot + relativeKeypath] = value;\n  \t\t\t\treturn obj;\n  \t\t\t}\n\n  \t\t\tif ((typeof relativeKeypath === 'undefined' ? 'undefined' : babelHelpers.typeof(relativeKeypath)) === 'object') {\n  \t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n  \t\t\t\treturn rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n  \t\t\t}\n  \t\t};\n  \t}\n\n  \treturn prefixers[rootKeypath];\n  }\n\n  var KeyModel = function () {\n  \tfunction KeyModel(key) {\n  \t\tbabelHelpers.classCallCheck(this, KeyModel);\n\n  \t\tthis.value = key;\n  \t\tthis.isReadonly = true;\n  \t\tthis.dependants = [];\n  \t}\n\n  \tKeyModel.prototype.get = function get() {\n  \t\treturn unescapeKey(this.value);\n  \t};\n\n  \tKeyModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn unescapeKey(this.value);\n  \t};\n\n  \tKeyModel.prototype.rebind = function rebind(key) {\n  \t\tthis.value = key;\n  \t\tthis.dependants.forEach(_handleChange);\n  \t};\n\n  \tKeyModel.prototype.register = function register(dependant) {\n  \t\tthis.dependants.push(dependant);\n  \t};\n\n  \tKeyModel.prototype.unregister = function unregister(dependant) {\n  \t\tremoveFromArray(this.dependants, dependant);\n  \t};\n\n  \treturn KeyModel;\n  }();\n\n  var KeypathModel = function () {\n  \tfunction KeypathModel(parent, ractive) {\n  \t\tbabelHelpers.classCallCheck(this, KeypathModel);\n\n  \t\tthis.parent = parent;\n  \t\tthis.ractive = ractive;\n  \t\tthis.value = ractive ? parent.getKeypath(ractive) : parent.getKeypath();\n  \t\tthis.dependants = [];\n  \t\tthis.children = [];\n  \t}\n\n  \tKeypathModel.prototype.addChild = function addChild(model) {\n  \t\tthis.children.push(model);\n  \t\tmodel.owner = this;\n  \t};\n\n  \tKeypathModel.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tKeypathModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn this.value;\n  \t};\n\n  \tKeypathModel.prototype.handleChange = function handleChange() {\n  \t\tthis.value = this.ractive ? this.parent.getKeypath(this.ractive) : this.parent.getKeypath();\n  \t\tif (this.ractive && this.owner) {\n  \t\t\tthis.ractive.viewmodel.keypathModels[this.owner.value] = this;\n  \t\t}\n  \t\tthis.children.forEach(_handleChange);\n  \t\tthis.dependants.forEach(_handleChange);\n  \t};\n\n  \tKeypathModel.prototype.register = function register(dependant) {\n  \t\tthis.dependants.push(dependant);\n  \t};\n\n  \tKeypathModel.prototype.removeChild = function removeChild(model) {\n  \t\tremoveFromArray(this.children, model);\n  \t};\n\n  \tKeypathModel.prototype.teardown = function teardown$$() {\n  \t\tif (this.owner) this.owner.removeChild(this);\n  \t\tthis.children.forEach(teardown);\n  \t};\n\n  \tKeypathModel.prototype.unregister = function unregister(dependant) {\n  \t\tremoveFromArray(this.dependants, dependant);\n  \t};\n\n  \treturn KeypathModel;\n  }();\n\n  var hasProp = Object.prototype.hasOwnProperty;\n\n  function _updateFromBindings(model) {\n  \tmodel.updateFromBindings(true);\n  }\n\n  function _updateKeypathDependants(model) {\n  \tmodel.updateKeypathDependants();\n  }\n\n  var originatingModel = null;\n\n  var Model = function () {\n  \tfunction Model(parent, key) {\n  \t\tbabelHelpers.classCallCheck(this, Model);\n\n  \t\tthis.deps = [];\n\n  \t\tthis.children = [];\n  \t\tthis.childByKey = {};\n\n  \t\tthis.indexModels = [];\n\n  \t\tthis.unresolved = [];\n  \t\tthis.unresolvedByKey = {};\n\n  \t\tthis.bindings = [];\n\n  \t\tthis.value = undefined;\n\n  \t\tthis.ticker = null;\n\n  \t\tif (parent) {\n  \t\t\tthis.parent = parent;\n  \t\t\tthis.root = parent.root;\n  \t\t\tthis.key = unescapeKey(key);\n  \t\t\tthis.isReadonly = parent.isReadonly;\n\n  \t\t\tif (parent.value) {\n  \t\t\t\tthis.value = parent.value[this.key];\n  \t\t\t\tthis.adapt();\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tModel.prototype.adapt = function adapt() {\n  \t\tvar adaptors = this.root.adaptors;\n  \t\tvar len = adaptors.length;\n\n  \t\t// Exit early if no adaptors\n  \t\tif (len === 0) return;\n\n  \t\tvar value = this.value;\n\n  \t\t// TODO remove this legacy nonsense\n  \t\tvar ractive = this.root.ractive;\n  \t\tvar keypath = this.getKeypath();\n\n  \t\t// tear previous adaptor down if present\n  \t\tif (this.wrapper) {\n  \t\t\tthis.wrapper.teardown();\n  \t\t\tthis.wrapper = null;\n  \t\t}\n\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar adaptor = adaptors[i];\n  \t\t\tif (adaptor.filter(value, keypath, ractive)) {\n  \t\t\t\tthis.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n  \t\t\t\tthis.wrapper.value = this.value;\n  \t\t\t\tthis.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n  \t\t\t\tthis.value = this.wrapper.get();\n\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tModel.prototype.addUnresolved = function addUnresolved(key, resolver) {\n  \t\tif (!this.unresolvedByKey[key]) {\n  \t\t\tthis.unresolved.push(key);\n  \t\t\tthis.unresolvedByKey[key] = [];\n  \t\t}\n\n  \t\tthis.unresolvedByKey[key].push(resolver);\n  \t};\n\n  \tModel.prototype.animate = function animate(from, to, options, interpolator) {\n  \t\tvar _this = this;\n\n  \t\tif (this.ticker) this.ticker.stop();\n\n  \t\tvar fulfilPromise = void 0;\n  \t\tvar promise = new Promise$1(function (fulfil) {\n  \t\t\treturn fulfilPromise = fulfil;\n  \t\t});\n\n  \t\tthis.ticker = new Ticker({\n  \t\t\tduration: options.duration,\n  \t\t\teasing: options.easing,\n  \t\t\tstep: function step(t) {\n  \t\t\t\tvar value = interpolator(t);\n  \t\t\t\t_this.applyValue(value);\n  \t\t\t\tif (options.step) options.step(t, value);\n  \t\t\t},\n  \t\t\tcomplete: function complete() {\n  \t\t\t\t_this.applyValue(to);\n  \t\t\t\tif (options.complete) options.complete(to);\n\n  \t\t\t\t_this.ticker = null;\n  \t\t\t\tfulfilPromise();\n  \t\t\t}\n  \t\t});\n\n  \t\tpromise.stop = this.ticker.stop;\n  \t\treturn promise;\n  \t};\n\n  \tModel.prototype.applyValue = function applyValue(value) {\n  \t\tif (isEqual(value, this.value)) return;\n\n  \t\t// TODO deprecate this nonsense\n  \t\tthis.root.changes[this.getKeypath()] = value;\n\n  \t\tif (this.parent.wrapper && this.parent.wrapper.set) {\n  \t\t\tthis.parent.wrapper.set(this.key, value);\n  \t\t\tthis.parent.value = this.parent.wrapper.get();\n\n  \t\t\tthis.value = this.parent.value[this.key];\n  \t\t\t// TODO should this value be adapted? probably\n  \t\t} else if (this.wrapper) {\n  \t\t\t\tvar shouldTeardown = !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n  \t\t\t\tif (shouldTeardown) {\n  \t\t\t\t\tthis.wrapper.teardown();\n  \t\t\t\t\tthis.wrapper = null;\n  \t\t\t\t\tvar parentValue = this.parent.value || this.parent.createBranch(this.key);\n  \t\t\t\t\tparentValue[this.key] = this.value = value;\n  \t\t\t\t\tthis.adapt();\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.value = this.wrapper.get();\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tvar _parentValue = this.parent.value || this.parent.createBranch(this.key);\n  \t\t\t\t_parentValue[this.key] = value;\n\n  \t\t\t\tthis.value = value;\n  \t\t\t\tthis.adapt();\n  \t\t\t}\n\n  \t\tthis.parent.clearUnresolveds();\n  \t\tthis.clearUnresolveds();\n\n  \t\t// notify dependants\n  \t\tvar previousOriginatingModel = originatingModel; // for the array.length special case\n  \t\toriginatingModel = this;\n\n  \t\tthis.children.forEach(mark);\n  \t\tthis.deps.forEach(_handleChange);\n\n  \t\tvar parent = this.parent;\n  \t\twhile (parent) {\n  \t\t\tparent.deps.forEach(_handleChange);\n  \t\t\tparent = parent.parent;\n  \t\t}\n\n  \t\toriginatingModel = previousOriginatingModel;\n  \t};\n\n  \tModel.prototype.clearUnresolveds = function clearUnresolveds(specificKey) {\n  \t\tvar i = this.unresolved.length;\n\n  \t\twhile (i--) {\n  \t\t\tvar key = this.unresolved[i];\n\n  \t\t\tif (specificKey && key !== specificKey) continue;\n\n  \t\t\tvar resolvers = this.unresolvedByKey[key];\n  \t\t\tvar hasKey = this.has(key);\n\n  \t\t\tvar j = resolvers.length;\n  \t\t\twhile (j--) {\n  \t\t\t\tif (hasKey) resolvers[j].attemptResolution();\n  \t\t\t\tif (resolvers[j].resolved) resolvers.splice(j, 1);\n  \t\t\t}\n\n  \t\t\tif (!resolvers.length) {\n  \t\t\t\tthis.unresolved.splice(i, 1);\n  \t\t\t\tthis.unresolvedByKey[key] = null;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tModel.prototype.createBranch = function createBranch(key) {\n  \t\tvar branch = isNumeric(key) ? [] : {};\n  \t\tthis.set(branch);\n\n  \t\treturn branch;\n  \t};\n\n  \tModel.prototype.findMatches = function findMatches(keys) {\n  \t\tvar len = keys.length;\n\n  \t\tvar existingMatches = [this];\n  \t\tvar matches = void 0;\n  \t\tvar i = void 0;\n\n  \t\tvar _loop = function _loop() {\n  \t\t\tvar key = keys[i];\n\n  \t\t\tif (key === '*') {\n  \t\t\t\tmatches = [];\n  \t\t\t\texistingMatches.forEach(function (model) {\n  \t\t\t\t\tmatches.push.apply(matches, model.getValueChildren(model.get()));\n  \t\t\t\t});\n  \t\t\t} else {\n  \t\t\t\tmatches = existingMatches.map(function (model) {\n  \t\t\t\t\treturn model.joinKey(key);\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\t\texistingMatches = matches;\n  \t\t};\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t_loop();\n  \t\t}\n\n  \t\treturn matches;\n  \t};\n\n  \tModel.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n  \t\treturn this.value;\n  \t};\n\n  \tModel.prototype.getIndexModel = function getIndexModel(fragmentIndex) {\n  \t\tvar indexModels = this.parent.indexModels;\n\n  \t\t// non-numeric keys are a special of a numeric index in a object iteration\n  \t\tif (typeof this.key === 'string' && fragmentIndex !== undefined) {\n  \t\t\treturn new KeyModel(fragmentIndex);\n  \t\t} else if (!indexModels[this.key]) {\n  \t\t\tindexModels[this.key] = new KeyModel(this.key);\n  \t\t}\n\n  \t\treturn indexModels[this.key];\n  \t};\n\n  \tModel.prototype.getKeyModel = function getKeyModel() {\n  \t\t// TODO... different to IndexModel because key can never change\n  \t\treturn new KeyModel(escapeKey(this.key));\n  \t};\n\n  \tModel.prototype.getKeypathModel = function getKeypathModel(ractive) {\n  \t\tvar keypath = this.getKeypath(),\n  \t\t    model = this.keypathModel || (this.keypathModel = new KeypathModel(this));\n\n  \t\tif (ractive && ractive.component) {\n  \t\t\tvar mapped = this.getKeypath(ractive);\n  \t\t\tif (mapped !== keypath) {\n  \t\t\t\tvar map = ractive.viewmodel.keypathModels || (ractive.viewmodel.keypathModels = {});\n  \t\t\t\tvar child = map[keypath] || (map[keypath] = new KeypathModel(this, ractive));\n  \t\t\t\tmodel.addChild(child);\n  \t\t\t\treturn child;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn model;\n  \t};\n\n  \tModel.prototype.getKeypath = function getKeypath(ractive) {\n  \t\tvar root = this.parent.isRoot ? escapeKey(this.key) : this.parent.getKeypath() + '.' + escapeKey(this.key);\n\n  \t\tif (ractive && ractive.component) {\n  \t\t\tvar map = ractive.viewmodel.mappings;\n  \t\t\tfor (var k in map) {\n  \t\t\t\tif (root.indexOf(map[k].getKeypath()) >= 0) {\n  \t\t\t\t\troot = root.replace(map[k].getKeypath(), k);\n  \t\t\t\t\tbreak;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn root;\n  \t};\n\n  \tModel.prototype.getValueChildren = function getValueChildren(value) {\n  \t\tvar _this2 = this;\n\n  \t\tvar children = void 0;\n  \t\tif (isArray(value)) {\n  \t\t\tchildren = [];\n  \t\t\t// special case - array.length. This is a horrible kludge, but\n  \t\t\t// it'll do for now. Alternatives welcome\n  \t\t\tif (originatingModel && originatingModel.parent === this && originatingModel.key === 'length') {\n  \t\t\t\tchildren.push(originatingModel);\n  \t\t\t}\n  \t\t\tvalue.forEach(function (m, i) {\n  \t\t\t\tchildren.push(_this2.joinKey(i));\n  \t\t\t});\n  \t\t} else if (isObject(value) || typeof value === 'function') {\n  \t\t\tchildren = Object.keys(value).map(function (key) {\n  \t\t\t\treturn _this2.joinKey(key);\n  \t\t\t});\n  \t\t} else if (value != null) {\n  \t\t\t// TODO: this will return incorrect keypath if model is mapped\n  \t\t\tthrow new Error('Cannot get values of ' + this.getKeypath() + '.* as ' + this.getKeypath() + ' is not an array, object or function');\n  \t\t}\n\n  \t\treturn children;\n  \t};\n\n  \tModel.prototype.has = function has(key) {\n  \t\tvar value = this.get();\n  \t\tif (!value) return false;\n\n  \t\tkey = unescapeKey(key);\n  \t\tif (hasProp.call(value, key)) return true;\n\n  \t\t// We climb up the constructor chain to find if one of them contains the key\n  \t\tvar constructor = value.constructor;\n  \t\twhile (constructor !== Function && constructor !== Array && constructor !== Object) {\n  \t\t\tif (hasProp.call(constructor.prototype, key)) return true;\n  \t\t\tconstructor = constructor.constructor;\n  \t\t}\n\n  \t\treturn false;\n  \t};\n\n  \tModel.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new Model(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tModel.prototype.joinAll = function joinAll(keys) {\n  \t\tvar model = this;\n  \t\tfor (var i = 0; i < keys.length; i += 1) {\n  \t\t\tmodel = model.joinKey(keys[i]);\n  \t\t}\n\n  \t\treturn model;\n  \t};\n\n  \tModel.prototype.mark = function mark$$() {\n  \t\tvar value = this.retrieve();\n\n  \t\tif (!isEqual(value, this.value)) {\n  \t\t\tvar old = this.value;\n  \t\t\tthis.value = value;\n\n  \t\t\t// make sure the wrapper stays in sync\n  \t\t\tif (old !== value) this.adapt();\n\n  \t\t\tthis.children.forEach(mark);\n\n  \t\t\tthis.deps.forEach(_handleChange);\n  \t\t\tthis.clearUnresolveds();\n  \t\t}\n  \t};\n\n  \tModel.prototype.merge = function merge(array, comparator) {\n  \t\tvar oldArray = comparator ? this.value.map(comparator) : this.value;\n  \t\tvar newArray = comparator ? array.map(comparator) : array;\n\n  \t\tvar oldLength = oldArray.length;\n\n  \t\tvar usedIndices = {};\n  \t\tvar firstUnusedIndex = 0;\n\n  \t\tvar newIndices = oldArray.map(function (item) {\n  \t\t\tvar index = void 0;\n  \t\t\tvar start = firstUnusedIndex;\n\n  \t\t\tdo {\n  \t\t\t\tindex = newArray.indexOf(item, start);\n\n  \t\t\t\tif (index === -1) {\n  \t\t\t\t\treturn -1;\n  \t\t\t\t}\n\n  \t\t\t\tstart = index + 1;\n  \t\t\t} while (usedIndices[index] === true && start < oldLength);\n\n  \t\t\t// keep track of the first unused index, so we don't search\n  \t\t\t// the whole of newArray for each item in oldArray unnecessarily\n  \t\t\tif (index === firstUnusedIndex) {\n  \t\t\t\tfirstUnusedIndex += 1;\n  \t\t\t}\n  \t\t\t// allow next instance of next \"equal\" to be found item\n  \t\t\tusedIndices[index] = true;\n  \t\t\treturn index;\n  \t\t});\n\n  \t\tthis.parent.value[this.key] = array;\n  \t\tthis._merged = true;\n  \t\tthis.shuffle(newIndices);\n  \t};\n\n  \tModel.prototype.register = function register(dep) {\n  \t\tthis.deps.push(dep);\n  \t};\n\n  \tModel.prototype.registerTwowayBinding = function registerTwowayBinding(binding) {\n  \t\tthis.bindings.push(binding);\n  \t};\n\n  \tModel.prototype.retrieve = function retrieve() {\n  \t\treturn this.parent.value ? this.parent.value[this.key] : undefined;\n  \t};\n\n  \tModel.prototype.set = function set(value) {\n  \t\tif (this.ticker) this.ticker.stop();\n  \t\tthis.applyValue(value);\n  \t};\n\n  \tModel.prototype.shuffle = function shuffle(newIndices) {\n  \t\tvar _this3 = this;\n\n  \t\tvar indexModels = [];\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\tif (! ~newIndex) return;\n\n  \t\t\tvar model = _this3.indexModels[oldIndex];\n\n  \t\t\tif (!model) return;\n\n  \t\t\tindexModels[newIndex] = model;\n\n  \t\t\tif (newIndex !== oldIndex) {\n  \t\t\t\tmodel.rebind(newIndex);\n  \t\t\t}\n  \t\t});\n\n  \t\tthis.indexModels = indexModels;\n\n  \t\t// shuffles need to happen before marks...\n  \t\tthis.deps.forEach(function (dep) {\n  \t\t\tif (dep.shuffle) dep.shuffle(newIndices);\n  \t\t});\n\n  \t\tthis.updateKeypathDependants();\n  \t\tthis.mark();\n\n  \t\t// ...but handleChange must happen after (TODO document why)\n  \t\tthis.deps.forEach(function (dep) {\n  \t\t\tif (!dep.shuffle) dep.handleChange();\n  \t\t});\n  \t};\n\n  \tModel.prototype.teardown = function teardown$$() {\n  \t\tthis.children.forEach(teardown);\n  \t\tif (this.wrapper) this.wrapper.teardown();\n  \t\tif (this.keypathModels) {\n  \t\t\tfor (var k in this.keypathModels) {\n  \t\t\t\tthis.keypathModels[k].teardown();\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tModel.prototype.unregister = function unregister(dependant) {\n  \t\tremoveFromArray(this.deps, dependant);\n  \t};\n\n  \tModel.prototype.unregisterTwowayBinding = function unregisterTwowayBinding(binding) {\n  \t\tremoveFromArray(this.bindings, binding);\n  \t};\n\n  \tModel.prototype.updateFromBindings = function updateFromBindings(cascade) {\n  \t\tvar i = this.bindings.length;\n  \t\twhile (i--) {\n  \t\t\tvar value = this.bindings[i].getValue();\n  \t\t\tif (value !== this.value) this.set(value);\n  \t\t}\n\n  \t\tif (cascade) {\n  \t\t\tthis.children.forEach(_updateFromBindings);\n  \t\t}\n  \t};\n\n  \tModel.prototype.updateKeypathDependants = function updateKeypathDependants() {\n  \t\tthis.children.forEach(_updateKeypathDependants);\n  \t\tif (this.keypathModel) this.keypathModel.handleChange();\n  \t};\n\n  \treturn Model;\n  }();\n\n  var GlobalModel = function (_Model) {\n  \tbabelHelpers.inherits(GlobalModel, _Model);\n\n  \tfunction GlobalModel() {\n  \t\tbabelHelpers.classCallCheck(this, GlobalModel);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, '@global'));\n\n  \t\t_this.value = typeof global !== 'undefined' ? global : window;\n  \t\t_this.isRoot = true;\n  \t\t_this.root = _this;\n  \t\t_this.adaptors = [];\n  \t\t_this.changes = {};\n  \t\treturn _this;\n  \t}\n\n  \tGlobalModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn '@global';\n  \t};\n\n  \treturn GlobalModel;\n  }(Model);\n\n  var GlobalModel$1 = new GlobalModel();\n\n  function resolveReference(fragment, ref) {\n  \tvar context = fragment.findContext();\n\n  \t// special references\n  \t// TODO does `this` become `.` at parse time?\n  \tif (ref === '.' || ref === 'this') return context;\n  \tif (ref === '@keypath') return context.getKeypathModel(fragment.ractive);\n  \tif (ref === '@rootpath') return context.getKeypathModel();\n  \tif (ref === '@index') {\n  \t\tvar repeater = fragment.findRepeatingFragment();\n  \t\t// make sure the found fragment is actually an iteration\n  \t\tif (!repeater.isIteration) return;\n  \t\treturn repeater.context.getIndexModel(repeater.index);\n  \t}\n  \tif (ref === '@key') return fragment.findRepeatingFragment().context.getKeyModel();\n  \tif (ref === '@ractive') {\n  \t\treturn fragment.ractive.viewmodel.getRactiveModel();\n  \t}\n  \tif (ref === '@global') {\n  \t\treturn GlobalModel$1;\n  \t}\n\n  \t// ancestor references\n  \tif (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypathI(ref.slice(2)));\n  \tif (ref[0] === '.') {\n  \t\tvar parts = ref.split('/');\n\n  \t\twhile (parts[0] === '.' || parts[0] === '..') {\n  \t\t\tvar part = parts.shift();\n\n  \t\t\tif (part === '..') {\n  \t\t\t\tcontext = context.parent;\n  \t\t\t}\n  \t\t}\n\n  \t\tref = parts.join('/');\n\n  \t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n  \t\tif (ref[0] === '.') ref = ref.slice(1);\n  \t\treturn context.joinAll(splitKeypathI(ref));\n  \t}\n\n  \treturn resolveAmbiguousReference(fragment, ref);\n  }\n\n  function Ractive$get(keypath) {\n  \tif (!keypath) return this.viewmodel.get(true);\n\n  \tvar keys = splitKeypathI(keypath);\n  \tvar key = keys[0];\n\n  \tvar model = void 0;\n\n  \tif (!this.viewmodel.has(key)) {\n  \t\t// if this is an inline component, we may need to create\n  \t\t// an implicit mapping\n  \t\tif (this.component && !this.isolated) {\n  \t\t\tmodel = resolveReference(this.component.parentFragment, key);\n\n  \t\t\tif (model) {\n  \t\t\t\tthis.viewmodel.map(key, model);\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tmodel = this.viewmodel.joinAll(keys);\n  \treturn model.get(true);\n  }\n\n  var insertHook = new Hook('insert');\n\n  function Ractive$insert(target, anchor) {\n  \tif (!this.fragment.rendered) {\n  \t\t// TODO create, and link to, documentation explaining this\n  \t\tthrow new Error('The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.');\n  \t}\n\n  \ttarget = getElement(target);\n  \tanchor = getElement(anchor) || null;\n\n  \tif (!target) {\n  \t\tthrow new Error('You must specify a valid target to insert into');\n  \t}\n\n  \ttarget.insertBefore(this.detach(), anchor);\n  \tthis.el = target;\n\n  \t(target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  \tthis.isDetached = false;\n\n  \tfireInsertHook(this);\n  }\n\n  function fireInsertHook(ractive) {\n  \tinsertHook.fire(ractive);\n\n  \tractive.findAllComponents('*').forEach(function (child) {\n  \t\tfireInsertHook(child.instance);\n  \t});\n  }\n\n  function link(there, here) {\n  \tif (here === there || (there + '.').indexOf(here + '.') === 0 || (here + '.').indexOf(there + '.') === 0) {\n  \t\tthrow new Error('A keypath cannot be linked to itself.');\n  \t}\n\n  \tvar unlink = void 0,\n  \t    run = void 0,\n  \t    model = void 0;\n\n  \tvar ln = this._links[here];\n\n  \tif (ln) {\n  \t\tif (ln.source.model.str !== there || ln.dest.model.str !== here) {\n  \t\t\tunlink = this.unlink(here);\n  \t\t} else {\n  \t\t\treturn Promise$1.resolve(true);\n  \t\t}\n  \t}\n\n  \trun = runloop.start();\n\n  \t// may need to allow a mapping to resolve implicitly\n  \tvar sourcePath = splitKeypathI(there);\n  \tif (!this.viewmodel.has(sourcePath[0]) && this.component) {\n  \t\tmodel = resolveReference(this.component.parentFragment, sourcePath[0]);\n\n  \t\tif (model) {\n  \t\t\tthis.viewmodel.map(sourcePath[0], model);\n  \t\t}\n  \t}\n\n  \tln = new Link(this.viewmodel.joinAll(sourcePath), this.viewmodel.joinAll(splitKeypathI(here)), this);\n  \tthis._links[here] = ln;\n  \tln.source.handleChange();\n\n  \trunloop.end();\n\n  \treturn Promise$1.all([unlink, run]);\n  }\n\n  var Link = function () {\n  \tfunction Link(source, dest, ractive) {\n  \t\tbabelHelpers.classCallCheck(this, Link);\n\n  \t\tthis.source = new LinkSide(source, this);\n  \t\tthis.dest = new LinkSide(dest, this);\n  \t\tthis.ractive = ractive;\n  \t\tthis.locked = false;\n  \t\tthis.initialValue = dest.get();\n  \t}\n\n  \tLink.prototype.sync = function sync(side) {\n  \t\tif (!this.locked) {\n  \t\t\tthis.locked = true;\n\n  \t\t\tif (side === this.dest) {\n  \t\t\t\tthis.source.model.set(this.dest.model.get());\n  \t\t\t} else {\n  \t\t\t\tthis.dest.model.set(this.source.model.get());\n  \t\t\t}\n\n  \t\t\tthis.locked = false;\n  \t\t}\n  \t};\n\n  \tLink.prototype.unlink = function unlink() {\n  \t\tthis.source.model.unregister(this.source);\n  \t\tthis.dest.model.unregister(this.dest);\n  \t};\n\n  \treturn Link;\n  }();\n\n  var LinkSide = function () {\n  \tfunction LinkSide(model, owner) {\n  \t\tbabelHelpers.classCallCheck(this, LinkSide);\n\n  \t\tthis.model = model;\n  \t\tthis.owner = owner;\n  \t\tmodel.register(this);\n  \t}\n\n  \tLinkSide.prototype.handleChange = function handleChange() {\n  \t\tthis.owner.sync(this);\n  \t};\n\n  \treturn LinkSide;\n  }();\n\n  var comparators = {};\n\n  function getComparator(option) {\n  \tif (!option) return null; // use existing arrays\n  \tif (option === true) return JSON.stringify;\n  \tif (typeof option === 'function') return option;\n\n  \tif (typeof option === 'string') {\n  \t\treturn comparators[option] || (comparators[option] = function (thing) {\n  \t\t\treturn thing[option];\n  \t\t});\n  \t}\n\n  \tthrow new Error('If supplied, options.compare must be a string, function, or `true`'); // TODO link to docs\n  }\n\n  function Ractive$merge(keypath, array, options) {\n  \tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \tvar promise = runloop.start(this, true);\n  \tvar value = model.get();\n\n  \tif (array === value) {\n  \t\tthrow new Error('You cannot merge an array with itself'); // TODO link to docs\n  \t} else if (!isArray(value) || !isArray(array)) {\n  \t\t\tthrow new Error('You cannot merge an array with a non-array');\n  \t\t}\n\n  \tvar comparator = getComparator(options && options.compare);\n  \tmodel.merge(array, comparator);\n\n  \trunloop.end();\n  \treturn promise;\n  }\n\n  function observe(keypath, callback, options) {\n  \tvar _this = this;\n\n  \tvar observers = [];\n  \tvar map = void 0;\n\n  \tif (isObject(keypath)) {\n  \t\tmap = keypath;\n  \t\toptions = callback || {};\n\n  \t\tObject.keys(map).forEach(function (keypath) {\n  \t\t\tvar callback = map[keypath];\n\n  \t\t\tkeypath.split(' ').forEach(function (keypath) {\n  \t\t\t\tobservers.push(createObserver(_this, keypath, callback, options));\n  \t\t\t});\n  \t\t});\n  \t} else {\n  \t\tvar keypaths = void 0;\n\n  \t\tif (typeof keypath === 'function') {\n  \t\t\toptions = callback;\n  \t\t\tcallback = keypath;\n  \t\t\tkeypaths = [''];\n  \t\t} else {\n  \t\t\tkeypaths = keypath.split(' ');\n  \t\t}\n\n  \t\tkeypaths.forEach(function (keypath) {\n  \t\t\tobservers.push(createObserver(_this, keypath, callback, options || {}));\n  \t\t});\n  \t}\n\n  \t// add observers to the Ractive instance, so they can be\n  \t// cancelled on ractive.teardown()\n  \tthis._observers.push.apply(this._observers, observers);\n\n  \treturn {\n  \t\tcancel: function cancel() {\n  \t\t\tobservers.forEach(function (observer) {\n  \t\t\t\tremoveFromArray(_this._observers, observer);\n  \t\t\t\tobserver.cancel();\n  \t\t\t});\n  \t\t}\n  \t};\n  }\n\n  function createObserver(ractive, keypath, callback, options) {\n  \tvar viewmodel = ractive.viewmodel;\n\n  \tvar keys = splitKeypathI(keypath);\n  \tvar wildcardIndex = keys.indexOf('*');\n\n  \t// normal keypath - no wildcards\n  \tif (! ~wildcardIndex) {\n  \t\tvar key = keys[0];\n\n  \t\t// if not the root model itself, check if viewmodel has key.\n  \t\tif (key !== '' && !viewmodel.has(key)) {\n  \t\t\t// if this is an inline component, we may need to create an implicit mapping\n  \t\t\tif (ractive.component) {\n  \t\t\t\tvar _model = resolveReference(ractive.component.parentFragment, key);\n  \t\t\t\tif (_model) viewmodel.map(key, _model);\n  \t\t\t}\n  \t\t}\n\n  \t\tvar model = viewmodel.joinAll(keys);\n  \t\treturn new Observer(ractive, model, callback, options);\n  \t}\n\n  \t// pattern observers - more complex case\n  \tvar baseModel = wildcardIndex === 0 ? viewmodel : viewmodel.joinAll(keys.slice(0, wildcardIndex));\n\n  \treturn new PatternObserver(ractive, baseModel, keys.splice(wildcardIndex), callback, options);\n  }\n\n  var Observer = function () {\n  \tfunction Observer(ractive, model, callback, options) {\n  \t\tbabelHelpers.classCallCheck(this, Observer);\n\n  \t\tthis.context = options.context || ractive;\n  \t\tthis.model = model;\n  \t\tthis.keypath = model.getKeypath(ractive);\n  \t\tthis.callback = callback;\n\n  \t\tthis.oldValue = undefined;\n  \t\tthis.newValue = model.get();\n\n  \t\tthis.defer = options.defer;\n  \t\tthis.once = options.once;\n  \t\tthis.strict = options.strict;\n\n  \t\tthis.dirty = false;\n\n  \t\tif (options.init !== false) {\n  \t\t\tthis.dispatch();\n  \t\t} else {\n  \t\t\tthis.oldValue = this.newValue;\n  \t\t}\n\n  \t\tmodel.register(this);\n  \t}\n\n  \tObserver.prototype.cancel = function cancel() {\n  \t\tthis.model.unregister(this);\n  \t};\n\n  \tObserver.prototype.dispatch = function dispatch() {\n  \t\tthis.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n  \t\tthis.oldValue = this.newValue;\n  \t\tthis.dirty = false;\n  \t};\n\n  \tObserver.prototype.handleChange = function handleChange() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.newValue = this.model.get();\n\n  \t\t\tif (this.strict && this.newValue === this.oldValue) return;\n\n  \t\t\trunloop.addObserver(this, this.defer);\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.once) this.cancel();\n  \t\t}\n  \t};\n\n  \treturn Observer;\n  }();\n\n  var PatternObserver = function () {\n  \tfunction PatternObserver(ractive, baseModel, keys, callback, options) {\n  \t\tvar _this2 = this;\n\n  \t\tbabelHelpers.classCallCheck(this, PatternObserver);\n\n  \t\tthis.context = options.context || ractive;\n  \t\tthis.ractive = ractive;\n  \t\tthis.baseModel = baseModel;\n  \t\tthis.keys = keys;\n  \t\tthis.callback = callback;\n\n  \t\tvar pattern = keys.join('\\\\.').replace(/\\*/g, '(.+)');\n  \t\tvar baseKeypath = baseModel.getKeypath(ractive);\n  \t\tthis.pattern = new RegExp('^' + (baseKeypath ? baseKeypath + '\\\\.' : '') + pattern + '$');\n\n  \t\tthis.oldValues = {};\n  \t\tthis.newValues = {};\n\n  \t\tthis.defer = options.defer;\n  \t\tthis.once = options.once;\n  \t\tthis.strict = options.strict;\n\n  \t\tthis.dirty = false;\n\n  \t\tvar models = baseModel.findMatches(this.keys);\n\n  \t\tmodels.forEach(function (model) {\n  \t\t\t_this2.newValues[model.getKeypath(_this2.ractive)] = model.get();\n  \t\t});\n\n  \t\tif (options.init !== false) {\n  \t\t\tthis.dispatch();\n  \t\t} else {\n  \t\t\tthis.oldValues = this.newValues;\n  \t\t}\n\n  \t\tbaseModel.register(this);\n  \t}\n\n  \tPatternObserver.prototype.cancel = function cancel() {\n  \t\tthis.baseModel.unregister(this);\n  \t};\n\n  \tPatternObserver.prototype.dispatch = function dispatch() {\n  \t\tvar _this3 = this;\n\n  \t\tObject.keys(this.newValues).forEach(function (keypath) {\n  \t\t\tif (_this3.newKeys && !_this3.newKeys[keypath]) return;\n\n  \t\t\tvar newValue = _this3.newValues[keypath];\n  \t\t\tvar oldValue = _this3.oldValues[keypath];\n\n  \t\t\tif (_this3.strict && newValue === oldValue) return;\n  \t\t\tif (isEqual(newValue, oldValue)) return;\n\n  \t\t\tvar args = [newValue, oldValue, keypath];\n  \t\t\tif (keypath) {\n  \t\t\t\tvar wildcards = _this3.pattern.exec(keypath).slice(1);\n  \t\t\t\targs = args.concat(wildcards);\n  \t\t\t}\n\n  \t\t\t_this3.callback.apply(_this3.context, args);\n  \t\t});\n\n  \t\tthis.oldValues = this.newValues;\n  \t\tthis.newKeys = null;\n  \t\tthis.dirty = false;\n  \t};\n\n  \tPatternObserver.prototype.shuffle = function shuffle(newIndices) {\n  \t\tif (!isArray(this.baseModel.value)) return;\n\n  \t\tvar base = this.baseModel.getKeypath(this.ractive);\n  \t\tvar max = this.baseModel.value.length;\n  \t\tvar suffix = this.keys.length > 1 ? '.' + this.keys.slice(1).join('.') : '';\n\n  \t\tthis.newKeys = {};\n  \t\tfor (var i = 0; i < newIndices.length; i++) {\n  \t\t\tif (newIndices[i] === -1 || newIndices[i] === i) continue;\n  \t\t\tthis.newKeys[base + '.' + i + suffix] = true;\n  \t\t}\n\n  \t\tfor (var _i = newIndices.touchedFrom; _i < max; _i++) {\n  \t\t\tthis.newKeys[base + '.' + _i + suffix] = true;\n  \t\t}\n  \t};\n\n  \tPatternObserver.prototype.handleChange = function handleChange() {\n  \t\tvar _this4 = this;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.newValues = {};\n\n  \t\t\t// handle case where previously extant keypath no longer exists -\n  \t\t\t// observer should still fire, with undefined as new value\n  \t\t\t// TODO huh. according to the test suite that's not the case...\n  \t\t\t// Object.keys( this.oldValues ).forEach( keypath => {\n  \t\t\t// \tthis.newValues[ keypath ] = undefined;\n  \t\t\t// });\n\n  \t\t\tthis.baseModel.findMatches(this.keys).forEach(function (model) {\n  \t\t\t\tvar keypath = model.getKeypath(_this4.ractive);\n  \t\t\t\t_this4.newValues[keypath] = model.get();\n  \t\t\t});\n\n  \t\t\trunloop.addObserver(this, this.defer);\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.once) this.cancel();\n  \t\t}\n  \t};\n\n  \treturn PatternObserver;\n  }();\n\n  function observeList(keypath, callback, options) {\n  \tif (typeof keypath !== 'string') {\n  \t\tthrow new Error('ractive.observeList() must be passed a string as its first argument');\n  \t}\n\n  \tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \tvar observer = new ListObserver(this, model, callback, options || {});\n\n  \t// add observer to the Ractive instance, so it can be\n  \t// cancelled on ractive.teardown()\n  \tthis._observers.push(observer);\n\n  \treturn {\n  \t\tcancel: function cancel() {\n  \t\t\tobserver.cancel();\n  \t\t}\n  \t};\n  }\n\n  function negativeOne() {\n  \treturn -1;\n  }\n\n  var ListObserver = function () {\n  \tfunction ListObserver(context, model, callback, options) {\n  \t\tbabelHelpers.classCallCheck(this, ListObserver);\n\n  \t\tthis.context = context;\n  \t\tthis.model = model;\n  \t\tthis.keypath = model.getKeypath();\n  \t\tthis.callback = callback;\n\n  \t\tthis.pending = null;\n\n  \t\tmodel.register(this);\n\n  \t\tif (options.init !== false) {\n  \t\t\tthis.sliced = [];\n  \t\t\tthis.shuffle([]);\n  \t\t\tthis.handleChange();\n  \t\t} else {\n  \t\t\tthis.sliced = this.slice();\n  \t\t}\n  \t}\n\n  \tListObserver.prototype.handleChange = function handleChange() {\n  \t\tif (this.pending) {\n  \t\t\t// post-shuffle\n  \t\t\tthis.callback(this.pending);\n  \t\t\tthis.pending = null;\n  \t\t} else {\n  \t\t\t// entire array changed\n  \t\t\tthis.shuffle(this.sliced.map(negativeOne));\n  \t\t\tthis.handleChange();\n  \t\t}\n  \t};\n\n  \tListObserver.prototype.shuffle = function shuffle(newIndices) {\n  \t\tvar _this = this;\n\n  \t\tvar newValue = this.slice();\n\n  \t\tvar inserted = [];\n  \t\tvar deleted = [];\n  \t\tvar start = void 0;\n\n  \t\tvar hadIndex = {};\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\thadIndex[newIndex] = true;\n\n  \t\t\tif (newIndex !== oldIndex && start === undefined) {\n  \t\t\t\tstart = oldIndex;\n  \t\t\t}\n\n  \t\t\tif (newIndex === -1) {\n  \t\t\t\tdeleted.push(_this.sliced[oldIndex]);\n  \t\t\t}\n  \t\t});\n\n  \t\tif (start === undefined) start = newIndices.length;\n\n  \t\tvar len = newValue.length;\n  \t\tfor (var i = 0; i < len; i += 1) {\n  \t\t\tif (!hadIndex[i]) inserted.push(newValue[i]);\n  \t\t}\n\n  \t\tthis.pending = { inserted: inserted, deleted: deleted, start: start };\n  \t\tthis.sliced = newValue;\n  \t};\n\n  \tListObserver.prototype.slice = function slice() {\n  \t\tvar value = this.model.get();\n  \t\treturn isArray(value) ? value.slice() : [];\n  \t};\n\n  \treturn ListObserver;\n  }();\n\n  var onceOptions = { init: false, once: true };\n\n  function observeOnce(keypath, callback, options) {\n  \tif (isObject(keypath) || typeof keypath === 'function') {\n  \t\toptions = extendObj(callback || {}, onceOptions);\n  \t\treturn this.observe(keypath, options);\n  \t}\n\n  \toptions = extendObj(options || {}, onceOptions);\n  \treturn this.observe(keypath, callback, options);\n  }\n\n  var trim = (function (str) {\n    return str.trim();\n  })\n\n  var notEmptyString = (function (str) {\n    return str !== '';\n  })\n\n  function Ractive$off(eventName, callback) {\n  \tvar _this = this;\n\n  \t// if no arguments specified, remove all callbacks\n  \tif (!eventName) {\n  \t\t// TODO use this code instead, once the following issue has been resolved\n  \t\t// in PhantomJS (tests are unpassable otherwise!)\n  \t\t// https://github.com/ariya/phantomjs/issues/11856\n  \t\t// defineProperty( this, '_subs', { value: create( null ), configurable: true });\n  \t\tfor (eventName in this._subs) {\n  \t\t\tdelete this._subs[eventName];\n  \t\t}\n  \t} else {\n  \t\t// Handle multiple space-separated event names\n  \t\tvar eventNames = eventName.split(' ').map(trim).filter(notEmptyString);\n\n  \t\teventNames.forEach(function (eventName) {\n  \t\t\tvar subscribers = _this._subs[eventName];\n\n  \t\t\t// If we have subscribers for this event...\n  \t\t\tif (subscribers) {\n  \t\t\t\t// ...if a callback was specified, only remove that\n  \t\t\t\tif (callback) {\n  \t\t\t\t\tvar index = subscribers.indexOf(callback);\n  \t\t\t\t\tif (index !== -1) {\n  \t\t\t\t\t\tsubscribers.splice(index, 1);\n  \t\t\t\t\t}\n  \t\t\t\t}\n\n  \t\t\t\t// ...otherwise remove all callbacks\n  \t\t\t\telse {\n  \t\t\t\t\t\t_this._subs[eventName] = [];\n  \t\t\t\t\t}\n  \t\t\t}\n  \t\t});\n  \t}\n\n  \treturn this;\n  }\n\n  function Ractive$on(eventName, callback) {\n  \tvar _this = this;\n\n  \t// allow multiple listeners to be bound in one go\n  \tif ((typeof eventName === 'undefined' ? 'undefined' : babelHelpers.typeof(eventName)) === 'object') {\n  \t\tvar _ret = function () {\n  \t\t\tvar listeners = [];\n  \t\t\tvar n = void 0;\n\n  \t\t\tfor (n in eventName) {\n  \t\t\t\tif (eventName.hasOwnProperty(n)) {\n  \t\t\t\t\tlisteners.push(_this.on(n, eventName[n]));\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\treturn {\n  \t\t\t\tv: {\n  \t\t\t\t\tcancel: function cancel() {\n  \t\t\t\t\t\tvar listener = void 0;\n  \t\t\t\t\t\twhile (listener = listeners.pop()) {\n  \t\t\t\t\t\t\tlistener.cancel();\n  \t\t\t\t\t\t}\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t};\n  \t\t}();\n\n  \t\tif ((typeof _ret === 'undefined' ? 'undefined' : babelHelpers.typeof(_ret)) === \"object\") return _ret.v;\n  \t}\n\n  \t// Handle multiple space-separated event names\n  \tvar eventNames = eventName.split(' ').map(trim).filter(notEmptyString);\n\n  \teventNames.forEach(function (eventName) {\n  \t\t(_this._subs[eventName] || (_this._subs[eventName] = [])).push(callback);\n  \t});\n\n  \treturn {\n  \t\tcancel: function cancel() {\n  \t\t\treturn _this.off(eventName, callback);\n  \t\t}\n  \t};\n  }\n\n  function Ractive$once(eventName, handler) {\n  \tvar listener = this.on(eventName, function () {\n  \t\thandler.apply(this, arguments);\n  \t\tlistener.cancel();\n  \t});\n\n  \t// so we can still do listener.cancel() manually\n  \treturn listener;\n  }\n\n  // This function takes an array, the name of a mutator method, and the\n  // arguments to call that mutator method with, and returns an array that\n  // maps the old indices to their new indices.\n\n  // So if you had something like this...\n  //\n  //     array = [ 'a', 'b', 'c', 'd' ];\n  //     array.push( 'e' );\n  //\n  // ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n  // have changed. If you then did this...\n  //\n  //     array.unshift( 'z' );\n  //\n  // ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n  // one higher to make room for the 'z'. If you removed an item, the new index\n  // would be -1...\n  //\n  //     array.splice( 2, 2 );\n  //\n  // ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n  //\n  // This information is used to enable fast, non-destructive shuffling of list\n  // sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\n  function getNewIndices(length, methodName, args) {\n  \tvar spliceArguments,\n  \t    newIndices = [],\n  \t    removeStart,\n  \t    removeEnd,\n  \t    balance,\n  \t    i;\n\n  \tspliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  \tif (!spliceArguments) {\n  \t\treturn null; // TODO support reverse and sort?\n  \t}\n\n  \tbalance = spliceArguments.length - 2 - spliceArguments[1];\n\n  \tremoveStart = Math.min(length, spliceArguments[0]);\n  \tremoveEnd = removeStart + spliceArguments[1];\n\n  \tfor (i = 0; i < removeStart; i += 1) {\n  \t\tnewIndices.push(i);\n  \t}\n\n  \tfor (; i < removeEnd; i += 1) {\n  \t\tnewIndices.push(-1);\n  \t}\n\n  \tfor (; i < length; i += 1) {\n  \t\tnewIndices.push(i + balance);\n  \t}\n\n  \t// there is a net shift for the rest of the array starting with index + balance\n  \tif (balance !== 0) {\n  \t\tnewIndices.touchedFrom = spliceArguments[0];\n  \t} else {\n  \t\tnewIndices.touchedFrom = length;\n  \t}\n\n  \treturn newIndices;\n  }\n\n  // The pop, push, shift an unshift methods can all be represented\n  // as an equivalent splice\n  function getSpliceEquivalent(length, methodName, args) {\n  \tswitch (methodName) {\n  \t\tcase 'splice':\n  \t\t\tif (args[0] !== undefined && args[0] < 0) {\n  \t\t\t\targs[0] = length + Math.max(args[0], -length);\n  \t\t\t}\n\n  \t\t\twhile (args.length < 2) {\n  \t\t\t\targs.push(length - args[0]);\n  \t\t\t}\n\n  \t\t\t// ensure we only remove elements that exist\n  \t\t\targs[1] = Math.min(args[1], length - args[0]);\n\n  \t\t\treturn args;\n\n  \t\tcase 'sort':\n  \t\tcase 'reverse':\n  \t\t\treturn null;\n\n  \t\tcase 'pop':\n  \t\t\tif (length) {\n  \t\t\t\treturn [length - 1, 1];\n  \t\t\t}\n  \t\t\treturn [0, 0];\n\n  \t\tcase 'push':\n  \t\t\treturn [length, 0].concat(args);\n\n  \t\tcase 'shift':\n  \t\t\treturn [0, length ? 1 : 0];\n\n  \t\tcase 'unshift':\n  \t\t\treturn [0, 0].concat(args);\n  \t}\n  }\n\n  var arrayProto = Array.prototype;\n\n  function makeArrayMethod (methodName) {\n  \treturn function (keypath) {\n  \t\tvar _this = this;\n\n  \t\tvar model = this.viewmodel.joinAll(splitKeypathI(keypath));\n  \t\tvar array = model.get();\n\n  \t\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n  \t\t\targs[_key - 1] = arguments[_key];\n  \t\t}\n\n  \t\tif (!isArray(array)) {\n  \t\t\tif (array === undefined) {\n  \t\t\t\tvar _ret = function () {\n  \t\t\t\t\tarray = [];\n  \t\t\t\t\tvar result = arrayProto[methodName].apply(array, args);\n  \t\t\t\t\treturn {\n  \t\t\t\t\t\tv: _this.set(keypath, array).then(function () {\n  \t\t\t\t\t\t\treturn result;\n  \t\t\t\t\t\t})\n  \t\t\t\t\t};\n  \t\t\t\t}();\n\n  \t\t\t\tif ((typeof _ret === 'undefined' ? 'undefined' : babelHelpers.typeof(_ret)) === \"object\") return _ret.v;\n  \t\t\t} else {\n  \t\t\t\tthrow new Error('shuffle array method ' + methodName + ' called on non-array at ' + model.getKeypath());\n  \t\t\t}\n  \t\t}\n\n  \t\tvar newIndices = getNewIndices(array.length, methodName, args);\n  \t\tvar result = arrayProto[methodName].apply(array, args);\n\n  \t\tvar promise = runloop.start(this, true).then(function () {\n  \t\t\treturn result;\n  \t\t});\n\n  \t\tif (newIndices) {\n  \t\t\tmodel.shuffle(newIndices);\n  \t\t} else {\n  \t\t\tmodel.set(result);\n  \t\t}\n\n  \t\trunloop.end();\n\n  \t\treturn promise;\n  \t};\n  }\n\n  var pop = makeArrayMethod('pop');\n\n  var push = makeArrayMethod('push');\n\n  var PREFIX = '/* Ractive.js component styles */';\n\n  // Holds current definitions of styles.\n  var styleDefinitions = [];\n\n  // Flag to tell if we need to update the CSS\n  var isDirty = false;\n\n  // These only make sense on the browser. See additional setup below.\n  var styleElement = null;\n  var useCssText = null;\n\n  function addCSS(styleDefinition) {\n  \tstyleDefinitions.push(styleDefinition);\n  \tisDirty = true;\n  }\n\n  function applyCSS() {\n\n  \t// Apply only seems to make sense when we're in the DOM. Server-side renders\n  \t// can call toCSS to get the updated CSS.\n  \tif (!doc || !isDirty) return;\n\n  \tif (useCssText) {\n  \t\tstyleElement.styleSheet.cssText = getCSS(null);\n  \t} else {\n  \t\tstyleElement.innerHTML = getCSS(null);\n  \t}\n\n  \tisDirty = false;\n  }\n\n  function getCSS(cssIds) {\n\n  \tvar filteredStyleDefinitions = cssIds ? styleDefinitions.filter(function (style) {\n  \t\treturn ~cssIds.indexOf(style.id);\n  \t}) : styleDefinitions;\n\n  \treturn filteredStyleDefinitions.reduce(function (styles, style) {\n  \t\treturn styles + '\\n\\n/* {' + style.id + '} */\\n' + style.styles;\n  \t}, PREFIX);\n  }\n\n  // If we're on the browser, additional setup needed.\n  if (doc && (!styleElement || !styleElement.parentNode)) {\n\n  \tstyleElement = doc.createElement('style');\n  \tstyleElement.type = 'text/css';\n\n  \tdoc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n  \tuseCssText = !!styleElement.styleSheet;\n  }\n\n  var renderHook = new Hook('render');\n  var completeHook = new Hook('complete');\n\n  function render(ractive, target, anchor, occupants) {\n  \t// if `noIntro` is `true`, temporarily disable transitions\n  \tvar transitionsEnabled = ractive.transitionsEnabled;\n  \tif (ractive.noIntro) ractive.transitionsEnabled = false;\n\n  \tvar promise = runloop.start(ractive, true);\n  \trunloop.scheduleTask(function () {\n  \t\treturn renderHook.fire(ractive);\n  \t}, true);\n\n  \tif (ractive.fragment.rendered) {\n  \t\tthrow new Error('You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first');\n  \t}\n\n  \tanchor = getElement(anchor) || ractive.anchor;\n\n  \tractive.el = target;\n  \tractive.anchor = anchor;\n\n  \t// ensure encapsulated CSS is up-to-date\n  \tif (ractive.cssId) applyCSS();\n\n  \tif (target) {\n  \t\t(target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n  \t\tif (anchor) {\n  \t\t\tvar docFrag = doc.createDocumentFragment();\n  \t\t\tractive.fragment.render(docFrag);\n  \t\t\ttarget.insertBefore(docFrag, anchor);\n  \t\t} else {\n  \t\t\tractive.fragment.render(target, occupants);\n  \t\t}\n  \t}\n\n  \trunloop.end();\n  \tractive.transitionsEnabled = transitionsEnabled;\n\n  \treturn promise.then(function () {\n  \t\treturn completeHook.fire(ractive);\n  \t});\n  }\n\n  function Ractive$render(target, anchor) {\n  \ttarget = getElement(target) || this.el;\n\n  \tif (!this.append && target) {\n  \t\t// Teardown any existing instances *before* trying to set up the new one -\n  \t\t// avoids certain weird bugs\n  \t\tvar others = target.__ractive_instances__;\n  \t\tif (others) others.forEach(teardown);\n\n  \t\t// make sure we are the only occupants\n  \t\tif (!this.enhance) {\n  \t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n  \t\t}\n  \t}\n\n  \tvar occupants = this.enhance ? toArray(target.childNodes) : null;\n  \tvar promise = render(this, target, anchor, occupants);\n\n  \tif (occupants) {\n  \t\twhile (occupants.length) {\n  \t\t\ttarget.removeChild(occupants.pop());\n  \t\t}\n  \t}\n\n  \treturn promise;\n  }\n\n  var adaptConfigurator = {\n  \textend: function extend(Parent, proto, options) {\n  \t\tproto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  \t},\n\n  \tinit: function init() {}\n  };\n\n  function combine(a, b) {\n  \tvar c = a.slice();\n  \tvar i = b.length;\n\n  \twhile (i--) {\n  \t\tif (! ~c.indexOf(b[i])) {\n  \t\t\tc.push(b[i]);\n  \t\t}\n  \t}\n\n  \treturn c;\n  }\n\n  var selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g;\n  var commentsPattern = /\\/\\*.*?\\*\\//g;\n  var selectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\n  var excludePattern = /^(?:@|\\d+%)/;\n  var dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\n  function trim$1(str) {\n  \treturn str.trim();\n  }\n\n  function extractString(unit) {\n  \treturn unit.str;\n  }\n\n  function transformSelector(selector, parent) {\n  \tvar selectorUnits = [];\n  \tvar match = void 0;\n\n  \twhile (match = selectorUnitPattern.exec(selector)) {\n  \t\tselectorUnits.push({\n  \t\t\tstr: match[0],\n  \t\t\tbase: match[1],\n  \t\t\tmodifiers: match[2]\n  \t\t});\n  \t}\n\n  \t// For each simple selector within the selector, we need to create a version\n  \t// that a) combines with the id, and b) is inside the id\n  \tvar base = selectorUnits.map(extractString);\n\n  \tvar transformed = [];\n  \tvar i = selectorUnits.length;\n\n  \twhile (i--) {\n  \t\tvar appended = base.slice();\n\n  \t\t// Pseudo-selectors should go after the attribute selector\n  \t\tvar unit = selectorUnits[i];\n  \t\tappended[i] = unit.base + parent + unit.modifiers || '';\n\n  \t\tvar prepended = base.slice();\n  \t\tprepended[i] = parent + ' ' + prepended[i];\n\n  \t\ttransformed.push(appended.join(' '), prepended.join(' '));\n  \t}\n\n  \treturn transformed.join(', ');\n  }\n\n  function transformCss(css, id) {\n  \tvar dataAttr = '[data-ractive-css~=\"{' + id + '}\"]';\n\n  \tvar transformed = void 0;\n\n  \tif (dataRvcGuidPattern.test(css)) {\n  \t\ttransformed = css.replace(dataRvcGuidPattern, dataAttr);\n  \t} else {\n  \t\ttransformed = css.replace(commentsPattern, '').replace(selectorsPattern, function (match, $1) {\n  \t\t\t// don't transform at-rules and keyframe declarations\n  \t\t\tif (excludePattern.test($1)) return match;\n\n  \t\t\tvar selectors = $1.split(',').map(trim$1);\n  \t\t\tvar transformed = selectors.map(function (selector) {\n  \t\t\t\treturn transformSelector(selector, dataAttr);\n  \t\t\t}).join(', ') + ' ';\n\n  \t\t\treturn match.replace($1, transformed);\n  \t\t});\n  \t}\n\n  \treturn transformed;\n  }\n\n  function s4() {\n  \treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n\n  function uuid() {\n  \treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n  }\n\n  var cssConfigurator = {\n  \tname: 'css',\n\n  \t// Called when creating a new component definition\n  \textend: function extend(Parent, proto, options) {\n  \t\tif (!options.css) return;\n\n  \t\tvar id = uuid();\n  \t\tvar styles = options.noCssTransform ? options.css : transformCss(options.css, id);\n\n  \t\tproto.cssId = id;\n\n  \t\taddCSS({ id: id, styles: styles });\n  \t},\n\n  \t// Called when creating a new component instance\n  \tinit: function init(Parent, target, options) {\n  \t\tif (!options.css) return;\n\n  \t\twarnIfDebug('\\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\\n\\nconst Component = Ractive.extend({\\n\\t...\\n\\tcss: \\'/* your css */\\',\\n\\t...\\n});\\n\\nconst componentInstance = new Component({ ... })\\n\\t\\t');\n  \t}\n\n  };\n\n  function bind(fn, context) {\n  \tif (!/this/.test(fn.toString())) return fn;\n\n  \tvar bound = fn.bind(context);\n  \tfor (var prop in fn) {\n  \t\tbound[prop] = fn[prop];\n  \t}return bound;\n  }\n\n  function validate(data) {\n  \t// Warn if userOptions.data is a non-POJO\n  \tif (data && data.constructor !== Object) {\n  \t\tif (typeof data === 'function') {\n  \t\t\t// TODO do we need to support this in the new Ractive() case?\n  \t\t} else if ((typeof data === 'undefined' ? 'undefined' : babelHelpers.typeof(data)) !== 'object') {\n  \t\t\t\tfatal('data option must be an object or a function, `' + data + '` is not valid');\n  \t\t\t} else {\n  \t\t\t\twarnIfDebug('If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged');\n  \t\t\t}\n  \t}\n  }\n\n  var dataConfigurator = {\n  \tname: 'data',\n\n  \textend: function extend(Parent, proto, options) {\n  \t\tvar key = void 0;\n  \t\tvar value = void 0;\n\n  \t\t// check for non-primitives, which could cause mutation-related bugs\n  \t\tif (options.data && isObject(options.data)) {\n  \t\t\tfor (key in options.data) {\n  \t\t\t\tvalue = options.data[key];\n\n  \t\t\t\tif (value && (typeof value === 'undefined' ? 'undefined' : babelHelpers.typeof(value)) === 'object') {\n  \t\t\t\t\tif (isObject(value) || isArray(value)) {\n  \t\t\t\t\t\twarnIfDebug('Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\\n\\n  // this...\\n  data: function () {\\n    return {\\n      myObject: {}\\n    };\\n  })\\n\\n  // instead of this:\\n  data: {\\n    myObject: {}\\n  }');\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tproto.data = combine$1(proto.data, options.data);\n  \t},\n\n  \tinit: function init(Parent, ractive, options) {\n  \t\tvar result = combine$1(Parent.prototype.data, options.data);\n\n  \t\tif (typeof result === 'function') result = result.call(ractive);\n\n  \t\t// bind functions to the ractive instance at the top level,\n  \t\t// unless it's a non-POJO (in which case alarm bells should ring)\n  \t\tif (result && result.constructor === Object) {\n  \t\t\tfor (var prop in result) {\n  \t\t\t\tif (typeof result[prop] === 'function') result[prop] = bind(result[prop], ractive);\n  \t\t\t}\n  \t\t}\n\n  \t\treturn result || {};\n  \t},\n\n  \treset: function reset(ractive) {\n  \t\tvar result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n  \t\tractive.viewmodel.root.set(result);\n  \t\treturn true;\n  \t}\n  };\n\n  function combine$1(parentValue, childValue) {\n  \tvalidate(childValue);\n\n  \tvar parentIsFn = typeof parentValue === 'function';\n  \tvar childIsFn = typeof childValue === 'function';\n\n  \t// Very important, otherwise child instance can become\n  \t// the default data object on Ractive or a component.\n  \t// then ractive.set() ends up setting on the prototype!\n  \tif (!childValue && !parentIsFn) {\n  \t\tchildValue = {};\n  \t}\n\n  \t// Fast path, where we just need to copy properties from\n  \t// parent to child\n  \tif (!parentIsFn && !childIsFn) {\n  \t\treturn fromProperties(childValue, parentValue);\n  \t}\n\n  \treturn function () {\n  \t\tvar child = childIsFn ? callDataFunction(childValue, this) : childValue;\n  \t\tvar parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n  \t\treturn fromProperties(child, parent);\n  \t};\n  }\n\n  function callDataFunction(fn, context) {\n  \tvar data = fn.call(context);\n\n  \tif (!data) return;\n\n  \tif ((typeof data === 'undefined' ? 'undefined' : babelHelpers.typeof(data)) !== 'object') {\n  \t\tfatal('Data function must return an object');\n  \t}\n\n  \tif (data.constructor !== Object) {\n  \t\twarnOnceIfDebug('Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged');\n  \t}\n\n  \treturn data;\n  }\n\n  function fromProperties(primary, secondary) {\n  \tif (primary && secondary) {\n  \t\tfor (var key in secondary) {\n  \t\t\tif (!(key in primary)) {\n  \t\t\t\tprimary[key] = secondary[key];\n  \t\t\t}\n  \t\t}\n\n  \t\treturn primary;\n  \t}\n\n  \treturn primary || secondary;\n  }\n\n  var TEMPLATE_VERSION = 3;\n\n  var pattern = /\\$\\{([^\\}]+)\\}/g;\n\n  function fromExpression(body) {\n  \tvar length = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n  \tvar args = new Array(length);\n\n  \twhile (length--) {\n  \t\targs[length] = '_' + length;\n  \t}\n\n  \t// Functions created directly with new Function() look like this:\n  \t//     function anonymous (_0 /**/) { return _0*2 }\n  \t//\n  \t// With this workaround, we get a little more compact:\n  \t//     function (_0){return _0*2}\n  \treturn new Function([], 'return function (' + args.join(',') + '){return(' + body + ');};')();\n  }\n\n  function fromComputationString(str, bindTo) {\n  \tvar hasThis = void 0;\n\n  \tvar functionBody = 'return (' + str.replace(pattern, function (match, keypath) {\n  \t\thasThis = true;\n  \t\treturn '__ractive.get(\"' + keypath + '\")';\n  \t}) + ');';\n\n  \tif (hasThis) functionBody = 'var __ractive = this; ' + functionBody;\n  \tvar fn = new Function(functionBody);\n  \treturn hasThis ? fn.bind(bindTo) : fn;\n  }\n\n  var functions = create(null);\n\n  function getFunction(str, i) {\n  \tif (functions[str]) return functions[str];\n  \treturn functions[str] = createFunction(str, i);\n  }\n\n  function addFunctions(template) {\n  \tif (!template) return;\n\n  \tvar exp = template.e;\n\n  \tif (!exp) return;\n\n  \tObject.keys(exp).forEach(function (str) {\n  \t\tif (functions[str]) return;\n  \t\tfunctions[str] = exp[str];\n  \t});\n  }\n\n  var parse = null;\n\n  var parseOptions = ['delimiters', 'tripleDelimiters', 'staticDelimiters', 'staticTripleDelimiters', 'csp', 'interpolate', 'preserveWhitespace', 'sanitize', 'stripComments'];\n\n  var TEMPLATE_INSTRUCTIONS = 'Either preparse or use a ractive runtime source that includes the parser. ';\n\n  var COMPUTATION_INSTRUCTIONS = 'Either use:\\n\\n\\tRactive.parse.computedStrings( component.computed )\\n\\nat build time to pre-convert the strings to functions, or use functions instead of strings in computed properties.';\n\n  function throwNoParse(method, error, instructions) {\n  \tif (!method) {\n  \t\tfatal('Missing Ractive.parse - cannot parse ' + error + '. ' + instructions);\n  \t}\n  }\n\n  function createFunction(body, length) {\n  \tthrowNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  \treturn fromExpression(body, length);\n  }\n\n  function createFunctionFromString(str, bindTo) {\n  \tthrowNoParse(fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  \treturn fromComputationString(str, bindTo);\n  }\n\n  var parser = {\n  \tfromId: function fromId(id, options) {\n  \t\tif (!doc) {\n  \t\t\tif (options && options.noThrow) {\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t\tthrow new Error('Cannot retrieve template #' + id + ' as Ractive is not running in a browser.');\n  \t\t}\n\n  \t\tif (id) id = id.replace(/^#/, '');\n\n  \t\tvar template = void 0;\n\n  \t\tif (!(template = doc.getElementById(id))) {\n  \t\t\tif (options && options.noThrow) {\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t\tthrow new Error('Could not find template element with id #' + id);\n  \t\t}\n\n  \t\tif (template.tagName.toUpperCase() !== 'SCRIPT') {\n  \t\t\tif (options && options.noThrow) {\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t\tthrow new Error('Template element with id #' + id + ', must be a <script> element');\n  \t\t}\n\n  \t\treturn 'textContent' in template ? template.textContent : template.innerHTML;\n  \t},\n  \tisParsed: function isParsed(template) {\n  \t\treturn !(typeof template === 'string');\n  \t},\n  \tgetParseOptions: function getParseOptions(ractive) {\n  \t\t// Could be Ractive or a Component\n  \t\tif (ractive.defaults) {\n  \t\t\tractive = ractive.defaults;\n  \t\t}\n\n  \t\treturn parseOptions.reduce(function (val, key) {\n  \t\t\tval[key] = ractive[key];\n  \t\t\treturn val;\n  \t\t}, {});\n  \t},\n  \tparse: function parse$$(template, options) {\n  \t\tthrowNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n  \t\tvar parsed = parse(template, options);\n  \t\taddFunctions(parsed);\n  \t\treturn parsed;\n  \t},\n  \tparseFor: function parseFor(template, ractive) {\n  \t\treturn this.parse(template, this.getParseOptions(ractive));\n  \t}\n  };\n\n  var templateConfigurator = {\n  \tname: 'template',\n\n  \textend: function extend(Parent, proto, options) {\n  \t\t// only assign if exists\n  \t\tif ('template' in options) {\n  \t\t\tvar template = options.template;\n\n  \t\t\tif (typeof template === 'function') {\n  \t\t\t\tproto.template = template;\n  \t\t\t} else {\n  \t\t\t\tproto.template = parseTemplate(template, proto);\n  \t\t\t}\n  \t\t}\n  \t},\n  \tinit: function init(Parent, ractive, options) {\n  \t\t// TODO because of prototypal inheritance, we might just be able to use\n  \t\t// ractive.template, and not bother passing through the Parent object.\n  \t\t// At present that breaks the test mocks' expectations\n  \t\tvar template = 'template' in options ? options.template : Parent.prototype.template;\n  \t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\n\n  \t\tif (typeof template === 'function') {\n  \t\t\tvar fn = template;\n  \t\t\ttemplate = getDynamicTemplate(ractive, fn);\n\n  \t\t\tractive._config.template = {\n  \t\t\t\tfn: fn,\n  \t\t\t\tresult: template\n  \t\t\t};\n  \t\t}\n\n  \t\ttemplate = parseTemplate(template, ractive);\n\n  \t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n  \t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n  \t\t// it's unnecessary, because the developer never needs to access\n  \t\t// ractive.template\n  \t\tractive.template = template.t;\n\n  \t\tif (template.p) {\n  \t\t\textendPartials(ractive.partials, template.p);\n  \t\t}\n  \t},\n  \treset: function reset(ractive) {\n  \t\tvar result = resetValue(ractive);\n\n  \t\tif (result) {\n  \t\t\tvar parsed = parseTemplate(result, ractive);\n\n  \t\t\tractive.template = parsed.t;\n  \t\t\textendPartials(ractive.partials, parsed.p, true);\n\n  \t\t\treturn true;\n  \t\t}\n  \t}\n  };\n\n  function resetValue(ractive) {\n  \tvar initial = ractive._config.template;\n\n  \t// If this isn't a dynamic template, there's nothing to do\n  \tif (!initial || !initial.fn) {\n  \t\treturn;\n  \t}\n\n  \tvar result = getDynamicTemplate(ractive, initial.fn);\n\n  \t// TODO deep equality check to prevent unnecessary re-rendering\n  \t// in the case of already-parsed templates\n  \tif (result !== initial.result) {\n  \t\tinitial.result = result;\n  \t\treturn result;\n  \t}\n  }\n\n  function getDynamicTemplate(ractive, fn) {\n  \treturn fn.call(ractive, {\n  \t\tfromId: parser.fromId,\n  \t\tisParsed: parser.isParsed,\n  \t\tparse: function parse(template) {\n  \t\t\tvar options = arguments.length <= 1 || arguments[1] === undefined ? parser.getParseOptions(ractive) : arguments[1];\n\n  \t\t\treturn parser.parse(template, options);\n  \t\t}\n  \t});\n  }\n\n  function parseTemplate(template, ractive) {\n  \tif (typeof template === 'string') {\n  \t\t// parse will validate and add expression functions\n  \t\ttemplate = parseAsString(template, ractive);\n  \t} else {\n  \t\t// need to validate and add exp for already parsed template\n  \t\tvalidate$1(template);\n  \t\taddFunctions(template);\n  \t}\n\n  \treturn template;\n  }\n\n  function parseAsString(template, ractive) {\n  \t// ID of an element containing the template?\n  \tif (template[0] === '#') {\n  \t\ttemplate = parser.fromId(template);\n  \t}\n\n  \treturn parser.parseFor(template, ractive);\n  }\n\n  function validate$1(template) {\n\n  \t// Check that the template even exists\n  \tif (template == undefined) {\n  \t\tthrow new Error('The template cannot be ' + template + '.');\n  \t}\n\n  \t// Check the parsed template has a version at all\n  \telse if (typeof template.v !== 'number') {\n  \t\t\tthrow new Error('The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.');\n  \t\t}\n\n  \t\t// Check we're using the correct version\n  \t\telse if (template.v !== TEMPLATE_VERSION) {\n  \t\t\t\tthrow new Error('Mismatched template version (expected ' + TEMPLATE_VERSION + ', got ' + template.v + ') Please ensure you are using the latest version of Ractive.js in your build process as well as in your app');\n  \t\t\t}\n  }\n\n  function extendPartials(existingPartials, newPartials, overwrite) {\n  \tif (!newPartials) return;\n\n  \t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  \t// case, but not initially...\n\n  \tfor (var key in newPartials) {\n  \t\tif (overwrite || !existingPartials.hasOwnProperty(key)) {\n  \t\t\texistingPartials[key] = newPartials[key];\n  \t\t}\n  \t}\n  }\n\n  var registryNames = ['adaptors', 'components', 'computed', 'decorators', 'easing', 'events', 'interpolators', 'partials', 'transitions'];\n\n  var Registry = function () {\n  \tfunction Registry(name, useDefaults) {\n  \t\tbabelHelpers.classCallCheck(this, Registry);\n\n  \t\tthis.name = name;\n  \t\tthis.useDefaults = useDefaults;\n  \t}\n\n  \tRegistry.prototype.extend = function extend(Parent, proto, options) {\n  \t\tthis.configure(this.useDefaults ? Parent.defaults : Parent, this.useDefaults ? proto : proto.constructor, options);\n  \t};\n\n  \tRegistry.prototype.init = function init() {\n  \t\t// noop\n  \t};\n\n  \tRegistry.prototype.configure = function configure(Parent, target, options) {\n  \t\tvar name = this.name;\n  \t\tvar option = options[name];\n\n  \t\tvar registry = create(Parent[name]);\n\n  \t\tfor (var key in option) {\n  \t\t\tregistry[key] = option[key];\n  \t\t}\n\n  \t\ttarget[name] = registry;\n  \t};\n\n  \tRegistry.prototype.reset = function reset(ractive) {\n  \t\tvar registry = ractive[this.name];\n  \t\tvar changed = false;\n\n  \t\tObject.keys(registry).forEach(function (key) {\n  \t\t\tvar item = registry[key];\n\n  \t\t\tif (item._fn) {\n  \t\t\t\tif (item._fn.isOwner) {\n  \t\t\t\t\tregistry[key] = item._fn;\n  \t\t\t\t} else {\n  \t\t\t\t\tdelete registry[key];\n  \t\t\t\t}\n  \t\t\t\tchanged = true;\n  \t\t\t}\n  \t\t});\n\n  \t\treturn changed;\n  \t};\n\n  \treturn Registry;\n  }();\n\n  var registries = registryNames.map(function (name) {\n  \treturn new Registry(name, name === 'computed');\n  });\n\n  function wrap(parent, name, method) {\n  \tif (!/_super/.test(method)) return method;\n\n  \tfunction wrapper() {\n  \t\tvar superMethod = getSuperMethod(wrapper._parent, name);\n  \t\tvar hasSuper = '_super' in this;\n  \t\tvar oldSuper = this._super;\n\n  \t\tthis._super = superMethod;\n\n  \t\tvar result = method.apply(this, arguments);\n\n  \t\tif (hasSuper) {\n  \t\t\tthis._super = oldSuper;\n  \t\t} else {\n  \t\t\tdelete this._super;\n  \t\t}\n\n  \t\treturn result;\n  \t}\n\n  \twrapper._parent = parent;\n  \twrapper._method = method;\n\n  \treturn wrapper;\n  }\n\n  function getSuperMethod(parent, name) {\n  \tif (name in parent) {\n  \t\tvar _ret = function () {\n  \t\t\tvar value = parent[name];\n\n  \t\t\treturn {\n  \t\t\t\tv: typeof value === 'function' ? value : function () {\n  \t\t\t\t\treturn value;\n  \t\t\t\t}\n  \t\t\t};\n  \t\t}();\n\n  \t\tif ((typeof _ret === 'undefined' ? 'undefined' : babelHelpers.typeof(_ret)) === \"object\") return _ret.v;\n  \t}\n\n  \treturn noop;\n  }\n\n  function getMessage(deprecated, correct, isError) {\n  \treturn 'options.' + deprecated + ' has been deprecated in favour of options.' + correct + '.' + (isError ? ' You cannot specify both options, please use options.' + correct + '.' : '');\n  }\n\n  function deprecateOption(options, deprecatedOption, correct) {\n  \tif (deprecatedOption in options) {\n  \t\tif (!(correct in options)) {\n  \t\t\twarnIfDebug(getMessage(deprecatedOption, correct));\n  \t\t\toptions[correct] = options[deprecatedOption];\n  \t\t} else {\n  \t\t\tthrow new Error(getMessage(deprecatedOption, correct, true));\n  \t\t}\n  \t}\n  }\n\n  function deprecate(options) {\n  \tdeprecateOption(options, 'beforeInit', 'onconstruct');\n  \tdeprecateOption(options, 'init', 'onrender');\n  \tdeprecateOption(options, 'complete', 'oncomplete');\n  \tdeprecateOption(options, 'eventDefinitions', 'events');\n\n  \t// Using extend with Component instead of options,\n  \t// like Human.extend( Spider ) means adaptors as a registry\n  \t// gets copied to options. So we have to check if actually an array\n  \tif (isArray(options.adaptors)) {\n  \t\tdeprecateOption(options, 'adaptors', 'adapt');\n  \t}\n  }\n\n  var custom = {\n  \tadapt: adaptConfigurator,\n  \tcss: cssConfigurator,\n  \tdata: dataConfigurator,\n  \ttemplate: templateConfigurator\n  };\n\n  var defaultKeys = Object.keys(defaults);\n\n  var isStandardKey = makeObj(defaultKeys.filter(function (key) {\n  \treturn !custom[key];\n  }));\n\n  // blacklisted keys that we don't double extend\n  var isBlacklisted = makeObj(defaultKeys.concat(registries.map(function (r) {\n  \treturn r.name;\n  })));\n\n  var order = [].concat(defaultKeys.filter(function (key) {\n  \treturn !registries[key] && !custom[key];\n  }), registries,\n  //custom.data,\n  custom.template, custom.css);\n\n  var config = {\n  \textend: function extend(Parent, proto, options) {\n  \t\treturn configure('extend', Parent, proto, options);\n  \t},\n\n  \tinit: function init(Parent, ractive, options) {\n  \t\treturn configure('init', Parent, ractive, options);\n  \t},\n\n  \treset: function reset(ractive) {\n  \t\treturn order.filter(function (c) {\n  \t\t\treturn c.reset && c.reset(ractive);\n  \t\t}).map(function (c) {\n  \t\t\treturn c.name;\n  \t\t});\n  \t},\n\n  \t// this defines the order. TODO this isn't used anywhere in the codebase,\n  \t// only in the test suite - should get rid of it\n  \torder: order\n  };\n\n  function configure(method, Parent, target, options) {\n  \tdeprecate(options);\n\n  \tfor (var key in options) {\n  \t\tif (isStandardKey.hasOwnProperty(key)) {\n  \t\t\tvar value = options[key];\n\n  \t\t\t// warn the developer if they passed a function and ignore its value\n\n  \t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n  \t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n  \t\t\t// function object as the result of querySelector methods\n  \t\t\tif (key !== 'el' && typeof value === 'function') {\n  \t\t\t\twarnIfDebug(key + ' is a Ractive option that does not expect a function and will be ignored', method === 'init' ? target : null);\n  \t\t\t} else {\n  \t\t\t\ttarget[key] = value;\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \t// disallow combination of `append` and `enhance`\n  \tif (options.append && options.enhance) {\n  \t\tthrow new Error('Cannot use append and enhance at the same time');\n  \t}\n\n  \tregistries.forEach(function (registry) {\n  \t\tregistry[method](Parent, target, options);\n  \t});\n\n  \tadaptConfigurator[method](Parent, target, options);\n  \ttemplateConfigurator[method](Parent, target, options);\n  \tcssConfigurator[method](Parent, target, options);\n\n  \textendOtherMethods(Parent.prototype, target, options);\n  }\n\n  function extendOtherMethods(parent, target, options) {\n  \tfor (var key in options) {\n  \t\tif (!isBlacklisted[key] && options.hasOwnProperty(key)) {\n  \t\t\tvar member = options[key];\n\n  \t\t\t// if this is a method that overwrites a method, wrap it:\n  \t\t\tif (typeof member === 'function') {\n  \t\t\t\tmember = wrap(parent, key, member);\n  \t\t\t}\n\n  \t\t\ttarget[key] = member;\n  \t\t}\n  \t}\n  }\n\n  function makeObj(array) {\n  \tvar obj = {};\n  \tarray.forEach(function (x) {\n  \t\treturn obj[x] = true;\n  \t});\n  \treturn obj;\n  }\n\n  var shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\n  var completeHook$1 = new Hook('complete');\n  var resetHook = new Hook('reset');\n  var renderHook$1 = new Hook('render');\n  var unrenderHook = new Hook('unrender');\n\n  function Ractive$reset(data) {\n  \tdata = data || {};\n\n  \tif ((typeof data === 'undefined' ? 'undefined' : babelHelpers.typeof(data)) !== 'object') {\n  \t\tthrow new Error('The reset method takes either no arguments, or an object containing new data');\n  \t}\n\n  \t// TEMP need to tidy this up\n  \tdata = dataConfigurator.init(this.constructor, this, { data: data });\n\n  \tvar promise = runloop.start(this, true);\n\n  \t// If the root object is wrapped, try and use the wrapper's reset value\n  \tvar wrapper = this.viewmodel.wrapper;\n  \tif (wrapper && wrapper.reset) {\n  \t\tif (wrapper.reset(data) === false) {\n  \t\t\t// reset was rejected, we need to replace the object\n  \t\t\tthis.viewmodel.set(data);\n  \t\t}\n  \t} else {\n  \t\tthis.viewmodel.set(data);\n  \t}\n\n  \t// reset config items and track if need to rerender\n  \tvar changes = config.reset(this);\n  \tvar rerender = void 0;\n\n  \tvar i = changes.length;\n  \twhile (i--) {\n  \t\tif (shouldRerender.indexOf(changes[i]) > -1) {\n  \t\t\trerender = true;\n  \t\t\tbreak;\n  \t\t}\n  \t}\n\n  \tif (rerender) {\n  \t\tunrenderHook.fire(this);\n  \t\tthis.fragment.resetTemplate(this.template);\n  \t\trenderHook$1.fire(this);\n  \t\tcompleteHook$1.fire(this);\n  \t}\n\n  \trunloop.end();\n\n  \tresetHook.fire(this, data);\n\n  \treturn promise;\n  }\n\n  var TEXT = 1;\n  var INTERPOLATOR = 2;\n  var TRIPLE = 3;\n  var SECTION = 4;\n  var ELEMENT = 7;\n  var PARTIAL = 8;\n  var COMPONENT = 15;\n  var YIELDER = 16;\n  var DOCTYPE = 18;\n  var ALIAS = 19;\n\n  var NUMBER_LITERAL = 20;\n  var STRING_LITERAL = 21;\n  var REFERENCE = 30;\n  var SECTION_IF = 50;\n  var SECTION_UNLESS = 51;\n  var SECTION_EACH = 52;\n  var SECTION_WITH = 53;\n  var SECTION_IF_WITH = 54;\n\n  function collect(source, name, dest) {\n  \tsource.forEach(function (item) {\n  \t\t// queue to rerender if the item is a partial and the current name matches\n  \t\tif (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n  \t\t\tdest.push(item);\n  \t\t\treturn; // go no further\n  \t\t}\n\n  \t\t// if it has a fragment, process its items\n  \t\tif (item.fragment) {\n  \t\t\tcollect(item.fragment.iterations || item.fragment.items, name, dest);\n  \t\t}\n\n  \t\t// or if it is itself a fragment, process its items\n  \t\telse if (isArray(item.items)) {\n  \t\t\t\tcollect(item.items, name, dest);\n  \t\t\t}\n\n  \t\t\t// or if it is a component, step in and process its items\n  \t\t\telse if (item.type === COMPONENT && item.instance) {\n  \t\t\t\t\t// ...unless the partial is shadowed\n  \t\t\t\t\tif (item.instance.partials[name]) return;\n  \t\t\t\t\tcollect(item.instance.fragment.items, name, dest);\n  \t\t\t\t}\n\n  \t\t// if the item is an element, process its attributes too\n  \t\tif (item.type === ELEMENT) {\n  \t\t\tif (isArray(item.attributes)) {\n  \t\t\t\tcollect(item.attributes, name, dest);\n  \t\t\t}\n\n  \t\t\tif (isArray(item.conditionalAttributes)) {\n  \t\t\t\tcollect(item.conditionalAttributes, name, dest);\n  \t\t\t}\n  \t\t}\n  \t});\n  }\n\n  function forceResetTemplate(partial) {\n  \tpartial.forceResetTemplate();\n  }\n\n  function resetPartial (name, partial) {\n  \tvar collection = [];\n  \tcollect(this.fragment.items, name, collection);\n\n  \tvar promise = runloop.start(this, true);\n\n  \tthis.partials[name] = partial;\n  \tcollection.forEach(forceResetTemplate);\n\n  \trunloop.end();\n\n  \treturn promise;\n  }\n\n  var Item = function () {\n  \tfunction Item(options) {\n  \t\tbabelHelpers.classCallCheck(this, Item);\n\n  \t\tthis.parentFragment = options.parentFragment;\n  \t\tthis.ractive = options.parentFragment.ractive;\n\n  \t\tthis.template = options.template;\n  \t\tthis.index = options.index;\n  \t\tthis.type = options.template.t;\n\n  \t\tthis.dirty = false;\n  \t}\n\n  \tItem.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.parentFragment.bubble();\n  \t\t}\n  \t};\n\n  \tItem.prototype.find = function find() {\n  \t\treturn null;\n  \t};\n\n  \tItem.prototype.findAll = function findAll() {\n  \t\t// noop\n  \t};\n\n  \tItem.prototype.findComponent = function findComponent() {\n  \t\treturn null;\n  \t};\n\n  \tItem.prototype.findAllComponents = function findAllComponents() {\n  \t\t// noop;\n  \t};\n\n  \tItem.prototype.findNextNode = function findNextNode() {\n  \t\treturn this.parentFragment.findNextNode(this);\n  \t};\n\n  \tItem.prototype.valueOf = function valueOf() {\n  \t\treturn this.toString();\n  \t};\n\n  \treturn Item;\n  }();\n\n  var ComputationChild = function (_Model) {\n  \tbabelHelpers.inherits(ComputationChild, _Model);\n\n  \tfunction ComputationChild() {\n  \t\tbabelHelpers.classCallCheck(this, ComputationChild);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Model.apply(this, arguments));\n  \t}\n\n  \tComputationChild.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n\n  \t\tvar parentValue = this.parent.get();\n  \t\treturn parentValue ? parentValue[this.key] : undefined;\n  \t};\n\n  \tComputationChild.prototype.handleChange = function handleChange() {\n  \t\tthis.dirty = true;\n\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(_handleChange);\n  \t\tthis.clearUnresolveds(); // TODO is this necessary?\n  \t};\n\n  \tComputationChild.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ComputationChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \t// TODO this causes problems with inter-component mappings\n  \t// set () {\n  \t// \tthrow new Error( `Cannot set read-only property of computed value (${this.getKeypath()})` );\n  \t// }\n\n\n  \treturn ComputationChild;\n  }(Model);\n\n  function getValue(model) {\n  \treturn model ? model.get(true) : undefined;\n  }\n\n  var ExpressionProxy = function (_Model) {\n  \tbabelHelpers.inherits(ExpressionProxy, _Model);\n\n  \tfunction ExpressionProxy(fragment, template) {\n  \t\tbabelHelpers.classCallCheck(this, ExpressionProxy);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, fragment.ractive.viewmodel, null));\n\n  \t\t_this.fragment = fragment;\n  \t\t_this.template = template;\n\n  \t\t_this.isReadonly = true;\n\n  \t\t_this.fn = getFunction(template.s, template.r.length);\n  \t\t_this.computation = null;\n\n  \t\t_this.resolvers = [];\n  \t\t_this.models = _this.template.r.map(function (ref, index) {\n  \t\t\tvar model = resolveReference(_this.fragment, ref);\n  \t\t\tvar resolver = void 0;\n\n  \t\t\tif (!model) {\n  \t\t\t\tresolver = _this.fragment.resolve(ref, function (model) {\n  \t\t\t\t\tremoveFromArray(_this.resolvers, resolver);\n  \t\t\t\t\t_this.models[index] = model;\n  \t\t\t\t\t_this.bubble();\n  \t\t\t\t});\n\n  \t\t\t\t_this.resolvers.push(resolver);\n  \t\t\t}\n\n  \t\t\treturn model;\n  \t\t});\n\n  \t\t_this.bubble();\n  \t\treturn _this;\n  \t}\n\n  \tExpressionProxy.prototype.bubble = function bubble() {\n  \t\tvar _this2 = this;\n\n  \t\tvar ractive = this.fragment.ractive;\n\n  \t\t// TODO the @ prevents computed props from shadowing keypaths, but the real\n  \t\t// question is why it's a computed prop in the first place... (hint, it's\n  \t\t// to do with {{else}} blocks)\n  \t\tvar key = '@' + this.template.s.replace(/_(\\d+)/g, function (match, i) {\n  \t\t\tif (i >= _this2.models.length) return match;\n\n  \t\t\tvar model = _this2.models[i];\n  \t\t\treturn model ? model.getKeypath() : '@undefined';\n  \t\t});\n\n  \t\t// TODO can/should we reuse computations?\n  \t\tvar signature = {\n  \t\t\tgetter: function getter() {\n  \t\t\t\tvar values = _this2.models.map(getValue);\n  \t\t\t\treturn _this2.fn.apply(ractive, values);\n  \t\t\t},\n  \t\t\tgetterString: key\n  \t\t};\n\n  \t\tvar computation = ractive.viewmodel.compute(key, signature);\n\n  \t\tthis.value = computation.get(); // TODO should not need this, eventually\n\n  \t\tif (this.computation) {\n  \t\t\tthis.computation.unregister(this);\n  \t\t\t// notify children...\n  \t\t}\n\n  \t\tthis.computation = computation;\n  \t\tcomputation.register(this);\n\n  \t\tthis.handleChange();\n  \t};\n\n  \tExpressionProxy.prototype.get = function get(shouldCapture) {\n  \t\treturn this.computation.get(shouldCapture);\n  \t};\n\n  \tExpressionProxy.prototype.getKeypath = function getKeypath() {\n  \t\treturn this.computation ? this.computation.getKeypath() : '@undefined';\n  \t};\n\n  \tExpressionProxy.prototype.handleChange = function handleChange() {\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(_handleChange);\n\n  \t\tthis.clearUnresolveds();\n  \t};\n\n  \tExpressionProxy.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ComputationChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tExpressionProxy.prototype.mark = function mark() {\n  \t\tthis.handleChange();\n  \t};\n\n  \tExpressionProxy.prototype.retrieve = function retrieve() {\n  \t\treturn this.get();\n  \t};\n\n  \tExpressionProxy.prototype.teardown = function teardown() {\n  \t\tthis.unbind();\n  \t\tthis.fragment = undefined;\n  \t\tif (this.computation) {\n  \t\t\tthis.computation.teardown();\n  \t\t}\n  \t\tthis.computation = undefined;\n  \t\t_Model.prototype.teardown.call(this);\n  \t};\n\n  \tExpressionProxy.prototype.unregister = function unregister(dep) {\n  \t\t_Model.prototype.unregister.call(this, dep);\n  \t\tif (!this.deps.length) this.teardown();\n  \t};\n\n  \tExpressionProxy.prototype.unbind = function unbind() {\n  \t\tthis.resolvers.forEach(_unbind);\n\n  \t\tvar i = this.models.length;\n  \t\twhile (i--) {\n  \t\t\tif (this.models[i]) this.models[i].unregister(this);\n  \t\t}\n  \t};\n\n  \treturn ExpressionProxy;\n  }(Model);\n\n  var ReferenceExpressionChild = function (_Model) {\n  \tbabelHelpers.inherits(ReferenceExpressionChild, _Model);\n\n  \tfunction ReferenceExpressionChild(parent, key) {\n  \t\tbabelHelpers.classCallCheck(this, ReferenceExpressionChild);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Model.call(this, parent, key));\n  \t}\n\n  \tReferenceExpressionChild.prototype.applyValue = function applyValue(value) {\n  \t\tif (isEqual(value, this.value)) return;\n\n  \t\tvar parent = this.parent,\n  \t\t    keys = [this.key];\n  \t\twhile (parent) {\n  \t\t\tif (parent.base) {\n  \t\t\t\tvar target = parent.model.joinAll(keys);\n  \t\t\t\ttarget.applyValue(value);\n  \t\t\t\tbreak;\n  \t\t\t}\n\n  \t\t\tkeys.unshift(parent.key);\n\n  \t\t\tparent = parent.parent;\n  \t\t}\n  \t};\n\n  \tReferenceExpressionChild.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ReferenceExpressionChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \treturn ReferenceExpressionChild;\n  }(Model);\n\n  var ReferenceExpressionProxy = function (_Model2) {\n  \tbabelHelpers.inherits(ReferenceExpressionProxy, _Model2);\n\n  \tfunction ReferenceExpressionProxy(fragment, template) {\n  \t\tbabelHelpers.classCallCheck(this, ReferenceExpressionProxy);\n\n  \t\tvar _this2 = babelHelpers.possibleConstructorReturn(this, _Model2.call(this, null, null));\n\n  \t\t_this2.root = fragment.ractive.viewmodel;\n\n  \t\t_this2.resolvers = [];\n\n  \t\t_this2.base = resolve$1(fragment, template);\n  \t\tvar baseResolver = void 0;\n\n  \t\tif (!_this2.base) {\n  \t\t\tbaseResolver = fragment.resolve(template.r, function (model) {\n  \t\t\t\t_this2.base = model;\n  \t\t\t\t_this2.bubble();\n\n  \t\t\t\tremoveFromArray(_this2.resolvers, baseResolver);\n  \t\t\t});\n\n  \t\t\t_this2.resolvers.push(baseResolver);\n  \t\t}\n\n  \t\tvar intermediary = {\n  \t\t\thandleChange: function handleChange() {\n  \t\t\t\treturn _this2.bubble();\n  \t\t\t}\n  \t\t};\n\n  \t\t_this2.members = template.m.map(function (template, i) {\n  \t\t\tif (typeof template === 'string') {\n  \t\t\t\treturn { get: function get() {\n  \t\t\t\t\t\treturn template;\n  \t\t\t\t\t} };\n  \t\t\t}\n\n  \t\t\tvar model = void 0;\n  \t\t\tvar resolver = void 0;\n\n  \t\t\tif (template.t === REFERENCE) {\n  \t\t\t\tmodel = resolveReference(fragment, template.n);\n\n  \t\t\t\tif (model) {\n  \t\t\t\t\tmodel.register(intermediary);\n  \t\t\t\t} else {\n  \t\t\t\t\tresolver = fragment.resolve(template.n, function (model) {\n  \t\t\t\t\t\t_this2.members[i] = model;\n\n  \t\t\t\t\t\tmodel.register(intermediary);\n  \t\t\t\t\t\t_this2.bubble();\n\n  \t\t\t\t\t\tremoveFromArray(_this2.resolvers, resolver);\n  \t\t\t\t\t});\n\n  \t\t\t\t\t_this2.resolvers.push(resolver);\n  \t\t\t\t}\n\n  \t\t\t\treturn model;\n  \t\t\t}\n\n  \t\t\tmodel = new ExpressionProxy(fragment, template);\n  \t\t\tmodel.register(intermediary);\n  \t\t\treturn model;\n  \t\t});\n\n  \t\t_this2.isUnresolved = true;\n  \t\t_this2.bubble();\n  \t\treturn _this2;\n  \t}\n\n  \tReferenceExpressionProxy.prototype.bubble = function bubble() {\n  \t\tif (!this.base) return;\n\n  \t\t// if some members are not resolved, abort\n  \t\tvar i = this.members.length;\n  \t\twhile (i--) {\n  \t\t\tif (!this.members[i]) return;\n  \t\t}\n\n  \t\tthis.isUnresolved = false;\n\n  \t\tvar keys = this.members.map(function (model) {\n  \t\t\treturn escapeKey(String(model.get()));\n  \t\t});\n  \t\tvar model = this.base.joinAll(keys);\n\n  \t\tif (this.model) {\n  \t\t\tthis.model.unregister(this);\n  \t\t\tthis.model.unregisterTwowayBinding(this);\n  \t\t}\n\n  \t\tthis.model = model;\n  \t\tthis.parent = model.parent;\n\n  \t\tmodel.register(this);\n  \t\tmodel.registerTwowayBinding(this);\n\n  \t\tif (this.keypathModel) this.keypathModel.handleChange();\n\n  \t\tthis.mark();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.forceResolution = function forceResolution() {\n  \t\tthis.resolvers.forEach(function (resolver) {\n  \t\t\treturn resolver.forceResolution();\n  \t\t});\n  \t\tthis.bubble();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.get = function get() {\n  \t\treturn this.model ? this.model.get() : undefined;\n  \t};\n\n  \t// indirect two-way bindings\n\n\n  \tReferenceExpressionProxy.prototype.getValue = function getValue() {\n  \t\tvar i = this.bindings.length;\n  \t\twhile (i--) {\n  \t\t\tvar value = this.bindings[i].getValue();\n  \t\t\tif (value !== this.value) return value;\n  \t\t}\n\n  \t\treturn this.value;\n  \t};\n\n  \tReferenceExpressionProxy.prototype.getKeypath = function getKeypath() {\n  \t\treturn this.model ? this.model.getKeypath() : '@undefined';\n  \t};\n\n  \tReferenceExpressionProxy.prototype.handleChange = function handleChange() {\n  \t\tthis.mark();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ReferenceExpressionChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tReferenceExpressionProxy.prototype.retrieve = function retrieve() {\n  \t\treturn this.get();\n  \t};\n\n  \tReferenceExpressionProxy.prototype.set = function set(value) {\n  \t\tif (!this.model) throw new Error('Unresolved reference expression. This should not happen!');\n  \t\tthis.model.set(value);\n  \t};\n\n  \tReferenceExpressionProxy.prototype.unbind = function unbind() {\n  \t\tthis.resolvers.forEach(_unbind);\n  \t};\n\n  \treturn ReferenceExpressionProxy;\n  }(Model);\n\n  function resolve$1(fragment, template) {\n  \tif (template.r) {\n  \t\treturn resolveReference(fragment, template.r);\n  \t} else if (template.x) {\n  \t\treturn new ExpressionProxy(fragment, template.x);\n  \t} else {\n  \t\treturn new ReferenceExpressionProxy(fragment, template.rx);\n  \t}\n  }\n\n  function resolveAliases(section) {\n  \tif (section.template.z) {\n  \t\tsection.aliases = {};\n\n  \t\tvar refs = section.template.z;\n  \t\tfor (var i = 0; i < refs.length; i++) {\n  \t\t\tsection.aliases[refs[i].n] = resolve$1(section.parentFragment, refs[i].x);\n  \t\t}\n  \t}\n  }\n\n  var Alias = function (_Item) {\n  \tbabelHelpers.inherits(Alias, _Item);\n\n  \tfunction Alias(options) {\n  \t\tbabelHelpers.classCallCheck(this, Alias);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.fragment = null;\n  \t\treturn _this;\n  \t}\n\n  \tAlias.prototype.bind = function bind() {\n  \t\tresolveAliases(this);\n\n  \t\tthis.fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\ttemplate: this.template.f\n  \t\t}).bind();\n  \t};\n\n  \tAlias.prototype.detach = function detach() {\n  \t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n  \t};\n\n  \tAlias.prototype.find = function find(selector) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.find(selector);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.findAll = function findAll(selector, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.findComponent = function findComponent(name) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tAlias.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment && this.fragment.firstNode(skipParent);\n  \t};\n\n  \tAlias.prototype.rebind = function rebind() {\n  \t\tresolveAliases(this);\n  \t\tif (this.fragment) this.fragment.rebind();\n  \t};\n\n  \tAlias.prototype.render = function render(target) {\n  \t\tthis.rendered = true;\n  \t\tif (this.fragment) this.fragment.render(target);\n  \t};\n\n  \tAlias.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment ? this.fragment.toString(escape) : '';\n  \t};\n\n  \tAlias.prototype.unbind = function unbind() {\n  \t\tthis.aliases = {};\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tAlias.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n  \t\tthis.rendered = false;\n  \t};\n\n  \tAlias.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tthis.fragment.update();\n  \t\t}\n  \t};\n\n  \treturn Alias;\n  }(Item);\n\n  function processWrapper (wrapper, array, methodName, newIndices) {\n  \tvar __model = wrapper.__model;\n\n\n  \tif (newIndices) {\n  \t\t__model.shuffle(newIndices);\n  \t} else {\n  \t\t// If this is a sort or reverse, we just do root.set()...\n  \t\t// TODO use merge logic?\n  \t\t//root.viewmodel.mark( keypath );\n  \t}\n  }\n\n  var mutatorMethods = ['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'];\n  var patchedArrayProto = [];\n\n  mutatorMethods.forEach(function (methodName) {\n  \tvar method = function method() {\n  \t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n  \t\t\targs[_key] = arguments[_key];\n  \t\t}\n\n  \t\tvar newIndices = getNewIndices(this.length, methodName, args);\n\n  \t\t// apply the underlying method\n  \t\tvar result = Array.prototype[methodName].apply(this, arguments);\n\n  \t\t// trigger changes\n  \t\trunloop.start();\n\n  \t\tthis._ractive.setting = true;\n  \t\tvar i = this._ractive.wrappers.length;\n  \t\twhile (i--) {\n  \t\t\tprocessWrapper(this._ractive.wrappers[i], this, methodName, newIndices);\n  \t\t}\n\n  \t\trunloop.end();\n\n  \t\tthis._ractive.setting = false;\n  \t\treturn result;\n  \t};\n\n  \tdefineProperty(patchedArrayProto, methodName, {\n  \t\tvalue: method\n  \t});\n  });\n\n  var patchArrayMethods = void 0;\n  var unpatchArrayMethods = void 0;\n\n  // can we use prototype chain injection?\n  // http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\n  if ({}.__proto__) {\n  \t// yes, we can\n  \tpatchArrayMethods = function patchArrayMethods(array) {\n  \t\treturn array.__proto__ = patchedArrayProto;\n  \t};\n  \tunpatchArrayMethods = function unpatchArrayMethods(array) {\n  \t\treturn array.__proto__ = Array.prototype;\n  \t};\n  } else {\n  \t// no, we can't\n  \tpatchArrayMethods = function patchArrayMethods(array) {\n  \t\tvar i = mutatorMethods.length;\n  \t\twhile (i--) {\n  \t\t\tvar methodName = mutatorMethods[i];\n  \t\t\tdefineProperty(array, methodName, {\n  \t\t\t\tvalue: patchedArrayProto[methodName],\n  \t\t\t\tconfigurable: true\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tunpatchArrayMethods = function unpatchArrayMethods(array) {\n  \t\tvar i = mutatorMethods.length;\n  \t\twhile (i--) {\n  \t\t\tdelete array[mutatorMethods[i]];\n  \t\t}\n  \t};\n  }\n\n  patchArrayMethods.unpatch = unpatchArrayMethods; // TODO export separately?\n  var patch = patchArrayMethods;\n\n  var errorMessage$1 = 'Something went wrong in a rather interesting way';\n\n  var arrayAdaptor = {\n  \tfilter: function filter(object) {\n  \t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n  \t\t// or the array didn't trigger the get() itself\n  \t\treturn isArray(object) && (!object._ractive || !object._ractive.setting);\n  \t},\n  \twrap: function wrap(ractive, array, keypath) {\n  \t\treturn new ArrayWrapper(ractive, array, keypath);\n  \t}\n  };\n\n  var ArrayWrapper = function () {\n  \tfunction ArrayWrapper(ractive, array) {\n  \t\tbabelHelpers.classCallCheck(this, ArrayWrapper);\n\n  \t\tthis.root = ractive;\n  \t\tthis.value = array;\n  \t\tthis.__model = null; // filled in later\n\n  \t\t// if this array hasn't already been ractified, ractify it\n  \t\tif (!array._ractive) {\n  \t\t\t// define a non-enumerable _ractive property to store the wrappers\n  \t\t\tdefineProperty(array, '_ractive', {\n  \t\t\t\tvalue: {\n  \t\t\t\t\twrappers: [],\n  \t\t\t\t\tinstances: [],\n  \t\t\t\t\tsetting: false\n  \t\t\t\t},\n  \t\t\t\tconfigurable: true\n  \t\t\t});\n\n  \t\t\tpatch(array);\n  \t\t}\n\n  \t\t// store the ractive instance, so we can handle transitions later\n  \t\tif (!array._ractive.instances[ractive._guid]) {\n  \t\t\tarray._ractive.instances[ractive._guid] = 0;\n  \t\t\tarray._ractive.instances.push(ractive);\n  \t\t}\n\n  \t\tarray._ractive.instances[ractive._guid] += 1;\n  \t\tarray._ractive.wrappers.push(this);\n  \t}\n\n  \tArrayWrapper.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tArrayWrapper.prototype.teardown = function teardown() {\n  \t\tvar array, storage, wrappers, instances, index;\n\n  \t\tarray = this.value;\n  \t\tstorage = array._ractive;\n  \t\twrappers = storage.wrappers;\n  \t\tinstances = storage.instances;\n\n  \t\t// if teardown() was invoked because we're clearing the cache as a result of\n  \t\t// a change that the array itself triggered, we can save ourselves the teardown\n  \t\t// and immediate setup\n  \t\tif (storage.setting) {\n  \t\t\treturn false; // so that we don't remove it from cached wrappers\n  \t\t}\n\n  \t\tindex = wrappers.indexOf(this);\n  \t\tif (index === -1) {\n  \t\t\tthrow new Error(errorMessage$1);\n  \t\t}\n\n  \t\twrappers.splice(index, 1);\n\n  \t\t// if nothing else depends on this array, we can revert it to its\n  \t\t// natural state\n  \t\tif (!wrappers.length) {\n  \t\t\tdelete array._ractive;\n  \t\t\tpatch.unpatch(this.value);\n  \t\t} else {\n  \t\t\t// remove ractive instance if possible\n  \t\t\tinstances[this.root._guid] -= 1;\n  \t\t\tif (!instances[this.root._guid]) {\n  \t\t\t\tindex = instances.indexOf(this.root);\n\n  \t\t\t\tif (index === -1) {\n  \t\t\t\t\tthrow new Error(errorMessage$1);\n  \t\t\t\t}\n\n  \t\t\t\tinstances.splice(index, 1);\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \treturn ArrayWrapper;\n  }();\n\n  var magicAdaptor = void 0;\n\n  try {\n  \tObject.defineProperty({}, 'test', {\n  \t\tget: function get() {},\n  \t\tset: function set() {}\n  \t});\n\n  \tmagicAdaptor = {\n  \t\tfilter: function filter(value) {\n  \t\t\treturn value && (typeof value === 'undefined' ? 'undefined' : babelHelpers.typeof(value)) === 'object';\n  \t\t},\n  \t\twrap: function wrap(ractive, value, keypath) {\n  \t\t\treturn new MagicWrapper(ractive, value, keypath);\n  \t\t}\n  \t};\n  } catch (err) {\n  \tmagicAdaptor = false;\n  }\n\n  var magicAdaptor$1 = magicAdaptor;\n\n  function createOrWrapDescriptor(originalDescriptor, ractive, keypath) {\n  \tif (originalDescriptor.set && originalDescriptor.set.__magic) {\n  \t\toriginalDescriptor.set.__magic.dependants.push({ ractive: ractive, keypath: keypath });\n  \t\treturn originalDescriptor;\n  \t}\n\n  \tvar setting = void 0;\n\n  \tvar dependants = [{ ractive: ractive, keypath: keypath }];\n\n  \tvar descriptor = {\n  \t\tget: function get() {\n  \t\t\treturn 'value' in originalDescriptor ? originalDescriptor.value : originalDescriptor.get();\n  \t\t},\n  \t\tset: function set(value) {\n  \t\t\tif (setting) return;\n\n  \t\t\tif ('value' in originalDescriptor) {\n  \t\t\t\toriginalDescriptor.value = value;\n  \t\t\t} else {\n  \t\t\t\toriginalDescriptor.set(value);\n  \t\t\t}\n\n  \t\t\tsetting = true;\n  \t\t\tdependants.forEach(function (_ref) {\n  \t\t\t\tvar ractive = _ref.ractive;\n  \t\t\t\tvar keypath = _ref.keypath;\n\n  \t\t\t\tractive.set(keypath, value);\n  \t\t\t});\n  \t\t\tsetting = false;\n  \t\t},\n  \t\tenumerable: true\n  \t};\n\n  \tdescriptor.set.__magic = { dependants: dependants, originalDescriptor: originalDescriptor };\n\n  \treturn descriptor;\n  }\n\n  function revert(descriptor, ractive, keypath) {\n  \tif (!descriptor.set || !descriptor.set.__magic) return true;\n\n  \tvar dependants = descriptor.set.__magic;\n  \tvar i = dependants.length;\n  \twhile (i--) {\n  \t\tvar dependant = dependants[i];\n  \t\tif (dependant.ractive === ractive && dependant.keypath === keypath) {\n  \t\t\tdependants.splice(i, 1);\n  \t\t\treturn false;\n  \t\t}\n  \t}\n  }\n\n  var MagicWrapper = function () {\n  \tfunction MagicWrapper(ractive, value, keypath) {\n  \t\tvar _this = this;\n\n  \t\tbabelHelpers.classCallCheck(this, MagicWrapper);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.value = value;\n  \t\tthis.keypath = keypath;\n\n  \t\tthis.originalDescriptors = {};\n\n  \t\t// wrap all properties with getters\n  \t\tObject.keys(value).forEach(function (key) {\n  \t\t\tvar originalDescriptor = Object.getOwnPropertyDescriptor(_this.value, key);\n  \t\t\t_this.originalDescriptors[key] = originalDescriptor;\n\n  \t\t\tvar childKeypath = keypath ? keypath + '.' + escapeKey(key) : escapeKey(key);\n\n  \t\t\tvar descriptor = createOrWrapDescriptor(originalDescriptor, ractive, childKeypath);\n\n  \t\t\tObject.defineProperty(_this.value, key, descriptor);\n  \t\t});\n  \t}\n\n  \tMagicWrapper.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tMagicWrapper.prototype.reset = function reset() {\n  \t\tthrow new Error('TODO magic adaptor reset'); // does this ever happen?\n  \t};\n\n  \tMagicWrapper.prototype.set = function set(key, value) {\n  \t\tthis.value[key] = value;\n  \t};\n\n  \tMagicWrapper.prototype.teardown = function teardown() {\n  \t\tvar _this2 = this;\n\n  \t\tObject.keys(this.value).forEach(function (key) {\n  \t\t\tvar descriptor = Object.getOwnPropertyDescriptor(_this2.value, key);\n  \t\t\tif (!descriptor.set || !descriptor.set.__magic) return;\n\n  \t\t\trevert(descriptor);\n\n  \t\t\tif (descriptor.set.__magic.dependants.length === 1) {\n  \t\t\t\tObject.defineProperty(_this2.value, key, descriptor.set.__magic.originalDescriptor);\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \treturn MagicWrapper;\n  }();\n\n  var MagicArrayWrapper = function () {\n  \tfunction MagicArrayWrapper(ractive, array, keypath) {\n  \t\tbabelHelpers.classCallCheck(this, MagicArrayWrapper);\n\n  \t\tthis.value = array;\n\n  \t\tthis.magic = true;\n\n  \t\tthis.magicWrapper = magicAdaptor$1.wrap(ractive, array, keypath);\n  \t\tthis.arrayWrapper = arrayAdaptor.wrap(ractive, array, keypath);\n\n  \t\t// ugh, this really is a terrible hack\n  \t\tObject.defineProperty(this, '__model', {\n  \t\t\tget: function get() {\n  \t\t\t\treturn this.arrayWrapper.__model;\n  \t\t\t},\n  \t\t\tset: function set(model) {\n  \t\t\t\tthis.arrayWrapper.__model = model;\n  \t\t\t}\n  \t\t});\n  \t}\n\n  \tMagicArrayWrapper.prototype.get = function get() {\n  \t\treturn this.value;\n  \t};\n\n  \tMagicArrayWrapper.prototype.teardown = function teardown() {\n  \t\tthis.arrayWrapper.teardown();\n  \t\tthis.magicWrapper.teardown();\n  \t};\n\n  \tMagicArrayWrapper.prototype.reset = function reset(value) {\n  \t\treturn this.magicWrapper.reset(value);\n  \t};\n\n  \treturn MagicArrayWrapper;\n  }();\n\n  var magicArrayAdaptor = {\n  \tfilter: function filter(object, keypath, ractive) {\n  \t\treturn magicAdaptor$1.filter(object, keypath, ractive) && arrayAdaptor.filter(object);\n  \t},\n  \twrap: function wrap(ractive, array, keypath) {\n  \t\treturn new MagicArrayWrapper(ractive, array, keypath);\n  \t}\n  };\n\n  // TODO this is probably a bit anal, maybe we should leave it out\n  function prettify(fnBody) {\n  \tvar lines = fnBody.replace(/^\\t+/gm, function (tabs) {\n  \t\treturn tabs.split('\\t').join('  ');\n  \t}).split('\\n');\n\n  \tvar minIndent = lines.length < 2 ? 0 : lines.slice(1).reduce(function (prev, line) {\n  \t\treturn Math.min(prev, /^\\s*/.exec(line)[0].length);\n  \t}, Infinity);\n\n  \treturn lines.map(function (line, i) {\n  \t\treturn '    ' + (i ? line.substring(minIndent) : line);\n  \t}).join('\\n');\n  }\n\n  // Ditto. This function truncates the stack to only include app code\n  function truncateStack(stack) {\n  \tif (!stack) return '';\n\n  \tvar lines = stack.split('\\n');\n  \tvar name = Computation.name + '.getValue';\n\n  \tvar truncated = [];\n\n  \tvar len = lines.length;\n  \tfor (var i = 1; i < len; i += 1) {\n  \t\tvar line = lines[i];\n\n  \t\tif (~line.indexOf(name)) {\n  \t\t\treturn truncated.join('\\n');\n  \t\t} else {\n  \t\t\ttruncated.push(line);\n  \t\t}\n  \t}\n  }\n\n  var Computation = function (_Model) {\n  \tbabelHelpers.inherits(Computation, _Model);\n\n  \tfunction Computation(viewmodel, signature, key) {\n  \t\tbabelHelpers.classCallCheck(this, Computation);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, null));\n\n  \t\t_this.root = _this.parent = viewmodel;\n  \t\t_this.signature = signature;\n\n  \t\t_this.key = key; // not actually used, but helps with debugging\n  \t\t_this.isExpression = key && key[0] === '@';\n\n  \t\t_this.isReadonly = !_this.signature.setter;\n\n  \t\t_this.context = viewmodel.computationContext;\n\n  \t\t_this.dependencies = [];\n\n  \t\t_this.children = [];\n  \t\t_this.childByKey = {};\n\n  \t\t_this.deps = [];\n\n  \t\t_this.boundsSensitive = true;\n  \t\t_this.dirty = true;\n\n  \t\t// TODO: is there a less hackish way to do this?\n  \t\t_this.shuffle = undefined;\n  \t\treturn _this;\n  \t}\n\n  \tComputation.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tthis.value = this.getValue();\n  \t\t\tthis.adapt();\n  \t\t}\n\n  \t\treturn this.value;\n  \t};\n\n  \tComputation.prototype.getValue = function getValue() {\n  \t\tstartCapturing();\n  \t\tvar result = void 0;\n\n  \t\ttry {\n  \t\t\tresult = this.signature.getter.call(this.context);\n  \t\t} catch (err) {\n  \t\t\twarnIfDebug('Failed to compute ' + this.getKeypath() + ': ' + (err.message || err));\n\n  \t\t\t// TODO this is all well and good in Chrome, but...\n  \t\t\t// ...also, should encapsulate this stuff better, and only\n  \t\t\t// show it if Ractive.DEBUG\n  \t\t\tif (hasConsole) {\n  \t\t\t\tif (console.groupCollapsed) console.groupCollapsed('%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;');\n  \t\t\t\tvar functionBody = prettify(this.signature.getterString);\n  \t\t\t\tvar stack = this.signature.getterUseStack ? '\\n\\n' + truncateStack(err.stack) : '';\n  \t\t\t\tconsole.error(err.name + ': ' + err.message + '\\n\\n' + functionBody + stack);\n  \t\t\t\tif (console.groupCollapsed) console.groupEnd();\n  \t\t\t}\n  \t\t}\n\n  \t\tvar dependencies = stopCapturing();\n  \t\tthis.setDependencies(dependencies);\n\n  \t\treturn result;\n  \t};\n\n  \tComputation.prototype.handleChange = function handleChange() {\n  \t\tthis.dirty = true;\n\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(_handleChange);\n  \t\tthis.clearUnresolveds(); // TODO same question as on Model - necessary for primitives?\n  \t};\n\n  \tComputation.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === undefined || key === '') return this;\n\n  \t\tif (!this.childByKey.hasOwnProperty(key)) {\n  \t\t\tvar child = new ComputationChild(this, key);\n  \t\t\tthis.children.push(child);\n  \t\t\tthis.childByKey[key] = child;\n  \t\t}\n\n  \t\treturn this.childByKey[key];\n  \t};\n\n  \tComputation.prototype.mark = function mark() {\n  \t\tthis.handleChange();\n  \t};\n\n  \tComputation.prototype.set = function set(value) {\n  \t\tif (!this.signature.setter) {\n  \t\t\tthrow new Error('Cannot set read-only computed value \\'' + this.key + '\\'');\n  \t\t}\n\n  \t\tthis.signature.setter(value);\n  \t};\n\n  \tComputation.prototype.setDependencies = function setDependencies(dependencies) {\n  \t\t// unregister any soft dependencies we no longer have\n  \t\tvar i = this.dependencies.length;\n  \t\twhile (i--) {\n  \t\t\tvar model = this.dependencies[i];\n  \t\t\tif (! ~dependencies.indexOf(model)) model.unregister(this);\n  \t\t}\n\n  \t\t// and add any new ones\n  \t\ti = dependencies.length;\n  \t\twhile (i--) {\n  \t\t\tvar _model = dependencies[i];\n  \t\t\tif (! ~this.dependencies.indexOf(_model)) _model.register(this);\n  \t\t}\n\n  \t\tthis.dependencies = dependencies;\n  \t};\n\n  \tComputation.prototype.teardown = function teardown() {\n  \t\tvar i = this.dependencies.length;\n  \t\twhile (i--) {\n  \t\t\tif (this.dependencies[i]) this.dependencies[i].unregister(this);\n  \t\t}\n  \t\tif (this.root.computations[this.key] === this) delete this.root.computations[this.key];\n  \t\t_Model.prototype.teardown.call(this);\n  \t};\n\n  \treturn Computation;\n  }(Model);\n\n  var RactiveModel = function (_Model) {\n  \tbabelHelpers.inherits(RactiveModel, _Model);\n\n  \tfunction RactiveModel(ractive) {\n  \t\tbabelHelpers.classCallCheck(this, RactiveModel);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, ''));\n\n  \t\t_this.value = ractive;\n  \t\t_this.isRoot = true;\n  \t\t_this.root = _this;\n  \t\t_this.adaptors = [];\n  \t\t_this.ractive = ractive;\n  \t\t_this.changes = {};\n  \t\treturn _this;\n  \t}\n\n  \tRactiveModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn '@ractive';\n  \t};\n\n  \treturn RactiveModel;\n  }(Model);\n\n  var hasProp$1 = Object.prototype.hasOwnProperty;\n\n  var RootModel = function (_Model) {\n  \tbabelHelpers.inherits(RootModel, _Model);\n\n  \tfunction RootModel(options) {\n  \t\tbabelHelpers.classCallCheck(this, RootModel);\n\n\n  \t\t// TODO deprecate this\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Model.call(this, null, null));\n\n  \t\t_this.changes = {};\n\n  \t\t_this.isRoot = true;\n  \t\t_this.root = _this;\n  \t\t_this.ractive = options.ractive; // TODO sever this link\n\n  \t\t_this.value = options.data;\n  \t\t_this.adaptors = options.adapt;\n  \t\t_this.adapt();\n\n  \t\t_this.mappings = {};\n\n  \t\t_this.computationContext = options.ractive;\n  \t\t_this.computations = {};\n  \t\treturn _this;\n  \t}\n\n  \tRootModel.prototype.applyChanges = function applyChanges() {\n  \t\tthis._changeHash = {};\n  \t\tthis.flush();\n\n  \t\treturn this._changeHash;\n  \t};\n\n  \tRootModel.prototype.compute = function compute(key, signature) {\n  \t\tvar computation = new Computation(this, signature, key);\n  \t\tthis.computations[key] = computation;\n\n  \t\treturn computation;\n  \t};\n\n  \tRootModel.prototype.extendChildren = function extendChildren(fn) {\n  \t\tvar mappings = this.mappings;\n  \t\tObject.keys(mappings).forEach(function (key) {\n  \t\t\tfn(key, mappings[key]);\n  \t\t});\n\n  \t\tvar computations = this.computations;\n  \t\tObject.keys(computations).forEach(function (key) {\n  \t\t\tvar computation = computations[key];\n  \t\t\t// exclude template expressions\n  \t\t\tif (!computation.isExpression) {\n  \t\t\t\tfn(key, computation);\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \tRootModel.prototype.get = function get(shouldCapture) {\n  \t\tif (shouldCapture) capture(this);\n  \t\tvar result = extendObj({}, this.value);\n\n  \t\tthis.extendChildren(function (key, model) {\n  \t\t\tresult[key] = model.value;\n  \t\t});\n\n  \t\treturn result;\n  \t};\n\n  \tRootModel.prototype.getKeypath = function getKeypath() {\n  \t\treturn '';\n  \t};\n\n  \tRootModel.prototype.getRactiveModel = function getRactiveModel() {\n  \t\treturn this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  \t};\n\n  \tRootModel.prototype.getValueChildren = function getValueChildren() {\n  \t\tvar children = _Model.prototype.getValueChildren.call(this, this.value);\n\n  \t\tthis.extendChildren(function (key, model) {\n  \t\t\tchildren.push(model);\n  \t\t});\n\n  \t\treturn children;\n  \t};\n\n  \tRootModel.prototype.handleChange = function handleChange() {\n  \t\tthis.deps.forEach(_handleChange);\n  \t};\n\n  \tRootModel.prototype.has = function has(key) {\n  \t\tif (key in this.mappings || key in this.computations) return true;\n\n  \t\tvar value = this.value;\n\n  \t\tkey = unescapeKey(key);\n  \t\tif (hasProp$1.call(value, key)) return true;\n\n  \t\t// We climb up the constructor chain to find if one of them contains the key\n  \t\tvar constructor = value.constructor;\n  \t\twhile (constructor !== Function && constructor !== Array && constructor !== Object) {\n  \t\t\tif (hasProp$1.call(constructor.prototype, key)) return true;\n  \t\t\tconstructor = constructor.constructor;\n  \t\t}\n\n  \t\treturn false;\n  \t};\n\n  \tRootModel.prototype.joinKey = function joinKey(key) {\n  \t\tif (key === '@global') return GlobalModel$1;\n  \t\tif (key === '@ractive') return this.getRactiveModel();\n\n  \t\treturn this.mappings.hasOwnProperty(key) ? this.mappings[key] : this.computations.hasOwnProperty(key) ? this.computations[key] : _Model.prototype.joinKey.call(this, key);\n  \t};\n\n  \tRootModel.prototype.map = function map(localKey, origin) {\n  \t\t// TODO remapping\n  \t\tthis.mappings[localKey] = origin;\n  \t\torigin.register(this);\n  \t};\n\n  \tRootModel.prototype.set = function set(value) {\n  \t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n  \t\tvar wrapper = this.wrapper;\n  \t\tif (wrapper) {\n  \t\t\tvar shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n  \t\t\tif (shouldTeardown) {\n  \t\t\t\twrapper.teardown();\n  \t\t\t\tthis.wrapper = null;\n  \t\t\t\tthis.value = value;\n  \t\t\t\tthis.adapt();\n  \t\t\t}\n  \t\t} else {\n  \t\t\tthis.value = value;\n  \t\t\tthis.adapt();\n  \t\t}\n\n  \t\tthis.deps.forEach(_handleChange);\n  \t\tthis.children.forEach(mark);\n  \t\tthis.clearUnresolveds(); // TODO do we need to do this with primitive values? if not, what about e.g. unresolved `length` property of null -> string?\n  \t};\n\n  \tRootModel.prototype.retrieve = function retrieve() {\n  \t\treturn this.value;\n  \t};\n\n  \tRootModel.prototype.teardown = function teardown() {\n  \t\tvar keys = Object.keys(this.mappings);\n  \t\tvar i = keys.length;\n  \t\twhile (i--) {\n  \t\t\tif (this.mappings[keys[i]]) this.mappings[keys[i]].unregister(this);\n  \t\t}\n\n  \t\t_Model.prototype.teardown.call(this);\n  \t};\n\n  \tRootModel.prototype.update = function update() {\n  \t\t// noop\n  \t};\n\n  \tRootModel.prototype.updateFromBindings = function updateFromBindings(cascade) {\n  \t\tvar _this2 = this;\n\n  \t\t_Model.prototype.updateFromBindings.call(this, cascade);\n\n  \t\tif (cascade) {\n  \t\t\t// TODO computations as well?\n  \t\t\tObject.keys(this.mappings).forEach(function (key) {\n  \t\t\t\tvar model = _this2.mappings[key];\n  \t\t\t\tmodel.updateFromBindings(cascade);\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \treturn RootModel;\n  }(Model);\n\n  function getComputationSignature(ractive, key, signature) {\n  \tvar getter = void 0;\n  \tvar setter = void 0;\n\n  \t// useful for debugging\n  \tvar getterString = void 0;\n  \tvar getterUseStack = void 0;\n  \tvar setterString = void 0;\n\n  \tif (typeof signature === 'function') {\n  \t\tgetter = bind(signature, ractive);\n  \t\tgetterString = signature.toString();\n  \t\tgetterUseStack = true;\n  \t}\n\n  \tif (typeof signature === 'string') {\n  \t\tgetter = createFunctionFromString(signature, ractive);\n  \t\tgetterString = signature;\n  \t}\n\n  \tif ((typeof signature === 'undefined' ? 'undefined' : babelHelpers.typeof(signature)) === 'object') {\n  \t\tif (typeof signature.get === 'string') {\n  \t\t\tgetter = createFunctionFromString(signature.get, ractive);\n  \t\t\tgetterString = signature.get;\n  \t\t} else if (typeof signature.get === 'function') {\n  \t\t\tgetter = bind(signature.get, ractive);\n  \t\t\tgetterString = signature.get.toString();\n  \t\t\tgetterUseStack = true;\n  \t\t} else {\n  \t\t\tfatal('`%s` computation must have a `get()` method', key);\n  \t\t}\n\n  \t\tif (typeof signature.set === 'function') {\n  \t\t\tsetter = bind(signature.set, ractive);\n  \t\t\tsetterString = signature.set.toString();\n  \t\t}\n  \t}\n\n  \treturn {\n  \t\tgetter: getter,\n  \t\tsetter: setter,\n  \t\tgetterString: getterString,\n  \t\tsetterString: setterString,\n  \t\tgetterUseStack: getterUseStack\n  \t};\n  }\n\n  var constructHook = new Hook('construct');\n\n  var registryNames$1 = ['adaptors', 'components', 'decorators', 'easing', 'events', 'interpolators', 'partials', 'transitions'];\n\n  var uid = 0;\n\n  function construct(ractive, options) {\n  \tif (Ractive.DEBUG) welcome();\n\n  \tinitialiseProperties(ractive);\n\n  \t// TODO remove this, eventually\n  \tdefineProperty(ractive, 'data', { get: deprecateRactiveData });\n\n  \t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  \tconstructHook.fire(ractive, options);\n\n  \t// Add registries\n  \tregistryNames$1.forEach(function (name) {\n  \t\tractive[name] = extendObj(create(ractive.constructor[name] || null), options[name]);\n  \t});\n\n  \t// Create a viewmodel\n  \tvar viewmodel = new RootModel({\n  \t\tadapt: getAdaptors(ractive, ractive.adapt, options),\n  \t\tdata: dataConfigurator.init(ractive.constructor, ractive, options),\n  \t\tractive: ractive\n  \t});\n\n  \tractive.viewmodel = viewmodel;\n\n  \t// Add computed properties\n  \tvar computed = extendObj(create(ractive.constructor.prototype.computed), options.computed);\n\n  \tfor (var key in computed) {\n  \t\tvar signature = getComputationSignature(ractive, key, computed[key]);\n  \t\tviewmodel.compute(key, signature);\n  \t}\n  }\n\n  function combine$2(a, b) {\n  \tvar c = a.slice();\n  \tvar i = b.length;\n\n  \twhile (i--) {\n  \t\tif (! ~c.indexOf(b[i])) {\n  \t\t\tc.push(b[i]);\n  \t\t}\n  \t}\n\n  \treturn c;\n  }\n\n  function getAdaptors(ractive, protoAdapt, options) {\n  \tprotoAdapt = protoAdapt.map(lookup);\n  \tvar adapt = ensureArray(options.adapt).map(lookup);\n\n  \tadapt = combine$2(protoAdapt, adapt);\n\n  \tvar magic = 'magic' in options ? options.magic : ractive.magic;\n  \tvar modifyArrays = 'modifyArrays' in options ? options.modifyArrays : ractive.modifyArrays;\n\n  \tif (magic) {\n  \t\tif (!magicSupported) {\n  \t\t\tthrow new Error('Getters and setters (magic mode) are not supported in this browser');\n  \t\t}\n\n  \t\tif (modifyArrays) {\n  \t\t\tadapt.push(magicArrayAdaptor);\n  \t\t}\n\n  \t\tadapt.push(magicAdaptor$1);\n  \t}\n\n  \tif (modifyArrays) {\n  \t\tadapt.push(arrayAdaptor);\n  \t}\n\n  \treturn adapt;\n\n  \tfunction lookup(adaptor) {\n  \t\tif (typeof adaptor === 'string') {\n  \t\t\tadaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n  \t\t\tif (!adaptor) {\n  \t\t\t\tfatal(missingPlugin(adaptor, 'adaptor'));\n  \t\t\t}\n  \t\t}\n\n  \t\treturn adaptor;\n  \t}\n  }\n\n  function initialiseProperties(ractive) {\n  \t// Generate a unique identifier, for places where you'd use a weak map if it\n  \t// existed\n  \tractive._guid = 'r-' + uid++;\n\n  \t// events\n  \tractive._subs = create(null);\n\n  \t// storage for item configuration from instantiation to reset,\n  \t// like dynamic functions or original values\n  \tractive._config = {};\n\n  \t// nodes registry\n  \tractive.nodes = {};\n\n  \t// events\n  \tractive.event = null;\n  \tractive._eventQueue = [];\n\n  \t// live queries\n  \tractive._liveQueries = [];\n  \tractive._liveComponentQueries = [];\n\n  \t// observers\n  \tractive._observers = [];\n\n  \t// links\n  \tractive._links = {};\n\n  \tif (!ractive.component) {\n  \t\tractive.root = ractive;\n  \t\tractive.parent = ractive.container = null; // TODO container still applicable?\n  \t}\n  }\n\n  function deprecateRactiveData() {\n  \tthrow new Error('Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead');\n  }\n\n  function getChildQueue(queue, ractive) {\n  \treturn queue[ractive._guid] || (queue[ractive._guid] = []);\n  }\n\n  function fire(hookQueue, ractive) {\n  \tvar childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  \thookQueue.hook.fire(ractive);\n\n  \t// queue is \"live\" because components can end up being\n  \t// added while hooks fire on parents that modify data values.\n  \twhile (childQueue.length) {\n  \t\tfire(hookQueue, childQueue.shift());\n  \t}\n\n  \tdelete hookQueue.queue[ractive._guid];\n  }\n\n  var HookQueue = function () {\n  \tfunction HookQueue(event) {\n  \t\tbabelHelpers.classCallCheck(this, HookQueue);\n\n  \t\tthis.hook = new Hook(event);\n  \t\tthis.inProcess = {};\n  \t\tthis.queue = {};\n  \t}\n\n  \tHookQueue.prototype.begin = function begin(ractive) {\n  \t\tthis.inProcess[ractive._guid] = true;\n  \t};\n\n  \tHookQueue.prototype.end = function end(ractive) {\n  \t\tvar parent = ractive.parent;\n\n  \t\t// If this is *isn't* a child of a component that's in process,\n  \t\t// it should call methods or fire at this point\n  \t\tif (!parent || !this.inProcess[parent._guid]) {\n  \t\t\tfire(this, ractive);\n  \t\t}\n  \t\t// elsewise, handoff to parent to fire when ready\n  \t\telse {\n  \t\t\t\tgetChildQueue(this.queue, parent).push(ractive);\n  \t\t\t}\n\n  \t\tdelete this.inProcess[ractive._guid];\n  \t};\n\n  \treturn HookQueue;\n  }();\n\n  var configHook = new Hook('config');\n  var initHook = new HookQueue('init');\n\n  function initialise(ractive, userOptions, options) {\n  \tObject.keys(ractive.viewmodel.computations).forEach(function (key) {\n  \t\tvar computation = ractive.viewmodel.computations[key];\n\n  \t\tif (ractive.viewmodel.value.hasOwnProperty(key)) {\n  \t\t\tcomputation.set(ractive.viewmodel.value[key]);\n  \t\t}\n  \t});\n\n  \t// init config from Parent and options\n  \tconfig.init(ractive.constructor, ractive, userOptions);\n\n  \tconfigHook.fire(ractive);\n  \tinitHook.begin(ractive);\n\n  \tvar fragment = void 0;\n\n  \t// Render virtual DOM\n  \tif (ractive.template) {\n  \t\tvar cssIds = void 0;\n\n  \t\tif (options.cssIds || ractive.cssId) {\n  \t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n  \t\t\tif (ractive.cssId) {\n  \t\t\t\tcssIds.push(ractive.cssId);\n  \t\t\t}\n  \t\t}\n\n  \t\tractive.fragment = fragment = new Fragment({\n  \t\t\towner: ractive,\n  \t\t\ttemplate: ractive.template,\n  \t\t\tcssIds: cssIds\n  \t\t}).bind(ractive.viewmodel);\n  \t}\n\n  \tinitHook.end(ractive);\n\n  \tif (fragment) {\n  \t\t// render automatically ( if `el` is specified )\n  \t\tvar el = getElement(ractive.el);\n  \t\tif (el) {\n  \t\t\tvar promise = ractive.render(el, ractive.append);\n\n  \t\t\tif (Ractive.DEBUG_PROMISES) {\n  \t\t\t\tpromise.catch(function (err) {\n  \t\t\t\t\twarnOnceIfDebug('Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;');\n  \t\t\t\t\twarnIfDebug('An error happened during rendering', { ractive: ractive });\n  \t\t\t\t\tlogIfDebug(err);\n\n  \t\t\t\t\tthrow err;\n  \t\t\t\t});\n  \t\t\t}\n  \t\t}\n  \t}\n  }\n\n  var Parser;\n  var ParseError;\n  var leadingWhitespace = /^\\s+/;\n  ParseError = function ParseError(message) {\n  \tthis.name = 'ParseError';\n  \tthis.message = message;\n  \ttry {\n  \t\tthrow new Error(message);\n  \t} catch (e) {\n  \t\tthis.stack = e.stack;\n  \t}\n  };\n\n  ParseError.prototype = Error.prototype;\n\n  Parser = function Parser(str, options) {\n  \tvar items,\n  \t    item,\n  \t    lineStart = 0;\n\n  \tthis.str = str;\n  \tthis.options = options || {};\n  \tthis.pos = 0;\n\n  \tthis.lines = this.str.split('\\n');\n  \tthis.lineEnds = this.lines.map(function (line) {\n  \t\tvar lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n  \t\tlineStart = lineEnd;\n  \t\treturn lineEnd;\n  \t}, 0);\n\n  \t// Custom init logic\n  \tif (this.init) this.init(str, options);\n\n  \titems = [];\n\n  \twhile (this.pos < this.str.length && (item = this.read())) {\n  \t\titems.push(item);\n  \t}\n\n  \tthis.leftover = this.remaining();\n  \tthis.result = this.postProcess ? this.postProcess(items, options) : items;\n  };\n\n  Parser.prototype = {\n  \tread: function read(converters) {\n  \t\tvar pos, i, len, item;\n\n  \t\tif (!converters) converters = this.converters;\n\n  \t\tpos = this.pos;\n\n  \t\tlen = converters.length;\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tthis.pos = pos; // reset for each attempt\n\n  \t\t\tif (item = converters[i](this)) {\n  \t\t\t\treturn item;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn null;\n  \t},\n\n  \tgetLinePos: function getLinePos(char) {\n  \t\tvar lineNum = 0,\n  \t\t    lineStart = 0,\n  \t\t    columnNum;\n\n  \t\twhile (char >= this.lineEnds[lineNum]) {\n  \t\t\tlineStart = this.lineEnds[lineNum];\n  \t\t\tlineNum += 1;\n  \t\t}\n\n  \t\tcolumnNum = char - lineStart;\n  \t\treturn [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  \t},\n\n  \terror: function error(message) {\n  \t\tvar pos = this.getLinePos(this.pos);\n  \t\tvar lineNum = pos[0];\n  \t\tvar columnNum = pos[1];\n\n  \t\tvar line = this.lines[pos[0] - 1];\n  \t\tvar numTabs = 0;\n  \t\tvar annotation = line.replace(/\\t/g, function (match, char) {\n  \t\t\tif (char < pos[1]) {\n  \t\t\t\tnumTabs += 1;\n  \t\t\t}\n\n  \t\t\treturn '  ';\n  \t\t}) + '\\n' + new Array(pos[1] + numTabs).join(' ') + '^----';\n\n  \t\tvar error = new ParseError(message + ' at line ' + lineNum + ' character ' + columnNum + ':\\n' + annotation);\n\n  \t\terror.line = pos[0];\n  \t\terror.character = pos[1];\n  \t\terror.shortMessage = message;\n\n  \t\tthrow error;\n  \t},\n\n  \tmatchString: function matchString(string) {\n  \t\tif (this.str.substr(this.pos, string.length) === string) {\n  \t\t\tthis.pos += string.length;\n  \t\t\treturn string;\n  \t\t}\n  \t},\n\n  \tmatchPattern: function matchPattern(pattern) {\n  \t\tvar match;\n\n  \t\tif (match = pattern.exec(this.remaining())) {\n  \t\t\tthis.pos += match[0].length;\n  \t\t\treturn match[1] || match[0];\n  \t\t}\n  \t},\n\n  \tallowWhitespace: function allowWhitespace() {\n  \t\tthis.matchPattern(leadingWhitespace);\n  \t},\n\n  \tremaining: function remaining() {\n  \t\treturn this.str.substring(this.pos);\n  \t},\n\n  \tnextChar: function nextChar() {\n  \t\treturn this.str.charAt(this.pos);\n  \t}\n  };\n\n  Parser.extend = function (proto) {\n  \tvar Parent = this,\n  \t    Child,\n  \t    key;\n\n  \tChild = function Child(str, options) {\n  \t\tParser.call(this, str, options);\n  \t};\n\n  \tChild.prototype = create(Parent.prototype);\n\n  \tfor (key in proto) {\n  \t\tif (hasOwn.call(proto, key)) {\n  \t\t\tChild.prototype[key] = proto[key];\n  \t\t}\n  \t}\n\n  \tChild.extend = Parser.extend;\n  \treturn Child;\n  };\n\n  var Parser$1 = Parser;\n\n  var stringMiddlePattern;\n  var escapeSequencePattern;\n  var lineContinuationPattern;\n  // Match one or more characters until: \", ', \\, or EOL/EOF.\n  // EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\n  stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n  // Match one escape sequence, including the backslash.\n  escapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n  // Match one ES5 line continuation (backslash + line terminator).\n  lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n  // Helper for defining getDoubleQuotedString and getSingleQuotedString.\n  function makeQuotedStringMatcher (okQuote) {\n  \treturn function (parser) {\n  \t\tvar literal = '\"';\n  \t\tvar done = false;\n  \t\tvar next = void 0;\n\n  \t\twhile (!done) {\n  \t\t\tnext = parser.matchPattern(stringMiddlePattern) || parser.matchPattern(escapeSequencePattern) || parser.matchString(okQuote);\n  \t\t\tif (next) {\n  \t\t\t\tif (next === '\"') {\n  \t\t\t\t\tliteral += '\\\\\"';\n  \t\t\t\t} else if (next === '\\\\\\'') {\n  \t\t\t\t\tliteral += '\\'';\n  \t\t\t\t} else {\n  \t\t\t\t\tliteral += next;\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tnext = parser.matchPattern(lineContinuationPattern);\n  \t\t\t\tif (next) {\n  \t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n  \t\t\t\t\tliteral += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n  \t\t\t\t} else {\n  \t\t\t\t\tdone = true;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tliteral += '\"';\n\n  \t\t// use JSON.parse to interpret escapes\n  \t\treturn JSON.parse(literal);\n  \t};\n  }\n\n  var getSingleQuotedString = makeQuotedStringMatcher('\"');\n  var getDoubleQuotedString = makeQuotedStringMatcher('\\'');\n\n  function readStringLiteral (parser) {\n  \tvar start, string;\n\n  \tstart = parser.pos;\n\n  \tif (parser.matchString('\"')) {\n  \t\tstring = getDoubleQuotedString(parser);\n\n  \t\tif (!parser.matchString('\"')) {\n  \t\t\tparser.pos = start;\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn {\n  \t\t\tt: STRING_LITERAL,\n  \t\t\tv: string\n  \t\t};\n  \t}\n\n  \tif (parser.matchString('\\'')) {\n  \t\tstring = getSingleQuotedString(parser);\n\n  \t\tif (!parser.matchString('\\'')) {\n  \t\t\tparser.pos = start;\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn {\n  \t\t\tt: STRING_LITERAL,\n  \t\t\tv: string\n  \t\t};\n  \t}\n\n  \treturn null;\n  }\n\n  // bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\n  var numberPattern$1 = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\n  function readNumberLiteral(parser) {\n  \tvar result;\n\n  \tif (result = parser.matchPattern(numberPattern$1)) {\n  \t\treturn {\n  \t\t\tt: NUMBER_LITERAL,\n  \t\t\tv: result\n  \t\t};\n  \t}\n\n  \treturn null;\n  }\n\n  var name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\n\n  var identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n  // http://mathiasbynens.be/notes/javascript-properties\n  // can be any name, string literal, or number literal\n  function readKey(parser) {\n  \tvar token;\n\n  \tif (token = readStringLiteral(parser)) {\n  \t\treturn identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  \t}\n\n  \tif (token = readNumberLiteral(parser)) {\n  \t\treturn token.v;\n  \t}\n\n  \tif (token = parser.matchPattern(name)) {\n  \t\treturn token;\n  \t}\n\n  \treturn null;\n  }\n\n  // simple JSON parser, without the restrictions of JSON parse\n  // (i.e. having to double-quote keys).\n  //\n  // If passed a hash of values as the second argument, ${placeholders}\n  // will be replaced with those values\n\n  var specials = {\n  \ttrue: true,\n  \tfalse: false,\n  \tnull: null,\n  \tundefined: undefined\n  };\n\n  var specialsPattern = new RegExp('^(?:' + Object.keys(specials).join('|') + ')');\n  var numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n  var placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\n  var placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\n  var onlyWhitespace = /^\\s*$/;\n\n  var JsonParser = Parser$1.extend({\n  \tinit: function init(str, options) {\n  \t\tthis.values = options.values;\n  \t\tthis.allowWhitespace();\n  \t},\n  \tpostProcess: function postProcess(result) {\n  \t\tif (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn { value: result[0].v };\n  \t},\n\n\n  \tconverters: [function getPlaceholder(parser) {\n  \t\tif (!parser.values) return null;\n\n  \t\tvar placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n  \t\tif (placeholder && parser.values.hasOwnProperty(placeholder)) {\n  \t\t\treturn { v: parser.values[placeholder] };\n  \t\t}\n  \t}, function getSpecial(parser) {\n  \t\tvar special = parser.matchPattern(specialsPattern);\n  \t\tif (special) return { v: specials[special] };\n  \t}, function getNumber(parser) {\n  \t\tvar number = parser.matchPattern(numberPattern);\n  \t\tif (number) return { v: +number };\n  \t}, function getString(parser) {\n  \t\tvar stringLiteral = readStringLiteral(parser);\n  \t\tvar values = parser.values;\n\n  \t\tif (stringLiteral && values) {\n  \t\t\treturn {\n  \t\t\t\tv: stringLiteral.v.replace(placeholderPattern, function (match, $1) {\n  \t\t\t\t\treturn $1 in values ? values[$1] : $1;\n  \t\t\t\t})\n  \t\t\t};\n  \t\t}\n\n  \t\treturn stringLiteral;\n  \t}, function getObject(parser) {\n  \t\tif (!parser.matchString('{')) return null;\n\n  \t\tvar result = {};\n\n  \t\tparser.allowWhitespace();\n\n  \t\tif (parser.matchString('}')) {\n  \t\t\treturn { v: result };\n  \t\t}\n\n  \t\tvar pair = void 0;\n  \t\twhile (pair = getKeyValuePair(parser)) {\n  \t\t\tresult[pair.key] = pair.value;\n\n  \t\t\tparser.allowWhitespace();\n\n  \t\t\tif (parser.matchString('}')) {\n  \t\t\t\treturn { v: result };\n  \t\t\t}\n\n  \t\t\tif (!parser.matchString(',')) {\n  \t\t\t\treturn null;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn null;\n  \t}, function getArray(parser) {\n  \t\tif (!parser.matchString('[')) return null;\n\n  \t\tvar result = [];\n\n  \t\tparser.allowWhitespace();\n\n  \t\tif (parser.matchString(']')) {\n  \t\t\treturn { v: result };\n  \t\t}\n\n  \t\tvar valueToken = void 0;\n  \t\twhile (valueToken = parser.read()) {\n  \t\t\tresult.push(valueToken.v);\n\n  \t\t\tparser.allowWhitespace();\n\n  \t\t\tif (parser.matchString(']')) {\n  \t\t\t\treturn { v: result };\n  \t\t\t}\n\n  \t\t\tif (!parser.matchString(',')) {\n  \t\t\t\treturn null;\n  \t\t\t}\n\n  \t\t\tparser.allowWhitespace();\n  \t\t}\n\n  \t\treturn null;\n  \t}]\n  });\n\n  function getKeyValuePair(parser) {\n  \tparser.allowWhitespace();\n\n  \tvar key = readKey(parser);\n\n  \tif (!key) return null;\n\n  \tvar pair = { key: key };\n\n  \tparser.allowWhitespace();\n  \tif (!parser.matchString(':')) {\n  \t\treturn null;\n  \t}\n  \tparser.allowWhitespace();\n\n  \tvar valueToken = parser.read();\n\n  \tif (!valueToken) return null;\n\n  \tpair.value = valueToken.v;\n  \treturn pair;\n  }\n\n  function parseJSON (str, values) {\n  \tvar parser = new JsonParser(str, { values: values });\n  \treturn parser.result;\n  }\n\n  function gatherRefs(fragment) {\n  \tvar key = {},\n  \t    index = {};\n\n  \t// walk up the template gather refs as we go\n  \twhile (fragment) {\n  \t\tif (fragment.parent && (fragment.parent.indexRef || fragment.parent.keyRef)) {\n  \t\t\tvar ref = fragment.parent.indexRef;\n  \t\t\tif (ref && !(ref in index)) index[ref] = fragment.index;\n  \t\t\tref = fragment.parent.keyRef;\n  \t\t\tif (ref && !(ref in key)) key[ref] = fragment.key;\n  \t\t}\n\n  \t\tif (fragment.componentParent && !fragment.ractive.isolated) {\n  \t\t\tfragment = fragment.componentParent;\n  \t\t} else {\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n  \t}\n\n  \treturn { key: key, index: index };\n  }\n\n  var eventPattern = /^event(?:\\.(.+))?$/;\n  var argumentsPattern = /^arguments\\.(\\d*)$/;\n  var dollarArgsPattern = /^\\$(\\d*)$/;\n\n  var EventDirective = function () {\n  \tfunction EventDirective(owner, event, template) {\n  \t\tbabelHelpers.classCallCheck(this, EventDirective);\n\n  \t\tthis.owner = owner;\n  \t\tthis.event = event;\n  \t\tthis.template = template;\n\n  \t\tthis.ractive = owner.parentFragment.ractive;\n  \t\tthis.parentFragment = owner.parentFragment;\n\n  \t\tthis.context = null;\n  \t\tthis.passthru = false;\n\n  \t\t// method calls\n  \t\tthis.method = null;\n  \t\tthis.resolvers = null;\n  \t\tthis.models = null;\n  \t\tthis.argsFn = null;\n\n  \t\t// handler directive\n  \t\tthis.action = null;\n  \t\tthis.args = null;\n  \t}\n\n  \tEventDirective.prototype.bind = function bind() {\n  \t\tvar _this = this;\n\n  \t\tthis.context = this.parentFragment.findContext();\n\n  \t\tvar template = this.template;\n\n  \t\tif (template.m) {\n  \t\t\tthis.method = template.m;\n\n  \t\t\t// pass-thru \"...arguments\"\n  \t\t\tthis.passthru = !!template.g;\n\n  \t\t\tif (template.a) {\n  \t\t\t\tthis.resolvers = [];\n  \t\t\t\tthis.models = template.a.r.map(function (ref, i) {\n\n  \t\t\t\t\tif (eventPattern.test(ref)) {\n  \t\t\t\t\t\t// on-click=\"foo(event.node)\"\n  \t\t\t\t\t\treturn {\n  \t\t\t\t\t\t\tevent: true,\n  \t\t\t\t\t\t\tkeys: ref.length > 5 ? splitKeypathI(ref.slice(6)) : [],\n  \t\t\t\t\t\t\tunbind: noop\n  \t\t\t\t\t\t};\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar argMatch = argumentsPattern.exec(ref);\n  \t\t\t\t\tif (argMatch) {\n  \t\t\t\t\t\t// on-click=\"foo(arguments[0])\"\n  \t\t\t\t\t\treturn {\n  \t\t\t\t\t\t\targument: true,\n  \t\t\t\t\t\t\tindex: argMatch[1]\n  \t\t\t\t\t\t};\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar dollarMatch = dollarArgsPattern.exec(ref);\n  \t\t\t\t\tif (dollarMatch) {\n  \t\t\t\t\t\t// on-click=\"foo($1)\"\n  \t\t\t\t\t\treturn {\n  \t\t\t\t\t\t\targument: true,\n  \t\t\t\t\t\t\tindex: dollarMatch[1] - 1\n  \t\t\t\t\t\t};\n  \t\t\t\t\t}\n\n  \t\t\t\t\tvar resolver = void 0;\n\n  \t\t\t\t\tvar model = resolveReference(_this.parentFragment, ref);\n  \t\t\t\t\tif (!model) {\n  \t\t\t\t\t\tresolver = _this.parentFragment.resolve(ref, function (model) {\n  \t\t\t\t\t\t\t_this.models[i] = model;\n  \t\t\t\t\t\t\tremoveFromArray(_this.resolvers, resolver);\n  \t\t\t\t\t\t});\n\n  \t\t\t\t\t\t_this.resolvers.push(resolver);\n  \t\t\t\t\t}\n\n  \t\t\t\t\treturn model;\n  \t\t\t\t});\n\n  \t\t\t\tthis.argsFn = getFunction(template.a.s, template.a.r.length);\n  \t\t\t}\n  \t\t} else {\n  \t\t\t// TODO deprecate this style of directive\n  \t\t\tthis.action = typeof template === 'string' ? // on-click='foo'\n  \t\t\ttemplate : typeof template.n === 'string' ? // on-click='{{dynamic}}'\n  \t\t\ttemplate.n : new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.n\n  \t\t\t});\n\n  \t\t\tthis.args = template.a ? // static arguments\n  \t\t\ttypeof template.a === 'string' ? [template.a] : template.a : template.d ? // dynamic arguments\n  \t\t\tnew Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.d\n  \t\t\t}) : []; // no arguments\n  \t\t}\n\n  \t\tif (this.template.n && typeof this.template.n !== 'string') this.action.bind();\n  \t\tif (this.template.d) this.args.bind();\n  \t};\n\n  \tEventDirective.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.owner.bubble();\n  \t\t}\n  \t};\n\n  \tEventDirective.prototype.fire = function fire(event) {\n  \t\tvar passedArgs = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n\n  \t\t// augment event object\n  \t\tif (event) {\n  \t\t\tvar refs = gatherRefs(this.parentFragment);\n  \t\t\tevent.keypath = this.context.getKeypath(this.ractive);\n  \t\t\tevent.rootpath = this.context.getKeypath();\n  \t\t\tevent.context = this.context.get();\n  \t\t\tevent.index = refs.index;\n  \t\t\tevent.key = refs.key;\n  \t\t}\n\n  \t\tif (this.method) {\n  \t\t\tif (typeof this.ractive[this.method] !== 'function') {\n  \t\t\t\tthrow new Error('Attempted to call a non-existent method (\"' + this.method + '\")');\n  \t\t\t}\n\n  \t\t\tvar args = void 0;\n\n  \t\t\tif (event) passedArgs.unshift(event);\n\n  \t\t\tif (this.models) {\n  \t\t\t\tvar values = this.models.map(function (model) {\n  \t\t\t\t\tif (!model) return undefined;\n\n  \t\t\t\t\tif (model.event) {\n  \t\t\t\t\t\tvar obj = event;\n  \t\t\t\t\t\tvar keys = model.keys.slice();\n\n  \t\t\t\t\t\twhile (keys.length) {\n  \t\t\t\t\t\t\tobj = obj[keys.shift()];\n  \t\t\t\t\t\t}return obj;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (model.argument) {\n  \t\t\t\t\t\treturn passedArgs ? passedArgs[model.index] : void 0;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (model.wrapper) {\n  \t\t\t\t\t\treturn model.wrapper.value;\n  \t\t\t\t\t}\n\n  \t\t\t\t\treturn model.get();\n  \t\t\t\t});\n\n  \t\t\t\targs = this.argsFn.apply(null, values);\n  \t\t\t}\n\n  \t\t\tif (this.passthru) {\n  \t\t\t\targs = args ? args.concat(passedArgs) : passedArgs;\n  \t\t\t}\n\n  \t\t\t// make event available as `this.event`\n  \t\t\tvar ractive = this.ractive;\n  \t\t\tvar oldEvent = ractive.event;\n\n  \t\t\tractive.event = event;\n  \t\t\tvar result = ractive[this.method].apply(ractive, args);\n\n  \t\t\t// Auto prevent and stop if return is explicitly false\n  \t\t\tvar original = void 0;\n  \t\t\tif (result === false && (original = event.original)) {\n  \t\t\t\toriginal.preventDefault && original.preventDefault();\n  \t\t\t\toriginal.stopPropagation && original.stopPropagation();\n  \t\t\t}\n\n  \t\t\tractive.event = oldEvent;\n  \t\t} else {\n  \t\t\tvar action = this.action.toString();\n  \t\t\tvar _args = this.template.d ? this.args.getArgsList() : this.args;\n\n  \t\t\tif (passedArgs.length) _args = _args.concat(passedArgs);\n\n  \t\t\tif (event) event.name = action;\n\n  \t\t\tfireEvent(this.ractive, action, {\n  \t\t\t\tevent: event,\n  \t\t\t\targs: _args\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tEventDirective.prototype.rebind = function rebind() {\n  \t\tthis.unbind();\n  \t\tthis.bind();\n  \t};\n\n  \tEventDirective.prototype.render = function render() {\n  \t\tthis.event.listen(this);\n  \t};\n\n  \tEventDirective.prototype.unbind = function unbind() {\n  \t\tvar template = this.template;\n\n  \t\tif (template.m) {\n  \t\t\tif (this.resolvers) this.resolvers.forEach(_unbind);\n  \t\t\tthis.resolvers = [];\n\n  \t\t\tthis.models = null;\n  \t\t} else {\n  \t\t\t// TODO this is brittle and non-explicit, fix it\n  \t\t\tif (this.action.unbind) this.action.unbind();\n  \t\t\tif (this.args.unbind) this.args.unbind();\n  \t\t}\n  \t};\n\n  \tEventDirective.prototype.unrender = function unrender() {\n  \t\tthis.event.unlisten();\n  \t};\n\n  \tEventDirective.prototype.update = function update() {\n  \t\tif (this.method || !this.dirty) return; // nothing to do\n\n  \t\tthis.dirty = false;\n\n  \t\t// ugh legacy\n  \t\tif (this.action.update) this.action.update();\n  \t\tif (this.template.d) this.args.update();\n  \t};\n\n  \treturn EventDirective;\n  }();\n\n  var RactiveEvent = function () {\n  \tfunction RactiveEvent(ractive, name) {\n  \t\tbabelHelpers.classCallCheck(this, RactiveEvent);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.name = name;\n  \t\tthis.handler = null;\n  \t}\n\n  \tRactiveEvent.prototype.listen = function listen(directive) {\n  \t\tvar ractive = this.ractive;\n\n  \t\tthis.handler = ractive.on(this.name, function () {\n  \t\t\tvar event = void 0;\n\n  \t\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n  \t\t\tif (arguments.length && arguments[0] && arguments[0].node) {\n  \t\t\t\tevent = Array.prototype.shift.call(arguments);\n  \t\t\t\tevent.component = ractive;\n  \t\t\t}\n\n  \t\t\tvar args = Array.prototype.slice.call(arguments);\n  \t\t\tdirective.fire(event, args);\n\n  \t\t\t// cancel bubbling\n  \t\t\treturn false;\n  \t\t});\n  \t};\n\n  \tRactiveEvent.prototype.unlisten = function unlisten() {\n  \t\tthis.handler.cancel();\n  \t};\n\n  \treturn RactiveEvent;\n  }();\n\n  // TODO it's unfortunate that this has to run every time a\n  // component is rendered... is there a better way?\n  function updateLiveQueries(component) {\n  \t// Does this need to be added to any live queries?\n  \tvar instance = component.ractive;\n\n  \tdo {\n  \t\tvar liveQueries = instance._liveComponentQueries;\n\n  \t\tvar i = liveQueries.length;\n  \t\twhile (i--) {\n  \t\t\tvar name = liveQueries[i];\n  \t\t\tvar query = liveQueries[\"_\" + name];\n\n  \t\t\tif (query.test(component)) {\n  \t\t\t\tquery.add(component.instance);\n  \t\t\t\t// keep register of applicable selectors, for when we teardown\n  \t\t\t\tcomponent.liveQueries.push(query);\n  \t\t\t}\n  \t\t}\n  \t} while (instance = instance.parent);\n  }\n\n  function removeFromLiveComponentQueries(component) {\n  \tvar instance = component.ractive;\n\n  \twhile (instance) {\n  \t\tvar query = instance._liveComponentQueries['_' + component.name];\n  \t\tif (query) query.remove(component);\n\n  \t\tinstance = instance.parent;\n  \t}\n  }\n\n  function makeDirty(query) {\n  \tquery.makeDirty();\n  }\n\n  var teardownHook = new Hook('teardown');\n\n  var Component = function (_Item) {\n  \tbabelHelpers.inherits(Component, _Item);\n\n  \tfunction Component(options, ComponentConstructor) {\n  \t\tbabelHelpers.classCallCheck(this, Component);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.type = COMPONENT; // override ELEMENT from super\n\n  \t\tvar instance = create(ComponentConstructor.prototype);\n\n  \t\t_this.instance = instance;\n  \t\t_this.name = options.template.e;\n  \t\t_this.parentFragment = options.parentFragment;\n  \t\t_this.complexMappings = [];\n\n  \t\t_this.liveQueries = [];\n\n  \t\tif (instance.el) {\n  \t\t\twarnIfDebug('The <' + _this.name + '> component has a default \\'el\\' property; it has been disregarded');\n  \t\t}\n\n  \t\tvar partials = options.template.p || {};\n  \t\tif (!('content' in partials)) partials.content = options.template.f || [];\n  \t\t_this._partials = partials; // TEMP\n\n  \t\t_this.yielders = {};\n\n  \t\t// find container\n  \t\tvar fragment = options.parentFragment;\n  \t\tvar container = void 0;\n  \t\twhile (fragment) {\n  \t\t\tif (fragment.owner.type === YIELDER) {\n  \t\t\t\tcontainer = fragment.owner.container;\n  \t\t\t\tbreak;\n  \t\t\t}\n\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n\n  \t\t// add component-instance-specific properties\n  \t\tinstance.parent = _this.parentFragment.ractive;\n  \t\tinstance.container = container || null;\n  \t\tinstance.root = instance.parent.root;\n  \t\tinstance.component = _this;\n\n  \t\tconstruct(_this.instance, { partials: partials });\n\n  \t\t// for hackability, this could be an open option\n  \t\t// for any ractive instance, but for now, just\n  \t\t// for components and just for ractive...\n  \t\tinstance._inlinePartials = partials;\n\n  \t\t_this.eventHandlers = [];\n  \t\tif (_this.template.v) _this.setupEvents();\n  \t\treturn _this;\n  \t}\n\n  \tComponent.prototype.bind = function bind() {\n  \t\tvar _this2 = this;\n\n  \t\tvar viewmodel = this.instance.viewmodel;\n  \t\tvar childData = viewmodel.value;\n\n  \t\t// determine mappings\n  \t\tif (this.template.a) {\n  \t\t\tObject.keys(this.template.a).forEach(function (localKey) {\n  \t\t\t\tvar template = _this2.template.a[localKey];\n  \t\t\t\tvar model = void 0;\n  \t\t\t\tvar fragment = void 0;\n\n  \t\t\t\tif (template === 0) {\n  \t\t\t\t\t// empty attributes are `true`\n  \t\t\t\t\tviewmodel.joinKey(localKey).set(true);\n  \t\t\t\t} else if (typeof template === 'string') {\n  \t\t\t\t\tvar parsed = parseJSON(template);\n  \t\t\t\t\tviewmodel.joinKey(localKey).set(parsed ? parsed.value : template);\n  \t\t\t\t} else if (isArray(template)) {\n  \t\t\t\t\tif (template.length === 1 && template[0].t === INTERPOLATOR) {\n  \t\t\t\t\t\tmodel = resolve$1(_this2.parentFragment, template[0]);\n\n  \t\t\t\t\t\tif (!model) {\n  \t\t\t\t\t\t\twarnOnceIfDebug('The ' + localKey + '=\\'{{' + template[0].r + '}}\\' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity', { ractive: _this2.instance }); // TODO add docs page explaining this\n  \t\t\t\t\t\t\t_this2.parentFragment.ractive.get(localKey); // side-effect: create mappings as necessary\n  \t\t\t\t\t\t\tmodel = _this2.parentFragment.findContext().joinKey(localKey);\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tviewmodel.map(localKey, model);\n\n  \t\t\t\t\t\tif (model.get() === undefined && localKey in childData) {\n  \t\t\t\t\t\t\tmodel.set(childData[localKey]);\n  \t\t\t\t\t\t}\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tfragment = new Fragment({\n  \t\t\t\t\t\t\towner: _this2,\n  \t\t\t\t\t\t\ttemplate: template\n  \t\t\t\t\t\t}).bind();\n\n  \t\t\t\t\t\tmodel = viewmodel.joinKey(localKey);\n  \t\t\t\t\t\tmodel.set(fragment.valueOf());\n\n  \t\t\t\t\t\t// this is a *bit* of a hack\n  \t\t\t\t\t\tfragment.bubble = function () {\n  \t\t\t\t\t\t\tFragment.prototype.bubble.call(fragment);\n  \t\t\t\t\t\t\tfragment.update();\n  \t\t\t\t\t\t\tmodel.set(fragment.valueOf());\n  \t\t\t\t\t\t};\n\n  \t\t\t\t\t\t_this2.complexMappings.push(fragment);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t});\n  \t\t}\n\n  \t\tinitialise(this.instance, {\n  \t\t\tpartials: this._partials\n  \t\t}, {\n  \t\t\tcssIds: this.parentFragment.cssIds\n  \t\t});\n\n  \t\tthis.eventHandlers.forEach(_bind);\n  \t};\n\n  \tComponent.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.parentFragment.bubble();\n  \t\t}\n  \t};\n\n  \tComponent.prototype.checkYielders = function checkYielders() {\n  \t\tvar _this3 = this;\n\n  \t\tObject.keys(this.yielders).forEach(function (name) {\n  \t\t\tif (_this3.yielders[name].length > 1) {\n  \t\t\t\trunloop.end();\n  \t\t\t\tthrow new Error('A component template can only have one {{yield' + (name ? ' ' + name : '') + '}} declaration at a time');\n  \t\t\t}\n  \t\t});\n  \t};\n\n  \tComponent.prototype.detach = function detach() {\n  \t\treturn this.instance.fragment.detach();\n  \t};\n\n  \tComponent.prototype.find = function find(selector) {\n  \t\treturn this.instance.fragment.find(selector);\n  \t};\n\n  \tComponent.prototype.findAll = function findAll(selector, query) {\n  \t\tthis.instance.fragment.findAll(selector, query);\n  \t};\n\n  \tComponent.prototype.findComponent = function findComponent(name) {\n  \t\tif (!name || this.name === name) return this.instance;\n\n  \t\tif (this.instance.fragment) {\n  \t\t\treturn this.instance.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tComponent.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (query.test(this)) {\n  \t\t\tquery.add(this.instance);\n\n  \t\t\tif (query.live) {\n  \t\t\t\tthis.liveQueries.push(query);\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.instance.fragment.findAllComponents(name, query);\n  \t};\n\n  \tComponent.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.instance.fragment.firstNode(skipParent);\n  \t};\n\n  \tComponent.prototype.rebind = function rebind() {\n  \t\tvar _this4 = this;\n\n  \t\tthis.complexMappings.forEach(_rebind);\n\n  \t\tthis.liveQueries.forEach(makeDirty);\n\n  \t\t// update relevant mappings\n  \t\tvar viewmodel = this.instance.viewmodel;\n  \t\tviewmodel.mappings = {};\n\n  \t\tif (this.template.a) {\n  \t\t\tObject.keys(this.template.a).forEach(function (localKey) {\n  \t\t\t\tvar template = _this4.template.a[localKey];\n  \t\t\t\tvar model = void 0;\n\n  \t\t\t\tif (isArray(template) && template.length === 1 && template[0].t === INTERPOLATOR) {\n  \t\t\t\t\tmodel = resolve$1(_this4.parentFragment, template[0]);\n\n  \t\t\t\t\tif (!model) {\n  \t\t\t\t\t\t// TODO is this even possible?\n  \t\t\t\t\t\twarnOnceIfDebug('The ' + localKey + '=\\'{{' + template[0].r + '}}\\' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity', { ractive: _this4.instance });\n  \t\t\t\t\t\t_this4.parentFragment.ractive.get(localKey); // side-effect: create mappings as necessary\n  \t\t\t\t\t\tmodel = _this4.parentFragment.findContext().joinKey(localKey);\n  \t\t\t\t\t}\n\n  \t\t\t\t\tviewmodel.map(localKey, model);\n  \t\t\t\t}\n  \t\t\t});\n  \t\t}\n\n  \t\tthis.instance.fragment.rebind(viewmodel);\n  \t};\n\n  \tComponent.prototype.render = function render$$(target, occupants) {\n  \t\trender(this.instance, target, null, occupants);\n\n  \t\tthis.checkYielders();\n  \t\tthis.eventHandlers.forEach(_render);\n  \t\tupdateLiveQueries(this);\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tComponent.prototype.setupEvents = function setupEvents() {\n  \t\tvar _this5 = this;\n\n  \t\tvar handlers = this.eventHandlers;\n\n  \t\tObject.keys(this.template.v).forEach(function (key) {\n  \t\t\tvar eventNames = key.split('-');\n  \t\t\tvar template = _this5.template.v[key];\n\n  \t\t\teventNames.forEach(function (eventName) {\n  \t\t\t\tvar event = new RactiveEvent(_this5.instance, eventName);\n  \t\t\t\thandlers.push(new EventDirective(_this5, event, template));\n  \t\t\t});\n  \t\t});\n  \t};\n\n  \tComponent.prototype.toString = function toString() {\n  \t\treturn this.instance.toHTML();\n  \t};\n\n  \tComponent.prototype.unbind = function unbind() {\n  \t\tthis.complexMappings.forEach(_unbind);\n\n  \t\tvar instance = this.instance;\n  \t\tinstance.viewmodel.teardown();\n  \t\tinstance.fragment.unbind();\n  \t\tinstance._observers.forEach(cancel);\n\n  \t\tremoveFromLiveComponentQueries(this);\n\n  \t\tif (instance.fragment.rendered && instance.el.__ractive_instances__) {\n  \t\t\tremoveFromArray(instance.el.__ractive_instances__, instance);\n  \t\t}\n\n  \t\tObject.keys(instance._links).forEach(function (k) {\n  \t\t\treturn instance._links[k].unlink();\n  \t\t});\n\n  \t\tteardownHook.fire(instance);\n  \t};\n\n  \tComponent.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tvar _this6 = this;\n\n  \t\tthis.shouldDestroy = shouldDestroy;\n  \t\tthis.instance.unrender();\n  \t\tthis.eventHandlers.forEach(_unrender);\n  \t\tthis.liveQueries.forEach(function (query) {\n  \t\t\treturn query.remove(_this6.instance);\n  \t\t});\n  \t};\n\n  \tComponent.prototype.update = function update() {\n  \t\tthis.dirty = false;\n  \t\tthis.instance.fragment.update();\n  \t\tthis.checkYielders();\n  \t\tthis.eventHandlers.forEach(_update);\n  \t\tthis.complexMappings.forEach(_update);\n  \t};\n\n  \treturn Component;\n  }(Item);\n\n  var Doctype = function (_Item) {\n  \tbabelHelpers.inherits(Doctype, _Item);\n\n  \tfunction Doctype() {\n  \t\tbabelHelpers.classCallCheck(this, Doctype);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Item.apply(this, arguments));\n  \t}\n\n  \tDoctype.prototype.bind = function bind() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.render = function render() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.teardown = function teardown() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.toString = function toString() {\n  \t\treturn '<!DOCTYPE' + this.template.a + '>';\n  \t};\n\n  \tDoctype.prototype.unbind = function unbind() {\n  \t\t// noop\n  \t};\n\n  \tDoctype.prototype.unrender = function unrender() {\n  \t\t// noop\n  \t};\n\n  \treturn Doctype;\n  }(Item);\n\n  var textTypes = [undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit'];\n\n  function getUpdateDelegate(attribute) {\n  \tvar element = attribute.element;\n  \tvar name = attribute.name;\n\n\n  \tif (name === 'id') return updateId;\n\n  \tif (name === 'value') {\n  \t\t// special case - selects\n  \t\tif (element.name === 'select' && name === 'value') {\n  \t\t\treturn element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n  \t\t}\n\n  \t\tif (element.name === 'textarea') return updateStringValue;\n\n  \t\t// special case - contenteditable\n  \t\tif (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n  \t\t// special case - <input>\n  \t\tif (element.name === 'input') {\n  \t\t\tvar type = element.getAttribute('type');\n\n  \t\t\t// type='file' value='{{fileList}}'>\n  \t\t\tif (type === 'file') return noop; // read-only\n\n  \t\t\t// type='radio' name='{{twoway}}'\n  \t\t\tif (type === 'radio' && element.binding && element.binding.attribute.name === 'name') return updateRadioValue;\n\n  \t\t\tif (~textTypes.indexOf(type)) return updateStringValue;\n  \t\t}\n\n  \t\treturn updateValue;\n  \t}\n\n  \tvar node = element.node;\n\n  \t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n  \tif (attribute.isTwoway && name === 'name') {\n  \t\tif (node.type === 'radio') return updateRadioName;\n  \t\tif (node.type === 'checkbox') return updateCheckboxName;\n  \t}\n\n  \t// special case - style attributes in Internet Exploder\n  \tif (name === 'style' && node.style.setAttribute) return updateIEStyleAttribute;\n\n  \t// special case - class names. IE fucks things up, again\n  \tif (name === 'class' && (!node.namespaceURI || node.namespaceURI === html)) return updateClassName;\n\n  \tif (attribute.isBoolean) return updateBoolean;\n\n  \tif (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI) return updateNamespacedAttribute;\n\n  \treturn updateAttribute;\n  }\n\n  function updateId() {\n  \tvar node = this.node;\n\n  \tvar value = this.getValue();\n\n  \tdelete this.ractive.nodes[node.id];\n  \tthis.ractive.nodes[value] = node;\n\n  \tnode.id = value;\n  }\n\n  function updateMultipleSelectValue() {\n  \tvar value = this.getValue();\n\n  \tif (!isArray(value)) value = [value];\n\n  \tvar options = this.node.options;\n  \tvar i = options.length;\n\n  \twhile (i--) {\n  \t\tvar option = options[i];\n  \t\tvar optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n  \t\toption.selected = arrayContains(value, optionValue);\n  \t}\n  }\n\n  function updateSelectValue() {\n  \tvar value = this.getValue();\n\n  \tif (!this.locked) {\n  \t\t// TODO is locked still a thing?\n  \t\tthis.node._ractive.value = value;\n\n  \t\tvar options = this.node.options;\n  \t\tvar i = options.length;\n\n  \t\twhile (i--) {\n  \t\t\tvar option = options[i];\n  \t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n  \t\t\tif (optionValue == value) {\n  \t\t\t\t// double equals as we may be comparing numbers with strings\n  \t\t\t\toption.selected = true;\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.node.selectedIndex = -1;\n  \t}\n  }\n\n  function updateContentEditableValue() {\n  \tvar value = this.getValue();\n\n  \tif (!this.locked) {\n  \t\tthis.node.innerHTML = value === undefined ? '' : value;\n  \t}\n  }\n\n  function updateRadioValue() {\n  \tvar node = this.node;\n  \tvar wasChecked = node.checked;\n\n  \tvar value = this.getValue();\n\n  \t//node.value = this.element.getAttribute( 'value' );\n  \tnode.value = this.node._ractive.value = value;\n  \tnode.checked = value === this.element.getAttribute('name');\n\n  \t// This is a special case - if the input was checked, and the value\n  \t// changed so that it's no longer checked, the twoway binding is\n  \t// most likely out of date. To fix it we have to jump through some\n  \t// hoops... this is a little kludgy but it works\n  \tif (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n  \t\tthis.element.binding.group.model.set(this.element.binding.group.getValue());\n  \t}\n  }\n\n  function updateValue() {\n  \tif (!this.locked) {\n  \t\tvar value = this.getValue();\n\n  \t\tthis.node.value = this.node._ractive.value = value;\n  \t\tthis.node.setAttribute('value', value);\n  \t}\n  }\n\n  function updateStringValue() {\n  \tif (!this.locked) {\n  \t\tvar value = this.getValue();\n\n  \t\tthis.node._ractive.value = value;\n\n  \t\tthis.node.value = safeToStringValue(value);\n  \t\tthis.node.setAttribute('value', safeToStringValue(value));\n  \t}\n  }\n\n  function updateRadioName() {\n  \tthis.node.checked = this.getValue() == this.node._ractive.value;\n  }\n\n  function updateCheckboxName() {\n  \tvar element = this.element;\n  \tvar node = this.node;\n\n  \tvar binding = element.binding;\n\n  \tvar value = this.getValue();\n  \tvar valueAttribute = element.getAttribute('value');\n\n  \tif (!isArray(value)) {\n  \t\tbinding.isChecked = node.checked = value == valueAttribute;\n  \t} else {\n  \t\tvar i = value.length;\n  \t\twhile (i--) {\n  \t\t\tif (valueAttribute == value[i]) {\n  \t\t\t\tbinding.isChecked = node.checked = true;\n  \t\t\t\treturn;\n  \t\t\t}\n  \t\t}\n  \t\tbinding.isChecked = node.checked = false;\n  \t}\n  }\n\n  function updateIEStyleAttribute() {\n  \tthis.node.style.setAttribute('cssText', this.getValue() || '');\n  }\n\n  function updateClassName() {\n  \tthis.node.className = safeToStringValue(this.getValue());\n  }\n\n  function updateBoolean() {\n  \t// with two-way binding, only update if the change wasn't initiated by the user\n  \t// otherwise the cursor will often be sent to the wrong place\n  \tif (!this.locked) {\n  \t\tif (this.useProperty) {\n  \t\t\tthis.node[this.propertyName] = this.getValue();\n  \t\t} else {\n  \t\t\tif (this.getValue()) {\n  \t\t\t\tthis.node.setAttribute(this.propertyName, '');\n  \t\t\t} else {\n  \t\t\t\tthis.node.removeAttribute(this.propertyName);\n  \t\t\t}\n  \t\t}\n  \t}\n  }\n\n  function updateAttribute() {\n  \tthis.node.setAttribute(this.name, safeToStringValue(this.getString()));\n  }\n\n  function updateNamespacedAttribute() {\n  \tthis.node.setAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1), safeToStringValue(this.getString()));\n  }\n\n  var propertyNames = {\n  \t'accept-charset': 'acceptCharset',\n  \taccesskey: 'accessKey',\n  \tbgcolor: 'bgColor',\n  \tclass: 'className',\n  \tcodebase: 'codeBase',\n  \tcolspan: 'colSpan',\n  \tcontenteditable: 'contentEditable',\n  \tdatetime: 'dateTime',\n  \tdirname: 'dirName',\n  \tfor: 'htmlFor',\n  \t'http-equiv': 'httpEquiv',\n  \tismap: 'isMap',\n  \tmaxlength: 'maxLength',\n  \tnovalidate: 'noValidate',\n  \tpubdate: 'pubDate',\n  \treadonly: 'readOnly',\n  \trowspan: 'rowSpan',\n  \ttabindex: 'tabIndex',\n  \tusemap: 'useMap'\n  };\n\n  // https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\n  var booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\n  var voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\n  var htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, 'int': 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830 };\n  var controlCharacters = [8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376];\n  var entityPattern = new RegExp('&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys(htmlEntities).join('|') + '));?', 'g');\n  var codePointSupport = typeof String.fromCodePoint === 'function';\n  var codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\n  function decodeCharacterReferences(html) {\n  \treturn html.replace(entityPattern, function (match, entity) {\n  \t\tvar code;\n\n  \t\t// Handle named entities\n  \t\tif (entity[0] !== '#') {\n  \t\t\tcode = htmlEntities[entity];\n  \t\t} else if (entity[1] === 'x') {\n  \t\t\tcode = parseInt(entity.substring(2), 16);\n  \t\t} else {\n  \t\t\tcode = parseInt(entity.substring(1), 10);\n  \t\t}\n\n  \t\tif (!code) {\n  \t\t\treturn match;\n  \t\t}\n\n  \t\treturn codeToChar(validateCode(code));\n  \t});\n  }\n\n  var lessThan = /</g;\n  var greaterThan = />/g;\n  var amp = /&/g;\n  var invalid = 65533;\n\n  function escapeHtml(str) {\n  \treturn str.replace(amp, '&amp;').replace(lessThan, '&lt;').replace(greaterThan, '&gt;');\n  }\n\n  // some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n  // code points with alternatives in some cases - since we're bypassing that mechanism, we need\n  // to replace them ourselves\n  //\n  // Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n  function validateCode(code) {\n  \tif (!code) {\n  \t\treturn invalid;\n  \t}\n\n  \t// line feed becomes generic whitespace\n  \tif (code === 10) {\n  \t\treturn 32;\n  \t}\n\n  \t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  \tif (code < 128) {\n  \t\treturn code;\n  \t}\n\n  \t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  \t// to correct the mistake or we'll end up with missing € signs and so on\n  \tif (code <= 159) {\n  \t\treturn controlCharacters[code - 128];\n  \t}\n\n  \t// basic multilingual plane\n  \tif (code < 55296) {\n  \t\treturn code;\n  \t}\n\n  \t// UTF-16 surrogate halves\n  \tif (code <= 57343) {\n  \t\treturn invalid;\n  \t}\n\n  \t// rest of the basic multilingual plane\n  \tif (code <= 65535) {\n  \t\treturn code;\n  \t} else if (!codePointSupport) {\n  \t\treturn invalid;\n  \t}\n\n  \t// supplementary multilingual plane 0x10000 - 0x1ffff\n  \tif (code >= 65536 && code <= 131071) {\n  \t\treturn code;\n  \t}\n\n  \t// supplementary ideographic plane 0x20000 - 0x2ffff\n  \tif (code >= 131072 && code <= 196607) {\n  \t\treturn code;\n  \t}\n\n  \treturn invalid;\n  }\n\n  function lookupNamespace(node, prefix) {\n  \tvar qualified = 'xmlns:' + prefix;\n\n  \twhile (node) {\n  \t\tif (node.hasAttribute(qualified)) return node.getAttribute(qualified);\n  \t\tnode = node.parentNode;\n  \t}\n\n  \treturn namespaces[prefix];\n  }\n\n  var Attribute = function (_Item) {\n  \tbabelHelpers.inherits(Attribute, _Item);\n\n  \tfunction Attribute(options) {\n  \t\tbabelHelpers.classCallCheck(this, Attribute);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.name = options.name;\n  \t\t_this.namespace = null;\n  \t\t_this.element = options.element;\n  \t\t_this.parentFragment = options.element.parentFragment; // shared\n  \t\t_this.ractive = _this.parentFragment.ractive;\n\n  \t\t_this.rendered = false;\n  \t\t_this.updateDelegate = null;\n  \t\t_this.fragment = null;\n  \t\t_this.value = null;\n\n  \t\tif (!isArray(options.template)) {\n  \t\t\t_this.value = options.template;\n  \t\t\tif (_this.value === 0) {\n  \t\t\t\t_this.value = '';\n  \t\t\t}\n  \t\t} else {\n  \t\t\t_this.fragment = new Fragment({\n  \t\t\t\towner: _this,\n  \t\t\t\ttemplate: options.template\n  \t\t\t});\n  \t\t}\n\n  \t\t_this.interpolator = _this.fragment && _this.fragment.items.length === 1 && _this.fragment.items[0].type === INTERPOLATOR && _this.fragment.items[0];\n  \t\treturn _this;\n  \t}\n\n  \tAttribute.prototype.bind = function bind() {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.bind();\n  \t\t}\n  \t};\n\n  \tAttribute.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.element.bubble();\n  \t\t\tthis.dirty = true;\n  \t\t}\n  \t};\n\n  \tAttribute.prototype.getString = function getString() {\n  \t\treturn this.fragment ? this.fragment.toString() : this.value != null ? '' + this.value : '';\n  \t};\n\n  \t// TODO could getValue ever be called for a static attribute,\n  \t// or can we assume that this.fragment exists?\n\n\n  \tAttribute.prototype.getValue = function getValue() {\n  \t\treturn this.fragment ? this.fragment.valueOf() : booleanAttributes.test(this.name) ? true : this.value;\n  \t};\n\n  \tAttribute.prototype.rebind = function rebind() {\n  \t\tif (this.fragment) this.fragment.rebind();\n  \t};\n\n  \tAttribute.prototype.render = function render() {\n  \t\tvar node = this.element.node;\n  \t\tthis.node = node;\n\n  \t\t// should we use direct property access, or setAttribute?\n  \t\tif (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n  \t\t\tthis.propertyName = propertyNames[this.name] || this.name;\n\n  \t\t\tif (node[this.propertyName] !== undefined) {\n  \t\t\t\tthis.useProperty = true;\n  \t\t\t}\n\n  \t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n  \t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n  \t\t\tif (booleanAttributes.test(this.name) || this.isTwoway) {\n  \t\t\t\tthis.isBoolean = true;\n  \t\t\t}\n\n  \t\t\tif (this.propertyName === 'value') {\n  \t\t\t\tnode._ractive.value = this.value;\n  \t\t\t}\n  \t\t}\n\n  \t\tif (node.namespaceURI) {\n  \t\t\tvar index = this.name.indexOf(':');\n  \t\t\tif (index !== -1) {\n  \t\t\t\tthis.namespace = lookupNamespace(node, this.name.slice(0, index));\n  \t\t\t} else {\n  \t\t\t\tthis.namespace = node.namespaceURI;\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t\tthis.updateDelegate = getUpdateDelegate(this);\n  \t\tthis.updateDelegate();\n  \t};\n\n  \tAttribute.prototype.toString = function toString() {\n  \t\tvar value = this.getValue();\n\n  \t\t// Special case - select and textarea values (should not be stringified)\n  \t\tif (this.name === 'value' && (this.element.getAttribute('contenteditable') !== undefined || this.element.name === 'select' || this.element.name === 'textarea')) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\t// Special case – bound radio `name` attributes\n  \t\tif (this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute('type') === 'radio') {\n  \t\t\treturn 'name=\"{{' + this.interpolator.model.getKeypath() + '}}\"';\n  \t\t}\n\n  \t\tif (booleanAttributes.test(this.name)) return value ? this.name : '';\n  \t\tif (value == null) return '';\n\n  \t\tvar str = safeToStringValue(this.getString()).replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;');\n\n  \t\treturn str ? this.name + '=\"' + str + '\"' : this.name;\n  \t};\n\n  \tAttribute.prototype.unbind = function unbind() {\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tAttribute.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tif (this.fragment) this.fragment.update();\n  \t\t\tif (this.rendered) this.updateDelegate();\n  \t\t}\n  \t};\n\n  \treturn Attribute;\n  }(Item);\n\n  var div$1 = doc ? createElement('div') : null;\n\n  var ConditionalAttribute = function (_Item) {\n  \tbabelHelpers.inherits(ConditionalAttribute, _Item);\n\n  \tfunction ConditionalAttribute(options) {\n  \t\tbabelHelpers.classCallCheck(this, ConditionalAttribute);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.attributes = [];\n\n  \t\t_this.owner = options.owner;\n\n  \t\t_this.fragment = new Fragment({\n  \t\t\tractive: _this.ractive,\n  \t\t\towner: _this,\n  \t\t\ttemplate: [_this.template]\n  \t\t});\n\n  \t\t_this.dirty = false;\n  \t\treturn _this;\n  \t}\n\n  \tConditionalAttribute.prototype.bind = function bind() {\n  \t\tthis.fragment.bind();\n  \t};\n\n  \tConditionalAttribute.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.owner.bubble();\n  \t\t}\n  \t};\n\n  \tConditionalAttribute.prototype.rebind = function rebind() {\n  \t\tthis.fragment.rebind();\n  \t};\n\n  \tConditionalAttribute.prototype.render = function render() {\n  \t\tthis.node = this.owner.node;\n  \t\tthis.isSvg = this.node.namespaceURI === svg$1;\n\n  \t\tthis.rendered = true;\n  \t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n  \t\tthis.update();\n  \t};\n\n  \tConditionalAttribute.prototype.toString = function toString() {\n  \t\treturn this.fragment.toString();\n  \t};\n\n  \tConditionalAttribute.prototype.unbind = function unbind() {\n  \t\tthis.fragment.unbind();\n  \t};\n\n  \tConditionalAttribute.prototype.unrender = function unrender() {\n  \t\tthis.rendered = false;\n  \t};\n\n  \tConditionalAttribute.prototype.update = function update() {\n  \t\tvar _this2 = this;\n\n  \t\tvar str = void 0;\n  \t\tvar attrs = void 0;\n\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tthis.fragment.update();\n\n  \t\t\tif (this.rendered) {\n  \t\t\t\tstr = this.fragment.toString();\n  \t\t\t\tattrs = parseAttributes(str, this.isSvg);\n\n  \t\t\t\t// any attributes that previously existed but no longer do\n  \t\t\t\t// must be removed\n  \t\t\t\tthis.attributes.filter(function (a) {\n  \t\t\t\t\treturn notIn(attrs, a);\n  \t\t\t\t}).forEach(function (a) {\n  \t\t\t\t\t_this2.node.removeAttribute(a.name);\n  \t\t\t\t});\n\n  \t\t\t\tattrs.forEach(function (a) {\n  \t\t\t\t\t_this2.node.setAttribute(a.name, a.value);\n  \t\t\t\t});\n\n  \t\t\t\tthis.attributes = attrs;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \treturn ConditionalAttribute;\n  }(Item);\n\n  function parseAttributes(str, isSvg) {\n  \tvar tagName = isSvg ? 'svg' : 'div';\n  \treturn str ? (div$1.innerHTML = '<' + tagName + ' ' + str + '></' + tagName + '>') && toArray(div$1.childNodes[0].attributes) : [];\n  }\n\n  function notIn(haystack, needle) {\n  \tvar i = haystack.length;\n\n  \twhile (i--) {\n  \t\tif (haystack[i].name === needle.name) {\n  \t\t\treturn false;\n  \t\t}\n  \t}\n\n  \treturn true;\n  }\n\n  var missingDecorator = {\n  \tupdate: noop,\n  \tteardown: noop\n  };\n\n  var Decorator = function () {\n  \tfunction Decorator(owner, template) {\n  \t\tbabelHelpers.classCallCheck(this, Decorator);\n\n  \t\tthis.owner = owner;\n  \t\tthis.template = template;\n\n  \t\tthis.parentFragment = owner.parentFragment;\n  \t\tthis.ractive = owner.ractive;\n\n  \t\tthis.dynamicName = babelHelpers.typeof(template.n) === 'object';\n  \t\tthis.dynamicArgs = !!template.d;\n\n  \t\tif (this.dynamicName) {\n  \t\t\tthis.nameFragment = new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.n\n  \t\t\t});\n  \t\t} else {\n  \t\t\tthis.name = template.n || template;\n  \t\t}\n\n  \t\tif (this.dynamicArgs) {\n  \t\t\tthis.argsFragment = new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: template.d\n  \t\t\t});\n  \t\t} else {\n  \t\t\tthis.args = template.a || [];\n  \t\t}\n\n  \t\tthis.node = null;\n  \t\tthis.intermediary = null;\n  \t}\n\n  \tDecorator.prototype.bind = function bind() {\n  \t\tif (this.dynamicName) {\n  \t\t\tthis.nameFragment.bind();\n  \t\t\tthis.name = this.nameFragment.toString();\n  \t\t}\n\n  \t\tif (this.dynamicArgs) this.argsFragment.bind();\n  \t};\n\n  \tDecorator.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.owner.bubble();\n  \t\t}\n  \t};\n\n  \tDecorator.prototype.rebind = function rebind() {\n  \t\tif (this.dynamicName) this.nameFragment.rebind();\n  \t\tif (this.dynamicArgs) this.argsFragment.rebind();\n  \t};\n\n  \tDecorator.prototype.render = function render() {\n  \t\tvar fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n  \t\tif (!fn) {\n  \t\t\twarnOnce(missingPlugin(this.name, 'decorator'));\n  \t\t\tthis.intermediary = missingDecorator;\n  \t\t\treturn;\n  \t\t}\n\n  \t\tthis.node = this.owner.node;\n\n  \t\tvar args = this.dynamicArgs ? this.argsFragment.getArgsList() : this.args;\n  \t\tthis.intermediary = fn.apply(this.ractive, [this.node].concat(args));\n\n  \t\tif (!this.intermediary || !this.intermediary.teardown) {\n  \t\t\tthrow new Error('The \\'' + this.name + '\\' decorator must return an object with a teardown method');\n  \t\t}\n  \t};\n\n  \tDecorator.prototype.unbind = function unbind() {\n  \t\tif (this.dynamicName) this.nameFragment.unbind();\n  \t\tif (this.dynamicArgs) this.argsFragment.unbind();\n  \t};\n\n  \tDecorator.prototype.unrender = function unrender() {\n  \t\tif (this.intermediary) this.intermediary.teardown();\n  \t};\n\n  \tDecorator.prototype.update = function update() {\n  \t\tif (!this.dirty) return;\n\n  \t\tthis.dirty = false;\n\n  \t\tvar nameChanged = false;\n\n  \t\tif (this.dynamicName && this.nameFragment.dirty) {\n  \t\t\tvar name = this.nameFragment.toString();\n  \t\t\tnameChanged = name !== this.name;\n  \t\t\tthis.name = name;\n  \t\t}\n\n  \t\tif (this.intermediary) {\n  \t\t\tif (nameChanged || !this.intermediary.update) {\n  \t\t\t\tthis.unrender();\n  \t\t\t\tthis.render();\n  \t\t\t} else {\n  \t\t\t\tif (this.dynamicArgs) {\n  \t\t\t\t\tif (this.argsFragment.dirty) {\n  \t\t\t\t\t\tvar args = this.argsFragment.getArgsList();\n  \t\t\t\t\t\tthis.intermediary.update.apply(this.ractive, args);\n  \t\t\t\t\t}\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.intermediary.update.apply(this.ractive, this.args);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\t// need to run these for unrender/render cases\n  \t\t// so can't just be in conditional if above\n\n  \t\tif (this.dynamicName && this.nameFragment.dirty) {\n  \t\t\tthis.nameFragment.update();\n  \t\t}\n\n  \t\tif (this.dynamicArgs && this.argsFragment.dirty) {\n  \t\t\tthis.argsFragment.update();\n  \t\t}\n  \t};\n\n  \treturn Decorator;\n  }();\n\n  var DOMEvent = function () {\n  \tfunction DOMEvent(name, owner) {\n  \t\tbabelHelpers.classCallCheck(this, DOMEvent);\n\n  \t\tif (name.indexOf('*') !== -1) {\n  \t\t\tfatal('Only component proxy-events may contain \"*\" wildcards, <' + owner.name + ' on-' + name + '=\"...\"/> is not valid');\n  \t\t}\n\n  \t\tthis.name = name;\n  \t\tthis.owner = owner;\n  \t\tthis.node = null;\n  \t\tthis.handler = null;\n  \t}\n\n  \tDOMEvent.prototype.listen = function listen(directive) {\n  \t\tvar node = this.node = this.owner.node;\n  \t\tvar name = this.name;\n\n  \t\tif (!('on' + name in node)) {\n  \t\t\twarnOnce(missingPlugin(name, 'events'));\n  \t\t}\n\n  \t\tnode.addEventListener(name, this.handler = function (event) {\n  \t\t\tdirective.fire({\n  \t\t\t\tnode: node,\n  \t\t\t\toriginal: event\n  \t\t\t});\n  \t\t}, false);\n  \t};\n\n  \tDOMEvent.prototype.unlisten = function unlisten() {\n  \t\tthis.node.removeEventListener(this.name, this.handler, false);\n  \t};\n\n  \treturn DOMEvent;\n  }();\n\n  var CustomEvent = function () {\n  \tfunction CustomEvent(eventPlugin, owner) {\n  \t\tbabelHelpers.classCallCheck(this, CustomEvent);\n\n  \t\tthis.eventPlugin = eventPlugin;\n  \t\tthis.owner = owner;\n  \t\tthis.handler = null;\n  \t}\n\n  \tCustomEvent.prototype.listen = function listen(directive) {\n  \t\tvar node = this.owner.node;\n\n  \t\tthis.handler = this.eventPlugin(node, function () {\n  \t\t\tvar event = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  \t\t\tevent.node = event.node || node;\n  \t\t\tdirective.fire(event);\n  \t\t});\n  \t};\n\n  \tCustomEvent.prototype.unlisten = function unlisten() {\n  \t\tthis.handler.teardown();\n  \t};\n\n  \treturn CustomEvent;\n  }();\n\n  function camelCase (hyphenatedStr) {\n  \treturn hyphenatedStr.replace(/-([a-zA-Z])/g, function (match, $1) {\n  \t\treturn $1.toUpperCase();\n  \t});\n  }\n\n  var prefix = void 0;\n\n  if (!isClient) {\n  \tprefix = null;\n  } else {\n  \t(function () {\n  \t\tvar prefixCache = {};\n  \t\tvar testStyle = createElement('div').style;\n\n  \t\tprefix = function prefix(prop) {\n  \t\t\tprop = camelCase(prop);\n\n  \t\t\tif (!prefixCache[prop]) {\n  \t\t\t\tif (testStyle[prop] !== undefined) {\n  \t\t\t\t\tprefixCache[prop] = prop;\n  \t\t\t\t} else {\n  \t\t\t\t\t// test vendors...\n  \t\t\t\t\tvar capped = prop.charAt(0).toUpperCase() + prop.substring(1);\n\n  \t\t\t\t\tvar i = vendors.length;\n  \t\t\t\t\twhile (i--) {\n  \t\t\t\t\t\tvar vendor = vendors[i];\n  \t\t\t\t\t\tif (testStyle[vendor + capped] !== undefined) {\n  \t\t\t\t\t\t\tprefixCache[prop] = vendor + capped;\n  \t\t\t\t\t\t\tbreak;\n  \t\t\t\t\t\t}\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\treturn prefixCache[prop];\n  \t\t};\n  \t})();\n  }\n\n  var prefix$1 = prefix;\n\n  var visible = void 0;\n  var hidden = 'hidden';\n\n  if (doc) {\n  \tvar prefix$2 = void 0;\n\n  \tif (hidden in doc) {\n  \t\tprefix$2 = '';\n  \t} else {\n  \t\tvar i$1 = vendors.length;\n  \t\twhile (i$1--) {\n  \t\t\tvar vendor = vendors[i$1];\n  \t\t\thidden = vendor + 'Hidden';\n\n  \t\t\tif (hidden in doc) {\n  \t\t\t\tprefix$2 = vendor;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tif (prefix$2 !== undefined) {\n  \t\tdoc.addEventListener(prefix$2 + 'visibilitychange', onChange);\n  \t\tonChange();\n  \t} else {\n  \t\t// gah, we're in an old browser\n  \t\tif ('onfocusout' in doc) {\n  \t\t\tdoc.addEventListener('focusout', onHide);\n  \t\t\tdoc.addEventListener('focusin', onShow);\n  \t\t} else {\n  \t\t\twin.addEventListener('pagehide', onHide);\n  \t\t\twin.addEventListener('blur', onHide);\n\n  \t\t\twin.addEventListener('pageshow', onShow);\n  \t\t\twin.addEventListener('focus', onShow);\n  \t\t}\n\n  \t\tvisible = true; // until proven otherwise. Not ideal but hey\n  \t}\n  }\n\n  function onChange() {\n  \tvisible = !doc[hidden];\n  }\n\n  function onHide() {\n  \tvisible = false;\n  }\n\n  function onShow() {\n  \tvisible = true;\n  }\n\n  var unprefixPattern = new RegExp('^-(?:' + vendors.join('|') + ')-');\n\n  function unprefix (prop) {\n  \treturn prop.replace(unprefixPattern, '');\n  }\n\n  var vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\n  function hyphenate (str) {\n  \tif (!str) return ''; // edge case\n\n  \tif (vendorPattern.test(str)) str = '-' + str;\n\n  \treturn str.replace(/[A-Z]/g, function (match) {\n  \t\treturn '-' + match.toLowerCase();\n  \t});\n  }\n\n  var createTransitions = void 0;\n\n  if (!isClient) {\n  \tcreateTransitions = null;\n  } else {\n  \t(function () {\n  \t\tvar testStyle = createElement('div').style;\n  \t\tvar linear = function linear(x) {\n  \t\t\treturn x;\n  \t\t};\n\n  \t\tvar canUseCssTransitions = {};\n  \t\tvar cannotUseCssTransitions = {};\n\n  \t\t// determine some facts about our environment\n  \t\tvar TRANSITION = void 0;\n  \t\tvar TRANSITIONEND = void 0;\n  \t\tvar CSS_TRANSITIONS_ENABLED = void 0;\n  \t\tvar TRANSITION_DURATION = void 0;\n  \t\tvar TRANSITION_PROPERTY = void 0;\n  \t\tvar TRANSITION_TIMING_FUNCTION = void 0;\n\n  \t\tif (testStyle.transition !== undefined) {\n  \t\t\tTRANSITION = 'transition';\n  \t\t\tTRANSITIONEND = 'transitionend';\n  \t\t\tCSS_TRANSITIONS_ENABLED = true;\n  \t\t} else if (testStyle.webkitTransition !== undefined) {\n  \t\t\tTRANSITION = 'webkitTransition';\n  \t\t\tTRANSITIONEND = 'webkitTransitionEnd';\n  \t\t\tCSS_TRANSITIONS_ENABLED = true;\n  \t\t} else {\n  \t\t\tCSS_TRANSITIONS_ENABLED = false;\n  \t\t}\n\n  \t\tif (TRANSITION) {\n  \t\t\tTRANSITION_DURATION = TRANSITION + 'Duration';\n  \t\t\tTRANSITION_PROPERTY = TRANSITION + 'Property';\n  \t\t\tTRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  \t\t}\n\n  \t\tcreateTransitions = function createTransitions(t, to, options, changedProperties, resolve) {\n\n  \t\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n  \t\t\t// TODO use a fastdom-style mechanism?\n  \t\t\tsetTimeout(function () {\n  \t\t\t\tvar jsTransitionsComplete = void 0;\n  \t\t\t\tvar cssTransitionsComplete = void 0;\n\n  \t\t\t\tfunction checkComplete() {\n  \t\t\t\t\tif (jsTransitionsComplete && cssTransitionsComplete) {\n  \t\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n  \t\t\t\t\t\tt.ractive.fire(t.name + ':end', t.node, t.isIntro);\n  \t\t\t\t\t\tresolve();\n  \t\t\t\t\t}\n  \t\t\t\t}\n\n  \t\t\t\t// this is used to keep track of which elements can use CSS to animate\n  \t\t\t\t// which properties\n  \t\t\t\tvar hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n  \t\t\t\t// need to reset transition properties\n  \t\t\t\tvar style = t.node.style;\n  \t\t\t\tvar previous = {\n  \t\t\t\t\tproperty: style[TRANSITION_PROPERTY],\n  \t\t\t\t\ttiming: style[TRANSITION_TIMING_FUNCTION],\n  \t\t\t\t\tduration: style[TRANSITION_DURATION]\n  \t\t\t\t};\n\n  \t\t\t\tstyle[TRANSITION_PROPERTY] = changedProperties.map(prefix$1).map(hyphenate).join(',');\n  \t\t\t\tstyle[TRANSITION_TIMING_FUNCTION] = hyphenate(options.easing || 'linear');\n  \t\t\t\tstyle[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n  \t\t\t\tfunction transitionEndHandler(event) {\n  \t\t\t\t\tvar index = changedProperties.indexOf(camelCase(unprefix(event.propertyName)));\n\n  \t\t\t\t\tif (index !== -1) {\n  \t\t\t\t\t\tchangedProperties.splice(index, 1);\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (changedProperties.length) {\n  \t\t\t\t\t\t// still transitioning...\n  \t\t\t\t\t\treturn;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tstyle[TRANSITION_PROPERTY] = previous.property;\n  \t\t\t\t\tstyle[TRANSITION_TIMING_FUNCTION] = previous.duration;\n  \t\t\t\t\tstyle[TRANSITION_DURATION] = previous.timing;\n\n  \t\t\t\t\tt.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n  \t\t\t\t\tcssTransitionsComplete = true;\n  \t\t\t\t\tcheckComplete();\n  \t\t\t\t}\n\n  \t\t\t\tt.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n  \t\t\t\tsetTimeout(function () {\n  \t\t\t\t\tvar i = changedProperties.length;\n  \t\t\t\t\tvar hash = void 0;\n  \t\t\t\t\tvar originalValue = void 0;\n  \t\t\t\t\tvar index = void 0;\n  \t\t\t\t\tvar propertiesToTransitionInJs = [];\n  \t\t\t\t\tvar prop = void 0;\n  \t\t\t\t\tvar suffix = void 0;\n  \t\t\t\t\tvar interpolator = void 0;\n\n  \t\t\t\t\twhile (i--) {\n  \t\t\t\t\t\tprop = changedProperties[i];\n  \t\t\t\t\t\thash = hashPrefix + prop;\n\n  \t\t\t\t\t\tif (CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\tstyle[prefix$1(prop)] = to[prop];\n\n  \t\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n  \t\t\t\t\t\t\t// this tag/property combo, find out now\n  \t\t\t\t\t\t\tif (!canUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\t\toriginalValue = t.getStyle(prop);\n\n  \t\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n  \t\t\t\t\t\t\t\t// the current style will be different from the target style\n  \t\t\t\t\t\t\t\tcanUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n  \t\t\t\t\t\t\t\tcannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n  \t\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n  \t\t\t\t\t\t\t\tif (cannotUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\t\t\tstyle[prefix$1(prop)] = originalValue;\n  \t\t\t\t\t\t\t\t}\n  \t\t\t\t\t\t\t}\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tif (!CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n  \t\t\t\t\t\t\t// we need to fall back to timer-based stuff\n  \t\t\t\t\t\t\tif (originalValue === undefined) {\n  \t\t\t\t\t\t\t\toriginalValue = t.getStyle(prop);\n  \t\t\t\t\t\t\t}\n\n  \t\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n  \t\t\t\t\t\t\t// will get confused\n  \t\t\t\t\t\t\tindex = changedProperties.indexOf(prop);\n  \t\t\t\t\t\t\tif (index === -1) {\n  \t\t\t\t\t\t\t\twarnIfDebug('Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n  \t\t\t\t\t\t\t} else {\n  \t\t\t\t\t\t\t\tchangedProperties.splice(index, 1);\n  \t\t\t\t\t\t\t}\n\n  \t\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n  \t\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec(to[prop])[0];\n  \t\t\t\t\t\t\tinterpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop])) || function () {\n  \t\t\t\t\t\t\t\treturn to[prop];\n  \t\t\t\t\t\t\t};\n\n  \t\t\t\t\t\t\t// ...then kick off a timer-based transition\n  \t\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n  \t\t\t\t\t\t\t\tname: prefix$1(prop),\n  \t\t\t\t\t\t\t\tinterpolator: interpolator,\n  \t\t\t\t\t\t\t\tsuffix: suffix\n  \t\t\t\t\t\t\t});\n  \t\t\t\t\t\t}\n  \t\t\t\t\t}\n\n  \t\t\t\t\t// javascript transitions\n  \t\t\t\t\tif (propertiesToTransitionInJs.length) {\n  \t\t\t\t\t\tvar easing = void 0;\n\n  \t\t\t\t\t\tif (typeof options.easing === 'string') {\n  \t\t\t\t\t\t\teasing = t.ractive.easing[options.easing];\n\n  \t\t\t\t\t\t\tif (!easing) {\n  \t\t\t\t\t\t\t\twarnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n  \t\t\t\t\t\t\t\teasing = linear;\n  \t\t\t\t\t\t\t}\n  \t\t\t\t\t\t} else if (typeof options.easing === 'function') {\n  \t\t\t\t\t\t\teasing = options.easing;\n  \t\t\t\t\t\t} else {\n  \t\t\t\t\t\t\teasing = linear;\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tnew Ticker({\n  \t\t\t\t\t\t\tduration: options.duration,\n  \t\t\t\t\t\t\teasing: easing,\n  \t\t\t\t\t\t\tstep: function step(pos) {\n  \t\t\t\t\t\t\t\tvar i = propertiesToTransitionInJs.length;\n  \t\t\t\t\t\t\t\twhile (i--) {\n  \t\t\t\t\t\t\t\t\tvar _prop = propertiesToTransitionInJs[i];\n  \t\t\t\t\t\t\t\t\tt.node.style[_prop.name] = _prop.interpolator(pos) + _prop.suffix;\n  \t\t\t\t\t\t\t\t}\n  \t\t\t\t\t\t\t},\n  \t\t\t\t\t\t\tcomplete: function complete() {\n  \t\t\t\t\t\t\t\tjsTransitionsComplete = true;\n  \t\t\t\t\t\t\t\tcheckComplete();\n  \t\t\t\t\t\t\t}\n  \t\t\t\t\t\t});\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tjsTransitionsComplete = true;\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (!changedProperties.length) {\n  \t\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n  \t\t\t\t\t\t// the fact that it will never fire\n  \t\t\t\t\t\tt.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n  \t\t\t\t\t\tcssTransitionsComplete = true;\n  \t\t\t\t\t\tcheckComplete();\n  \t\t\t\t\t}\n  \t\t\t\t}, 0);\n  \t\t\t}, options.delay || 0);\n  \t\t};\n  \t})();\n  }\n\n  var createTransitions$1 = createTransitions;\n\n  function resetStyle(node, style) {\n  \tif (style) {\n  \t\tnode.setAttribute('style', style);\n  \t} else {\n  \t\t// Next line is necessary, to remove empty style attribute!\n  \t\t// See http://stackoverflow.com/a/7167553\n  \t\tnode.getAttribute('style');\n  \t\tnode.removeAttribute('style');\n  \t}\n  }\n\n  var getComputedStyle = win && (win.getComputedStyle || legacy.getComputedStyle);\n  var resolved = Promise$1.resolve();\n\n  var Transition = function () {\n  \tfunction Transition(ractive, node, name, params, eventName) {\n  \t\tbabelHelpers.classCallCheck(this, Transition);\n\n  \t\tthis.ractive = ractive;\n  \t\tthis.node = node;\n  \t\tthis.name = name;\n  \t\tthis.params = params;\n\n  \t\t// TODO this will need to change...\n  \t\tthis.eventName = eventName;\n  \t\tthis.isIntro = eventName !== 'outro';\n\n  \t\tif (typeof name === 'function') {\n  \t\t\tthis._fn = name;\n  \t\t} else {\n  \t\t\tthis._fn = findInViewHierarchy('transitions', ractive, name);\n\n  \t\t\tif (!this._fn) {\n  \t\t\t\twarnOnceIfDebug(missingPlugin(name, 'transition'), { ractive: ractive });\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \tTransition.prototype.animateStyle = function animateStyle(style, value, options) {\n  \t\tvar _this = this;\n\n  \t\tif (arguments.length === 4) {\n  \t\t\tthrow new Error('t.animateStyle() returns a promise - use .then() instead of passing a callback');\n  \t\t}\n\n  \t\t// Special case - page isn't visible. Don't animate anything, because\n  \t\t// that way you'll never get CSS transitionend events\n  \t\tif (!visible) {\n  \t\t\tthis.setStyle(style, value);\n  \t\t\treturn resolved;\n  \t\t}\n\n  \t\tvar to = void 0;\n\n  \t\tif (typeof style === 'string') {\n  \t\t\tto = {};\n  \t\t\tto[style] = value;\n  \t\t} else {\n  \t\t\tto = style;\n\n  \t\t\t// shuffle arguments\n  \t\t\toptions = value;\n  \t\t}\n\n  \t\t// As of 0.3.9, transition authors should supply an `option` object with\n  \t\t// `duration` and `easing` properties (and optional `delay`), plus a\n  \t\t// callback function that gets called after the animation completes\n\n  \t\t// TODO remove this check in a future version\n  \t\tif (!options) {\n  \t\t\twarnOnceIfDebug('The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name);\n  \t\t\toptions = this;\n  \t\t}\n\n  \t\treturn new Promise$1(function (fulfil) {\n  \t\t\t// Edge case - if duration is zero, set style synchronously and complete\n  \t\t\tif (!options.duration) {\n  \t\t\t\t_this.setStyle(to);\n  \t\t\t\tfulfil();\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\t// Get a list of the properties we're animating\n  \t\t\tvar propertyNames = Object.keys(to);\n  \t\t\tvar changedProperties = [];\n\n  \t\t\t// Store the current styles\n  \t\t\tvar computedStyle = getComputedStyle(_this.node);\n\n  \t\t\tvar i = propertyNames.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tvar prop = propertyNames[i];\n  \t\t\t\tvar current = computedStyle[prefix$1(prop)];\n\n  \t\t\t\tif (current === '0px') current = 0;\n\n  \t\t\t\t// we need to know if we're actually changing anything\n  \t\t\t\tif (current != to[prop]) {\n  \t\t\t\t\t// use != instead of !==, so we can compare strings with numbers\n  \t\t\t\t\tchangedProperties.push(prop);\n\n  \t\t\t\t\t// make the computed style explicit, so we can animate where\n  \t\t\t\t\t// e.g. height='auto'\n  \t\t\t\t\t_this.node.style[prefix$1(prop)] = current;\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\t// If we're not actually changing anything, the transitionend event\n  \t\t\t// will never fire! So we complete early\n  \t\t\tif (!changedProperties.length) {\n  \t\t\t\tfulfil();\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tcreateTransitions$1(_this, to, options, changedProperties, fulfil);\n  \t\t});\n  \t};\n\n  \tTransition.prototype.getStyle = function getStyle(props) {\n  \t\tvar computedStyle = getComputedStyle(this.node);\n\n  \t\tif (typeof props === 'string') {\n  \t\t\tvar value = computedStyle[prefix$1(props)];\n  \t\t\treturn value === '0px' ? 0 : value;\n  \t\t}\n\n  \t\tif (!isArray(props)) {\n  \t\t\tthrow new Error('Transition$getStyle must be passed a string, or an array of strings representing CSS properties');\n  \t\t}\n\n  \t\tvar styles = {};\n\n  \t\tvar i = props.length;\n  \t\twhile (i--) {\n  \t\t\tvar prop = props[i];\n  \t\t\tvar _value = computedStyle[prefix$1(prop)];\n\n  \t\t\tif (_value === '0px') _value = 0;\n  \t\t\tstyles[prop] = _value;\n  \t\t}\n\n  \t\treturn styles;\n  \t};\n\n  \tTransition.prototype.processParams = function processParams(params, defaults) {\n  \t\tif (typeof params === 'number') {\n  \t\t\tparams = { duration: params };\n  \t\t} else if (typeof params === 'string') {\n  \t\t\tif (params === 'slow') {\n  \t\t\t\tparams = { duration: 600 };\n  \t\t\t} else if (params === 'fast') {\n  \t\t\t\tparams = { duration: 200 };\n  \t\t\t} else {\n  \t\t\t\tparams = { duration: 400 };\n  \t\t\t}\n  \t\t} else if (!params) {\n  \t\t\tparams = {};\n  \t\t}\n\n  \t\treturn extendObj({}, defaults, params);\n  \t};\n\n  \tTransition.prototype.setStyle = function setStyle(style, value) {\n  \t\tif (typeof style === 'string') {\n  \t\t\tthis.node.style[prefix$1(style)] = value;\n  \t\t} else {\n  \t\t\tvar prop = void 0;\n  \t\t\tfor (prop in style) {\n  \t\t\t\tif (style.hasOwnProperty(prop)) {\n  \t\t\t\t\tthis.node.style[prefix$1(prop)] = style[prop];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn this;\n  \t};\n\n  \tTransition.prototype.start = function start() {\n  \t\tvar _this2 = this;\n\n  \t\tvar node = this.node;\n  \t\tvar originalStyle = node.getAttribute('style');\n\n  \t\tvar completed = void 0;\n\n  \t\t// create t.complete() - we don't want this on the prototype,\n  \t\t// because we don't want `this` silliness when passing it as\n  \t\t// an argument\n  \t\tthis.complete = function (noReset) {\n  \t\t\tif (completed) {\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tif (!noReset && _this2.eventName === 'intro') {\n  \t\t\t\tresetStyle(node, originalStyle);\n  \t\t\t}\n\n  \t\t\t_this2._manager.remove(_this2);\n\n  \t\t\tcompleted = true;\n  \t\t};\n\n  \t\t// If the transition function doesn't exist, abort\n  \t\tif (!this._fn) {\n  \t\t\tthis.complete();\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar promise = this._fn.apply(this.ractive, [this].concat(this.params));\n  \t\tif (promise) promise.then(this.complete);\n  \t};\n\n  \treturn Transition;\n  }();\n\n  function updateLiveQueries$1(element) {\n  \t// Does this need to be added to any live queries?\n  \tvar node = element.node;\n  \tvar instance = element.ractive;\n\n  \tdo {\n  \t\tvar liveQueries = instance._liveQueries;\n\n  \t\tvar i = liveQueries.length;\n  \t\twhile (i--) {\n  \t\t\tvar selector = liveQueries[i];\n  \t\t\tvar query = liveQueries[\"_\" + selector];\n\n  \t\t\tif (query.test(node)) {\n  \t\t\t\tquery.add(node);\n  \t\t\t\t// keep register of applicable selectors, for when we teardown\n  \t\t\t\telement.liveQueries.push(query);\n  \t\t\t}\n  \t\t}\n  \t} while (instance = instance.parent);\n  }\n\n  // TODO element.parent currently undefined\n  function findParentForm(element) {\n  \twhile (element = element.parent) {\n  \t\tif (element.name === 'form') {\n  \t\t\treturn element;\n  \t\t}\n  \t}\n  }\n\n  function warnAboutAmbiguity(description, ractive) {\n  \twarnOnceIfDebug('The ' + description + ' being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity', { ractive: ractive });\n  }\n\n  var Binding = function () {\n  \tfunction Binding(element) {\n  \t\tvar name = arguments.length <= 1 || arguments[1] === undefined ? 'value' : arguments[1];\n  \t\tbabelHelpers.classCallCheck(this, Binding);\n\n  \t\tthis.element = element;\n  \t\tthis.ractive = element.ractive;\n  \t\tthis.attribute = element.attributeByName[name];\n\n  \t\tvar interpolator = this.attribute.interpolator;\n  \t\tinterpolator.twowayBinding = this;\n\n  \t\tvar model = interpolator.model;\n\n  \t\t// not bound?\n  \t\tif (!model) {\n  \t\t\t// try to force resolution\n  \t\t\tinterpolator.resolver.forceResolution();\n  \t\t\tmodel = interpolator.model;\n\n  \t\t\twarnAboutAmbiguity('\\'' + interpolator.template.r + '\\' reference', this.ractive);\n  \t\t} else if (model.isUnresolved) {\n  \t\t\t// reference expressions (e.g. foo[bar])\n  \t\t\tmodel.forceResolution();\n  \t\t\twarnAboutAmbiguity('expression', this.ractive);\n  \t\t}\n\n  \t\t// TODO include index/key/keypath refs as read-only\n  \t\telse if (model.isReadonly) {\n  \t\t\t\tvar keypath = model.getKeypath().replace(/^@/, '');\n  \t\t\t\twarnOnceIfDebug('Cannot use two-way binding on <' + element.name + '> element: ' + keypath + ' is read-only. To suppress this warning use <' + element.name + ' twoway=\\'false\\'...>', { ractive: this.ractive });\n  \t\t\t\treturn false;\n  \t\t\t}\n\n  \t\tthis.attribute.isTwoway = true;\n  \t\tthis.model = model;\n\n  \t\t// initialise value, if it's undefined\n  \t\tvar value = model.get();\n  \t\tthis.wasUndefined = value === undefined;\n\n  \t\tif (value === undefined && this.getInitialValue) {\n  \t\t\tvalue = this.getInitialValue();\n  \t\t\tmodel.set(value);\n  \t\t}\n\n  \t\tvar parentForm = findParentForm(element);\n  \t\tif (parentForm) {\n  \t\t\tthis.resetValue = value;\n  \t\t\tparentForm.formBindings.push(this);\n  \t\t}\n  \t}\n\n  \tBinding.prototype.bind = function bind() {\n  \t\tthis.model.registerTwowayBinding(this);\n  \t};\n\n  \tBinding.prototype.handleChange = function handleChange() {\n  \t\tvar _this = this;\n\n  \t\trunloop.start(this.root);\n  \t\tthis.attribute.locked = true;\n  \t\tthis.model.set(this.getValue());\n  \t\trunloop.scheduleTask(function () {\n  \t\t\treturn _this.attribute.locked = false;\n  \t\t});\n  \t\trunloop.end();\n  \t};\n\n  \tBinding.prototype.rebind = function rebind() {\n  \t\t// TODO what does this work with CheckboxNameBinding et al?\n  \t\tthis.unbind();\n  \t\tthis.model = this.attribute.interpolator.model;\n  \t\tthis.bind();\n  \t};\n\n  \tBinding.prototype.render = function render() {\n  \t\tthis.node = this.element.node;\n  \t\tthis.node._ractive.binding = this;\n  \t\tthis.rendered = true; // TODO is this used anywhere?\n  \t};\n\n  \tBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.value);\n  \t};\n\n  \tBinding.prototype.unbind = function unbind() {\n  \t\tthis.model.unregisterTwowayBinding(this);\n  \t};\n\n  \tBinding.prototype.unrender = function unrender() {\n  \t\t// noop?\n  \t};\n\n  \treturn Binding;\n  }();\n\n  // This is the handler for DOM events that would lead to a change in the model\n  // (i.e. change, sometimes, input, and occasionally click and keyup)\n  function handleDomEvent() {\n  \tthis._ractive.binding.handleChange();\n  }\n\n  var CheckboxBinding = function (_Binding) {\n  \tbabelHelpers.inherits(CheckboxBinding, _Binding);\n\n  \tfunction CheckboxBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, CheckboxBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'checked'));\n  \t}\n\n  \tCheckboxBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (this.node.attachEvent) {\n  \t\t\tthis.node.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tCheckboxBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t\tthis.node.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \tCheckboxBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn !!this.element.getAttribute('checked');\n  \t};\n\n  \tCheckboxBinding.prototype.getValue = function getValue() {\n  \t\treturn this.node.checked;\n  \t};\n\n  \tCheckboxBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.checked);\n  \t};\n\n  \treturn CheckboxBinding;\n  }(Binding);\n\n  function getBindingGroup(group, model, getValue) {\n  \tvar hash = group + '-bindingGroup';\n  \treturn model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n  }\n\n  var BindingGroup = function () {\n  \tfunction BindingGroup(hash, model, getValue) {\n  \t\tvar _this = this;\n\n  \t\tbabelHelpers.classCallCheck(this, BindingGroup);\n\n  \t\tthis.model = model;\n  \t\tthis.hash = hash;\n  \t\tthis.getValue = function () {\n  \t\t\t_this.value = getValue.call(_this);\n  \t\t\treturn _this.value;\n  \t\t};\n\n  \t\tthis.bindings = [];\n  \t}\n\n  \tBindingGroup.prototype.add = function add(binding) {\n  \t\tthis.bindings.push(binding);\n  \t};\n\n  \tBindingGroup.prototype.bind = function bind() {\n  \t\tthis.value = this.model.get();\n  \t\tthis.model.registerTwowayBinding(this);\n  \t\tthis.bound = true;\n  \t};\n\n  \tBindingGroup.prototype.remove = function remove(binding) {\n  \t\tremoveFromArray(this.bindings, binding);\n  \t\tif (!this.bindings.length) {\n  \t\t\tthis.unbind();\n  \t\t}\n  \t};\n\n  \tBindingGroup.prototype.unbind = function unbind() {\n  \t\tthis.model.unregisterTwowayBinding(this);\n  \t\tthis.bound = false;\n  \t\tdelete this.model[this.hash];\n  \t};\n\n  \treturn BindingGroup;\n  }();\n\n  var push$1 = [].push;\n\n  function getValue$1() {\n  \tvar all = this.bindings.filter(function (b) {\n  \t\treturn b.node && b.node.checked;\n  \t}).map(function (b) {\n  \t\treturn b.element.getAttribute('value');\n  \t});\n  \tvar res = [];\n  \tall.forEach(function (v) {\n  \t\tif (!arrayContains(res, v)) res.push(v);\n  \t});\n  \treturn res;\n  }\n\n  var CheckboxNameBinding = function (_Binding) {\n  \tbabelHelpers.inherits(CheckboxNameBinding, _Binding);\n\n  \tfunction CheckboxNameBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, CheckboxNameBinding);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'name'));\n\n  \t\t_this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n  \t\t// Each input has a reference to an array containing it and its\n  \t\t// group, as two-way binding depends on being able to ascertain\n  \t\t// the status of all inputs within the group\n  \t\t_this.group = getBindingGroup('checkboxes', _this.model, getValue$1);\n  \t\t_this.group.add(_this);\n\n  \t\tif (_this.noInitialValue) {\n  \t\t\t_this.group.noInitialValue = true;\n  \t\t}\n\n  \t\t// If no initial value was set, and this input is checked, we\n  \t\t// update the model\n  \t\tif (_this.group.noInitialValue && _this.element.getAttribute('checked')) {\n  \t\t\tvar existingValue = _this.model.get();\n  \t\t\tvar bindingValue = _this.element.getAttribute('value');\n\n  \t\t\tif (!arrayContains(existingValue, bindingValue)) {\n  \t\t\t\tpush$1.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n  \t\t\t}\n  \t\t}\n  \t\treturn _this;\n  \t}\n\n  \tCheckboxNameBinding.prototype.bind = function bind() {\n  \t\tif (!this.group.bound) {\n  \t\t\tthis.group.bind();\n  \t\t}\n  \t};\n\n  \tCheckboxNameBinding.prototype.changed = function changed() {\n  \t\tvar wasChecked = !!this.isChecked;\n  \t\tthis.isChecked = this.node.checked;\n  \t\treturn this.isChecked === wasChecked;\n  \t};\n\n  \tCheckboxNameBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\t// This only gets called once per group (of inputs that\n  \t\t// share a name), because it only gets called if there\n  \t\t// isn't an initial value. By the same token, we can make\n  \t\t// a note of that fact that there was no initial value,\n  \t\t// and populate it using any `checked` attributes that\n  \t\t// exist (which users should avoid, but which we should\n  \t\t// support anyway to avoid breaking expectations)\n  \t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n  \t\treturn [];\n  \t};\n\n  \tCheckboxNameBinding.prototype.getValue = function getValue() {\n  \t\treturn this.group.value;\n  \t};\n\n  \tCheckboxNameBinding.prototype.handleChange = function handleChange() {\n  \t\tthis.isChecked = this.element.node.checked;\n  \t\tthis.group.value = this.model.get();\n  \t\tvar value = this.element.getAttribute('value');\n  \t\tif (this.isChecked && !arrayContains(this.group.value, value)) {\n  \t\t\tthis.group.value.push(value);\n  \t\t} else if (!this.isChecked && arrayContains(this.group.value, value)) {\n  \t\t\tremoveFromArray(this.group.value, value);\n  \t\t}\n  \t\t_Binding.prototype.handleChange.call(this);\n  \t};\n\n  \tCheckboxNameBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tvar node = this.node;\n\n  \t\tvar existingValue = this.model.get();\n  \t\tvar bindingValue = this.element.getAttribute('value');\n\n  \t\tif (isArray(existingValue)) {\n  \t\t\tthis.isChecked = arrayContains(existingValue, bindingValue);\n  \t\t} else {\n  \t\t\tthis.isChecked = existingValue == bindingValue;\n  \t\t}\n\n  \t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n  \t\tnode.checked = this.isChecked;\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n\n  \t\t// in case of IE emergency, bind to click event as well\n  \t\tif (node.attachEvent) {\n  \t\t\tnode.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tCheckboxNameBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.group.bindings.forEach(function (binding) {\n  \t\t\treturn binding.wasUndefined = true;\n  \t\t});\n\n  \t\tif (node.checked) {\n  \t\t\tvar valueSoFar = this.group.getValue();\n  \t\t\tvalueSoFar.push(this.element.getAttribute('value'));\n\n  \t\t\tthis.group.model.set(valueSoFar);\n  \t\t}\n  \t};\n\n  \tCheckboxNameBinding.prototype.unbind = function unbind() {\n  \t\tthis.group.remove(this);\n  \t};\n\n  \tCheckboxNameBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.element.node;\n\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \treturn CheckboxNameBinding;\n  }(Binding);\n\n  var ContentEditableBinding = function (_Binding) {\n  \tbabelHelpers.inherits(ContentEditableBinding, _Binding);\n\n  \tfunction ContentEditableBinding() {\n  \t\tbabelHelpers.classCallCheck(this, ContentEditableBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tContentEditableBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n  \t};\n\n  \tContentEditableBinding.prototype.getValue = function getValue() {\n  \t\treturn this.element.node.innerHTML;\n  \t};\n\n  \tContentEditableBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tvar node = this.node;\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n  \t\tnode.addEventListener('blur', handleDomEvent, false);\n\n  \t\tif (!this.ractive.lazy) {\n  \t\t\tnode.addEventListener('input', handleDomEvent, false);\n\n  \t\t\tif (node.attachEvent) {\n  \t\t\t\tnode.addEventListener('keyup', handleDomEvent, false);\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tContentEditableBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.innerHTML);\n  \t};\n\n  \tContentEditableBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.node;\n\n  \t\tnode.removeEventListener('blur', handleDomEvent, false);\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('input', handleDomEvent, false);\n  \t\tnode.removeEventListener('keyup', handleDomEvent, false);\n  \t};\n\n  \treturn ContentEditableBinding;\n  }(Binding);\n\n  function handleBlur() {\n  \thandleDomEvent.call(this);\n\n  \tvar value = this._ractive.binding.model.get();\n  \tthis.value = value == undefined ? '' : value;\n  }\n\n  function handleDelay(delay) {\n  \tvar timeout = void 0;\n\n  \treturn function () {\n  \t\tvar _this = this;\n\n  \t\tif (timeout) clearTimeout(timeout);\n\n  \t\ttimeout = setTimeout(function () {\n  \t\t\tvar binding = _this._ractive.binding;\n  \t\t\tif (binding.rendered) handleDomEvent.call(_this);\n  \t\t\ttimeout = null;\n  \t\t}, delay);\n  \t};\n  }\n\n  var GenericBinding = function (_Binding) {\n  \tbabelHelpers.inherits(GenericBinding, _Binding);\n\n  \tfunction GenericBinding() {\n  \t\tbabelHelpers.classCallCheck(this, GenericBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tGenericBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn '';\n  \t};\n\n  \tGenericBinding.prototype.getValue = function getValue() {\n  \t\treturn this.node.value;\n  \t};\n\n  \tGenericBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\t// any lazy setting for this element overrides the root\n  \t\t// if the value is a number, it's a timeout\n  \t\tvar lazy = this.ractive.lazy;\n  \t\tvar timeout = false;\n\n  \t\t// TODO handle at parse time\n  \t\tif (this.element.template.a && 'lazy' in this.element.template.a) {\n  \t\t\tlazy = this.element.template.a.lazy;\n  \t\t\tif (lazy === 0) lazy = true; // empty attribute\n  \t\t}\n\n  \t\t// TODO handle this at parse time as well?\n  \t\tif (lazy === 'false') lazy = false;\n\n  \t\tif (isNumeric(lazy)) {\n  \t\t\ttimeout = +lazy;\n  \t\t\tlazy = false;\n  \t\t}\n\n  \t\tthis.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n  \t\tvar node = this.node;\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (!lazy) {\n  \t\t\tnode.addEventListener('input', this.handler, false);\n\n  \t\t\tif (node.attachEvent) {\n  \t\t\t\tnode.addEventListener('keyup', this.handler, false);\n  \t\t\t}\n  \t\t}\n\n  \t\tnode.addEventListener('blur', handleBlur, false);\n  \t};\n\n  \tGenericBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.element.node;\n  \t\tthis.rendered = false;\n\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('input', this.handler, false);\n  \t\tnode.removeEventListener('keyup', this.handler, false);\n  \t\tnode.removeEventListener('blur', handleBlur, false);\n  \t};\n\n  \treturn GenericBinding;\n  }(Binding);\n\n  function getSelectedOptions(select) {\n  \treturn select.selectedOptions ? toArray(select.selectedOptions) : select.options ? toArray(select.options).filter(function (option) {\n  \t\treturn option.selected;\n  \t}) : [];\n  }\n\n  var MultipleSelectBinding = function (_Binding) {\n  \tbabelHelpers.inherits(MultipleSelectBinding, _Binding);\n\n  \tfunction MultipleSelectBinding() {\n  \t\tbabelHelpers.classCallCheck(this, MultipleSelectBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tMultipleSelectBinding.prototype.forceUpdate = function forceUpdate() {\n  \t\tvar _this2 = this;\n\n  \t\tvar value = this.getValue();\n\n  \t\tif (value !== undefined) {\n  \t\t\tthis.attribute.locked = true;\n  \t\t\trunloop.scheduleTask(function () {\n  \t\t\t\treturn _this2.attribute.locked = false;\n  \t\t\t});\n  \t\t\tthis.model.set(value);\n  \t\t}\n  \t};\n\n  \tMultipleSelectBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn this.element.options.filter(function (option) {\n  \t\t\treturn option.getAttribute('selected');\n  \t\t}).map(function (option) {\n  \t\t\treturn option.getAttribute('value');\n  \t\t});\n  \t};\n\n  \tMultipleSelectBinding.prototype.getValue = function getValue() {\n  \t\tvar options = this.element.node.options;\n  \t\tvar len = options.length;\n\n  \t\tvar selectedValues = [];\n\n  \t\tfor (var i = 0; i < len; i += 1) {\n  \t\t\tvar option = options[i];\n\n  \t\t\tif (option.selected) {\n  \t\t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value;\n  \t\t\t\tselectedValues.push(optionValue);\n  \t\t\t}\n  \t\t}\n\n  \t\treturn selectedValues;\n  \t};\n\n  \tMultipleSelectBinding.prototype.handleChange = function handleChange() {\n  \t\tvar attribute = this.attribute;\n  \t\tvar previousValue = attribute.getValue();\n\n  \t\tvar value = this.getValue();\n\n  \t\tif (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n  \t\t\t_Binding.prototype.handleChange.call(this);\n  \t\t}\n\n  \t\treturn this;\n  \t};\n\n  \tMultipleSelectBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (this.model.get() === undefined) {\n  \t\t\t// get value from DOM, if possible\n  \t\t\tthis.handleChange();\n  \t\t}\n  \t};\n\n  \tMultipleSelectBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tvar selectedOptions = getSelectedOptions(node);\n  \t\tvar i = selectedOptions.length;\n  \t\tvar result = new Array(i);\n\n  \t\twhile (i--) {\n  \t\t\tvar option = selectedOptions[i];\n  \t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\n  \t\t}\n\n  \t\tthis.model.set(result);\n  \t};\n\n  \tMultipleSelectBinding.prototype.setValue = function setValue() {\n  \t\tthrow new Error('TODO not implemented yet');\n  \t};\n\n  \tMultipleSelectBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t};\n\n  \tMultipleSelectBinding.prototype.updateModel = function updateModel() {\n  \t\tif (this.attribute.value === undefined || !this.attribute.value.length) {\n  \t\t\tthis.keypath.set(this.initialValue);\n  \t\t}\n  \t};\n\n  \treturn MultipleSelectBinding;\n  }(Binding);\n\n  var NumericBinding = function (_GenericBinding) {\n  \tbabelHelpers.inherits(NumericBinding, _GenericBinding);\n\n  \tfunction NumericBinding() {\n  \t\tbabelHelpers.classCallCheck(this, NumericBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _GenericBinding.apply(this, arguments));\n  \t}\n\n  \tNumericBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\treturn undefined;\n  \t};\n\n  \tNumericBinding.prototype.getValue = function getValue() {\n  \t\tvar value = parseFloat(this.node.value);\n  \t\treturn isNaN(value) ? undefined : value;\n  \t};\n\n  \tNumericBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tvar value = parseFloat(node.value);\n  \t\tif (!isNaN(value)) this.model.set(value);\n  \t};\n\n  \treturn NumericBinding;\n  }(GenericBinding);\n\n  var siblings = {};\n\n  function getSiblings(hash) {\n  \treturn siblings[hash] || (siblings[hash] = []);\n  }\n\n  var RadioBinding = function (_Binding) {\n  \tbabelHelpers.inherits(RadioBinding, _Binding);\n\n  \tfunction RadioBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, RadioBinding);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'checked'));\n\n  \t\t_this.siblings = getSiblings(_this.ractive._guid + _this.element.getAttribute('name'));\n  \t\t_this.siblings.push(_this);\n  \t\treturn _this;\n  \t}\n\n  \tRadioBinding.prototype.getValue = function getValue() {\n  \t\treturn this.node.checked;\n  \t};\n\n  \tRadioBinding.prototype.handleChange = function handleChange() {\n  \t\trunloop.start(this.root);\n\n  \t\tthis.siblings.forEach(function (binding) {\n  \t\t\tbinding.model.set(binding.getValue());\n  \t\t});\n\n  \t\trunloop.end();\n  \t};\n\n  \tRadioBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (this.node.attachEvent) {\n  \t\t\tthis.node.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tRadioBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tthis.model.set(node.checked);\n  \t};\n\n  \tRadioBinding.prototype.unbind = function unbind() {\n  \t\tremoveFromArray(this.siblings, this);\n  \t};\n\n  \tRadioBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t\tthis.node.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \treturn RadioBinding;\n  }(Binding);\n\n  function getValue$2() {\n  \tvar checked = this.bindings.filter(function (b) {\n  \t\treturn b.node.checked;\n  \t});\n  \tif (checked.length > 0) {\n  \t\treturn checked[0].element.getAttribute('value');\n  \t}\n  }\n\n  var RadioNameBinding = function (_Binding) {\n  \tbabelHelpers.inherits(RadioNameBinding, _Binding);\n\n  \tfunction RadioNameBinding(element) {\n  \t\tbabelHelpers.classCallCheck(this, RadioNameBinding);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Binding.call(this, element, 'name'));\n\n  \t\t_this.group = getBindingGroup('radioname', _this.model, getValue$2);\n  \t\t_this.group.add(_this);\n\n  \t\tif (element.checked) {\n  \t\t\t_this.group.value = _this.getValue();\n  \t\t}\n  \t\treturn _this;\n  \t}\n\n  \tRadioNameBinding.prototype.bind = function bind() {\n  \t\tvar _this2 = this;\n\n  \t\tif (!this.group.bound) {\n  \t\t\tthis.group.bind();\n  \t\t}\n\n  \t\t// update name keypath when necessary\n  \t\tthis.nameAttributeBinding = {\n  \t\t\thandleChange: function handleChange() {\n  \t\t\t\treturn _this2.node.name = '{{' + _this2.model.getKeypath() + '}}';\n  \t\t\t}\n  \t\t};\n\n  \t\tthis.model.getKeypathModel().register(this.nameAttributeBinding);\n  \t};\n\n  \tRadioNameBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\tif (this.element.getAttribute('checked')) {\n  \t\t\treturn this.element.getAttribute('value');\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.getValue = function getValue() {\n  \t\treturn this.element.getAttribute('value');\n  \t};\n\n  \tRadioNameBinding.prototype.handleChange = function handleChange() {\n  \t\t// If this <input> is the one that's checked, then the value of its\n  \t\t// `name` model gets set to its value\n  \t\tif (this.node.checked) {\n  \t\t\tthis.group.value = this.getValue();\n  \t\t\t_Binding.prototype.handleChange.call(this);\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n\n  \t\tvar node = this.node;\n\n  \t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n  \t\tnode.checked = this.model.get() == this.element.getAttribute('value');\n\n  \t\tnode.addEventListener('change', handleDomEvent, false);\n\n  \t\tif (node.attachEvent) {\n  \t\t\tnode.addEventListener('click', handleDomEvent, false);\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tif (node.checked) {\n  \t\t\tthis.group.model.set(this.element.getAttribute('value'));\n  \t\t}\n  \t};\n\n  \tRadioNameBinding.prototype.unbind = function unbind() {\n  \t\tthis.group.remove(this);\n\n  \t\tthis.model.getKeypathModel().unregister(this.nameAttributeBinding);\n  \t};\n\n  \tRadioNameBinding.prototype.unrender = function unrender() {\n  \t\tvar node = this.node;\n\n  \t\tnode.removeEventListener('change', handleDomEvent, false);\n  \t\tnode.removeEventListener('click', handleDomEvent, false);\n  \t};\n\n  \treturn RadioNameBinding;\n  }(Binding);\n\n  var SingleSelectBinding = function (_Binding) {\n  \tbabelHelpers.inherits(SingleSelectBinding, _Binding);\n\n  \tfunction SingleSelectBinding() {\n  \t\tbabelHelpers.classCallCheck(this, SingleSelectBinding);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Binding.apply(this, arguments));\n  \t}\n\n  \tSingleSelectBinding.prototype.forceUpdate = function forceUpdate() {\n  \t\tvar _this2 = this;\n\n  \t\tvar value = this.getValue();\n\n  \t\tif (value !== undefined) {\n  \t\t\tthis.attribute.locked = true;\n  \t\t\trunloop.scheduleTask(function () {\n  \t\t\t\treturn _this2.attribute.locked = false;\n  \t\t\t});\n  \t\t\tthis.model.set(value);\n  \t\t}\n  \t};\n\n  \tSingleSelectBinding.prototype.getInitialValue = function getInitialValue() {\n  \t\tif (this.element.getAttribute('value') !== undefined) {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar options = this.element.options;\n  \t\tvar len = options.length;\n\n  \t\tif (!len) return;\n\n  \t\tvar value = void 0;\n  \t\tvar optionWasSelected = void 0;\n  \t\tvar i = len;\n\n  \t\t// take the final selected option...\n  \t\twhile (i--) {\n  \t\t\tvar option = options[i];\n\n  \t\t\tif (option.getAttribute('selected')) {\n  \t\t\t\tif (!option.getAttribute('disabled')) {\n  \t\t\t\t\tvalue = option.getAttribute('value');\n  \t\t\t\t}\n\n  \t\t\t\toptionWasSelected = true;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n\n  \t\t// or the first non-disabled option, if none are selected\n  \t\tif (!optionWasSelected) {\n  \t\t\twhile (++i < len) {\n  \t\t\t\tif (!options[i].getAttribute('disabled')) {\n  \t\t\t\t\tvalue = options[i].getAttribute('value');\n  \t\t\t\t\tbreak;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\t// This is an optimisation (aka hack) that allows us to forgo some\n  \t\t// other more expensive work\n  \t\t// TODO does it still work? seems at odds with new architecture\n  \t\tif (value !== undefined) {\n  \t\t\tthis.element.attributeByName.value.value = value;\n  \t\t}\n\n  \t\treturn value;\n  \t};\n\n  \tSingleSelectBinding.prototype.getValue = function getValue() {\n  \t\tvar options = this.node.options;\n  \t\tvar len = options.length;\n\n  \t\tvar i = void 0;\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar option = options[i];\n\n  \t\t\tif (options[i].selected && !options[i].disabled) {\n  \t\t\t\treturn option._ractive ? option._ractive.value : option.value;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tSingleSelectBinding.prototype.render = function render() {\n  \t\t_Binding.prototype.render.call(this);\n  \t\tthis.node.addEventListener('change', handleDomEvent, false);\n  \t};\n\n  \tSingleSelectBinding.prototype.setFromNode = function setFromNode(node) {\n  \t\tvar option = getSelectedOptions(node)[0];\n  \t\tthis.model.set(option._ractive ? option._ractive.value : option.value);\n  \t};\n\n  \t// TODO this method is an anomaly... is it necessary?\n\n\n  \tSingleSelectBinding.prototype.setValue = function setValue(value) {\n  \t\tthis.model.set(value);\n  \t};\n\n  \tSingleSelectBinding.prototype.unrender = function unrender() {\n  \t\tthis.node.removeEventListener('change', handleDomEvent, false);\n  \t};\n\n  \treturn SingleSelectBinding;\n  }(Binding);\n\n  function isBindable(attribute) {\n  \treturn attribute && attribute.template.length === 1 && attribute.template[0].t === INTERPOLATOR && !attribute.template[0].s;\n  }\n\n  function selectBinding(element) {\n  \tvar attributes = element.attributeByName;\n\n  \t// contenteditable - bind if the contenteditable attribute is true\n  \t// or is bindable and may thus become true...\n  \tif (element.getAttribute('contenteditable') || isBindable(attributes.contenteditable)) {\n  \t\t// ...and this element also has a value attribute to bind\n  \t\treturn isBindable(attributes.value) ? ContentEditableBinding : null;\n  \t}\n\n  \t// <input>\n  \tif (element.name === 'input') {\n  \t\tvar type = element.getAttribute('type');\n\n  \t\tif (type === 'radio' || type === 'checkbox') {\n  \t\t\tvar bindName = isBindable(attributes.name);\n  \t\t\tvar bindChecked = isBindable(attributes.checked);\n\n  \t\t\t// for radios we can either bind the name attribute, or the checked attribute - not both\n  \t\t\tif (bindName && bindChecked) {\n  \t\t\t\tif (type === 'radio') {\n  \t\t\t\t\twarnIfDebug('A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n  \t\t\t\t} else {\n  \t\t\t\t\t// A checkbox with bindings for both name and checked - see https://github.com/ractivejs/ractive/issues/1749\n  \t\t\t\t\treturn CheckboxBinding;\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tif (bindName) {\n  \t\t\t\treturn type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n  \t\t\t}\n\n  \t\t\tif (bindChecked) {\n  \t\t\t\treturn type === 'radio' ? RadioBinding : CheckboxBinding;\n  \t\t\t}\n  \t\t}\n\n  \t\tif (type === 'file' && isBindable(attributes.value)) {\n  \t\t\treturn Binding;\n  \t\t}\n\n  \t\tif (isBindable(attributes.value)) {\n  \t\t\treturn type === 'number' || type === 'range' ? NumericBinding : GenericBinding;\n  \t\t}\n\n  \t\treturn null;\n  \t}\n\n  \t// <select>\n  \tif (element.name === 'select' && isBindable(attributes.value)) {\n  \t\treturn element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  \t}\n\n  \t// <textarea>\n  \tif (element.name === 'textarea' && isBindable(attributes.value)) {\n  \t\treturn GenericBinding;\n  \t}\n  }\n\n  function makeDirty$1(query) {\n  \tquery.makeDirty();\n  }\n\n  var Element = function (_Item) {\n  \tbabelHelpers.inherits(Element, _Item);\n\n  \tfunction Element(options) {\n  \t\tbabelHelpers.classCallCheck(this, Element);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.liveQueries = []; // TODO rare case. can we handle differently?\n\n  \t\t_this.name = options.template.e.toLowerCase();\n  \t\t_this.isVoid = voidElementNames.test(_this.name);\n\n  \t\t// find parent element\n  \t\tvar fragment = _this.parentFragment;\n  \t\twhile (fragment) {\n  \t\t\tif (fragment.owner.type === ELEMENT) {\n  \t\t\t\t_this.parent = fragment.owner;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t\tfragment = fragment.parent;\n  \t\t}\n\n  \t\tif (_this.parent && _this.parent.name === 'option') {\n  \t\t\tthrow new Error('An <option> element cannot contain other elements (encountered <' + _this.name + '>)');\n  \t\t}\n\n  \t\t// create attributes\n  \t\t_this.attributeByName = {};\n  \t\t_this.attributes = [];\n\n  \t\tif (_this.template.a) {\n  \t\t\tObject.keys(_this.template.a).forEach(function (name) {\n  \t\t\t\t// TODO process this at parse time\n  \t\t\t\tif (name === 'twoway' || name === 'lazy') return;\n\n  \t\t\t\tvar attribute = new Attribute({\n  \t\t\t\t\tname: name,\n  \t\t\t\t\telement: _this,\n  \t\t\t\t\tparentFragment: _this.parentFragment,\n  \t\t\t\t\ttemplate: _this.template.a[name]\n  \t\t\t\t});\n\n  \t\t\t\t_this.attributeByName[name] = attribute;\n\n  \t\t\t\tif (name !== 'value' && name !== 'type') _this.attributes.push(attribute);\n  \t\t\t});\n\n  \t\t\tif (_this.attributeByName.type) _this.attributes.unshift(_this.attributeByName.type);\n  \t\t\tif (_this.attributeByName.value) _this.attributes.push(_this.attributeByName.value);\n  \t\t}\n\n  \t\t// create conditional attributes\n  \t\t_this.conditionalAttributes = (_this.template.m || []).map(function (template) {\n  \t\t\treturn new ConditionalAttribute({\n  \t\t\t\towner: _this,\n  \t\t\t\tparentFragment: _this.parentFragment,\n  \t\t\t\ttemplate: template\n  \t\t\t});\n  \t\t});\n\n  \t\t// create decorator\n  \t\tif (_this.template.o) {\n  \t\t\t_this.decorator = new Decorator(_this, _this.template.o);\n  \t\t}\n\n  \t\t// attach event handlers\n  \t\t_this.eventHandlers = [];\n  \t\tif (_this.template.v) {\n  \t\t\tObject.keys(_this.template.v).forEach(function (key) {\n  \t\t\t\tvar eventNames = key.split('-');\n  \t\t\t\tvar template = _this.template.v[key];\n\n  \t\t\t\teventNames.forEach(function (eventName) {\n  \t\t\t\t\tvar fn = findInViewHierarchy('events', _this.ractive, eventName);\n  \t\t\t\t\t// we need to pass in \"this\" in order to get\n  \t\t\t\t\t// access to node when it is created.\n  \t\t\t\t\tvar event = fn ? new CustomEvent(fn, _this) : new DOMEvent(eventName, _this);\n  \t\t\t\t\t_this.eventHandlers.push(new EventDirective(_this, event, template));\n  \t\t\t\t});\n  \t\t\t});\n  \t\t}\n\n  \t\t// create children\n  \t\tif (options.template.f && !options.noContent) {\n  \t\t\t_this.fragment = new Fragment({\n  \t\t\t\ttemplate: options.template.f,\n  \t\t\t\towner: _this,\n  \t\t\t\tcssIds: null\n  \t\t\t});\n  \t\t}\n\n  \t\t_this.binding = null; // filled in later\n  \t\treturn _this;\n  \t}\n\n  \tElement.prototype.bind = function bind() {\n  \t\tthis.attributes.forEach(_bind);\n  \t\tthis.conditionalAttributes.forEach(_bind);\n  \t\tthis.eventHandlers.forEach(_bind);\n\n  \t\tif (this.decorator) this.decorator.bind();\n  \t\tif (this.fragment) this.fragment.bind();\n\n  \t\t// create two-way binding if necessary\n  \t\tif (this.binding = this.createTwowayBinding()) this.binding.bind();\n  \t};\n\n  \tElement.prototype.createTwowayBinding = function createTwowayBinding() {\n  \t\tvar attributes = this.template.a;\n\n  \t\tif (!attributes) return null;\n\n  \t\tvar shouldBind = 'twoway' in attributes ? attributes.twoway === 0 || attributes.twoway === 'true' : // covers `twoway` and `twoway='true'`\n  \t\tthis.ractive.twoway;\n\n  \t\tif (!shouldBind) return null;\n\n  \t\tvar Binding = selectBinding(this);\n\n  \t\tif (!Binding) return null;\n\n  \t\tvar binding = new Binding(this);\n\n  \t\treturn binding && binding.model ? binding : null;\n  \t};\n\n  \tElement.prototype.detach = function detach() {\n  \t\tif (this.decorator) this.decorator.unrender();\n  \t\treturn detachNode(this.node);\n  \t};\n\n  \tElement.prototype.find = function find(selector) {\n  \t\tif (matches(this.node, selector)) return this.node;\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.find(selector);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findAll = function findAll(selector, query) {\n  \t\t// Add this node to the query, if applicable, and register the\n  \t\t// query on this element\n  \t\tvar matches = query.test(this.node);\n  \t\tif (matches) {\n  \t\t\tquery.add(this.node);\n  \t\t\tif (query.live) this.liveQueries.push(query);\n  \t\t}\n\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findComponent = function findComponent(name) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tElement.prototype.findNextNode = function findNextNode() {\n  \t\treturn null;\n  \t};\n\n  \tElement.prototype.firstNode = function firstNode() {\n  \t\treturn this.node;\n  \t};\n\n  \tElement.prototype.getAttribute = function getAttribute(name) {\n  \t\tvar attribute = this.attributeByName[name];\n  \t\treturn attribute ? attribute.getValue() : undefined;\n  \t};\n\n  \tElement.prototype.rebind = function rebind() {\n  \t\tthis.attributes.forEach(_rebind);\n  \t\tthis.conditionalAttributes.forEach(_rebind);\n  \t\tthis.eventHandlers.forEach(_rebind);\n  \t\tif (this.decorator) this.decorator.rebind();\n  \t\tif (this.fragment) this.fragment.rebind();\n  \t\tif (this.binding) this.binding.rebind();\n\n  \t\tthis.liveQueries.forEach(makeDirty$1);\n  \t};\n\n  \tElement.prototype.render = function render(target, occupants) {\n  \t\tvar _this2 = this;\n\n  \t\t// TODO determine correct namespace\n  \t\tthis.namespace = getNamespace(this);\n\n  \t\tvar node = void 0;\n  \t\tvar existing = false;\n\n  \t\tif (occupants) {\n  \t\t\tvar n = void 0;\n  \t\t\twhile (n = occupants.shift()) {\n  \t\t\t\tif (n.nodeName === this.template.e.toUpperCase() && n.namespaceURI === this.namespace) {\n  \t\t\t\t\tthis.node = node = n;\n  \t\t\t\t\texisting = true;\n  \t\t\t\t\tbreak;\n  \t\t\t\t} else {\n  \t\t\t\t\tdetachNode(n);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tif (!node) {\n  \t\t\tnode = createElement(this.template.e, this.namespace, this.getAttribute('is'));\n  \t\t\tthis.node = node;\n  \t\t}\n\n  \t\tdefineProperty(node, '_ractive', {\n  \t\t\tvalue: {\n  \t\t\t\tproxy: this,\n  \t\t\t\tfragment: this.parentFragment\n  \t\t\t}\n  \t\t});\n\n  \t\t// Is this a top-level node of a component? If so, we may need to add\n  \t\t// a data-ractive-css attribute, for CSS encapsulation\n  \t\tif (this.parentFragment.cssIds) {\n  \t\t\tnode.setAttribute('data-ractive-css', this.parentFragment.cssIds.map(function (x) {\n  \t\t\t\treturn '{' + x + '}';\n  \t\t\t}).join(' '));\n  \t\t}\n\n  \t\tif (existing && this.foundNode) this.foundNode(node);\n\n  \t\tif (this.fragment) {\n  \t\t\tvar children = existing ? toArray(node.childNodes) : undefined;\n  \t\t\tthis.fragment.render(node, children);\n\n  \t\t\t// clean up leftover children\n  \t\t\tif (children) {\n  \t\t\t\tchildren.forEach(detachNode);\n  \t\t\t}\n  \t\t}\n\n  \t\tif (existing) {\n  \t\t\t// store initial values for two-way binding\n  \t\t\tif (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n\n  \t\t\t// remove unused attributes\n  \t\t\tvar i = node.attributes.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tvar name = node.attributes[i].name;\n  \t\t\t\tif (!this.template.a || !(name in this.template.a)) node.removeAttribute(name);\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.attributes.forEach(_render);\n  \t\tthis.conditionalAttributes.forEach(_render);\n\n  \t\tif (this.decorator) runloop.scheduleTask(function () {\n  \t\t\treturn _this2.decorator.render();\n  \t\t}, true);\n  \t\tif (this.binding) this.binding.render();\n\n  \t\tthis.eventHandlers.forEach(_render);\n\n  \t\tupdateLiveQueries$1(this);\n\n  \t\t// store so we can abort if it gets removed\n  \t\tthis._introTransition = getTransition(this, this.template.t0 || this.template.t1, 'intro');\n\n  \t\tif (!existing) {\n  \t\t\ttarget.appendChild(node);\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tElement.prototype.toString = function toString() {\n  \t\tvar tagName = this.template.e;\n\n  \t\tvar attrs = this.attributes.map(stringifyAttribute).join('') + this.conditionalAttributes.map(stringifyAttribute).join('');\n\n  \t\t// Special case - selected options\n  \t\tif (this.name === 'option' && this.isSelected()) {\n  \t\t\tattrs += ' selected';\n  \t\t}\n\n  \t\t// Special case - two-way radio name bindings\n  \t\tif (this.name === 'input' && inputIsCheckedRadio(this)) {\n  \t\t\tattrs += ' checked';\n  \t\t}\n\n  \t\tvar str = '<' + tagName + attrs + '>';\n\n  \t\tif (this.isVoid) return str;\n\n  \t\t// Special case - textarea\n  \t\tif (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n  \t\t\tstr += escapeHtml(this.getAttribute('value'));\n  \t\t}\n\n  \t\t// Special case - contenteditable\n  \t\telse if (this.getAttribute('contenteditable') !== undefined) {\n  \t\t\t\tstr += this.getAttribute('value') || '';\n  \t\t\t}\n\n  \t\tif (this.fragment) {\n  \t\t\tstr += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n  \t\t}\n\n  \t\tstr += '</' + tagName + '>';\n  \t\treturn str;\n  \t};\n\n  \tElement.prototype.unbind = function unbind() {\n  \t\tthis.attributes.forEach(_unbind);\n  \t\tthis.conditionalAttributes.forEach(_unbind);\n\n  \t\tif (this.decorator) this.decorator.unbind();\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tElement.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (!this.rendered) return;\n  \t\tthis.rendered = false;\n\n  \t\t// unrendering before intro completed? complete it now\n  \t\t// TODO should be an API for aborting transitions\n  \t\tvar transition = this._introTransition;\n  \t\tif (transition) transition.complete();\n\n  \t\t// Detach as soon as we can\n  \t\tif (this.name === 'option') {\n  \t\t\t// <option> elements detach immediately, so that\n  \t\t\t// their parent <select> element syncs correctly, and\n  \t\t\t// since option elements can't have transitions anyway\n  \t\t\tthis.detach();\n  \t\t} else if (shouldDestroy) {\n  \t\t\trunloop.detachWhenReady(this);\n  \t\t}\n\n  \t\tif (this.fragment) this.fragment.unrender();\n\n  \t\tthis.eventHandlers.forEach(_unrender);\n\n  \t\tif (this.binding) this.binding.unrender();\n  \t\tif (!shouldDestroy && this.decorator) this.decorator.unrender();\n\n  \t\t// outro transition\n  \t\tgetTransition(this, this.template.t0 || this.template.t2, 'outro');\n\n  \t\t// special case\n  \t\tvar id = this.attributeByName.id;\n  \t\tif (id) {\n  \t\t\tdelete this.ractive.nodes[id.getValue()];\n  \t\t}\n\n  \t\tremoveFromLiveQueries(this);\n  \t\t// TODO forms are a special case\n  \t};\n\n  \tElement.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tthis.attributes.forEach(_update);\n  \t\t\tthis.conditionalAttributes.forEach(_update);\n  \t\t\tthis.eventHandlers.forEach(_update);\n\n  \t\t\tif (this.decorator) this.decorator.update();\n  \t\t\tif (this.fragment) this.fragment.update();\n  \t\t}\n  \t};\n\n  \treturn Element;\n  }(Item);\n\n  function getTransition(owner, template, eventName) {\n  \tif (!template || !owner.ractive.transitionsEnabled) return;\n\n  \tvar name = getTransitionName(owner, template);\n  \tif (!name) return;\n\n  \tvar params = getTransitionParams(owner, template);\n  \tvar transition = new Transition(owner.ractive, owner.node, name, params, eventName);\n  \trunloop.registerTransition(transition);\n  \treturn transition;\n  }\n\n  function getTransitionName(owner, template) {\n  \tvar name = template.n || template;\n\n  \tif (typeof name === 'string') return name;\n\n  \tvar fragment = new Fragment({\n  \t\towner: owner,\n  \t\ttemplate: name\n  \t}).bind(); // TODO need a way to capture values without bind()\n\n  \tname = fragment.toString();\n  \tfragment.unbind();\n\n  \treturn name;\n  }\n\n  function getTransitionParams(owner, template) {\n  \tif (template.a) return template.a;\n  \tif (!template.d) return;\n\n  \t// TODO is there a way to interpret dynamic arguments without all the\n  \t// 'dependency thrashing'?\n  \tvar fragment = new Fragment({\n  \t\towner: owner,\n  \t\ttemplate: template.d\n  \t}).bind();\n\n  \tvar params = fragment.getArgsList();\n  \tfragment.unbind();\n\n  \treturn params;\n  }\n\n  function inputIsCheckedRadio(element) {\n  \tvar attributes = element.attributeByName;\n\n  \tvar typeAttribute = attributes.type;\n  \tvar valueAttribute = attributes.value;\n  \tvar nameAttribute = attributes.name;\n\n  \tif (!typeAttribute || typeAttribute.value !== 'radio' || !valueAttribute || !nameAttribute.interpolator) {\n  \t\treturn;\n  \t}\n\n  \tif (valueAttribute.getValue() === nameAttribute.interpolator.model.get()) {\n  \t\treturn true;\n  \t}\n  }\n\n  function stringifyAttribute(attribute) {\n  \tvar str = attribute.toString();\n  \treturn str ? ' ' + str : '';\n  }\n\n  function removeFromLiveQueries(element) {\n  \tvar i = element.liveQueries.length;\n  \twhile (i--) {\n  \t\tvar query = element.liveQueries[i];\n  \t\tquery.remove(element.node);\n  \t}\n  }\n\n  function getNamespace(element) {\n  \t// Use specified namespace...\n  \tvar xmlns = element.getAttribute('xmlns');\n  \tif (xmlns) return xmlns;\n\n  \t// ...or SVG namespace, if this is an <svg> element\n  \tif (element.name === 'svg') return svg$1;\n\n  \tvar parent = element.parent;\n\n  \tif (parent) {\n  \t\t// ...or HTML, if the parent is a <foreignObject>\n  \t\tif (parent.name === 'foreignobject') return html;\n\n  \t\t// ...or inherit from the parent node\n  \t\treturn parent.node.namespaceURI;\n  \t}\n\n  \treturn element.ractive.el.namespaceURI;\n  }\n\n  var Form = function (_Element) {\n  \tbabelHelpers.inherits(Form, _Element);\n\n  \tfunction Form(options) {\n  \t\tbabelHelpers.classCallCheck(this, Form);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Element.call(this, options));\n\n  \t\t_this.formBindings = [];\n  \t\treturn _this;\n  \t}\n\n  \tForm.prototype.render = function render(target, occupants) {\n  \t\t_Element.prototype.render.call(this, target, occupants);\n  \t\tthis.node.addEventListener('reset', handleReset, false);\n  \t};\n\n  \tForm.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.node.removeEventListener('reset', handleReset, false);\n  \t\t_Element.prototype.unrender.call(this, shouldDestroy);\n  \t};\n\n  \treturn Form;\n  }(Element);\n\n  function handleReset() {\n  \tvar element = this._ractive.proxy;\n\n  \trunloop.start();\n  \telement.formBindings.forEach(updateModel);\n  \trunloop.end();\n  }\n\n  function updateModel(binding) {\n  \tbinding.model.set(binding.resetValue);\n  }\n\n  var Mustache = function (_Item) {\n  \tbabelHelpers.inherits(Mustache, _Item);\n\n  \tfunction Mustache(options) {\n  \t\tbabelHelpers.classCallCheck(this, Mustache);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.parentFragment = options.parentFragment;\n  \t\t_this.template = options.template;\n  \t\t_this.index = options.index;\n\n  \t\t_this.isStatic = !!options.template.s;\n\n  \t\t_this.model = null;\n  \t\t_this.dirty = false;\n  \t\treturn _this;\n  \t}\n\n  \tMustache.prototype.bind = function bind() {\n  \t\tvar _this2 = this;\n\n  \t\t// try to find a model for this view\n  \t\tvar model = resolve$1(this.parentFragment, this.template);\n  \t\tvar value = model ? model.get() : undefined;\n\n  \t\tif (this.isStatic) {\n  \t\t\tthis.model = { get: function get() {\n  \t\t\t\t\treturn value;\n  \t\t\t\t} };\n  \t\t\treturn;\n  \t\t}\n\n  \t\tif (model) {\n  \t\t\tmodel.register(this);\n  \t\t\tthis.model = model;\n  \t\t} else {\n  \t\t\tthis.resolver = this.parentFragment.resolve(this.template.r, function (model) {\n  \t\t\t\t_this2.model = model;\n  \t\t\t\tmodel.register(_this2);\n\n  \t\t\t\t_this2.handleChange();\n  \t\t\t\t_this2.resolver = null;\n  \t\t\t});\n  \t\t}\n  \t};\n\n  \tMustache.prototype.handleChange = function handleChange() {\n  \t\tthis.bubble();\n  \t};\n\n  \tMustache.prototype.rebind = function rebind() {\n  \t\tif (this.isStatic || !this.model) return;\n\n  \t\tvar model = resolve$1(this.parentFragment, this.template);\n\n  \t\tif (model === this.model) return;\n\n  \t\tthis.model.unregister(this);\n\n  \t\tthis.model = model;\n\n  \t\tif (model) {\n  \t\t\tmodel.register(this);\n  \t\t\tthis.handleChange();\n  \t\t}\n  \t};\n\n  \tMustache.prototype.unbind = function unbind() {\n  \t\tif (!this.isStatic) {\n  \t\t\tthis.model && this.model.unregister(this);\n  \t\t\tthis.model = undefined;\n  \t\t\tthis.resolver && this.resolver.unbind();\n  \t\t}\n  \t};\n\n  \treturn Mustache;\n  }(Item);\n\n  var Interpolator = function (_Mustache) {\n  \tbabelHelpers.inherits(Interpolator, _Mustache);\n\n  \tfunction Interpolator() {\n  \t\tbabelHelpers.classCallCheck(this, Interpolator);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Mustache.apply(this, arguments));\n  \t}\n\n  \tInterpolator.prototype.detach = function detach() {\n  \t\treturn detachNode(this.node);\n  \t};\n\n  \tInterpolator.prototype.firstNode = function firstNode() {\n  \t\treturn this.node;\n  \t};\n\n  \tInterpolator.prototype.getString = function getString() {\n  \t\treturn this.model ? safeToStringValue(this.model.get()) : '';\n  \t};\n\n  \tInterpolator.prototype.render = function render(target, occupants) {\n  \t\tvar value = this.getString();\n\n  \t\tthis.rendered = true;\n\n  \t\tif (occupants) {\n  \t\t\tvar n = occupants[0];\n  \t\t\tif (n && n.nodeType === 3) {\n  \t\t\t\toccupants.shift();\n  \t\t\t\tif (n.nodeValue !== value) {\n  \t\t\t\t\tn.nodeValue = value;\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tn = this.node = doc.createTextNode(value);\n  \t\t\t\tif (occupants[0]) {\n  \t\t\t\t\ttarget.insertBefore(n, occupants[0]);\n  \t\t\t\t} else {\n  \t\t\t\t\ttarget.appendChild(n);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.node = n;\n  \t\t} else {\n  \t\t\tthis.node = doc.createTextNode(value);\n  \t\t\ttarget.appendChild(this.node);\n  \t\t}\n  \t};\n\n  \tInterpolator.prototype.toString = function toString(escape) {\n  \t\tvar string = this.getString();\n  \t\treturn escape ? escapeHtml(string) : string;\n  \t};\n\n  \tInterpolator.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (shouldDestroy) this.detach();\n  \t\tthis.rendered = false;\n  \t};\n\n  \tInterpolator.prototype.update = function update() {\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n  \t\t\tif (this.rendered) {\n  \t\t\t\tthis.node.data = this.getString();\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tInterpolator.prototype.valueOf = function valueOf() {\n  \t\treturn this.model ? this.model.get() : undefined;\n  \t};\n\n  \treturn Interpolator;\n  }(Mustache);\n\n  var Input = function (_Element) {\n  \tbabelHelpers.inherits(Input, _Element);\n\n  \tfunction Input() {\n  \t\tbabelHelpers.classCallCheck(this, Input);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Element.apply(this, arguments));\n  \t}\n\n  \tInput.prototype.render = function render(target, occupants) {\n  \t\t_Element.prototype.render.call(this, target, occupants);\n  \t\tthis.node.defaultValue = this.node.value;\n  \t};\n\n  \treturn Input;\n  }(Element);\n\n  function findParentSelect(element) {\n  \twhile (element) {\n  \t\tif (element.name === 'select') return element;\n  \t\telement = element.parent;\n  \t}\n  }\n\n  var Option = function (_Element) {\n  \tbabelHelpers.inherits(Option, _Element);\n\n  \tfunction Option(options) {\n  \t\tbabelHelpers.classCallCheck(this, Option);\n\n  \t\tvar template = options.template;\n  \t\tif (!template.a) template.a = {};\n\n  \t\t// If the value attribute is missing, use the element's content,\n  \t\t// as long as it isn't disabled\n  \t\tif (template.a.value === undefined && !('disabled' in template.a)) {\n  \t\t\ttemplate.a.value = template.f || '';\n  \t\t}\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Element.call(this, options));\n\n  \t\t_this.select = findParentSelect(_this.parent);\n  \t\treturn _this;\n  \t}\n\n  \tOption.prototype.bind = function bind() {\n  \t\tif (!this.select) {\n  \t\t\t_Element.prototype.bind.call(this);\n  \t\t\treturn;\n  \t\t}\n\n  \t\t// If the select has a value, it overrides the `selected` attribute on\n  \t\t// this option - so we delete the attribute\n  \t\tvar selectedAttribute = this.attributeByName.selected;\n  \t\tif (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n  \t\t\tvar index = this.attributes.indexOf(selectedAttribute);\n  \t\t\tthis.attributes.splice(index, 1);\n  \t\t\tdelete this.attributeByName.selected;\n  \t\t}\n\n  \t\t_Element.prototype.bind.call(this);\n  \t\tthis.select.options.push(this);\n  \t};\n\n  \tOption.prototype.isSelected = function isSelected() {\n  \t\tvar optionValue = this.getAttribute('value');\n\n  \t\tif (optionValue === undefined || !this.select) {\n  \t\t\treturn false;\n  \t\t}\n\n  \t\tvar selectValue = this.select.getAttribute('value');\n\n  \t\tif (selectValue == optionValue) {\n  \t\t\treturn true;\n  \t\t}\n\n  \t\tif (this.select.getAttribute('multiple') && isArray(selectValue)) {\n  \t\t\tvar i = selectValue.length;\n  \t\t\twhile (i--) {\n  \t\t\t\tif (selectValue[i] == optionValue) {\n  \t\t\t\t\treturn true;\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tOption.prototype.unbind = function unbind() {\n  \t\t_Element.prototype.unbind.call(this);\n\n  \t\tif (this.select) {\n  \t\t\tremoveFromArray(this.select.options, this);\n  \t\t}\n  \t};\n\n  \treturn Option;\n  }(Element);\n\n  function getPartialTemplate(ractive, name, parentFragment) {\n  \t// If the partial in instance or view heirarchy instances, great\n  \tvar partial = getPartialFromRegistry(ractive, name, parentFragment || {});\n  \tif (partial) return partial;\n\n  \t// Does it exist on the page as a script tag?\n  \tpartial = parser.fromId(name, { noThrow: true });\n  \tif (partial) {\n  \t\t// parse and register to this ractive instance\n  \t\tvar parsed = parser.parseFor(partial, ractive);\n\n  \t\t// register extra partials on the ractive instance if they don't already exist\n  \t\tif (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n  \t\t// register (and return main partial if there are others in the template)\n  \t\treturn ractive.partials[name] = parsed.t;\n  \t}\n  }\n\n  function getPartialFromRegistry(ractive, name, parentFragment) {\n  \t// if there was an instance up-hierarchy, cool\n  \tvar partial = findParentPartial(name, parentFragment.owner);\n  \tif (partial) return partial;\n\n  \t// find first instance in the ractive or view hierarchy that has this partial\n  \tvar instance = findInstance('partials', ractive, name);\n\n  \tif (!instance) {\n  \t\treturn;\n  \t}\n\n  \tpartial = instance.partials[name];\n\n  \t// partial is a function?\n  \tvar fn = void 0;\n  \tif (typeof partial === 'function') {\n  \t\tfn = partial.bind(instance);\n  \t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n  \t\tpartial = fn.call(ractive, parser);\n  \t}\n\n  \tif (!partial && partial !== '') {\n  \t\twarnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', { ractive: ractive });\n  \t\treturn;\n  \t}\n\n  \t// If this was added manually to the registry,\n  \t// but hasn't been parsed, parse it now\n  \tif (!parser.isParsed(partial)) {\n  \t\t// use the parseOptions of the ractive instance on which it was found\n  \t\tvar parsed = parser.parseFor(partial, instance);\n\n  \t\t// Partials cannot contain nested partials!\n  \t\t// TODO add a test for this\n  \t\tif (parsed.p) {\n  \t\t\twarnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive: ractive });\n  \t\t}\n\n  \t\t// if fn, use instance to store result, otherwise needs to go\n  \t\t// in the correct point in prototype chain on instance or constructor\n  \t\tvar target = fn ? instance : findOwner(instance, name);\n\n  \t\t// may be a template with partials, which need to be registered and main template extracted\n  \t\ttarget.partials[name] = partial = parsed.t;\n  \t}\n\n  \t// store for reset\n  \tif (fn) partial._fn = fn;\n\n  \treturn partial.v ? partial.t : partial;\n  }\n\n  function findOwner(ractive, key) {\n  \treturn ractive.partials.hasOwnProperty(key) ? ractive : findConstructor(ractive.constructor, key);\n  }\n\n  function findConstructor(constructor, key) {\n  \tif (!constructor) {\n  \t\treturn;\n  \t}\n  \treturn constructor.partials.hasOwnProperty(key) ? constructor : findConstructor(constructor._Parent, key);\n  }\n\n  function findParentPartial(name, parent) {\n  \tif (parent) {\n  \t\tif (parent.template && parent.template.p && parent.template.p[name]) {\n  \t\t\treturn parent.template.p[name];\n  \t\t} else if (parent.parentFragment && parent.parentFragment.owner) {\n  \t\t\treturn findParentPartial(name, parent.parentFragment.owner);\n  \t\t}\n  \t}\n  }\n\n  var Partial = function (_Mustache) {\n  \tbabelHelpers.inherits(Partial, _Mustache);\n\n  \tfunction Partial() {\n  \t\tbabelHelpers.classCallCheck(this, Partial);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Mustache.apply(this, arguments));\n  \t}\n\n  \tPartial.prototype.bind = function bind() {\n  \t\t// keep track of the reference name for future resets\n  \t\tthis.refName = this.template.r;\n\n  \t\t// name matches take priority over expressions\n  \t\tvar template = this.refName ? getPartialTemplate(this.ractive, this.refName, this.parentFragment) || null : null;\n  \t\tvar templateObj = void 0;\n\n  \t\tif (template) {\n  \t\t\tthis.named = true;\n  \t\t\tthis.setTemplate(this.template.r, template);\n  \t\t}\n\n  \t\tif (!template) {\n  \t\t\t_Mustache.prototype.bind.call(this);\n  \t\t\tif (this.model && (templateObj = this.model.get()) && (typeof templateObj === 'undefined' ? 'undefined' : babelHelpers.typeof(templateObj)) === 'object' && (typeof templateObj.template === 'string' || isArray(templateObj.t))) {\n  \t\t\t\tif (templateObj.template) {\n  \t\t\t\t\ttemplateObj = parsePartial(this.template.r, templateObj.template, this.ractive);\n  \t\t\t\t}\n  \t\t\t\tthis.setTemplate(this.template.r, templateObj.t);\n  \t\t\t} else if ((!this.model || typeof this.model.get() !== 'string') && this.refName) {\n  \t\t\t\tthis.setTemplate(this.refName, template);\n  \t\t\t} else {\n  \t\t\t\tthis.setTemplate(this.model.get());\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\ttemplate: this.partialTemplate\n  \t\t}).bind();\n  \t};\n\n  \tPartial.prototype.detach = function detach() {\n  \t\treturn this.fragment.detach();\n  \t};\n\n  \tPartial.prototype.find = function find(selector) {\n  \t\treturn this.fragment.find(selector);\n  \t};\n\n  \tPartial.prototype.findAll = function findAll(selector, query) {\n  \t\tthis.fragment.findAll(selector, query);\n  \t};\n\n  \tPartial.prototype.findComponent = function findComponent(name) {\n  \t\treturn this.fragment.findComponent(name);\n  \t};\n\n  \tPartial.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tthis.fragment.findAllComponents(name, query);\n  \t};\n\n  \tPartial.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment.firstNode(skipParent);\n  \t};\n\n  \tPartial.prototype.forceResetTemplate = function forceResetTemplate() {\n  \t\tthis.partialTemplate = undefined;\n\n  \t\t// on reset, check for the reference name first\n  \t\tif (this.refName) {\n  \t\t\tthis.partialTemplate = getPartialTemplate(this.ractive, this.refName, this.parentFragment);\n  \t\t}\n\n  \t\t// then look for the resolved name\n  \t\tif (!this.partialTemplate) {\n  \t\t\tthis.partialTemplate = getPartialTemplate(this.ractive, this.name, this.parentFragment);\n  \t\t}\n\n  \t\tif (!this.partialTemplate) {\n  \t\t\twarnOnceIfDebug('Could not find template for partial \\'' + this.name + '\\'');\n  \t\t\tthis.partialTemplate = [];\n  \t\t}\n\n  \t\tthis.fragment.resetTemplate(this.partialTemplate);\n  \t\tthis.bubble();\n  \t};\n\n  \tPartial.prototype.rebind = function rebind() {\n  \t\t_Mustache.prototype.unbind.call(this);\n  \t\t_Mustache.prototype.bind.call(this);\n  \t\tthis.fragment.rebind();\n  \t};\n\n  \tPartial.prototype.render = function render(target, occupants) {\n  \t\tthis.fragment.render(target, occupants);\n  \t};\n\n  \tPartial.prototype.setTemplate = function setTemplate(name, template) {\n  \t\tthis.name = name;\n\n  \t\tif (!template && template !== null) template = getPartialTemplate(this.ractive, name, this.parentFragment);\n\n  \t\tif (!template) {\n  \t\t\twarnOnceIfDebug('Could not find template for partial \\'' + name + '\\'');\n  \t\t}\n\n  \t\tthis.partialTemplate = template || [];\n  \t};\n\n  \tPartial.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment.toString(escape);\n  \t};\n\n  \tPartial.prototype.unbind = function unbind() {\n  \t\t_Mustache.prototype.unbind.call(this);\n  \t\tthis.fragment.unbind();\n  \t};\n\n  \tPartial.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.fragment.unrender(shouldDestroy);\n  \t};\n\n  \tPartial.prototype.update = function update() {\n  \t\tvar template = void 0;\n\n  \t\tif (this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tif (!this.named) {\n  \t\t\t\tif (this.model) {\n  \t\t\t\t\ttemplate = this.model.get();\n  \t\t\t\t}\n\n  \t\t\t\tif (template && typeof template === 'string' && template !== this.name) {\n  \t\t\t\t\tthis.setTemplate(template);\n  \t\t\t\t\tthis.fragment.resetTemplate(this.partialTemplate);\n  \t\t\t\t} else if (template && (typeof template === 'undefined' ? 'undefined' : babelHelpers.typeof(template)) === 'object' && (typeof template.template === 'string' || isArray(template.t))) {\n  \t\t\t\t\tif (template.template) {\n  \t\t\t\t\t\ttemplate = parsePartial(this.name, template.template, this.ractive);\n  \t\t\t\t\t}\n  \t\t\t\t\tthis.setTemplate(this.name, template.t);\n  \t\t\t\t\tthis.fragment.resetTemplate(this.partialTemplate);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.fragment.update();\n  \t\t}\n  \t};\n\n  \treturn Partial;\n  }(Mustache);\n\n  function parsePartial(name, partial, ractive) {\n  \tvar parsed = void 0;\n\n  \ttry {\n  \t\tparsed = parser.parse(partial, parser.getParseOptions(ractive));\n  \t} catch (e) {\n  \t\twarnIfDebug('Could not parse partial from expression \\'' + name + '\\'\\n' + e.message);\n  \t}\n\n  \treturn parsed || { t: [] };\n  }\n\n  var RepeatedFragment = function () {\n  \tfunction RepeatedFragment(options) {\n  \t\tbabelHelpers.classCallCheck(this, RepeatedFragment);\n\n  \t\tthis.parent = options.owner.parentFragment;\n\n  \t\t// bit of a hack, so reference resolution works without another\n  \t\t// layer of indirection\n  \t\tthis.parentFragment = this;\n  \t\tthis.owner = options.owner;\n  \t\tthis.ractive = this.parent.ractive;\n\n  \t\t// encapsulated styles should be inherited until they get applied by an element\n  \t\tthis.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n  \t\tthis.context = null;\n  \t\tthis.rendered = false;\n  \t\tthis.iterations = [];\n\n  \t\tthis.template = options.template;\n\n  \t\tthis.indexRef = options.indexRef;\n  \t\tthis.keyRef = options.keyRef;\n\n  \t\tthis.pendingNewIndices = null;\n  \t\tthis.previousIterations = null;\n\n  \t\t// track array versus object so updates of type rest\n  \t\tthis.isArray = false;\n  \t}\n\n  \tRepeatedFragment.prototype.bind = function bind(context) {\n  \t\tvar _this = this;\n\n  \t\tthis.context = context;\n  \t\tvar value = context.get();\n\n  \t\t// {{#each array}}...\n  \t\tif (this.isArray = isArray(value)) {\n  \t\t\t// we can't use map, because of sparse arrays\n  \t\t\tthis.iterations = [];\n  \t\t\tfor (var i = 0; i < value.length; i += 1) {\n  \t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t}\n  \t\t}\n\n  \t\t// {{#each object}}...\n  \t\telse if (isObject(value)) {\n  \t\t\t\tthis.isArray = false;\n\n  \t\t\t\t// TODO this is a dreadful hack. There must be a neater way\n  \t\t\t\tif (this.indexRef) {\n  \t\t\t\t\tvar refs = this.indexRef.split(',');\n  \t\t\t\t\tthis.keyRef = refs[0];\n  \t\t\t\t\tthis.indexRef = refs[1];\n  \t\t\t\t}\n\n  \t\t\t\tthis.iterations = Object.keys(value).map(function (key, index) {\n  \t\t\t\t\treturn _this.createIteration(key, index);\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\treturn this;\n  \t};\n\n  \tRepeatedFragment.prototype.bubble = function bubble() {\n  \t\tthis.owner.bubble();\n  \t};\n\n  \tRepeatedFragment.prototype.createIteration = function createIteration(key, index) {\n  \t\tvar fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\ttemplate: this.template\n  \t\t});\n\n  \t\t// TODO this is a bit hacky\n  \t\tfragment.key = key;\n  \t\tfragment.index = index;\n  \t\tfragment.isIteration = true;\n\n  \t\tvar model = this.context.joinKey(key);\n\n  \t\t// set up an iteration alias if there is one\n  \t\tif (this.owner.template.z) {\n  \t\t\tfragment.aliases = {};\n  \t\t\tfragment.aliases[this.owner.template.z[0].n] = model;\n  \t\t}\n\n  \t\treturn fragment.bind(model);\n  \t};\n\n  \tRepeatedFragment.prototype.detach = function detach() {\n  \t\tvar docFrag = createDocumentFragment();\n  \t\tthis.iterations.forEach(function (fragment) {\n  \t\t\treturn docFrag.appendChild(fragment.detach());\n  \t\t});\n  \t\treturn docFrag;\n  \t};\n\n  \tRepeatedFragment.prototype.find = function find(selector) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.iterations[i].find(selector);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findAll = function findAll(selector, query) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tthis.iterations[i].findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findComponent = function findComponent(name) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.iterations[i].findComponent(name);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tvar len = this.iterations.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tthis.iterations[i].findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tRepeatedFragment.prototype.findNextNode = function findNextNode(iteration) {\n  \t\tif (iteration.index < this.iterations.length - 1) {\n  \t\t\tfor (var i = iteration.index + 1; i < this.iterations.length; i++) {\n  \t\t\t\tvar node = this.iterations[i].firstNode(true);\n  \t\t\t\tif (node) return node;\n  \t\t\t}\n  \t\t}\n\n  \t\treturn this.owner.findNextNode();\n  \t};\n\n  \tRepeatedFragment.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  \t};\n\n  \tRepeatedFragment.prototype.rebind = function rebind(context) {\n  \t\tvar _this2 = this;\n\n  \t\tthis.context = context;\n\n  \t\tthis.iterations.forEach(function (fragment) {\n  \t\t\tvar model = context.joinKey(fragment.key || fragment.index);\n  \t\t\tif (_this2.owner.template.z) {\n  \t\t\t\tfragment.aliases = {};\n  \t\t\t\tfragment.aliases[_this2.owner.template.z[0].n] = model;\n  \t\t\t}\n  \t\t\tfragment.rebind(model);\n  \t\t});\n  \t};\n\n  \tRepeatedFragment.prototype.render = function render(target, occupants) {\n  \t\t// TODO use docFrag.cloneNode...\n\n  \t\tif (this.iterations) {\n  \t\t\tthis.iterations.forEach(function (fragment) {\n  \t\t\t\treturn fragment.render(target, occupants);\n  \t\t\t});\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tRepeatedFragment.prototype.shuffle = function shuffle(newIndices) {\n  \t\tvar _this3 = this;\n\n  \t\tif (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n  \t\tif (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n  \t\tthis.pendingNewIndices.push(newIndices);\n\n  \t\tvar iterations = [];\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\tif (newIndex === -1) return;\n\n  \t\t\tvar fragment = _this3.iterations[oldIndex];\n  \t\t\titerations[newIndex] = fragment;\n\n  \t\t\tif (newIndex !== oldIndex && fragment) fragment.dirty = true;\n  \t\t});\n\n  \t\tthis.iterations = iterations;\n\n  \t\tthis.bubble();\n  \t};\n\n  \tRepeatedFragment.prototype.toString = function toString(escape) {\n  \t\treturn this.iterations ? this.iterations.map(escape ? toEscapedString : _toString).join('') : '';\n  \t};\n\n  \tRepeatedFragment.prototype.unbind = function unbind() {\n  \t\tthis.iterations.forEach(_unbind);\n  \t\treturn this;\n  \t};\n\n  \tRepeatedFragment.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.iterations.forEach(shouldDestroy ? unrenderAndDestroy : _unrender);\n  \t\tif (this.pendingNewIndices && this.previousIterations) {\n  \t\t\tthis.previousIterations.forEach(function (fragment) {\n  \t\t\t\tif (fragment.rendered) shouldDestroy ? unrenderAndDestroy(fragment) : _unrender(fragment);\n  \t\t\t});\n  \t\t}\n  \t\tthis.rendered = false;\n  \t};\n\n  \t// TODO smart update\n\n\n  \tRepeatedFragment.prototype.update = function update() {\n  \t\tvar _this4 = this;\n\n  \t\t// skip dirty check, since this is basically just a facade\n\n  \t\tif (this.pendingNewIndices) {\n  \t\t\tthis.updatePostShuffle();\n  \t\t\treturn;\n  \t\t}\n\n  \t\tif (this.updating) return;\n  \t\tthis.updating = true;\n\n  \t\tvar value = this.context.get(),\n  \t\t    wasArray = this.isArray;\n\n  \t\tvar toRemove = void 0;\n  \t\tvar oldKeys = void 0;\n  \t\tvar reset = true;\n  \t\tvar i = void 0;\n\n  \t\tif (this.isArray = isArray(value)) {\n  \t\t\tif (wasArray) {\n  \t\t\t\treset = false;\n  \t\t\t\tif (this.iterations.length > value.length) {\n  \t\t\t\t\ttoRemove = this.iterations.splice(value.length);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t} else if (isObject(value) && !wasArray) {\n  \t\t\treset = false;\n  \t\t\ttoRemove = [];\n  \t\t\toldKeys = {};\n  \t\t\ti = this.iterations.length;\n\n  \t\t\twhile (i--) {\n  \t\t\t\tvar _fragment = this.iterations[i];\n  \t\t\t\tif (_fragment.key in value) {\n  \t\t\t\t\toldKeys[_fragment.key] = true;\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.iterations.splice(i, 1);\n  \t\t\t\t\ttoRemove.push(_fragment);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tif (reset) {\n  \t\t\ttoRemove = this.iterations;\n  \t\t\tthis.iterations = [];\n  \t\t}\n\n  \t\tif (toRemove) {\n  \t\t\ttoRemove.forEach(function (fragment) {\n  \t\t\t\tfragment.unbind();\n  \t\t\t\tfragment.unrender(true);\n  \t\t\t});\n  \t\t}\n\n  \t\t// update the remaining ones\n  \t\tthis.iterations.forEach(_update);\n\n  \t\t// add new iterations\n  \t\tvar newLength = isArray(value) ? value.length : isObject(value) ? Object.keys(value).length : 0;\n\n  \t\tvar docFrag = void 0;\n  \t\tvar fragment = void 0;\n\n  \t\tif (newLength > this.iterations.length) {\n  \t\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\n  \t\t\ti = this.iterations.length;\n\n  \t\t\tif (isArray(value)) {\n  \t\t\t\twhile (i < value.length) {\n  \t\t\t\t\tfragment = this.createIteration(i, i);\n\n  \t\t\t\t\tthis.iterations.push(fragment);\n  \t\t\t\t\tif (this.rendered) fragment.render(docFrag);\n\n  \t\t\t\t\ti += 1;\n  \t\t\t\t}\n  \t\t\t} else if (isObject(value)) {\n  \t\t\t\t// TODO this is a dreadful hack. There must be a neater way\n  \t\t\t\tif (this.indexRef && !this.keyRef) {\n  \t\t\t\t\tvar refs = this.indexRef.split(',');\n  \t\t\t\t\tthis.keyRef = refs[0];\n  \t\t\t\t\tthis.indexRef = refs[1];\n  \t\t\t\t}\n\n  \t\t\t\tObject.keys(value).forEach(function (key) {\n  \t\t\t\t\tif (!oldKeys || !(key in oldKeys)) {\n  \t\t\t\t\t\tfragment = _this4.createIteration(key, i);\n\n  \t\t\t\t\t\t_this4.iterations.push(fragment);\n  \t\t\t\t\t\tif (_this4.rendered) fragment.render(docFrag);\n\n  \t\t\t\t\t\ti += 1;\n  \t\t\t\t\t}\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\t\tif (this.rendered) {\n  \t\t\t\tvar parentNode = this.parent.findParentNode();\n  \t\t\t\tvar anchor = this.parent.findNextNode(this.owner);\n\n  \t\t\t\tparentNode.insertBefore(docFrag, anchor);\n  \t\t\t}\n  \t\t}\n\n  \t\tthis.updating = false;\n  \t};\n\n  \tRepeatedFragment.prototype.updatePostShuffle = function updatePostShuffle() {\n  \t\tvar _this5 = this;\n\n  \t\tvar newIndices = this.pendingNewIndices[0];\n\n  \t\t// map first shuffle through\n  \t\tthis.pendingNewIndices.slice(1).forEach(function (indices) {\n  \t\t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\t\tnewIndices[oldIndex] = indices[newIndex];\n  \t\t\t});\n  \t\t});\n\n  \t\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n  \t\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n  \t\t// but it seems to work for now\n  \t\tvar len = this.context.get().length;\n  \t\tvar i = void 0,\n  \t\t    maxIdx = 0,\n  \t\t    merged = false;\n\n  \t\tnewIndices.forEach(function (newIndex, oldIndex) {\n  \t\t\tvar fragment = _this5.previousIterations[oldIndex];\n\n  \t\t\t// check for merged shuffles\n  \t\t\tif (!merged && newIndex !== -1) {\n  \t\t\t\tif (newIndex < maxIdx) merged = true;\n  \t\t\t\tif (newIndex > maxIdx) maxIdx = newIndex;\n  \t\t\t}\n\n  \t\t\tif (newIndex === -1) {\n  \t\t\t\tfragment.unbind().unrender(true);\n  \t\t\t} else {\n  \t\t\t\tfragment.index = newIndex;\n  \t\t\t\tvar model = _this5.context.joinKey(newIndex);\n  \t\t\t\tif (_this5.owner.template.z) {\n  \t\t\t\t\tfragment.aliases = {};\n  \t\t\t\t\tfragment.aliases[_this5.owner.template.z[0].n] = model;\n  \t\t\t\t}\n  \t\t\t\tfragment.rebind(model);\n  \t\t\t}\n  \t\t});\n\n  \t\t// create new iterations\n  \t\tvar docFrag = this.rendered ? createDocumentFragment() : null;\n  \t\tvar parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n  \t\tif (merged) {\n  \t\t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t\tvar frag = this.iterations[i];\n\n  \t\t\t\tif (this.rendered) {\n  \t\t\t\t\tif (frag) {\n  \t\t\t\t\t\tdocFrag.appendChild(frag.detach());\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t\t\tthis.iterations[i].render(docFrag);\n  \t\t\t\t\t}\n  \t\t\t\t}\n\n  \t\t\t\tif (!this.rendered) {\n  \t\t\t\t\tif (!frag) {\n  \t\t\t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t}\n  \t\t} else {\n  \t\t\tfor (i = 0; i < len; i++) {\n  \t\t\t\tvar _frag = this.iterations[i];\n\n  \t\t\t\tif (this.rendered) {\n  \t\t\t\t\tif (_frag && docFrag.childNodes.length) {\n  \t\t\t\t\t\tparentNode.insertBefore(docFrag, _frag.firstNode());\n  \t\t\t\t\t}\n\n  \t\t\t\t\tif (!_frag) {\n  \t\t\t\t\t\t_frag = this.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t\t\t_frag.render(docFrag);\n  \t\t\t\t\t}\n  \t\t\t\t} else if (!_frag) {\n  \t\t\t\t\tthis.iterations[i] = this.createIteration(i, i);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\tif (this.rendered && docFrag.childNodes.length) {\n  \t\t\tparentNode.insertBefore(docFrag, this.owner.findNextNode());\n  \t\t}\n\n  \t\tthis.iterations.forEach(_update);\n\n  \t\tthis.pendingNewIndices = null;\n  \t};\n\n  \treturn RepeatedFragment;\n  }();\n\n  function isEmpty(value) {\n  \treturn !value || isArray(value) && value.length === 0 || isObject(value) && Object.keys(value).length === 0;\n  }\n\n  function getType(value, hasIndexRef) {\n  \tif (hasIndexRef || isArray(value)) return SECTION_EACH;\n  \tif (isObject(value) || typeof value === 'function') return SECTION_IF_WITH;\n  \tif (value === undefined) return null;\n  \treturn SECTION_IF;\n  }\n\n  var Section = function (_Mustache) {\n  \tbabelHelpers.inherits(Section, _Mustache);\n\n  \tfunction Section(options) {\n  \t\tbabelHelpers.classCallCheck(this, Section);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Mustache.call(this, options));\n\n  \t\t_this.sectionType = options.template.n || null;\n  \t\t_this.templateSectionType = _this.sectionType;\n  \t\t_this.fragment = null;\n  \t\treturn _this;\n  \t}\n\n  \tSection.prototype.bind = function bind() {\n  \t\t_Mustache.prototype.bind.call(this);\n\n  \t\t// if we managed to bind, we need to create children\n  \t\tif (this.model) {\n  \t\t\tthis.dirty = true;\n  \t\t\tthis.update();\n  \t\t} else if (this.sectionType && this.sectionType === SECTION_UNLESS) {\n  \t\t\tthis.fragment = new Fragment({\n  \t\t\t\towner: this,\n  \t\t\t\ttemplate: this.template.f\n  \t\t\t}).bind();\n  \t\t}\n  \t};\n\n  \tSection.prototype.detach = function detach() {\n  \t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n  \t};\n\n  \tSection.prototype.find = function find(selector) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.find(selector);\n  \t\t}\n  \t};\n\n  \tSection.prototype.findAll = function findAll(selector, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAll(selector, query);\n  \t\t}\n  \t};\n\n  \tSection.prototype.findComponent = function findComponent(name) {\n  \t\tif (this.fragment) {\n  \t\t\treturn this.fragment.findComponent(name);\n  \t\t}\n  \t};\n\n  \tSection.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.findAllComponents(name, query);\n  \t\t}\n  \t};\n\n  \tSection.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment && this.fragment.firstNode(skipParent);\n  \t};\n\n  \tSection.prototype.rebind = function rebind() {\n  \t\t_Mustache.prototype.rebind.call(this);\n\n  \t\tif (this.fragment) {\n  \t\t\tthis.fragment.rebind(this.sectionType === SECTION_IF || this.sectionType === SECTION_UNLESS ? null : this.model);\n  \t\t}\n  \t};\n\n  \tSection.prototype.render = function render(target, occupants) {\n  \t\tthis.rendered = true;\n  \t\tif (this.fragment) this.fragment.render(target, occupants);\n  \t};\n\n  \tSection.prototype.shuffle = function shuffle(newIndices) {\n  \t\tif (this.fragment && this.sectionType === SECTION_EACH) {\n  \t\t\tthis.fragment.shuffle(newIndices);\n  \t\t}\n  \t};\n\n  \tSection.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment ? this.fragment.toString(escape) : '';\n  \t};\n\n  \tSection.prototype.unbind = function unbind() {\n  \t\t_Mustache.prototype.unbind.call(this);\n  \t\tif (this.fragment) this.fragment.unbind();\n  \t};\n\n  \tSection.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n  \t\tthis.rendered = false;\n  \t};\n\n  \tSection.prototype.update = function update() {\n  \t\tif (!this.dirty) return;\n  \t\tif (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n  \t\tthis.dirty = false;\n\n  \t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n  \t\tvar lastType = this.sectionType;\n\n  \t\t// watch for switching section types\n  \t\tif (this.sectionType === null || this.templateSectionType === null) this.sectionType = getType(value, this.template.i);\n  \t\tif (lastType && lastType !== this.sectionType && this.fragment) {\n  \t\t\tif (this.rendered) {\n  \t\t\t\tthis.fragment.unbind().unrender(true);\n  \t\t\t}\n\n  \t\t\tthis.fragment = null;\n  \t\t}\n\n  \t\tvar newFragment = void 0;\n\n  \t\tif (this.sectionType === SECTION_EACH) {\n  \t\t\tif (this.fragment) {\n  \t\t\t\tthis.fragment.update();\n  \t\t\t} else {\n  \t\t\t\t// TODO can this happen?\n  \t\t\t\tnewFragment = new RepeatedFragment({\n  \t\t\t\t\towner: this,\n  \t\t\t\t\ttemplate: this.template.f,\n  \t\t\t\t\tindexRef: this.template.i\n  \t\t\t\t}).bind(this.model);\n  \t\t\t}\n  \t\t}\n\n  \t\t// WITH is now IF_WITH; WITH is only used for {{>partial context}}\n  \t\telse if (this.sectionType === SECTION_WITH) {\n  \t\t\t\tif (this.fragment) {\n  \t\t\t\t\tthis.fragment.update();\n  \t\t\t\t} else {\n  \t\t\t\t\tnewFragment = new Fragment({\n  \t\t\t\t\t\towner: this,\n  \t\t\t\t\t\ttemplate: this.template.f\n  \t\t\t\t\t}).bind(this.model);\n  \t\t\t\t}\n  \t\t\t} else if (this.sectionType === SECTION_IF_WITH) {\n  \t\t\t\tif (this.fragment) {\n  \t\t\t\t\tif (isEmpty(value)) {\n  \t\t\t\t\t\tif (this.rendered) {\n  \t\t\t\t\t\t\tthis.fragment.unbind().unrender(true);\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tthis.fragment = null;\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tthis.fragment.update();\n  \t\t\t\t\t}\n  \t\t\t\t} else if (!isEmpty(value)) {\n  \t\t\t\t\tnewFragment = new Fragment({\n  \t\t\t\t\t\towner: this,\n  \t\t\t\t\t\ttemplate: this.template.f\n  \t\t\t\t\t}).bind(this.model);\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tvar fragmentShouldExist = this.sectionType === SECTION_UNLESS ? isEmpty(value) : !!value && !isEmpty(value);\n\n  \t\t\t\tif (this.fragment) {\n  \t\t\t\t\tif (fragmentShouldExist) {\n  \t\t\t\t\t\tthis.fragment.update();\n  \t\t\t\t\t} else {\n  \t\t\t\t\t\tif (this.rendered) {\n  \t\t\t\t\t\t\tthis.fragment.unbind().unrender(true);\n  \t\t\t\t\t\t}\n\n  \t\t\t\t\t\tthis.fragment = null;\n  \t\t\t\t\t}\n  \t\t\t\t} else if (fragmentShouldExist) {\n  \t\t\t\t\tnewFragment = new Fragment({\n  \t\t\t\t\t\towner: this,\n  \t\t\t\t\t\ttemplate: this.template.f\n  \t\t\t\t\t}).bind(null);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\tif (newFragment) {\n  \t\t\tif (this.rendered) {\n  \t\t\t\tvar parentNode = this.parentFragment.findParentNode();\n  \t\t\t\tvar anchor = this.parentFragment.findNextNode(this);\n\n  \t\t\t\tif (anchor) {\n  \t\t\t\t\tvar docFrag = createDocumentFragment();\n  \t\t\t\t\tnewFragment.render(docFrag);\n\n  \t\t\t\t\t// we use anchor.parentNode, not parentNode, because the sibling\n  \t\t\t\t\t// may be temporarily detached as a result of a shuffle\n  \t\t\t\t\tanchor.parentNode.insertBefore(docFrag, anchor);\n  \t\t\t\t} else {\n  \t\t\t\t\tnewFragment.render(parentNode);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.fragment = newFragment;\n  \t\t}\n  \t};\n\n  \treturn Section;\n  }(Mustache);\n\n  function valueContains(selectValue, optionValue) {\n  \tvar i = selectValue.length;\n  \twhile (i--) {\n  \t\tif (selectValue[i] == optionValue) return true;\n  \t}\n  }\n\n  var Select = function (_Element) {\n  \tbabelHelpers.inherits(Select, _Element);\n\n  \tfunction Select(options) {\n  \t\tbabelHelpers.classCallCheck(this, Select);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Element.call(this, options));\n\n  \t\t_this.options = [];\n  \t\treturn _this;\n  \t}\n\n  \tSelect.prototype.foundNode = function foundNode(node) {\n  \t\tif (this.binding) {\n  \t\t\tvar selectedOptions = getSelectedOptions(node);\n\n  \t\t\tif (selectedOptions.length > 0) {\n  \t\t\t\tthis.selectedOptions = selectedOptions;\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tSelect.prototype.render = function render(target, occupants) {\n  \t\t_Element.prototype.render.call(this, target, occupants);\n  \t\tthis.sync();\n\n  \t\tvar node = this.node;\n\n  \t\tvar i = node.options.length;\n  \t\twhile (i--) {\n  \t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n  \t\t}\n\n  \t\tthis.rendered = true;\n  \t};\n\n  \tSelect.prototype.sync = function sync() {\n  \t\tvar _this2 = this;\n\n  \t\tvar selectNode = this.node;\n\n  \t\tif (!selectNode) return;\n\n  \t\tvar options = toArray(selectNode.options);\n\n  \t\tif (this.selectedOptions) {\n  \t\t\toptions.forEach(function (o) {\n  \t\t\t\tif (_this2.selectedOptions.indexOf(o) >= 0) o.selected = true;else o.selected = false;\n  \t\t\t});\n  \t\t\tthis.binding.setFromNode(selectNode);\n  \t\t\tdelete this.selectedOptions;\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar selectValue = this.getAttribute('value');\n  \t\tvar isMultiple = this.getAttribute('multiple');\n\n  \t\t// If the <select> has a specified value, that should override\n  \t\t// these options\n  \t\tif (selectValue !== undefined) {\n  \t\t\tvar optionWasSelected = void 0;\n\n  \t\t\toptions.forEach(function (o) {\n  \t\t\t\tvar optionValue = o._ractive ? o._ractive.value : o.value;\n  \t\t\t\tvar shouldSelect = isMultiple ? valueContains(selectValue, optionValue) : selectValue == optionValue;\n\n  \t\t\t\tif (shouldSelect) {\n  \t\t\t\t\toptionWasSelected = true;\n  \t\t\t\t}\n\n  \t\t\t\to.selected = shouldSelect;\n  \t\t\t});\n\n  \t\t\tif (!optionWasSelected && !isMultiple) {\n  \t\t\t\tif (this.binding) {\n  \t\t\t\t\tthis.binding.forceUpdate();\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\t// Otherwise the value should be initialised according to which\n  \t\t// <option> element is selected, if twoway binding is in effect\n  \t\telse if (this.binding) {\n  \t\t\t\tthis.binding.forceUpdate();\n  \t\t\t}\n  \t};\n\n  \tSelect.prototype.update = function update() {\n  \t\t_Element.prototype.update.call(this);\n  \t\tthis.sync();\n  \t};\n\n  \treturn Select;\n  }(Element);\n\n  var Textarea = function (_Input) {\n  \tbabelHelpers.inherits(Textarea, _Input);\n\n  \tfunction Textarea(options) {\n  \t\tbabelHelpers.classCallCheck(this, Textarea);\n\n  \t\tvar template = options.template;\n\n  \t\t// if there is a bindable value, there should be no body\n  \t\tif (template.a && template.a.value && isBindable({ template: template.a.value })) {\n  \t\t\toptions.noContent = true;\n  \t\t}\n\n  \t\t// otherwise, if there is a single bindable interpolator as content, move it to the value attr\n  \t\telse if (template.f && (!template.a || !template.a.value) && isBindable({ template: template.f })) {\n  \t\t\t\tif (!template.a) template.a = {};\n  \t\t\t\ttemplate.a.value = template.f;\n  \t\t\t\toptions.noContent = true;\n  \t\t\t}\n\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Input.call(this, options));\n  \t}\n\n  \tTextarea.prototype.bubble = function bubble() {\n  \t\tvar _this2 = this;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.rendered && !this.binding && this.fragment) {\n  \t\t\t\trunloop.scheduleTask(function () {\n  \t\t\t\t\t_this2.dirty = false;\n  \t\t\t\t\t_this2.node.value = _this2.fragment.toString();\n  \t\t\t\t});\n  \t\t\t}\n\n  \t\t\tthis.parentFragment.bubble(); // default behaviour\n  \t\t}\n  \t};\n\n  \treturn Textarea;\n  }(Input);\n\n  var Text = function (_Item) {\n  \tbabelHelpers.inherits(Text, _Item);\n\n  \tfunction Text(options) {\n  \t\tbabelHelpers.classCallCheck(this, Text);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.type = TEXT;\n  \t\treturn _this;\n  \t}\n\n  \tText.prototype.bind = function bind() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.detach = function detach() {\n  \t\treturn detachNode(this.node);\n  \t};\n\n  \tText.prototype.firstNode = function firstNode() {\n  \t\treturn this.node;\n  \t};\n\n  \tText.prototype.rebind = function rebind() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.render = function render(target, occupants) {\n  \t\tthis.rendered = true;\n\n  \t\tif (occupants) {\n  \t\t\tvar n = occupants[0];\n  \t\t\tif (n && n.nodeType === 3) {\n  \t\t\t\toccupants.shift();\n  \t\t\t\tif (n.nodeValue !== this.template) {\n  \t\t\t\t\tn.nodeValue = this.template;\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tn = this.node = doc.createTextNode(this.template);\n  \t\t\t\tif (occupants[0]) {\n  \t\t\t\t\ttarget.insertBefore(n, occupants[0]);\n  \t\t\t\t} else {\n  \t\t\t\t\ttarget.appendChild(n);\n  \t\t\t\t}\n  \t\t\t}\n\n  \t\t\tthis.node = n;\n  \t\t} else {\n  \t\t\tthis.node = doc.createTextNode(this.template);\n  \t\t\ttarget.appendChild(this.node);\n  \t\t}\n  \t};\n\n  \tText.prototype.toString = function toString(escape) {\n  \t\treturn escape ? escapeHtml(this.template) : this.template;\n  \t};\n\n  \tText.prototype.unbind = function unbind() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tif (this.rendered && shouldDestroy) this.detach();\n  \t\tthis.rendered = false;\n  \t};\n\n  \tText.prototype.update = function update() {\n  \t\t// noop\n  \t};\n\n  \tText.prototype.valueOf = function valueOf() {\n  \t\treturn this.template;\n  \t};\n\n  \treturn Text;\n  }(Item);\n\n  var elementCache = {};\n\n  var ieBug = void 0;\n  var ieBlacklist = void 0;\n\n  try {\n  \tcreateElement('table').innerHTML = 'foo';\n  } catch (err) {\n  \tieBug = true;\n\n  \tieBlacklist = {\n  \t\tTABLE: ['<table class=\"x\">', '</table>'],\n  \t\tTHEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n  \t\tTBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n  \t\tTR: ['<table><tr class=\"x\">', '</tr></table>'],\n  \t\tSELECT: ['<select class=\"x\">', '</select>']\n  \t};\n  }\n\n  function insertHtml (html, node, docFrag) {\n  \tvar nodes = [];\n\n  \t// render 0 and false\n  \tif (html == null || html === '') return nodes;\n\n  \tvar container = void 0;\n  \tvar wrapper = void 0;\n  \tvar selectedOption = void 0;\n\n  \tif (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n  \t\tcontainer = element('DIV');\n  \t\tcontainer.innerHTML = wrapper[0] + html + wrapper[1];\n  \t\tcontainer = container.querySelector('.x');\n\n  \t\tif (container.tagName === 'SELECT') {\n  \t\t\tselectedOption = container.options[container.selectedIndex];\n  \t\t}\n  \t} else if (node.namespaceURI === svg$1) {\n  \t\tcontainer = element('DIV');\n  \t\tcontainer.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n  \t\tcontainer = container.querySelector('.x');\n  \t} else if (node.tagName === 'TEXTAREA') {\n  \t\tcontainer = createElement('div');\n\n  \t\tif (typeof container.textContent !== 'undefined') {\n  \t\t\tcontainer.textContent = html;\n  \t\t} else {\n  \t\t\tcontainer.innerHTML = html;\n  \t\t}\n  \t} else {\n  \t\tcontainer = element(node.tagName);\n  \t\tcontainer.innerHTML = html;\n\n  \t\tif (container.tagName === 'SELECT') {\n  \t\t\tselectedOption = container.options[container.selectedIndex];\n  \t\t}\n  \t}\n\n  \tvar child = void 0;\n  \twhile (child = container.firstChild) {\n  \t\tnodes.push(child);\n  \t\tdocFrag.appendChild(child);\n  \t}\n\n  \t// This is really annoying. Extracting <option> nodes from the\n  \t// temporary container <select> causes the remaining ones to\n  \t// become selected. So now we have to deselect them. IE8, you\n  \t// amaze me. You really do\n  \t// ...and now Chrome too\n  \tvar i = void 0;\n  \tif (node.tagName === 'SELECT') {\n  \t\ti = nodes.length;\n  \t\twhile (i--) {\n  \t\t\tif (nodes[i] !== selectedOption) {\n  \t\t\t\tnodes[i].selected = false;\n  \t\t\t}\n  \t\t}\n  \t}\n\n  \treturn nodes;\n  }\n\n  function element(tagName) {\n  \treturn elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n  }\n\n  var Triple = function (_Mustache) {\n  \tbabelHelpers.inherits(Triple, _Mustache);\n\n  \tfunction Triple(options) {\n  \t\tbabelHelpers.classCallCheck(this, Triple);\n  \t\treturn babelHelpers.possibleConstructorReturn(this, _Mustache.call(this, options));\n  \t}\n\n  \tTriple.prototype.detach = function detach() {\n  \t\tvar docFrag = createDocumentFragment();\n  \t\tthis.nodes.forEach(function (node) {\n  \t\t\treturn docFrag.appendChild(node);\n  \t\t});\n  \t\treturn docFrag;\n  \t};\n\n  \tTriple.prototype.find = function find(selector) {\n  \t\tvar len = this.nodes.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar node = this.nodes[i];\n\n  \t\t\tif (node.nodeType !== 1) continue;\n\n  \t\t\tif (matches(node, selector)) return node;\n\n  \t\t\tvar queryResult = node.querySelector(selector);\n  \t\t\tif (queryResult) return queryResult;\n  \t\t}\n\n  \t\treturn null;\n  \t};\n\n  \tTriple.prototype.findAll = function findAll(selector, query) {\n  \t\tvar len = this.nodes.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar node = this.nodes[i];\n\n  \t\t\tif (node.nodeType !== 1) continue;\n\n  \t\t\tif (query.test(node)) query.add(node);\n\n  \t\t\tvar queryAllResult = node.querySelectorAll(selector);\n  \t\t\tif (queryAllResult) {\n  \t\t\t\tvar numNodes = queryAllResult.length;\n  \t\t\t\tvar j = void 0;\n\n  \t\t\t\tfor (j = 0; j < numNodes; j += 1) {\n  \t\t\t\t\tquery.add(queryAllResult[j]);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tTriple.prototype.findComponent = function findComponent() {\n  \t\treturn null;\n  \t};\n\n  \tTriple.prototype.firstNode = function firstNode() {\n  \t\treturn this.nodes[0];\n  \t};\n\n  \tTriple.prototype.render = function render(target) {\n  \t\tvar html = this.model ? this.model.get() : '';\n  \t\tthis.nodes = insertHtml(html, this.parentFragment.findParentNode(), target);\n  \t\tthis.rendered = true;\n  \t};\n\n  \tTriple.prototype.toString = function toString() {\n  \t\treturn this.model && this.model.get() != null ? decodeCharacterReferences('' + this.model.get()) : '';\n  \t};\n\n  \tTriple.prototype.unrender = function unrender() {\n  \t\tif (this.nodes) this.nodes.forEach(function (node) {\n  \t\t\treturn detachNode(node);\n  \t\t});\n  \t\tthis.rendered = false;\n  \t};\n\n  \tTriple.prototype.update = function update() {\n  \t\tif (this.rendered && this.dirty) {\n  \t\t\tthis.dirty = false;\n\n  \t\t\tthis.unrender();\n  \t\t\tvar docFrag = createDocumentFragment();\n  \t\t\tthis.render(docFrag);\n\n  \t\t\tvar parentNode = this.parentFragment.findParentNode();\n  \t\t\tvar anchor = this.parentFragment.findNextNode(this);\n\n  \t\t\tparentNode.insertBefore(docFrag, anchor);\n  \t\t}\n  \t};\n\n  \treturn Triple;\n  }(Mustache);\n\n  var Yielder = function (_Item) {\n  \tbabelHelpers.inherits(Yielder, _Item);\n\n  \tfunction Yielder(options) {\n  \t\tbabelHelpers.classCallCheck(this, Yielder);\n\n  \t\tvar _this = babelHelpers.possibleConstructorReturn(this, _Item.call(this, options));\n\n  \t\t_this.container = options.parentFragment.ractive;\n  \t\t_this.component = _this.container.component;\n\n  \t\t_this.containerFragment = options.parentFragment;\n  \t\t_this.parentFragment = _this.component.parentFragment;\n\n  \t\t// {{yield}} is equivalent to {{yield content}}\n  \t\t_this.name = options.template.n || '';\n  \t\treturn _this;\n  \t}\n\n  \tYielder.prototype.bind = function bind() {\n  \t\tvar name = this.name;\n\n  \t\t(this.component.yielders[name] || (this.component.yielders[name] = [])).push(this);\n\n  \t\t// TODO don't parse here\n  \t\tvar template = this.container._inlinePartials[name || 'content'];\n\n  \t\tif (typeof template === 'string') {\n  \t\t\ttemplate = parse(template).t;\n  \t\t}\n\n  \t\tif (!template) {\n  \t\t\twarnIfDebug('Could not find template for partial \"' + name + '\"', { ractive: this.ractive });\n  \t\t\ttemplate = [];\n  \t\t}\n\n  \t\tthis.fragment = new Fragment({\n  \t\t\towner: this,\n  \t\t\tractive: this.container.parent,\n  \t\t\ttemplate: template\n  \t\t}).bind();\n  \t};\n\n  \tYielder.prototype.bubble = function bubble() {\n  \t\tif (!this.dirty) {\n  \t\t\tthis.containerFragment.bubble();\n  \t\t\tthis.dirty = true;\n  \t\t}\n  \t};\n\n  \tYielder.prototype.detach = function detach() {\n  \t\treturn this.fragment.detach();\n  \t};\n\n  \tYielder.prototype.find = function find(selector) {\n  \t\treturn this.fragment.find(selector);\n  \t};\n\n  \tYielder.prototype.findAll = function findAll(selector, queryResult) {\n  \t\tthis.fragment.find(selector, queryResult);\n  \t};\n\n  \tYielder.prototype.findComponent = function findComponent(name) {\n  \t\treturn this.fragment.findComponent(name);\n  \t};\n\n  \tYielder.prototype.findAllComponents = function findAllComponents(name, queryResult) {\n  \t\tthis.fragment.findAllComponents(name, queryResult);\n  \t};\n\n  \tYielder.prototype.findNextNode = function findNextNode() {\n  \t\treturn this.containerFragment.findNextNode(this);\n  \t};\n\n  \tYielder.prototype.firstNode = function firstNode(skipParent) {\n  \t\treturn this.fragment.firstNode(skipParent);\n  \t};\n\n  \tYielder.prototype.rebind = function rebind() {\n  \t\tthis.fragment.rebind();\n  \t};\n\n  \tYielder.prototype.render = function render(target, occupants) {\n  \t\treturn this.fragment.render(target, occupants);\n  \t};\n\n  \tYielder.prototype.setTemplate = function setTemplate(name) {\n  \t\tvar template = this.parentFragment.ractive.partials[name];\n\n  \t\tif (typeof template === 'string') {\n  \t\t\ttemplate = parse(template).t;\n  \t\t}\n\n  \t\tthis.partialTemplate = template || []; // TODO warn on missing partial\n  \t};\n\n  \tYielder.prototype.toString = function toString(escape) {\n  \t\treturn this.fragment.toString(escape);\n  \t};\n\n  \tYielder.prototype.unbind = function unbind() {\n  \t\tthis.fragment.unbind();\n  \t\tremoveFromArray(this.component.yielders[this.name], this);\n  \t};\n\n  \tYielder.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.fragment.unrender(shouldDestroy);\n  \t};\n\n  \tYielder.prototype.update = function update() {\n  \t\tthis.dirty = false;\n  \t\tthis.fragment.update();\n  \t};\n\n  \treturn Yielder;\n  }(Item);\n\n  // finds the component constructor in the registry or view hierarchy registries\n  function getComponentConstructor(ractive, name) {\n  \tvar instance = findInstance('components', ractive, name);\n  \tvar Component = void 0;\n\n  \tif (instance) {\n  \t\tComponent = instance.components[name];\n\n  \t\t// best test we have for not Ractive.extend\n  \t\tif (!Component._Parent) {\n  \t\t\t// function option, execute and store for reset\n  \t\t\tvar fn = Component.bind(instance);\n  \t\t\tfn.isOwner = instance.components.hasOwnProperty(name);\n  \t\t\tComponent = fn();\n\n  \t\t\tif (!Component) {\n  \t\t\t\twarnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', { ractive: ractive });\n  \t\t\t\treturn;\n  \t\t\t}\n\n  \t\t\tif (typeof Component === 'string') {\n  \t\t\t\t// allow string lookup\n  \t\t\t\tComponent = getComponentConstructor(ractive, Component);\n  \t\t\t}\n\n  \t\t\tComponent._fn = fn;\n  \t\t\tinstance.components[name] = Component;\n  \t\t}\n  \t}\n\n  \treturn Component;\n  }\n\n  var constructors = {};\n  constructors[ALIAS] = Alias;\n  constructors[DOCTYPE] = Doctype;\n  constructors[INTERPOLATOR] = Interpolator;\n  constructors[PARTIAL] = Partial;\n  constructors[SECTION] = Section;\n  constructors[TRIPLE] = Triple;\n  constructors[YIELDER] = Yielder;\n\n  var specialElements = {\n  \tdoctype: Doctype,\n  \tform: Form,\n  \tinput: Input,\n  \toption: Option,\n  \tselect: Select,\n  \ttextarea: Textarea\n  };\n\n  function createItem(options) {\n  \tif (typeof options.template === 'string') {\n  \t\treturn new Text(options);\n  \t}\n\n  \tif (options.template.t === ELEMENT) {\n  \t\t// could be component or element\n  \t\tvar ComponentConstructor = getComponentConstructor(options.parentFragment.ractive, options.template.e);\n  \t\tif (ComponentConstructor) {\n  \t\t\treturn new Component(options, ComponentConstructor);\n  \t\t}\n\n  \t\tvar tagName = options.template.e.toLowerCase();\n\n  \t\tvar ElementConstructor = specialElements[tagName] || Element;\n  \t\treturn new ElementConstructor(options);\n  \t}\n\n  \tvar Item = constructors[options.template.t];\n\n  \tif (!Item) throw new Error('Unrecognised item type ' + options.template.t);\n\n  \treturn new Item(options);\n  }\n\n  var ReferenceResolver = function () {\n  \tfunction ReferenceResolver(fragment, reference, callback) {\n  \t\tbabelHelpers.classCallCheck(this, ReferenceResolver);\n\n  \t\tthis.fragment = fragment;\n  \t\tthis.reference = normalise(reference);\n  \t\tthis.callback = callback;\n\n  \t\tthis.keys = splitKeypathI(reference);\n  \t\tthis.resolved = false;\n\n  \t\t// TODO the consumer should take care of addUnresolved\n  \t\t// we attach to all the contexts between here and the root\n  \t\t// - whenever their values change, they can quickly\n  \t\t// check to see if we can resolve\n  \t\twhile (fragment) {\n  \t\t\tif (fragment.context) {\n  \t\t\t\tfragment.context.addUnresolved(this.keys[0], this);\n  \t\t\t}\n\n  \t\t\tfragment = fragment.componentParent || fragment.parent;\n  \t\t}\n  \t}\n\n  \tReferenceResolver.prototype.attemptResolution = function attemptResolution() {\n  \t\tif (this.resolved) return;\n\n  \t\tvar model = resolveAmbiguousReference(this.fragment, this.reference);\n\n  \t\tif (model) {\n  \t\t\tthis.resolved = true;\n  \t\t\tthis.callback(model);\n  \t\t}\n  \t};\n\n  \tReferenceResolver.prototype.forceResolution = function forceResolution() {\n  \t\tif (this.resolved) return;\n\n  \t\tvar model = this.fragment.findContext().joinAll(this.keys);\n  \t\tthis.callback(model);\n  \t\tthis.resolved = true;\n  \t};\n\n  \tReferenceResolver.prototype.unbind = function unbind() {\n  \t\tremoveFromArray(this.fragment.unresolved, this);\n  \t};\n\n  \treturn ReferenceResolver;\n  }();\n\n  // TODO all this code needs to die\n  function processItems(items, values, guid) {\n  \tvar counter = arguments.length <= 3 || arguments[3] === undefined ? 0 : arguments[3];\n\n  \treturn items.map(function (item) {\n  \t\tif (item.type === TEXT) {\n  \t\t\treturn item.template;\n  \t\t}\n\n  \t\tif (item.fragment) {\n  \t\t\tif (item.fragment.iterations) {\n  \t\t\t\treturn item.fragment.iterations.map(function (fragment) {\n  \t\t\t\t\treturn processItems(fragment.items, values, guid, counter);\n  \t\t\t\t}).join('');\n  \t\t\t} else {\n  \t\t\t\treturn processItems(item.fragment.items, values, guid, counter);\n  \t\t\t}\n  \t\t}\n\n  \t\tvar placeholderId = guid + '-' + counter++;\n\n  \t\tvalues[placeholderId] = item.model ? item.model.wrapper ? item.model.wrapper.value : item.model.get() : undefined;\n\n  \t\treturn '${' + placeholderId + '}';\n  \t}).join('');\n  }\n\n  function unrenderAndDestroy$1(item) {\n  \titem.unrender(true);\n  }\n\n  var Fragment = function () {\n  \tfunction Fragment(options) {\n  \t\tbabelHelpers.classCallCheck(this, Fragment);\n\n  \t\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n  \t\tthis.isRoot = !options.owner.parentFragment;\n  \t\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n  \t\tthis.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n  \t\tthis.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.parentFragment : null;\n\n  \t\tthis.context = null;\n  \t\tthis.rendered = false;\n\n  \t\t// encapsulated styles should be inherited until they get applied by an element\n  \t\tthis.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n  \t\tthis.resolvers = [];\n\n  \t\tthis.dirty = false;\n  \t\tthis.dirtyArgs = this.dirtyValue = true; // TODO getArgsList is nonsense - should deprecate legacy directives style\n\n  \t\tthis.template = options.template || [];\n  \t\tthis.createItems();\n  \t}\n\n  \tFragment.prototype.bind = function bind(context) {\n  \t\tthis.context = context;\n  \t\tthis.items.forEach(_bind);\n  \t\tthis.bound = true;\n\n  \t\t// in rare cases, a forced resolution (or similar) will cause the\n  \t\t// fragment to be dirty before it's even finished binding. In those\n  \t\t// cases we update immediately\n  \t\tif (this.dirty) this.update();\n\n  \t\treturn this;\n  \t};\n\n  \tFragment.prototype.bubble = function bubble() {\n  \t\tthis.dirtyArgs = this.dirtyValue = true;\n\n  \t\tif (!this.dirty) {\n  \t\t\tthis.dirty = true;\n\n  \t\t\tif (this.isRoot) {\n  \t\t\t\t// TODO encapsulate 'is component root, but not overall root' check?\n  \t\t\t\tif (this.ractive.component) {\n  \t\t\t\t\tthis.ractive.component.bubble();\n  \t\t\t\t} else if (this.bound) {\n  \t\t\t\t\trunloop.addFragment(this);\n  \t\t\t\t}\n  \t\t\t} else {\n  \t\t\t\tthis.owner.bubble();\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tFragment.prototype.createItems = function createItems() {\n  \t\tvar _this = this;\n\n  \t\tthis.items = this.template.map(function (template, index) {\n  \t\t\treturn createItem({ parentFragment: _this, template: template, index: index });\n  \t\t});\n  \t};\n\n  \tFragment.prototype.detach = function detach() {\n  \t\tvar docFrag = createDocumentFragment();\n  \t\tthis.items.forEach(function (item) {\n  \t\t\treturn docFrag.appendChild(item.detach());\n  \t\t});\n  \t\treturn docFrag;\n  \t};\n\n  \tFragment.prototype.find = function find(selector) {\n  \t\tvar len = this.items.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.items[i].find(selector);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tFragment.prototype.findAll = function findAll(selector, query) {\n  \t\tif (this.items) {\n  \t\t\tvar len = this.items.length;\n  \t\t\tvar i = void 0;\n\n  \t\t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t\tvar item = this.items[i];\n\n  \t\t\t\tif (item.findAll) {\n  \t\t\t\t\titem.findAll(selector, query);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn query;\n  \t};\n\n  \tFragment.prototype.findComponent = function findComponent(name) {\n  \t\tvar len = this.items.length;\n  \t\tvar i = void 0;\n\n  \t\tfor (i = 0; i < len; i += 1) {\n  \t\t\tvar found = this.items[i].findComponent(name);\n  \t\t\tif (found) return found;\n  \t\t}\n  \t};\n\n  \tFragment.prototype.findAllComponents = function findAllComponents(name, query) {\n  \t\tif (this.items) {\n  \t\t\tvar len = this.items.length;\n  \t\t\tvar i = void 0;\n\n  \t\t\tfor (i = 0; i < len; i += 1) {\n  \t\t\t\tvar item = this.items[i];\n\n  \t\t\t\tif (item.findAllComponents) {\n  \t\t\t\t\titem.findAllComponents(name, query);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n\n  \t\treturn query;\n  \t};\n\n  \tFragment.prototype.findContext = function findContext() {\n  \t\tvar fragment = this;\n  \t\twhile (!fragment.context) {\n  \t\t\tfragment = fragment.parent;\n  \t\t}return fragment.context;\n  \t};\n\n  \tFragment.prototype.findNextNode = function findNextNode(item) {\n  \t\t// search for the next node going forward\n  \t\tfor (var i = item.index + 1; i < this.items.length; i++) {\n  \t\t\tif (!this.items[i]) continue;\n\n  \t\t\tvar node = this.items[i].firstNode(true);\n  \t\t\tif (node) return node;\n  \t\t}\n\n  \t\t// if this is the root fragment, and there are no more items,\n  \t\t// it means we're at the end...\n  \t\tif (this.isRoot) {\n  \t\t\tif (this.ractive.component) {\n  \t\t\t\treturn this.ractive.component.parentFragment.findNextNode(this.ractive.component);\n  \t\t\t}\n\n  \t\t\t// TODO possible edge case with other content\n  \t\t\t// appended to this.ractive.el?\n  \t\t\treturn null;\n  \t\t}\n\n  \t\treturn this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  \t};\n\n  \tFragment.prototype.findParentNode = function findParentNode() {\n  \t\tvar fragment = this;\n\n  \t\tdo {\n  \t\t\tif (fragment.owner.type === ELEMENT) {\n  \t\t\t\treturn fragment.owner.node;\n  \t\t\t}\n\n  \t\t\tif (fragment.isRoot && !fragment.ractive.component) {\n  \t\t\t\t// TODO encapsulate check\n  \t\t\t\treturn fragment.ractive.el;\n  \t\t\t}\n\n  \t\t\tif (fragment.owner.type === YIELDER) {\n  \t\t\t\tfragment = fragment.owner.containerFragment;\n  \t\t\t} else {\n  \t\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n  \t\t\t}\n  \t\t} while (fragment);\n\n  \t\tthrow new Error('Could not find parent node'); // TODO link to issue tracker\n  \t};\n\n  \tFragment.prototype.findRepeatingFragment = function findRepeatingFragment() {\n  \t\tvar fragment = this;\n  \t\t// TODO better check than fragment.parent.iterations\n  \t\twhile (fragment.parent && !fragment.isIteration) {\n  \t\t\tfragment = fragment.parent || fragment.componentParent;\n  \t\t}\n\n  \t\treturn fragment;\n  \t};\n\n  \tFragment.prototype.firstNode = function firstNode(skipParent) {\n  \t\tvar node = void 0;\n  \t\tfor (var i = 0; i < this.items.length; i++) {\n  \t\t\tnode = this.items[i].firstNode(true);\n\n  \t\t\tif (node) {\n  \t\t\t\treturn node;\n  \t\t\t}\n  \t\t}\n\n  \t\tif (skipParent) return null;\n\n  \t\treturn this.parent.findNextNode(this.owner);\n  \t};\n\n  \t// TODO ideally, this would be deprecated in favour of an\n  \t// expression-like approach\n\n\n  \tFragment.prototype.getArgsList = function getArgsList() {\n  \t\tif (this.dirtyArgs) {\n  \t\t\tvar values = {};\n  \t\t\tvar source = processItems(this.items, values, this.ractive._guid);\n  \t\t\tvar parsed = parseJSON('[' + source + ']', values);\n\n  \t\t\tthis.argsList = parsed ? parsed.value : [this.toString()];\n\n  \t\t\tthis.dirtyArgs = false;\n  \t\t}\n\n  \t\treturn this.argsList;\n  \t};\n\n  \tFragment.prototype.rebind = function rebind(context) {\n  \t\tthis.context = context;\n\n  \t\tthis.items.forEach(_rebind);\n  \t};\n\n  \tFragment.prototype.render = function render(target, occupants) {\n  \t\tif (this.rendered) throw new Error('Fragment is already rendered!');\n  \t\tthis.rendered = true;\n\n  \t\tthis.items.forEach(function (item) {\n  \t\t\treturn item.render(target, occupants);\n  \t\t});\n  \t};\n\n  \tFragment.prototype.resetTemplate = function resetTemplate(template) {\n  \t\tvar wasBound = this.bound;\n  \t\tvar wasRendered = this.rendered;\n\n  \t\t// TODO ensure transitions are disabled globally during reset\n\n  \t\tif (wasBound) {\n  \t\t\tif (wasRendered) this.unrender(true);\n  \t\t\tthis.unbind();\n  \t\t}\n\n  \t\tthis.template = template;\n  \t\tthis.createItems();\n\n  \t\tif (wasBound) {\n  \t\t\tthis.bind(this.context);\n\n  \t\t\tif (wasRendered) {\n  \t\t\t\tvar parentNode = this.findParentNode();\n  \t\t\t\tvar anchor = this.parent ? this.parent.findNextNode(this.owner) : null;\n\n  \t\t\t\tif (anchor) {\n  \t\t\t\t\tvar docFrag = createDocumentFragment();\n  \t\t\t\t\tthis.render(docFrag);\n  \t\t\t\t\tparentNode.insertBefore(docFrag, anchor);\n  \t\t\t\t} else {\n  \t\t\t\t\tthis.render(parentNode);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t}\n  \t};\n\n  \tFragment.prototype.resolve = function resolve(template, callback) {\n  \t\tif (!this.context) {\n  \t\t\treturn this.parent.resolve(template, callback);\n  \t\t}\n\n  \t\tvar resolver = new ReferenceResolver(this, template, callback);\n  \t\tthis.resolvers.push(resolver);\n\n  \t\treturn resolver; // so we can e.g. force resolution\n  \t};\n\n  \tFragment.prototype.toHtml = function toHtml() {\n  \t\treturn this.toString();\n  \t};\n\n  \tFragment.prototype.toString = function toString(escape) {\n  \t\treturn this.items.map(escape ? toEscapedString : _toString).join('');\n  \t};\n\n  \tFragment.prototype.unbind = function unbind() {\n  \t\tthis.items.forEach(_unbind);\n  \t\tthis.bound = false;\n\n  \t\treturn this;\n  \t};\n\n  \tFragment.prototype.unrender = function unrender(shouldDestroy) {\n  \t\tthis.items.forEach(shouldDestroy ? unrenderAndDestroy$1 : _unrender);\n  \t\tthis.rendered = false;\n  \t};\n\n  \tFragment.prototype.update = function update() {\n  \t\tif (this.dirty && !this.updating) {\n  \t\t\tthis.dirty = false;\n  \t\t\tthis.updating = true;\n  \t\t\tthis.items.forEach(_update);\n  \t\t\tthis.updating = false;\n  \t\t}\n  \t};\n\n  \tFragment.prototype.valueOf = function valueOf() {\n  \t\tif (this.items.length === 1) {\n  \t\t\treturn this.items[0].valueOf();\n  \t\t}\n\n  \t\tif (this.dirtyValue) {\n  \t\t\tvar values = {};\n  \t\t\tvar source = processItems(this.items, values, this.ractive._guid);\n  \t\t\tvar parsed = parseJSON(source, values);\n\n  \t\t\tthis.value = parsed ? parsed.value : this.toString();\n\n  \t\t\tthis.dirtyValue = false;\n  \t\t}\n\n  \t\treturn this.value;\n  \t};\n\n  \treturn Fragment;\n  }();\n\n  // TODO should resetTemplate be asynchronous? i.e. should it be a case\n  // of outro, update template, intro? I reckon probably not, since that\n  // could be achieved with unrender-resetTemplate-render. Also, it should\n  // conceptually be similar to resetPartial, which couldn't be async\n\n  function Ractive$resetTemplate(template) {\n  \ttemplateConfigurator.init(null, this, { template: template });\n\n  \tvar transitionsEnabled = this.transitionsEnabled;\n  \tthis.transitionsEnabled = false;\n\n  \t// Is this is a component, we need to set the `shouldDestroy`\n  \t// flag, otherwise it will assume by default that a parent node\n  \t// will be detached, and therefore it doesn't need to bother\n  \t// detaching its own nodes\n  \tvar component = this.component;\n  \tif (component) component.shouldDestroy = true;\n  \tthis.unrender();\n  \tif (component) component.shouldDestroy = false;\n\n  \t// remove existing fragment and create new one\n  \tthis.fragment.unbind().unrender(true);\n\n  \tthis.fragment = new Fragment({\n  \t\ttemplate: this.template,\n  \t\troot: this,\n  \t\towner: this\n  \t});\n\n  \tvar docFrag = createDocumentFragment();\n  \tthis.fragment.bind(this.viewmodel).render(docFrag);\n  \tthis.el.insertBefore(docFrag, this.anchor);\n\n  \tthis.transitionsEnabled = transitionsEnabled;\n  }\n\n  var reverse = makeArrayMethod('reverse');\n\n  function Ractive$set(keypath, value) {\n  \tvar promise = runloop.start(this, true);\n\n  \t// Set multiple keypaths in one go\n  \tif (isObject(keypath)) {\n  \t\tvar map = keypath;\n\n  \t\tfor (var k in map) {\n  \t\t\tif (map.hasOwnProperty(k)) {\n  \t\t\t\tset(this, k, map[k]);\n  \t\t\t}\n  \t\t}\n  \t}\n  \t// Set a single keypath\n  \telse {\n  \t\t\tset(this, keypath, value);\n  \t\t}\n\n  \trunloop.end();\n\n  \treturn promise;\n  }\n\n  function set(ractive, keypath, value) {\n  \tif (typeof value === 'function') value = bind(value, ractive);\n\n  \tif (/\\*/.test(keypath)) {\n  \t\tractive.viewmodel.findMatches(splitKeypathI(keypath)).forEach(function (model) {\n  \t\t\tmodel.set(value);\n  \t\t});\n  \t} else {\n  \t\tvar model = ractive.viewmodel.joinAll(splitKeypathI(keypath));\n  \t\tmodel.set(value);\n  \t}\n  }\n\n  var shift = makeArrayMethod('shift');\n\n  var sort = makeArrayMethod('sort');\n\n  var splice = makeArrayMethod('splice');\n\n  function Ractive$subtract(keypath, d) {\n  \treturn add(this, keypath, d === undefined ? -1 : -d);\n  }\n\n  var teardownHook$1 = new Hook('teardown');\n\n  // Teardown. This goes through the root fragment and all its children, removing observers\n  // and generally cleaning up after itself\n\n  function Ractive$teardown() {\n  \tvar _this = this;\n\n  \tthis.fragment.unbind();\n  \tthis.viewmodel.teardown();\n\n  \tthis._observers.forEach(cancel);\n\n  \tif (this.fragment.rendered && this.el.__ractive_instances__) {\n  \t\tremoveFromArray(this.el.__ractive_instances__, this);\n  \t}\n\n  \tthis.shouldDestroy = true;\n  \tvar promise = this.fragment.rendered ? this.unrender() : Promise$1.resolve();\n\n  \tObject.keys(this._links).forEach(function (k) {\n  \t\treturn _this._links[k].unlink();\n  \t});\n\n  \tteardownHook$1.fire(this);\n\n  \treturn promise;\n  }\n\n  function Ractive$toggle(keypath) {\n  \tif (typeof keypath !== 'string') {\n  \t\tthrow new TypeError(badArguments);\n  \t}\n\n  \tvar changes = void 0;\n\n  \tif (/\\*/.test(keypath)) {\n  \t\tchanges = {};\n\n  \t\tthis.viewmodel.findMatches(splitKeypathI(keypath)).forEach(function (model) {\n  \t\t\tchanges[model.getKeypath()] = !model.get();\n  \t\t});\n\n  \t\treturn this.set(changes);\n  \t}\n\n  \treturn this.set(keypath, !this.get(keypath));\n  }\n\n  function Ractive$toCSS() {\n  \tvar cssIds = [this.cssId].concat(babelHelpers.toConsumableArray(this.findAllComponents().map(function (c) {\n  \t\treturn c.cssId;\n  \t})));\n  \tvar uniqueCssIds = Object.keys(cssIds.reduce(function (ids, id) {\n  \t\treturn ids[id] = true, ids;\n  \t}, {}));\n  \treturn getCSS(uniqueCssIds);\n  }\n\n  function Ractive$toHTML() {\n  \treturn this.fragment.toString(true);\n  }\n\n  function Ractive$transition(name, node, params) {\n\n  \tif (node instanceof HTMLElement) {\n  \t\t// good to go\n  \t} else if (isObject(node)) {\n  \t\t\t// omitted, use event node\n  \t\t\tparams = node;\n  \t\t}\n\n  \t// if we allow query selector, then it won't work\n  \t// simple params like \"fast\"\n\n  \t// else if ( typeof node === 'string' ) {\n  \t// \t// query selector\n  \t// \tnode = this.find( node )\n  \t// }\n\n  \tnode = node || this.event.node;\n\n  \tif (!node) {\n  \t\tfatal('No node was supplied for transition ' + name);\n  \t}\n\n  \tvar transition = new Transition(this, node, name, params);\n  \tvar promise = runloop.start(this, true);\n  \trunloop.registerTransition(transition);\n  \trunloop.end();\n  \treturn promise;\n  }\n\n  function unlink(here) {\n  \tvar ln = this._links[here];\n\n  \tif (ln) {\n  \t\tln.unlink();\n  \t\tdelete this._links[here];\n  \t\treturn this.set(here, ln.intialValue);\n  \t} else {\n  \t\treturn Promise$1.resolve(true);\n  \t}\n  }\n\n  var unrenderHook$1 = new Hook('unrender');\n\n  function Ractive$unrender() {\n  \tif (!this.fragment.rendered) {\n  \t\twarnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n  \t\treturn Promise$1.resolve();\n  \t}\n\n  \tvar promise = runloop.start(this, true);\n\n  \t// If this is a component, and the component isn't marked for destruction,\n  \t// don't detach nodes from the DOM unnecessarily\n  \tvar shouldDestroy = !this.component || this.component.shouldDestroy || this.shouldDestroy;\n  \tthis.fragment.unrender(shouldDestroy);\n\n  \tremoveFromArray(this.el.__ractive_instances__, this);\n\n  \tunrenderHook$1.fire(this);\n\n  \trunloop.end();\n  \treturn promise;\n  }\n\n  var unshift = makeArrayMethod('unshift');\n\n  var updateHook = new Hook('update');\n\n  function Ractive$update(keypath) {\n  \tif (keypath) keypath = splitKeypathI(keypath);\n\n  \tvar model = keypath ? this.viewmodel.joinAll(keypath) : this.viewmodel;\n\n  \tvar promise = runloop.start(this, true);\n\n  \tmodel.mark();\n\n  \tif (keypath) {\n  \t\t// there may be unresolved refs that are now resolvable up the context tree\n  \t\tvar _parent = model.parent;\n  \t\twhile (keypath.length && _parent) {\n  \t\t\tif (_parent.clearUnresolveds) _parent.clearUnresolveds(keypath.pop());\n  \t\t\t_parent = _parent.parent;\n  \t\t}\n  \t}\n\n  \t// notify upstream\n  \tvar parent = model.parent;\n  \twhile (parent) {\n  \t\tvar i = parent.deps.length;\n  \t\twhile (i--) {\n  \t\t\tparent.deps[i].handleChange();\n  \t\t}parent = parent.parent;\n  \t}\n\n  \trunloop.end();\n\n  \tupdateHook.fire(this, model);\n\n  \treturn promise;\n  }\n\n  function Ractive$updateModel(keypath, cascade) {\n  \tvar promise = runloop.start(this, true);\n\n  \tif (!keypath) {\n  \t\tthis.viewmodel.updateFromBindings(true);\n  \t} else {\n  \t\tthis.viewmodel.joinAll(splitKeypathI(keypath)).updateFromBindings(cascade !== false);\n  \t}\n\n  \trunloop.end();\n\n  \treturn promise;\n  }\n\n  var proto = {\n  \tadd: Ractive$add,\n  \tanimate: Ractive$animate,\n  \tdetach: Ractive$detach,\n  \tfind: Ractive$find,\n  \tfindAll: Ractive$findAll,\n  \tfindAllComponents: Ractive$findAllComponents,\n  \tfindComponent: Ractive$findComponent,\n  \tfindContainer: Ractive$findContainer,\n  \tfindParent: Ractive$findParent,\n  \tfire: Ractive$fire,\n  \tget: Ractive$get,\n  \tinsert: Ractive$insert,\n  \tlink: link,\n  \tmerge: Ractive$merge,\n  \tobserve: observe,\n  \tobserveList: observeList,\n  \tobserveOnce: observeOnce,\n  \t// TODO reinstate these\n  \t// observeListOnce,\n  \toff: Ractive$off,\n  \ton: Ractive$on,\n  \tonce: Ractive$once,\n  \tpop: pop,\n  \tpush: push,\n  \trender: Ractive$render,\n  \treset: Ractive$reset,\n  \tresetPartial: resetPartial,\n  \tresetTemplate: Ractive$resetTemplate,\n  \treverse: reverse,\n  \tset: Ractive$set,\n  \tshift: shift,\n  \tsort: sort,\n  \tsplice: splice,\n  \tsubtract: Ractive$subtract,\n  \tteardown: Ractive$teardown,\n  \ttoggle: Ractive$toggle,\n  \ttoCSS: Ractive$toCSS,\n  \ttoCss: Ractive$toCSS,\n  \ttoHTML: Ractive$toHTML,\n  \ttoHtml: Ractive$toHTML,\n  \ttransition: Ractive$transition,\n  \tunlink: unlink,\n  \tunrender: Ractive$unrender,\n  \tunshift: unshift,\n  \tupdate: Ractive$update,\n  \tupdateModel: Ractive$updateModel\n  };\n\n  function wrap$1 (method, superMethod, force) {\n\n  \tif (force || needsSuper(method, superMethod)) {\n\n  \t\treturn function () {\n\n  \t\t\tvar hasSuper = '_super' in this,\n  \t\t\t    _super = this._super,\n  \t\t\t    result;\n\n  \t\t\tthis._super = superMethod;\n\n  \t\t\tresult = method.apply(this, arguments);\n\n  \t\t\tif (hasSuper) {\n  \t\t\t\tthis._super = _super;\n  \t\t\t}\n\n  \t\t\treturn result;\n  \t\t};\n  \t} else {\n  \t\treturn method;\n  \t}\n  }\n\n  function needsSuper(method, superMethod) {\n  \treturn typeof superMethod === 'function' && /_super/.test(method);\n  }\n\n  function unwrap(Child) {\n  \tvar options = {};\n\n  \twhile (Child) {\n  \t\taddRegistries(Child, options);\n  \t\taddOtherOptions(Child, options);\n\n  \t\tif (Child._Parent !== Ractive) {\n  \t\t\tChild = Child._Parent;\n  \t\t} else {\n  \t\t\tChild = false;\n  \t\t}\n  \t}\n\n  \treturn options;\n  }\n\n  function addRegistries(Child, options) {\n  \tregistries.forEach(function (r) {\n  \t\taddRegistry(r.useDefaults ? Child.prototype : Child, options, r.name);\n  \t});\n  }\n\n  function addRegistry(target, options, name) {\n  \tvar registry,\n  \t    keys = Object.keys(target[name]);\n\n  \tif (!keys.length) {\n  \t\treturn;\n  \t}\n\n  \tif (!(registry = options[name])) {\n  \t\tregistry = options[name] = {};\n  \t}\n\n  \tkeys.filter(function (key) {\n  \t\treturn !(key in registry);\n  \t}).forEach(function (key) {\n  \t\treturn registry[key] = target[name][key];\n  \t});\n  }\n\n  function addOtherOptions(Child, options) {\n  \tObject.keys(Child.prototype).forEach(function (key) {\n  \t\tif (key === 'computed') {\n  \t\t\treturn;\n  \t\t}\n\n  \t\tvar value = Child.prototype[key];\n\n  \t\tif (!(key in options)) {\n  \t\t\toptions[key] = value._method ? value._method : value;\n  \t\t}\n\n  \t\t// is it a wrapped function?\n  \t\telse if (typeof options[key] === 'function' && typeof value === 'function' && options[key]._method) {\n\n  \t\t\t\tvar result = void 0,\n  \t\t\t\t    needsSuper = value._method;\n\n  \t\t\t\tif (needsSuper) {\n  \t\t\t\t\tvalue = value._method;\n  \t\t\t\t}\n\n  \t\t\t\t// rewrap bound directly to parent fn\n  \t\t\t\tresult = wrap$1(options[key]._method, value);\n\n  \t\t\t\tif (needsSuper) {\n  \t\t\t\t\tresult._method = result;\n  \t\t\t\t}\n\n  \t\t\t\toptions[key] = result;\n  \t\t\t}\n  \t});\n  }\n\n  function extend() {\n  \tfor (var _len = arguments.length, options = Array(_len), _key = 0; _key < _len; _key++) {\n  \t\toptions[_key] = arguments[_key];\n  \t}\n\n  \tif (!options.length) {\n  \t\treturn extendOne(this);\n  \t} else {\n  \t\treturn options.reduce(extendOne, this);\n  \t}\n  }\n\n  function extendOne(Parent) {\n  \tvar options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  \tvar _Child, proto;\n\n  \t// if we're extending with another Ractive instance...\n  \t//\n  \t//   var Human = Ractive.extend(...), Spider = Ractive.extend(...);\n  \t//   var Spiderman = Human.extend( Spider );\n  \t//\n  \t// ...inherit prototype methods and default options as well\n  \tif (options.prototype instanceof Ractive) {\n  \t\toptions = unwrap(options);\n  \t}\n\n  \t_Child = function Child(options) {\n  \t\tif (!(this instanceof _Child)) return new _Child(options);\n\n  \t\tconstruct(this, options || {});\n  \t\tinitialise(this, options || {}, {});\n  \t};\n\n  \tproto = create(Parent.prototype);\n  \tproto.constructor = _Child;\n\n  \t// Static properties\n  \tdefineProperties(_Child, {\n  \t\t// alias prototype as defaults\n  \t\tdefaults: { value: proto },\n\n  \t\t// extendable\n  \t\textend: { value: extend, writable: true, configurable: true },\n\n  \t\t// Parent - for IE8, can't use Object.getPrototypeOf\n  \t\t_Parent: { value: Parent }\n  \t});\n\n  \t// extend configuration\n  \tconfig.extend(Parent, proto, options);\n\n  \tdataConfigurator.extend(Parent, proto, options);\n\n  \tif (options.computed) {\n  \t\tproto.computed = extendObj(create(Parent.prototype.computed), options.computed);\n  \t}\n\n  \t_Child.prototype = proto;\n\n  \treturn _Child;\n  }\n\n  function getNodeInfo (node) {\n  \tif (!node || !node._ractive) return {};\n\n  \tvar storage = node._ractive;\n  \tvar ractive = storage.fragment.ractive;\n\n  \tvar _gatherRefs = gatherRefs(storage.fragment);\n\n  \tvar key = _gatherRefs.key;\n  \tvar index = _gatherRefs.index;\n\n  \tvar context = storage.fragment.findContext();\n\n  \treturn {\n  \t\tractive: ractive,\n  \t\tkeypath: context.getKeypath(ractive),\n  \t\trootpath: context.getKeypath(),\n  \t\tindex: index,\n  \t\tkey: key\n  \t};\n  }\n\n  function joinKeys() {\n  \tfor (var _len = arguments.length, keys = Array(_len), _key = 0; _key < _len; _key++) {\n  \t\tkeys[_key] = arguments[_key];\n  \t}\n\n  \treturn keys.map(escapeKey).join('.');\n  }\n\n  function splitKeypath(keypath) {\n  \treturn splitKeypathI(keypath).map(unescapeKey);\n  }\n\n  // Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n  // older browsers, these are made available via a shim - here, we do a quick\n  // pre-flight check to make sure that either a) we're not in a shit browser,\n  // or b) we're using a Ractive-legacy.js build\n  var FUNCTION = 'function';\n\n  if (babelHelpers.typeof(Date.now) !== FUNCTION || babelHelpers.typeof(String.prototype.trim) !== FUNCTION || babelHelpers.typeof(Object.keys) !== FUNCTION || babelHelpers.typeof(Array.prototype.indexOf) !== FUNCTION || babelHelpers.typeof(Array.prototype.forEach) !== FUNCTION || babelHelpers.typeof(Array.prototype.map) !== FUNCTION || babelHelpers.typeof(Array.prototype.filter) !== FUNCTION || win && babelHelpers.typeof(win.addEventListener) !== FUNCTION) {\n  \tthrow new Error('It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.');\n  }\n\n  function Ractive(options) {\n  \tif (!(this instanceof Ractive)) return new Ractive(options);\n\n  \tconstruct(this, options || {});\n  \tinitialise(this, options || {}, {});\n  }\n\n  extendObj(Ractive.prototype, proto, defaults);\n  Ractive.prototype.constructor = Ractive;\n\n  // alias prototype as `defaults`\n  Ractive.defaults = Ractive.prototype;\n\n  // static properties\n  defineProperties(Ractive, {\n\n  \t// debug flag\n  \tDEBUG: { writable: true, value: true },\n  \tDEBUG_PROMISES: { writable: true, value: true },\n\n  \t// static methods:\n  \textend: { value: extend },\n  \tescapeKey: { value: escapeKey },\n  \tgetNodeInfo: { value: getNodeInfo },\n  \tjoinKeys: { value: joinKeys },\n  \tparse: { value: parse },\n  \tsplitKeypath: { value: splitKeypath },\n  \tunescapeKey: { value: unescapeKey },\n  \tgetCSS: { value: getCSS },\n\n  \t// namespaced constructors\n  \tPromise: { value: Promise$1 },\n\n  \t// support\n  \tenhance: { writable: true, value: false },\n  \tsvg: { value: svg },\n  \tmagic: { value: magicSupported },\n\n  \t// version\n  \tVERSION: { value: '0.8.0-edge' },\n\n  \t// plugins\n  \tadaptors: { writable: true, value: {} },\n  \tcomponents: { writable: true, value: {} },\n  \tdecorators: { writable: true, value: {} },\n  \teasing: { writable: true, value: easing },\n  \tevents: { writable: true, value: {} },\n  \tinterpolators: { writable: true, value: interpolators },\n  \tpartials: { writable: true, value: {} },\n  \ttransitions: { writable: true, value: {} }\n  });\n\n  return Ractive;\n\n}));"],"names":["this","conditionalAttributes","forEach","_bind","eventHandlers","decorator","bind","fragment","binding","createTwowayBinding","Element","prototype","attributes","template","a","shouldBind","twoway","ractive","Binding","selectBinding","model","detach","unrender","detachNode","node","find","selector","matches","findAll","query","test","add","live","liveQueries","push","findComponent","name","findAllComponents","findNextNode","firstNode","getAttribute","attribute","attributeByName","getValue","undefined","rebind","_rebind","makeDirty$1","render","target","occupants","_this2","namespace","getNamespace","existing","n","shift","nodeName","e","toUpperCase","namespaceURI","createElement","defineProperty","value","proxy","parentFragment","cssIds","setAttribute","map","x","join","foundNode","children","toArray","childNodes","wasUndefined","setFromNode","i","length","removeAttribute","_render","runloop","scheduleTask","updateLiveQueries$1","_introTransition","getTransition","t0","t1","appendChild","rendered","toString","tagName","attrs","stringifyAttribute","isSelected","inputIsCheckedRadio","str","isVoid","escapeHtml","unbind","_unbind","shouldDestroy","transition","complete","detachWhenReady","_unrender","t2","id","nodes","removeFromLiveQueries","update","dirty","_update","Item","Form","_Element","options","babelHelpers","classCallCheck","_this","possibleConstructorReturn","call","formBindings","inherits","addEventListener","handleReset","removeEventListener","Mustache","_Item","index","isStatic","s","resolve$1","get","register","resolver","resolve","r","handleChange","bubble","unregister","Interpolator","_Mustache","apply","arguments","getString","safeToStringValue","nodeType","nodeValue","doc","createTextNode","insertBefore","escape","string","data","valueOf","Input","defaultValue","Option","f","select","findParentSelect","parent","selectedAttribute","selected","indexOf","splice","optionValue","selectValue","isArray","removeFromArray","Partial","refName","getPartialTemplate","templateObj","named","setTemplate","t","parsePartial","Fragment","owner","partialTemplate","skipParent","forceResetTemplate","warnOnceIfDebug","resetTemplate","RepeatedFragment","context","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","createIteration","isObject","refs","split","Object","keys","key","isIteration","joinKey","z","aliases","docFrag","createDocumentFragment","len","found","iteration","shuffle","newIndices","_this3","slice","newIndex","oldIndex","toEscapedString","_toString","unrenderAndDestroy","_this4","updatePostShuffle","updating","wasArray","toRemove","oldKeys","reset","_fragment","newLength","parentNode","findParentNode","anchor","_this5","indices","maxIdx","merged","frag","_frag","Section","sectionType","templateSectionType","SECTION_UNLESS","SECTION_IF","SECTION_EACH","isRoot","lastType","getType","newFragment","SECTION_WITH","SECTION_IF_WITH","isEmpty","fragmentShouldExist","Select","selectedOptions","getSelectedOptions","sync","defaultSelected","selectNode","o","isMultiple","optionWasSelected","_ractive","shouldSelect","valueContains","forceUpdate","Textarea","_Input","isBindable","noContent","Text","type","TEXT","elementCache","ieBug","ieBlacklist","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","Triple","queryResult","querySelector","queryAllResult","querySelectorAll","numNodes","j","html","insertHtml","decodeCharacterReferences","Yielder","container","component","containerFragment","yielders","_inlinePartials","parse","warnIfDebug","partials","constructors","ALIAS","Alias","DOCTYPE","Doctype","INTERPOLATOR","PARTIAL","SECTION","TRIPLE","YIELDER","specialElements","doctype","form","input","option","textarea","ReferenceResolver","reference","callback","normalise","splitKeypathI","resolved","addUnresolved","componentParent","attemptResolution","resolveAmbiguousReference","forceResolution","findContext","joinAll","unresolved","resolvers","dirtyArgs","dirtyValue","createItems","items","bound","addFragment","createItem","item","ELEMENT","el","Error","findRepeatingFragment","getArgsList","values","source","processItems","_guid","parsed","parseJSON","argsList","wasBound","wasRendered","toHtml","unrenderAndDestroy$1","reverse","makeArrayMethod","sort","teardownHook$1","Hook","unrenderHook$1","unshift","updateHook","proto","Ractive$add","animate","Ractive$animate","Ractive$detach","Ractive$find","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","findContainer","Ractive$findContainer","findParent","Ractive$findParent","fire","Ractive$fire","Ractive$get","insert","Ractive$insert","link","merge","Ractive$merge","observe","observeList","observeOnce","off","Ractive$off","on","Ractive$on","once","Ractive$once","pop","Ractive$render","Ractive$reset","resetPartial","Ractive$resetTemplate","set","Ractive$set","subtract","Ractive$subtract","teardown","Ractive$teardown","toggle","Ractive$toggle","toCSS","Ractive$toCSS","toCss","toHTML","Ractive$toHTML","Ractive$transition","unlink","Ractive$unrender","Ractive$update","updateModel","Ractive$updateModel","FUNCTION","Date","now","String","trim","Array","filter","win","extendObj","Ractive","defaults","constructor","defineProperties","DEBUG","writable","DEBUG_PROMISES","extend","escapeKey","getNodeInfo","joinKeys","splitKeypath","unescapeKey","getCSS","Promise","Promise$1","enhance","svg","magic","magicSupported","VERSION","adaptors","components","decorators","easing","events","interpolators","transitions","localKey","viewmodel","instance","childData","complexMappings","initialise","_partials","Component","checkYielders","end","makeDirty","mappings","updateLiveQueries","setupEvents","handlers","v","eventNames","eventName","event","RactiveEvent","EventDirective","_observers","cancel","removeFromLiveComponentQueries","__ractive_instances__","_links","k","teardownHook","_this6","remove","textTypes","propertyNames","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","booleanAttributes","voidElementNames","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","prop","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","RegExp","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","Attribute","element","updateDelegate","interpolator","namespaces","propertyName","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","getKeypath","replace","div$1","ConditionalAttribute","isSvg","svg$1","parseAttributes","notIn","missingDecorator","noop","Decorator","dynamicName","dynamicArgs","d","nameFragment","argsFragment","args","intermediary","fn","findInViewHierarchy","warnOnce","missingPlugin","concat","nameChanged","DOMEvent","fatal","handler","listen","directive","original","unlisten","CustomEvent","eventPlugin","prefix","isClient","prefixCache","testStyle","style","camelCase","capped","charAt","substring","vendors","vendor","prefix$1","visible","hidden","prefix$2","i$1","onChange","onHide","onShow","unprefixPattern","vendorPattern","createTransitions","linear","canUseCssTransitions","cannotUseCssTransitions","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","webkitTransition","to","changedProperties","setTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","isIntro","transitionEndHandler","unprefix","previous","property","duration","timing","hashPrefix","hyphenate","hash","originalValue","propertiesToTransitionInJs","suffix","getStyle","exec","interpolate","parseFloat","Ticker","step","pos","_prop","delay","createTransitions$1","getComputedStyle","legacy","Transition","params","_fn","animateStyle","setStyle","fulfil","computedStyle","current","props","styles","_value","processParams","hasOwnProperty","start","originalStyle","completed","noReset","resetStyle","_manager","promise","then","twowayBinding","isUnresolved","warnAboutAmbiguity","isReadonly","keypath","getInitialValue","parentForm","findParentForm","resetValue","registerTwowayBinding","root","locked","unregisterTwowayBinding","CheckboxBinding","_Binding","handleDomEvent","attachEvent","checked","BindingGroup","bindings","push$1","CheckboxNameBinding","checkboxName","group","getBindingGroup","getValue$1","noInitialValue","existingValue","bindingValue","arrayContains","changed","wasChecked","isChecked","valueSoFar","ContentEditableBinding","lazy","GenericBinding","timeout","isNumeric","handleDelay","handleBlur","MultipleSelectBinding","selectedValues","previousValue","arrayContentsMatch","result","setValue","initialValue","NumericBinding","_GenericBinding","isNaN","siblings","RadioBinding","getSiblings","RadioNameBinding","getValue$2","nameAttributeBinding","getKeypathModel","SingleSelectBinding","disabled","toLowerCase","m","Link","LinkSide","dest","side","comparators","Observer","oldValue","newValue","defer","strict","init","dispatch","addObserver","PatternObserver","baseModel","pattern","baseKeypath","oldValues","newValues","models","findMatches","newKeys","isEqual","wildcards","base","max","_i","touchedFrom","ListObserver","pending","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","notEmptyString","arrayProto","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","getElementsByTagName","styleSheet","renderHook","completeHook","adaptConfigurator","Parent","adapt","combine","ensureArray","selectorsPattern","commentsPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","cssConfigurator","css","uuid","noCssTransform","transformCss","cssId","addCSS","dataConfigurator","combine$1","TEMPLATE_VERSION","functions","create","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","parser","fromId","noThrow","getElementById","textContent","isParsed","getParseOptions","reduce","val","throwNoParse","addFunctions","parseFor","templateConfigurator","parseTemplate","getDynamicTemplate","_config","p","extendPartials","registryNames","Registry","useDefaults","configure","registry","isOwner","registries","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","c","shouldRerender","completeHook$1","resetHook","renderHook$1","unrenderHook","COMPONENT","NUMBER_LITERAL","STRING_LITERAL","REFERENCE","ComputationChild","_Model","shouldCapture","capture","parentValue","deps","_handleChange","clearUnresolveds","childByKey","child","Model","ExpressionProxy","getFunction","computation","ref","resolveReference","match","signature","getter","getterString","compute","mark","retrieve","dep","ReferenceExpressionChild","applyValue","ReferenceExpressionProxy","_Model2","baseResolver","members","keypathModel","resolveAliases","mutatorMethods","patchedArrayProto","methodName","method","_len","_key","getNewIndices","setting","wrappers","processWrapper","patchArrayMethods","unpatchArrayMethods","__proto__","array","configurable","unpatch","patch","errorMessage$1","arrayAdaptor","object","wrap","ArrayWrapper","__model","instances","storage","magicAdaptor","MagicWrapper","Parser","ParseError","magicAdaptor$1","originalDescriptors","originalDescriptor","getOwnPropertyDescriptor","childKeypath","descriptor","createOrWrapDescriptor","__magic","revert","dependants","MagicArrayWrapper","magicWrapper","arrayWrapper","magicArrayAdaptor","Computation","isExpression","setter","computationContext","dependencies","boundsSensitive","startCapturing","message","hasConsole","console","groupCollapsed","functionBody","prettify","stack","getterUseStack","truncateStack","error","groupEnd","stopCapturing","setDependencies","_model","computations","RactiveModel","changes","hasProp$1","RootModel","applyChanges","_changeHash","flush","extendChildren","getRactiveModel","ractiveModel","getValueChildren","has","Function","GlobalModel$1","origin","wrapper","shouldTeardown","updateFromBindings","cascade","constructHook","registryNames$1","uid","HookQueue","hook","inProcess","queue","begin","getChildQueue","configHook","initHook","leadingWhitespace","lineStart","lines","lineEnds","line","lineEnd","read","leftover","remaining","postProcess","converters","getLinePos","char","columnNum","lineNum","numTabs","annotation","character","shortMessage","matchString","substr","matchPattern","allowWhitespace","nextChar","Child","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","Parser$1","getSingleQuotedString","makeQuotedStringMatcher","getDoubleQuotedString","numberPattern$1","identifier","specials","true","false","null","specialsPattern","numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","placeholder","special","number","stringLiteral","readStringLiteral","$1","pair","getKeyValuePair","valueToken","eventPattern","argumentsPattern","dollarArgsPattern","passthru","argsFn","action","g","argMatch","argument","dollarMatch","passedArgs","gatherRefs","rootpath","obj","oldEvent","preventDefault","stopPropagation","_args","fireEvent","ComponentConstructor","content","construct","code","validateCode","qualified","hasAttribute","haystack","needle","hyphenatedStr","_liveQueries","description","all","b","res","clearTimeout","bindName","bindChecked","transitionsEnabled","getTransitionName","getTransitionParams","registerTransition","typeAttribute","valueAttribute","nameAttribute","xmlns","partial","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","_Parent","hasIndexRef","selectedOption","selectedIndex","firstChild","getComponentConstructor","ElementConstructor","guid","counter","placeholderId","TypeError","badArguments","toConsumableArray","uniqueCssIds","ids","HTMLElement","here","ln","intialValue","_parent","wrap$1","superMethod","force","needsSuper","hasSuper","_super","unwrap","addRegistries","addOtherOptions","addRegistry","_method","extendOne","_Child","computed","_gatherRefs","Symbol","iterator","Constructor","subClass","superClass","enumerable","setPrototypeOf","self","ReferenceError","arr","arr2","from","append","delimiters","tripleDelimiters","staticDelimiters","staticTripleDelimiters","csp","preserveWhitespace","sanitize","stripComments","modifyArrays","isolated","noIntro","easeIn","Math","pow","easeOut","easeInOut","window","document","navigator","appName","warn","div","methodNames","unprefixed","prefixed","makeFunction","implementation","hasFeature","mathml","xlink","xml","ns","createElementNS","cloneNode","desc","F","log","printWarning","welcome","alreadyWarned","welcomeIntro","welcomeMessage","hasGroup","_Promise2","intermediate","min","properties","snap","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","errorMessage","deprecations","deprecated","replacement","deprecate","arg","PENDING","FULFILLED","REJECTED","dispatchHandlers","makeResolver","reject","fulfilledHandlers","rejectedHandlers","state","newState","makeDispatcher","wait","onFulfilled","onRejected","promise2","processResolutionHandler","forward","p1result","promises","processPromise","reason","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","addChild","list","decrementOutros","check","decrementTotal","detachNodes","_detachNodes","ready","changeHook","batch","returnPromise","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","addToArray","observer","thing","task","postRender","_batch","noAnimation","requestAnimationFrame","detachHook","Query","isComponentQuery","_root","nodeOrComponent","sortByItemPosition","sortByDocumentPosition","starMaps","wildcardCache","captureGroup","lastTime","currTime","timeToCall","rAF","getTime","performance","tickers","running","tick","elapsed","eased","stop","abort","prefixers","KeyModel","dependant","KeypathModel","keypathModels","removeChild","hasProp","originatingModel","indexModels","unresolvedByKey","ticker","adaptor","getPrefixer","createBranch","_parentValue","previousOriginatingModel","specificKey","hasKey","branch","existingMatches","_loop","getIndexModel","fragmentIndex","getKeyModel","mapped","old","comparator","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","_merged","updateKeypathDependants","_updateFromBindings","_updateKeypathDependants","GlobalModel","global","insertHook","factory","exports","module","define","amd","getElement","output","sources","_len2","_key2","isFinite","format","logIfDebug","_len3","_key3","registryName","interpol","lastItem","member","arrayLike","called","resolvePromise","rejectPromise","y","tm","which","getOptions","isDetached","otherNode","compareDocumentPosition","bitmask","ancestryA","getAncestry","ancestryB","oldestA","oldestB","mutualAncestor","fragmentA","fragmentB","indexA","indexB","_indexA","_indexB","getParent","ancestry","ancestor","_liveComponentQueries","enqueue","_eventQueue","dequeue","getPotentialWildcardMatches","starMap","mapper","wildcardKeypath","getStarMap","star","num","binary","l","ones","parseInt","digit","_noArg","getWildcardNames","fireEventAs","subscribers","initialFire","_subs","notifySubscribers","fullName","originalEvent","stopEvent","badReference","localViewmodel","hasContextChain","crossedComponentBoundary","prefixKeypath","rootKeypath","rootDot","relativeKeypath","repeater","parts","fireInsertHook","there","run","sourcePath","getComparator","JSON","stringify","compare","observers","createObserver","keypaths","wildcardIndex","_ret","listeners","listener","spliceArguments","removeStart","removeEnd","balance","getSpliceEquivalent","styleDefinition","applyCSS","cssText","filteredStyleDefinitions","others","trim$1","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","dataAttr","selectors","s4","floor","random","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","fromExpression","body","fromComputationString","bindTo","hasThis","createFunction","exp","instructions","createFunctionFromString","initial","parseAsString","validate$1","existingPartials","newPartials","overwrite","getSuperMethod","oldSuper","getMessage","correct","isError","deprecateOption","deprecatedOption","extendOtherMethods","rerender","collect","collection","rx","section","_ref","fnBody","tabs","minIndent","prev","Infinity","truncated","getComputationSignature","setterString","initialiseProperties","deprecateRactiveData","getAdaptors","combine$2","protoAdapt","lookup","hookQueue","childQueue","userOptions","okQuote","literal","done","next","charCodeAt","readNumberLiteral","readKey","token","updateId","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateIEStyleAttribute","updateBoolean","updateNamespacedAttribute","updateAttribute","updateClassName","className","setAttributeNS","entity"],"mappings":"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,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,SAAU,IAAKC,MAAO,IAAKC,IAAK,IAAKC,KAAM,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,MAAO,KAAMC,KAAM,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,MAAO,KAAMC,QAAS,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,MAAO,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,KAAM,KAAMC,MAAO,KAAMC,GAAI,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"}